GrahamTechnology.iframecomms.resizeIFrame=function(){if(GrahamTechnology.iframecomms.resizeParentIFrameToForm){var b=GrahamTechnology.iframecomms.documentHeight();var a=GrahamTechnology.iframecomms.documentWidth();if(top.location!=self.location){if(b>0){GrahamTechnology.iframecomms.sendMessage({type:"resize",height:b,width:a})}}}};GrahamTechnology.iframecomms.documentHeight=function(){var b=document;var a=navigator.userAgent.indexOf("AppleWebKit")>-1;if(a){return b.documentElement.scrollHeight}else{return b.body.scrollHeight}};GrahamTechnology.iframecomms.documentWidth=function(){var b=document;var a=navigator.userAgent.indexOf("AppleWebKit")>-1;if(a){return b.documentElement.scrollWidth}else{return b.body.scrollWidth}};GrahamTechnology.iframecomms.currentIncrementalValue=1;GrahamTechnology.iframecomms.navigateParentPage=function(a){GrahamTechnology.iframecomms.sendMessage({type:"navigate",targetUrl:a});GrahamTechnology.iframecomms.navigatePending=true};GrahamTechnology.iframecomms.sendMessage=function(a){if(GrahamTechnology.iframecomms.navigatePending){return}a.srcUrl=window.location.href;var c=GrahamTechnology.iframecomms.iframeParentURL;if((!c||c.length===0)||((c&&c!=="*")&&GrahamTechnology.iframecomms.canAccessWindowAtUrl(c))){window.parent.SwordCiboodle.CiboodleFrameController.handleMessage(a)}else{var b=GrahamTechnology.iframecomms.serialiseMessage(a);if(window.postMessage){window.parent.postMessage(b,GrahamTechnology.iframecomms.extractDomain(c))}else{window.parent.location=c.replace(/#.*$/,"")+"#"+(+new Date)+(GrahamTechnology.iframecomms.currentIncrementalValue++)+"&"+b}}};GrahamTechnology.iframecomms.canAccessWindowAtUrl=function(c){var d=GrahamTechnology.iframecomms.extractDomain(window.location.href);var a=GrahamTechnology.iframecomms.extractDomain(c);if(d!==a){return false}try{var b=window.parent.SwordCiboodle.CiboodleFrameController}catch(f){return false}if(b){return true}else{return false}};GrahamTechnology.iframecomms.extractDomain=function(a){if(a==="*"){return"*"}return a.replace(/([^:]+:\/\/[^\/]+).*/,"$1")};GrahamTechnology.iframecomms.serialiseMessage=function(b){var a="";for(var c in b){if(b.hasOwnProperty(c)){if(a.length!==0){a+=":"}a+=c+"="+escape(b[c])}}return a};