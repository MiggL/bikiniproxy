define(["jquery","wcs.product-views-util"],function(f,d){var k=null,i=null;function h(){var m=0;if(f(".show-more-js").hasClass("expanded")){return false}f(".collapsable-container-js").not(f(".stl-product-grid-product-js .collapsable-container-js")).find(".attr-box").each(function(n){m+=f(this).outerWidth(true);if(f(this).hasClass("selected")){return false}});if(m>f(".collapsable-container-js").not(f(".stl-product-grid-product-js .collapsable-container-js")).width()){f(".show-more-js").click()}}function a(){var s=f(".collapsable-container-js").not(f(".stl-product-grid-product-js .collapsable-container-js")),m=s.find("label"),p=m.length,q=m.outerWidth(true),o=s.outerWidth(),r=Math.floor(o/q),n=Math.ceil(p/r);if(n===0){return}else{if(n===1){d.pdpUpdatePage.toggleVisibility(f(".show-more-js"),false)}else{d.pdpUpdatePage.toggleVisibility(f(".show-more-js"),true)}}}function l(){if(k=="last"){return}var t=f(".collapsable-container-js"),q=f(".color-swatches-action-js"),s=t.find("label"),o=s.length,p=s.outerWidth(true),n=t.outerWidth(),r=Math.floor(n/p),m=Math.ceil(o/r);i=s.outerHeight(true);t.height(i);if(m===0){return}else{if(m===1){q.css("display","none")}else{$lastElementInFirstRow=f(f("label",t).get(r-2));inputId=$lastElementInFirstRow.attr("for");q.css("display","inline-block");f('label[for="'+inputId+'"]').after(q)}}}function j(){var m=(typeof SHOWMORELINKASSWATCH!=="undefined"&&SHOWMORELINKASSWATCH);if(m){l();c()}else{a();e()}}var g=(function(){var m={};m.init=function(p){var n,o;if(p==="marketing"){n=f(".btn-marketing-video-js")}else{if(p==="product"){n=f(".product-videos-js")}}o=m.setVideoSwatchHtml(p,n)||"";return o};m.setVideoSwatchHtml=function(p,n){var o;if(n.length){if(p==="marketing"){o=f(".marketing-video-js",n).removeClass("hide").html()}else{if(p==="product"){o=n.html()}}}return o};return m.init}());var c=(function(){var m={};m.init=function(){m.bindClick()};m.bindClick=function(){f(".show-more-js",".color-swatches-action-js").on("click",function(n){m.resizeContainerForColorSwatches(n)})};m.resizeContainerForColorSwatches=function(o){o.preventDefault();var r=f(o.target),B=r.attr("data-alt-toggle-text"),C=f(".collapsable-container-js"),A=f(".color-swatches-action-js"),t=C.find("label"),v=t.length+A.length,p=t.outerWidth(true),z=C.outerWidth(),n=Math.floor(z/p),y=Math.ceil(v/n),u=v%y,w=y*i,s,x,q;r.attr("data-alt-toggle-text",r.html()).html(B);if(C.height()>=w){s=f(f("label",C).get(n-2));x=s.attr("for");w=i;f('label[for="'+x+'"]').after(A);k=null}else{q=f(f("label",C)).last();x=q.attr("for");f('label[for="'+x+'"]').after(A);k="last"}C.animate({height:w},500)};return m.init}());var e=(function(){var m={};m.init=function(){m.bindClick()};m.bindClick=function(){f(".show-more-js").off().on("click",function(n){m.resizeContainerForSwatches(n)})};m.resizeContainerForSwatches=function(n){n.preventDefault();n.stopPropagation();var x=f(".collapsable-container-js").not(f(".stl-product-grid-product-js .collapsable-container-js")),w=x.find("label:first").outerHeight(true),p=x.find("label:first").outerWidth(true),q=x.find("label").length,s=x.outerWidth(),o=Math.floor(s/p),t=Math.ceil(q/o),r=t*w;if(x.height()>=r){r=w}x.animate({height:r+1},500);var v=f(n.target).data("alt-toggle-text"),u=f(n.target).text();if(typeof v!=="undefined"&&typeof u!=="undefined"){f(n.target).data("alt-toggle-text",u).text(v)}f(n.target).toggleClass("expanded")};return m.init}());var b=(function(){var m={};m.init=function(){j();h()};return m.init}());return{pdpAndQuickViewInitialSetup:b,showMoreSwatches:e,expandMoreSwatches:h,showMoreSwatchesIfRoom:j,createVideoSwatch:g,initShowMoreColorsAsSwatch:l,showMoreColorAsSwatches:c,initShowMoreColorsLink:a}});