define(["jquery","pubsub","wcs.teaser","wcs.utils","shared.lazyload","jquery.tooltipster","foundation.reveal"],function(f,i,e,h){var k=(function(){var m={};m.bindEvents=function(){f(".find-size-btn-js").on("click",m.openSizeChart);f(".size-chart-js .icon-close").on("click",m.closeSizeChart)};m.openSizeChart=function(n){f(".size-chart-js").slideToggle();f("html, body").animate({scrollTop:f(".size-chart-js").offset().top},500);f(".lazyload",f(".size-chart-js")).lazyload()};m.closeSizeChart=function(n){n.preventDefault();f(".size-chart-js").slideToggle();f("html, body").animate({scrollTop:f(".product-form-js").offset().top},500)};m.init=function(){m.bindEvents()};return m.init}());var b=(function(){var m={};m.updateTime=function(o,n){if(n<10){o.text("0"+n)}else{o.text(n)}};m.initCountDown=function(){var t=24*60*60,o=60*60,n=60,q=f(".countdown-js"),v=q.find(".countdown-day-js"),r=q.find(".countdown-hours-js"),s=q.find(".countdown-min-js"),u=q.find(".countdown-sec-js"),p=parseInt(v.text())*t+parseInt(r.text())*o+parseInt(s.text())*n+parseInt(u.text());p=(new Date().getTime())+(p*1000);setInterval(function(){var x=0,w=0,y=0,z=0,A=0;A=Math.floor((p-(new Date()))/1000);if(A<0){A=0}x=Math.floor(A/t);m.updateTime(v,x);A-=x*t;w=Math.floor(A/o);m.updateTime(r,w);A-=w*o;y=Math.floor(A/n);m.updateTime(s,y);A-=y*n;A=A-1;m.updateTime(u,A<0?59:A)},1000)};return m}());var g=(function(){var m={};m.setSwatchPage=function(){isSwatchPage=f("body").hasClass("pdp-swatches");return isSwatchPage};m.updateProductURL=function(n){f("a.more-detail-js").attr("href",n)};m.updateOGImageSrc=function(n){f("meta[ property = 'og:image']").attr("content",n)};m.updateProductDesc=function(o){if(o!==""){var n=l.decodeHTML(o);f(".product-details-js .desc-container-js").html(n);e.toggleEventListener()}};m.updateProductName=function(o,n){var p;if(f("#isQuickView").length>0){p='<a href="'+n+'">'+o+"</a>"}else{p=o}f("#product-info h1").html(p)};m.updateProductPartNumber=function(n){f(".product-style-js").html(n)};m.toggleSelectedClass=function(o,n){if(n){o.addClass("selected")}else{o.removeClass("selected")}};m.toggleVisibility=function(n,o){if(o&&n.hasClass("hidden")){n.removeClass("hidden")}else{if(!o&&!n.hasClass("hidden")){n.addClass("hidden")}}};m.updateProductPrice=function(n){if(n.length>0){if(f(".price-container-js").length>0){f(".price-container-js")[0].innerHTML=n[0].innerHTML}}};m.populateProductPartNumberAndAttrName=function(n){var p=f(".attr-color:visible .collapsable-container-js .selected img").attr("data-part-number"),o=f(".product-form-js").eq(n);if(o.find(".product-style-js").length>0){}if(o.find(".attr-selected-color-js").length>0){o.find(".attr-selected-color-js").html(o.find(".attr-color .collapsable-container-js .selected img").attr("alt"))}};m.setShowOverviewHandler=function(){f(".link-more-btn-js").on({click:function(n){n.preventDefault();f(".prod-desc-js").toggleClass("ellip-line",500)}})};m.initDiscountTooltips=function(){var o=".discount-container .tooltip-js",n={contentAsHTML:true,multiple:true,animation:"fade",trigger:"click",interactive:true};f(o).each(function(){var p=f(this);p.tooltipster(n)});f.pubsub("subscribe","WCS.PRODUCT_FORM.PROMO.RENDER.COMPLETE",function(){f(o).each(function(){var p=f(this);p.tooltipster(n)})})};m.setStepContentWidths=function(){var n=f("#product-content-container .product-form-js").width();$stepContainer=f(".step-container:not(.attr-color)",".pdp-drawer");$stepContainer.each(function(){var o=f(this);o.find(".step-content").css("width",n-o.find(".step-header").outerWidth(true)-1)})};m.initMobileCarouselViewer=function(){var n=f(".product-img-js .views-js ul").clone();n.addClass("mobile-viewer-js");f(".product-img-js .views-js").append(n)};m.updateProductDetailBtnURL=function(q){var n=f(".quickview-box-js .product-detail-btn-js"),p=n.attr("href"),o=f("label.context-trigger-js.active-context-js");if(o.length>0){p=o.attr("data-product-url")}p=h.setURLParam(p,"variationId",q);n.attr("href",p)};m.showAltViewControls=function(){if(main.screen.size()!=="small"){f(".product-view-control-js").not(".secondary").show()}};return m}());var l=(function(){var m={};m.decodeHTML=function(o){var n=document.createElement("div");n.innerHTML=o;return n.childNodes[0].nodeValue};m.setupShareButton=function(){$shareButton=f("#share-button-container","#pdp-header-content");$shareButton.clone().appendTo("#product-views-container")};m.appendZoomPopup=function(){var o=f(".full-zoom-hopup-js"),n=f('<div class="reveal-modal full-zoom-hopup-js">');if(o.length===0){f("body").append(n)}};m.createOlapicUploadWidget=function(){if(!WCS_CONFIG.get("PDP::olapicEnabled")){return}_olapicPartNumber=f(".product-form-js").attr("data-olapic-partnumber");if(_olapicPartNumber&&OLAPIC_SETTINGS.SHOW_ALT_IMAGE===true){var r="olapic_upload_widget",o=OLAPIC_SETTINGS.CUSTOMER_ID,v=OLAPIC_SETTINGS.UPLOAD_WIDGET_ID,q=true,p=false,s=false,t=document.createElement("script"),u="",n=u===""?document.domain+document.location.pathname:u;t.async=true;t.type="text/javascript";t.src=encodeURI("//widgets.photorank.me/automator?e="+r+"&customer_id="+o+"&url="+encodeURIComponent(n)+"&title="+encodeURIComponent(document.title)+"&widget="+v+"&tags="+_olapicPartNumber+"&tag_based="+q+"&cat_based="+p+"&collection="+s);(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}};m.duplicateFullZoomBtn=function(){var n=f(".product-view-control-js").clone(true),o=g.setSwatchPage();n.addClass("secondary");if(o){n.find(".btn-full").detach();n.find(".btn-zoom span").removeClass("icon").addClass("graphic-icon-zoom-mobile")}else{n.find(".btn-full-js").addClass("secondary");n.find(".btn-zoom").detach()}f("div.product-img-js").append(n)};return m}());var d=(function(){var m={};m.init=function(){if((f(".green-index-hopup-js").length<1)||(f(".green-index-hopup-js").attr("sku")===null)||(f(".green-index-hopup-js").attr("sku")==="")){return}var o=f(".green-index-hopup-js").attr("sku"),n="/greenindex/api/tbl_greenindex/search-sku/"+o;m.ajax(n)};m.ajax=function(n){f.ajax({url:n,dataType:"json",success:function(o){if(o!==null&&o.result!="failure"){f(".greenshortdesc-js").html(o.product_name);f(".greenscore-js").html(o.gi_score);f(".greenclimimpact-js").html(o.climate_score);f(".greenchemimpact-js").html(o.chemical_score);f(".greenrescconsumption-js").html(o.resource_score);f("#greenindex-area-js").removeClass("hide")}}})};return m.init}());var a=(function(){var n={};var p=f("#pr-wyb-display"),o=p.parent("#pr-container"),m=true;n.init=function(){f(window).on("scroll",n.onWindowScroll);f(".product-content-info-review-count-link").on("click",n.handleReviewsLinkClick)};n.onWindowScroll=function(q){if(o.find(".pr-wyb-header").hasClass("hide")&&(o.find(".pr-carousel-slide").length)){n.handlePowerReviewHeaderVisibility(o)}};n.handleReviewsLinkClick=function(q){var r;if(m){r=500}else{r=0}q.preventDefault();if(f(".pr-snapshot-no-ratings").is(":visible")||f(".pr-rd-no-reviews").is(":visible")){n.scrollToPRContainer();return}if(f(".pr-review-wrap, .pr-review").is(":visible")){f(".power-reviews-loading-indicator-js").removeClass("hide");setTimeout(function(){f(".power-reviews-loading-indicator-js").addClass("hide");n.scrollToPRContainer();m=false},r)}else{f(".power-reviews-loading-indicator-js").removeClass("hide");setTimeout(function(){n.handleReviewsLinkClick(q)},500)}};n.handlePowerReviewHeaderVisibility=function(s){var q=s[0].getBoundingClientRect().top,r=s[0].getBoundingClientRect().bottom;if((q<window.innerHeight)&&(r>=0)){s.find(".pr-wyb-header").removeClass("hide")}};n.scrollToPRContainer=function(){f("html, body").animate({scrollTop:f("#rating_reviews").offset().top},800)};return n.init}());var j=(function(){var m={};m.init=function(){g.setSwatchPage();b.initCountDown();l.setupShareButton();d();l.appendZoomPopup();l.createOlapicUploadWidget();g.populateProductPartNumberAndAttrName();l.duplicateFullZoomBtn();g.setShowOverviewHandler();g.showAltViewControls();a();g.initDiscountTooltips()};return m.init}());var c=(function(){var m={};m.init=function(){g.initDiscountTooltips();g.setSwatchPage();g.setStepContentWidths();m.initShareThis();l.appendZoomPopup()};m.initShareThis=function(){if(typeof stLight!=="undefined"&&stLight!==null){var n=f("#social-medial-st-js").attr("data-publisher");stLight.options({publisher:n,doNotHash:false,doNotCopy:false,hashAddressBar:false})}};m.enableGridPageQuickview=function(n){if(WCS_CONFIG.get("quickView::quickViewAlternateViewsEnabled")){n=(n||f("body").hasClass("grid"))}return n};return m.init}());return{pdpInitialSetup:j,quickViewInitialSetup:c,pdpUpdatePage:g,pdpTime:b,viewDomAdd:l,initGreenIndex:d,sizeChartSlideView:k,updateProductPartNumberAndAttrName:g.populateProductPartNumberAndAttrName}});