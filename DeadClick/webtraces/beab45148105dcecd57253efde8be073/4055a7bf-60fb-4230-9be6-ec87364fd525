!function(t,e){"function"==typeof define&&define.amd?define(["jQuery"],e):e("object"==typeof exports?require("jQuery"):t.jQuery)}(this,function(t){var e=function(){var t={},e=new RegExp("{{([^}]+)}}","g"),n=function(t){for(var n,s=[];n=e.exec(t);)s.push(n);return s};return t.parse=function(t){var e={inpts:{},chars:{}},s=n(t),r=t.length,i=0,a=0,h=0;for(h;h<r;h++)i<s.length&&h===s[i].index?function(t){for(var n=t.length,s=0;s<n;s++)e.inpts[a]=t.charAt(s),a++;i++,h+=t.length+4-1}(s[i][1]):e.chars[h-4*i]=t.charAt(h);return e.mLength=h-4*i,e},t}(),n=function(){var t={};"undefined"!=typeof navigator&&navigator.userAgent;return t.extend=function(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])t[n]=arguments[e][n];return t},t.addChars=function(t,e,n){return t.substr(0,n)+e+t.substr(n,t.length)},t.removeChars=function(t,e,n){return t.substr(0,e)+t.substr(n,t.length)},t.isBetween=function(t,e){return e.sort(function(t,e){return t-e}),t>e[0]&&t<e[1]},t.addListener=function(t,e,n){return void 0!==t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},t.preventDefault=function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1},t.getClip=function(t){return t.clipboardData?t.clipboardData.getData("Text"):window.clipboardData?window.clipboardData.getData("Text"):void 0},t.getMatchingKey=function(t,e,n){for(var s in n){var r=n[s];if(t===r.which&&e===r.keyCode)return s}},t.isDelKeyDown=function(e,n){var s={backspace:{which:8,keyCode:8},delete:{which:46,keyCode:46}};return t.getMatchingKey(e,n,s)},t.isDelKeyPress=function(e,n){var s={backspace:{which:8,keyCode:8,shiftKey:!1},delete:{which:0,keyCode:46}};return t.getMatchingKey(e,n,s)},t.isSpecialKeyPress=function(e,n){var s={tab:{which:0,keyCode:9},enter:{which:13,keyCode:13},end:{which:0,keyCode:35},home:{which:0,keyCode:36},leftarrow:{which:0,keyCode:37},uparrow:{which:0,keyCode:38},rightarrow:{which:0,keyCode:39},downarrow:{which:0,keyCode:40}};return t.getMatchingKey(e,n,s)},t.isModifier=function(t){return t.ctrlKey||t.altKey||t.metaKey},t.forEach=function(t,e,n){if(t.hasOwnProperty("length"))for(var s=0,r=t.length;s<r&&!1!==e.call(n,t[s],s,t);s++);else for(var i in t)if(t.hasOwnProperty(i)&&!1===e.call(n,t[i],i,t))break},t}(),s=function(t,e,n){function s(e,s){var i=this;if(i.el=e,!i.el)throw new TypeError("Must provide an existing element");if(i.opts=n.extend({},r,s),void 0!==i.opts.pattern&&(i.opts.patterns=i._specFromSinglePattern(i.opts.pattern),delete i.opts.pattern),void 0===i.opts.patterns)throw new TypeError("Must provide a pattern or array of patterns");i.patternMatcher=t(i.opts.patterns),i._updatePattern(),i.hldrs={},i.focus=0,n.addListener(i.el,"keydown",function(t){i._keyDown(t)}),n.addListener(i.el,"keypress",function(t){i._keyPress(t)}),n.addListener(i.el,"paste",function(t){i._paste(t)}),i.opts.persistent&&(i._processKey("",!1),i.el.blur(),n.addListener(i.el,"focus",function(t){i._focus(t)}),n.addListener(i.el,"click",function(t){i._focus(t)}),n.addListener(i.el,"touchstart",function(t){i._focus(t)}))}var r={persistent:!1,repeat:!1,placeholder:" "},i={9:/[0-9]/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/};return s.addInptType=function(t,e){i[t]=e},s.prototype.resetPattern=function(n){this.opts.patterns=n?this._specFromSinglePattern(n):this.opts.patterns,this.sel=e.get(this.el),this.val=this.el.value,this.delta=0,this._removeChars(),this.patternMatcher=t(this.opts.patterns);var s=this.patternMatcher.getPattern(this.val);this.mLength=s.mLength,this.chars=s.chars,this.inpts=s.inpts,this._processKey("",!1,!0)},s.prototype._updatePattern=function(){var t=this.patternMatcher.getPattern(this.val);t&&(this.mLength=t.mLength,this.chars=t.chars,this.inpts=t.inpts)},s.prototype._keyDown=function(t){var e=t.which||t.keyCode;if(e&&n.isDelKeyDown(t.which,t.keyCode))return this._processKey(null,e),n.preventDefault(t)},s.prototype._keyPress=function(t){var e,s;if(e=t.which||t.keyCode,s=n.isSpecialKeyPress(t.which,t.keyCode),!n.isDelKeyPress(t.which,t.keyCode)&&!s&&!n.isModifier(t))return this._processKey(String.fromCharCode(e),!1),n.preventDefault(t)},s.prototype._paste=function(t){return this._processKey(n.getClip(t),!1),n.preventDefault(t)},s.prototype._focus=function(){var t=this;setTimeout(function(){var n=e.get(t.el),s=n.end>t.focus,r=0===n.end;(s||r)&&e.set(t.el,t.focus)},0)},s.prototype._processKey=function(t,s,r){if(this.sel=e.get(this.el),this.val=this.el.value,this.delta=0,this.sel.begin!==this.sel.end)this.delta=-1*Math.abs(this.sel.begin-this.sel.end),this.val=n.removeChars(this.val,this.sel.begin,this.sel.end);else if(s&&46===s)this._delete();else if(s&&this.sel.begin-1>=0)this.val=n.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta-=1;else if(s)return!0;s||(this.val=n.addChars(this.val,t,this.sel.begin),this.delta+=t.length),this._formatValue(r)},s.prototype._delete=function(){for(;this.chars[this.sel.begin];)this._nextPos();this.sel.begin<this.val.length&&(this._nextPos(),this.val=n.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta=-1)},s.prototype._nextPos=function(){this.sel.end++,this.sel.begin++},s.prototype._formatValue=function(t){this.newPos=this.sel.end+this.delta,this._removeChars(),this._updatePattern(),this._validateInpts(),this._addChars(),this.el.value=this.val.substr(0,this.mLength),void 0!==t&&!1!==t||e.set(this.el,this.newPos)},s.prototype._removeChars=function(){this.sel.end>this.focus&&(this.delta+=this.sel.end-this.focus);for(var t=0,e=0;e<=this.mLength;e++){var s,r=this.chars[e],i=this.hldrs[e],a=e+t;a=e>=this.sel.begin?a+this.delta:a,s=this.val.charAt(a),(r&&r===s||i&&i===s)&&(this.val=n.removeChars(this.val,a,a+1),t--)}this.hldrs={},this.focus=this.val.length},s.prototype._validateInpts=function(){for(var t=0;t<this.val.length;t++){var e=this.inpts[t],s=!i[e],r=!s&&!i[e].test(this.val.charAt(t)),a=this.inpts[t];(s||r)&&a&&(this.val=n.removeChars(this.val,t,t+1),this.focusStart--,this.newPos--,this.delta--,t--)}},s.prototype._addChars=function(){if(this.opts.persistent){for(var t=0;t<=this.mLength;t++)this.val.charAt(t)||(this.val=n.addChars(this.val,this.opts.placeholder,t),this.hldrs[t]=this.opts.placeholder),this._addChar(t);for(;this.chars[this.focus];)this.focus++}else for(var e=0;e<=this.val.length;e++){if(this.delta<=0&&e===this.focus)return!0;this._addChar(e)}},s.prototype._addChar=function(t){var e=this.chars[t];if(!e)return!0;n.isBetween(t,[this.sel.begin-1,this.newPos+1])&&(this.newPos++,this.delta++),t<=this.focus&&this.focus++,this.hldrs[t]&&(delete this.hldrs[t],this.hldrs[t+1]=this.opts.placeholder),this.val=n.addChars(this.val,e,t)},s.prototype._specFromSinglePattern=function(t){return[{"*":t}]},s}(function(t,e){var n=function(t){return"*"===t?/.*/:new RegExp(t)};return function(s){var r=[],i=[];e.forEach(s,function(s){e.forEach(s,function(e,s){var a=t.parse(e),h=n(s);return r.push(h),i.push(a),!1})});return{getPattern:function(t){var n;return e.forEach(r,function(e,s){if(e.test(t))return n=s,!1}),void 0===n?null:i[n]},patterns:i,matchers:r}}}(e,n),function(){var t={};return t.get=function(t){if("number"==typeof t.selectionStart)return{begin:t.selectionStart,end:t.selectionEnd};var e=document.selection.createRange();if(e&&e.parentElement()===t){var n=t.createTextRange(),s=t.createTextRange(),r=t.value.length;return n.moveToBookmark(e.getBookmark()),s.collapse(!1),n.compareEndPoints("StartToEnd",s)>-1?{begin:r,end:r}:{begin:-n.moveStart("character",-r),end:-n.moveEnd("character",-r)}}return{begin:0,end:0}},t.set=function(t,e){if("object"!=typeof e&&(e={begin:e,end:e}),t.setSelectionRange)t.focus(),t.setSelectionRange(e.begin,e.end);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e.end),n.moveStart("character",e.begin),n.select()}},t}(),n);$.fn.formatter=function(t){return"object"==typeof t&&this.each(function(){$.data(this,"plugin_formatter")||$.data(this,"plugin_formatter",new s(this,t))}),this.resetPattern=function(t){return this.each(function(){var e=$.data(this,"plugin_formatter");e&&e.resetPattern(t)}),this},this},$.fn.formatter.addInptType=function(t,e){s.addInptType(t,e)}});