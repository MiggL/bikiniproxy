define(["jquery","underscore","backbone","./tabgroup.tmpl"],function(a,b,c,d){d=b.template(d);var e=c.View.extend({events:{"click .tabgroup-tab":"handleClick"},currentIndex:0,initialize:function(c){b.extend(this,c.options),this.$panels=this.$(this.panelSelector),this.$panels.not(":first").hide();var e=this.$panels.find(this.tabSelector).map(function(){return a(this).hide().html()}).get(),f=a(d({tabs:e}));this.$el.prepend(f),this.$tabs=f.find("li"),this.$el.addClass("tabgroup-rendered")},changeTab:function(a){if(a===this.currentIndex)return;var b=this.$panels.eq(a),c=this.$tabs.eq(a);b.hide(0).delay(0).show(0),this.$panels.not(b).hide(),c.addClass("current"),this.$tabs.not(c).removeClass("current"),this.currentIndex=a},handleClick:function(b){b.preventDefault(),this.changeTab(a(b.currentTarget).index())}},{defaults:{selector:".tabgroup",panelSelector:".tabgroup-panel",tabSelector:".section-title"}}),f={TabGroup:e,init:function(c){return c=b.extend({},e.defaults,c),a(c.selector).each(function(){a.data(this,"tabgroup",new e({el:this,options:c}))})}};return f})