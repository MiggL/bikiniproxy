window.MSU_Global=new function(){this.showDebug=!1;if((new String(document.location)).indexOf("localhost")>=0||(new String(document.location)).indexOf("www-dev")>=0){this.showDebug=!0}
this.monthLabels=[{"short":"Jan","long":"January"},{"short":"Feb","long":"February"},{"short":"Mar","long":"March"},{"short":"Apr","long":"April"},{"short":"May","long":"May"},{"short":"Jun","long":"June"},{"short":"Jul","long":"July"},{"short":"Aug","long":"August"},{"short":"Sep","long":"September"},{"short":"Oct","long":"October"},{"short":"Nov","long":"November"},{"short":"Dec","long":"December"}];this.dayLabels=[{"short":"Sun","long":"Sunday"},{"short":"Mon","long":"Monday"},{"short":"Tue","long":"Tuesday"},{"short":"Wed","long":"Wednesday"},{"short":"Thur","long":"Thursday"},{"short":"Fri","long":"Friday"},{"short":"Sat","long":"Saturday"}];this.log=function(inMessage){if(this.showDebug&&("console" in window)){console.log(inMessage)}};this.getCheckWidth=function(){var checkWidth=$(window).width();if(navigator.userAgent.indexOf("Chrome")>=0){if("innerWidth" in window)checkWidth=window.innerWidth}else if(navigator.userAgent.indexOf("Safari")>=0){}else if("innerWidth" in window){checkWidth=window.innerWidth}
return checkWidth};this.getCheckHeight=function(){var checkHeight=$(window).height();if(navigator.userAgent.indexOf("Chrome")>=0){if("innerHeight" in window)checkHeight=window.innerHeight}else if(navigator.userAgent.indexOf("Safari")>=0){}else if("innerHeight" in window){checkHeight=window.innerHeight}
return checkHeight};this.createElement=function(inTagName,inClassName,inID,inText){if(!inTagName)return!1;var ret=document.createElement(inTagName);if(inClassName)ret.className=inClassName;if(inID)ret.id=inID;if(inText)ret.appendChild(document.createTextNode(inText));return ret};this.getTextAsHTML=function(inText){var tmp=this.createElement("div",null,null,inText);return tmp.innerHTML};return this};function MSU_Animator(inData,inDuration,inCallback,inFinish){this.duration=inDuration;this.data=inData;this.animationCallback=inCallback;this.finishCallback=inFinish;this.startTime=null;this.animationHandle=null;this.doFrame=function(){var progress=Math.min(1.0,((new Date()).getTime()-this.startTime)/this.duration);MSU_Global.log("Animation progress: "+progress);this.animationCallback(this.data,progress);if(progress==1.0){if(this.finishCallback){this.finishCallback(this.data,progress)}}else{window.requestAnimationFrame(this.doFrame.bind(this))}}
this.start=function(){MSU_Global.log("Starting animation");MSU_Global.log(this.data);this.startTime=(new Date()).getTime();window.requestAnimationFrame(this.doFrame.bind(this))}}
function MSU_PRPLFooterFoldoutMenu(inObject){this.parentNode=inObject;this.subMenu=$(inObject).find("ul").get(0);this.openLink=null;this.isOpen=!1;this.prevWidth=null;this.toggle=function(inEvent){if(this.isOpen){$(this.subMenu).slideUp();$(this.openLink).removeClass("open")}else{$(this.subMenu).slideDown();$(this.openLink).addClass("open")}
this.isOpen=!this.isOpen};this.handleResize=function(inEvent){var w=MSU_Global.getCheckWidth();var hasChanged=!1;if(this.prevWidth!=w){hasChanged=!0}
if(hasChanged){if(w>=720){$(this.subMenu).show()}else{if(this.isOpen){$(this.subMenu).show()}else{$(this.subMenu).hide()}}}
this.prevWidth=w};if(this.subMenu){this.openLink=MSU_Global.createElement("A","open-button",null,"+");this.openLink.href="javascript: ;";this.parentNode.insertBefore(this.openLink,this.parentNode.firstChild);$(this.openLink).click(this.toggle.bind(this));$(this.subMenu).hide();$(window).resize(this.handleResize.bind(this));this.handleResize()}};window.HeaderFoldoutCount=0;function MSU_PRPLFoldoutMenu(inObject){this.parentNode=inObject;this.subMenu=$(inObject).find("ul").get(0);this.openLink=null;this.isOpen=!1;this.label=$(this.parentNode).find("a").first().text();this.toggle=function(inEvent){inEvent.preventDefault();if(this.isOpen){$(this.subMenu).slideUp();$(this.openLink).removeClass("open");$(this.openLink).attr("aria-expanded","false");$(this.openLink).attr("aria-label","Open "+this.label)}else{$(this.subMenu).slideDown();this.subMenu.focus();$(this.openLink).addClass("open");$(this.openLink).attr("aria-expanded","true");$(this.openLink).attr("aria-label","Close "+this.label)}
this.isOpen=!this.isOpen};if(this.subMenu){this.openLink=MSU_Global.createElement("A","open-button",null,"+");this.openLink.href="";this.subMenu.parentNode.insertBefore(this.openLink,this.subMenu);$(this.openLink).click(this.toggle.bind(this));$(this.openLink).attr("aria-label","Open "+this.label);$(this.openLink).attr("aria-controls","SidebarFoldable"+window.HeaderFoldoutCount);$(this.openLink).attr("role","button");$(this.openLink).attr("aria-expanded","false");$(this.subMenu).attr("tabindex","-1");$(this.subMenu).attr("id","SidebarFoldable"+window.HeaderFoldoutCount);$(this.subMenu).attr("role","region");$(this.subMenu).attr("aria-label",this.label+" sub-menu");$(this.subMenu).hide();window.HeaderFoldoutCount++}}
window.MSU_PRPLDesktopMenu=new function(){this.navPanel=null;this.menuButton=null;this.mobileMenuButton=null;this.menuPane=null;this.searchButton=null;this.mobileSearchButton=null;this.searchPane=null;this.calendarButton=null;this.calendarPane=null;this.linksButton=null;this.linksPane=null;this.scrim=null;this.isOpen=!1;this.prevWidth=null;this.calendarInitialized=!1;this.handleResize=function(inEvent){var w=MSU_Global.getCheckWidth();if(w!=this.prevWidth){if(this.isOpen){if(w<720){$(this.scrim).hide();$(this.navPanel).find(".sidebar-wrapper").css("display","block")}else{$(this.scrim).show();$(this.navPanel).find(".sidebar-wrapper").css("display","")}}else{if(w<720){$(this.navPanel).find(".sidebar-wrapper").css("display","none")}else{$(this.navPanel).find(".sidebar-wrapper").css("display","")}}
this.prevWidth=w}};this.closeMenu=function(){$(this.navPanel).removeClass("open");$(this.menuButton).removeClass("current");$(this.searchButton).removeClass("current");if(this.calendarButton)$(this.calendarButton).removeClass("current");if(this.linksButton)$(this.linksButton).removeClass("current");$(document.body).removeClass('no-scroll');$(this.navPanel).find(".sidebar-wrapper").attr("aria-hidden","true");if(MSU_Global.getCheckWidth()<720){$(this.navPanel).find(".sidebar-wrapper").fadeOut(500,function(){$(this.menuPane).hide();$(this.searchPane).hide();if(this.calendarPane)$(this.calendarPane).hide();if(this.linksPane)$(this.linksPane).hide()}.bind(this))}else{$(this.scrim).fadeOut(500,function(){$(this.menuPane).hide();$(this.searchPane).hide();if(this.calendarPane)$(this.calendarPane).hide();if(this.linksPane)$(this.linksPane).hide();$(this.navPanel).addClass("unclickable");$(".header-navigation .close-button").css("display","none");$(".header-navigation .sidebar-social").css("display","none")}.bind(this))}
this.isOpen=!1};this.openMenu=function(){$(this.navPanel).addClass("open");$(this.navPanel).removeClass("unclickable");$(document.body).addClass("no-scroll");$(this.navPanel).find(".sidebar-wrapper").attr("aria-hidden","false");if(MSU_Global.getCheckWidth()<720){$(this.navPanel).find(".sidebar-wrapper").fadeIn()}else{$(this.scrim).fadeIn(500)}
$(".header-navigation .close-button").css("display","block");$(".header-navigation .sidebar-social").css("display","block");this.isOpen=!0};this.tapContainer=function(inEvent){if(this.isOpen&&(inEvent.target==this.navPanel)){this.closeMenu()}};this.switchTo=function(inPane,inButton){var currentPane,currentButton;if(this.calendarButton&&$(this.calendarButton).hasClass("current")){currentButton=this.calendarButton;currentPane=this.calendarPane}else if($(this.searchButton).hasClass("current")){currentButton=this.searchButton;currentPane=this.searchPane}else if($(this.linksButton).hasClass("current")){currentButton=this.linksButton;currentPane=this.linksPane}else{currentButton=this.menuButton;currentPane=this.menuPane}
if(inPane!=currentPane){$(currentButton).removeClass("current");$(inButton).addClass("current");$(currentPane).fadeOut(250,function(){$(inPane).fadeIn(250)})}}
this.tapMenu=function(inEvent){if(!this.isOpen){$(this.menuButton).addClass("current");$(this.menuPane).show();$(this.menuPane).attr("tabindex",0);this.openMenu();this.menuPane.focus()}else{if($(this.menuButton).hasClass("current")){this.closeMenu()}else{this.switchTo(this.menuPane,this.menuButton)}}};this.tapSearch=function(inEvent){if(!this.isOpen){$(this.searchButton).addClass("current");$(this.searchPane).show();this.openMenu();$(this.searchPane).find("input#SidebarSearchInput").get(0).focus()}else{if($(this.searchButton).hasClass("current")){this.closeMenu()}else{this.switchTo(this.searchPane,this.searchButton)}}};this.tapLinks=function(inEvent){if(!this.isOpen){$(this.linksButton).addClass("current");$(this.linksPane).show();this.openMenu();$(this.linksPane).focus()}else{if($(this.linksButton).hasClass("current")){this.closeMenu()}else{this.switchTo(this.linksPane,this.linksButton)}}}
this.tapCalendar=function(inEvent){if(!this.calendarInitialized)this.initCalendar();if(!this.isOpen){$(this.calendarButton).addClass("current");$(this.calendarPane).show();this.openMenu();$(this.calendarPane).focus()}else{if($(this.calendarButton).hasClass("current")){this.closeMenu()}else{this.switchTo(this.calendarPane,this.calendarButton)}}};this.initCalendar=function(){if(!this.calendarInitialized){this.calendarInitialized=!0;var calOpts=window.sidebarCalendarOptions;if(calOpts&&("show" in calOpts)&&calOpts.show==!0){var calURL="//www.montclair.edu/includes/calendar/upcoming-events.php?callback=?";var calParams={};if(("homepage" in calOpts)&&calOpts.homepage==!0){calParams.special="homepage";calParams.MaxEvents=3}else{calParams.CalendarID=calOpts.id;calParams.MaxEvents=3}
$.getJSON(calURL,calParams,this.handleCalendar.bind(this));var newsURL="//www.montclair.edu/news/data/channel.php?callback=?";var newsParams={"id":7};$.getJSON(newsURL,newsParams,this.handleNews.bind(this))}}};this.handleCalendar=function(inData){var outputArea=$(this.calendarPane).find(".calendar-output").get(0);if(inData.status=="success"){outputArea.innerHTML="";for(var i in inData.data){var evt=inData.data[i];var tmp=MSU_Global.createElement("A","event");tmp.href="//www.montclair.edu/calendar/view-event.php?id="+evt.id;var tmpDate=new Date(evt.date.replace(/-/g,"/"));var tmpDateString=MSU_Global.monthLabels[tmpDate.getMonth()].short+" "+tmpDate.getDate();tmp.appendChild(MSU_Global.createElement("SPAN","date",null,tmpDateString));tmp.appendChild(MSU_Global.createElement("SPAN","title",null,evt.title));if(evt.summary){tmp.appendChild(MSU_Global.createElement("SPAN","summary",null,evt.summary))}
outputArea.appendChild(tmp)}}};this.handleNews=function(inData){var outputArea=$(this.calendarPane).find(".news-output").get(0);if(inData.status=="success"){var articles=inData.data.slice(0,3);outputArea.innerHTML="";for(var i in articles){var article=articles[i];var tmp=MSU_Global.createElement("A","article");tmp.href="//www.montclair.edu/news/article.php?ChannelID=7&ArticleID="+article.id;tmp.appendChild(MSU_Global.createElement("SPAN","headline",null,article.headline));if(article.lead){tmp.appendChild(MSU_Global.createElement("SPAN","lead",null,article.lead))}
outputArea.appendChild(tmp)}}}
this.goToSearch=function(e){e.preventDefault();MSU_Global.log("Header Sidebar: goToSearch()");if(!this.isOpen){$(this.searchButton).addClass("current");$(this.searchPane).show();$(this.searchPane).focus();this.openMenu()}else{$(this.menuButton).removeClass("current");$(this.searchButton).addClass("current");$(this.menuPane).fadeOut(250,function(){$(this.searchPane).fadeIn(250);$(this.searchPane).focus()}.bind(this))}};this.genericClick=function(inEvent){var tmp=inEvent.target;while(tmp&&!$(tmp).hasClass("nav-tab")){tmp=tmp.parentNode}
if(tmp){var a=$(tmp).find("a").get(0);if(a){var tmp=a.href.split("/");tmp=tmp[tmp.length-1];if(tmp!="#")document.location=a.href}}};this.handleScroll=function(inEvent){var pos=$(window).scrollTop();if(pos>0){if(!$(this.navPanel).hasClass("off-top")){$(this.navPanel).addClass("off-top");$(document.body).addClass("off-top")}}else{if($(this.navPanel).hasClass("off-top")){$(this.navPanel).removeClass("off-top");$(document.body).removeClass("off-top")}}};this.init=function(){this.navPanel=$(".header-navigation").get(0);this.menuButton=$(this.navPanel).find(".side-tags .nav-tab.menu").get(0);this.mobileMenuButton=$(this.navPanel).find(".mobile-tags .nav-tab.menu").get(0);this.searchButton=$(this.navPanel).find(".side-tags .nav-tab.search").get(0);this.calendarButton=$(this.navPanel).find(".side-tags .nav-tab.calendar").get(0);this.linksButton=$(this.navPanel).find(".side-tags .nav-tab.links").get(0);this.mobileSearchButton=$(this.navPanel).find(".mobile-tags .nav-tab.search").get(0);this.menuPane=$(this.navPanel).find(".sidebar-menu").get(0);this.searchPane=$(this.navPanel).find(".sidebar-search").get(0);this.calendarPane=$(this.navPanel).find(".sidebar-calendar").get(0);this.linksPane=$(this.navPanel).find(".sidebar-links").get(0);this.scrim=MSU_Global.createElement("DIV","scrim");$(this.scrim).hide();$(this.scrim).click(this.closeMenu.bind(this));document.body.appendChild(this.scrim);$(this.menuPane).hide();$(this.searchPane).hide();if(this.calendarPane){$(this.calendarPane).hide()}
if(this.linksPane){$(this.linksPane).hide()}
$(this.navPanel).click(this.tapContainer.bind(this));$(this.menuButton).click(this.tapMenu.bind(this));$(this.mobileMenuButton).click(this.tapMenu.bind(this));$(this.searchButton).click(this.tapSearch.bind(this));$(this.mobileSearchButton).click(this.tapSearch.bind(this));if(this.calendarButton){$(this.calendarButton).click(this.tapCalendar.bind(this))}
if(this.linksButton){$(this.linksButton).click(this.tapLinks.bind(this))}
$(this.navPanel).find(".nav-tab").click(this.genericClick.bind(this));$(this.navPanel).find(".nav-tab svg").click(this.genericClick.bind(this));$(this.navPanel).find(".close-button a").click(this.closeMenu.bind(this));$(this.navPanel).find(".foldable-menu>ul>li").each(function(idx,el){var tmp=new MSU_PRPLFoldoutMenu(el);el.handler=tmp}.bind(this));$(window).scroll(this.handleScroll.bind(this));this.handleScroll(null);$(window).resize(this.handleResize.bind(this));this.handleResize(null);$(this.navPanel).addClass("unclickable");var accessibilityLink=MSU_Global.createElement("a","a11y-link",null,"Go to Search");accessibilityLink.href="#";$(accessibilityLink).click(this.goToSearch.bind(this));var SkipToContent=$("#SkipToContent").get(0);SkipToContent.parentNode.insertBefore(accessibilityLink,SkipToContent.nextSibling);if(this.linksPane){var holder=MSU_Global.createElement("div","mobile-links-pane mobile-only",null,null);holder.innerHTML=this.linksPane.innerHTML;this.menuPane.appendChild(holder)}};return this};window.MSU_LiveSearchManager=new function(){this.searchURL="//www.montclair.edu/hawkeye/data.php?callback=?";this.outputArea=null;this.outputCount=null;this.inputElement=null;this.pollingInterval=null;this.intervalLength=10;this.typingTimeout=null;this.typingDelay=200;this.lastSearch="";this.exclusions=new Array("catalog");this.filters=new Array();this.maxResults=10;this.handleFilters=function(inData){MSU_Global.log("MSU_LiveSearchManager.handleFilters()");MSU_Global.log(inData);if("status" in inData&&inData.status=="success"){for(var i in inData.data)if(this.exclusions.indexOf(i)==-1){var t=inData.data[i];this.filters.push({"id":i,"label":t.labelPlural,"active":!0})}
this.lastSearch="";if(this.inputElement.value!=this.lastSearch){this.requestSearch()}}};this.handleSearchResults=function(inData,inTextStatus,injqXHR){if("status" in inData&&inData.status=="success"){var outHTML="";if(inData.data.length>this.maxResults){this.outputCount.innerHTML="<p class='count'>Displaying "+this.maxResults+" of "+inData.data.length+" results.</p>";inData.data=inData.data.slice(0,this.maxResults)}else{this.outputCount.innerHTML="<p class='count'>Displaying "+inData.data.length+" result"+(inData.data.length!=1?"s":"")+".</p>"}
for(var i=0;i<inData.data.length;i++){outHTML+=inData.data[i].html}
this.outputArea.innerHTML=outHTML;this.outputArea.scrollTop=0}};this.requestSearch=function(){this.typingTimeout=null;MSU_Global.log("MSU_LiveSearchManager.requestSearch("+this.lastSearch+")");if(this.lastSearch.length<2){this.outputArea.innerHTML=""}else if(this.filters.length>0){var filterArray=new Array();for(var i in this.filters){if(this.filters[i].active){filterArray.push(this.filters[i].id)}}
$.getJSON(this.searchURL,{"action":"search","q":this.lastSearch,"filter":filterArray.join(",")}).done(this.handleSearchResults.bind(this)).fail(function(inMessage){MSU_Global.log("SearchFailure: "+inMessage)})}};this.poll=function(){var currentQuery=this.inputElement.value.toString().trim().toLowerCase();if(this.lastSearch!=currentQuery){this.lastSearch=currentQuery;if(this.typingTimeout){window.clearTimeout(this.typingTimeout)}
this.typingTimeout=window.setTimeout(this.requestSearch.bind(this),this.typingDelay)}};this.beginPolling=function(){window.ensureCSS(window.themeRoot+"/search-icons.css");MSU_Global.log("MSU_LiveSearchManager.beginPolling()");this.pollingInterval=window.setInterval(this.poll.bind(this),this.intervalLength)};this.endPolling=function(){MSU_Global.log("MSU_LiveSearchManager.endPolling()");window.clearInterval(this.pollingInterval);this.pollingInterval=null};this.init=function(){MSU_Global.log("MSU_LiveSearchManager.init()");this.outputArea=$("#SidebarSearchOutput").get(0);this.outputCount=$("#SidebarSearchOutputCount").get(0);this.inputElement=$(".sidebar-search #SidebarSearchInput").get(0);$(this.inputElement).focus(this.beginPolling.bind(this));$(this.inputElement).blur(this.endPolling.bind(this));$.getJSON(this.searchURL,{"action":"types"},this.handleFilters.bind(this))};return this};function MSU_PRPLHomepageHero(inObject){this.obj=inObject;this.minAspect=16/9;this.maxAspect=2/1;this.handleResize=function(inEvent){MSU_Global.log("homepage hero resize");var w=MSU_Global.getCheckWidth();var h=0;var aspect;if(w>=720){h=MSU_Global.getCheckHeight();aspect=w/h;aspect=Math.min(aspect,this.maxAspect);aspect=Math.max(aspect,this.minAspect);h=w/aspect}else{h=w*0.65}
$(this.obj).find(".image-wrapper").css("height",h+"px")}}
function MSU_PRPLHomepageHeroCarousel(inObject){this.obj=inObject;this.slides=new Array();this.activeSlide=0;this.moveNext=function(){var nextSlide=(this.activeSlide+1)%this.slides.length;$(this.slides[this.activeSlide]).attr("aria-hidden","true");$(this.slides[this.activeSlide]).attr("aria-live","off");$(this.slides[this.activeSlide]).attr("tabindex","-1");$(this.slides[this.activeSlide]).fadeOut();$(this.slides[nextSlide]).attr("aria-hidden","false");$(this.slides[nextSlide]).attr("aria-live","off");$(this.slides[nextSlide]).attr("tabindex","0");$(this.slides[nextSlide]).fadeIn();this.activeSlide=nextSlide};this.movePrevious=function(){var previousSlide=(this.activeSlide+this.slides.length-1)%this.slides.length;$(this.slides[this.activeSlide]).attr("aria-hidden","true");$(this.slides[this.activeSlide]).attr("aria-live","off");$(this.slides[this.activeSlide]).attr("tabindex","-1");$(this.slides[this.activeSlide]).fadeOut();$(this.slides[previousSlide]).attr("aria-hidden","false");$(this.slides[previousSlide]).attr("aria-live","off");$(this.slides[previousSlide]).attr("tabindex","0");$(this.slides[previousSlide]).fadeIn();this.activeSlide=previousSlide}
$(this.obj).find(".homepage-carousel-item").each(function(idx,el){this.slides.push(el);if(idx>0)$(el).hide()}.bind(this));$(this.slides[0]).attr("aria-hidden","false");$(this.slides[0]).attr("tabindex","0");$(this.obj).find(".next-nav a").click(this.moveNext.bind(this));$(this.obj).find(".previous-nav a").click(this.movePrevious.bind(this))}
window.PRPLHomepageHeroCarouselManager=new function(){this.carousels=new Array();this.add=function(inObject){this.carousels.push(new MSU_PRPLHomepageHeroCarousel(inObject))}
this.init=function(){$(".prpl-homepage-hero-carousel").each(function(idx,el){this.add(el)}.bind(this))}
return this};function MSU_HomepageHawkeye(inObject){this.object=inObject;this.resultsArea=$(inObject).find(".results-area").get(0);this.input=$(inObject).find("input").get(0);this.filters=new Array();this.filterButtons=new Array();this.maxResults=20;this.lastSearch="";this.searchInterval=null;this.searchTimeout=null;this.url="https://www.montclair.edu/hawkeye/data.php?callback=?";this.exclusions=new Array("catalog");this.handleSearch=function(inData){MSU_Global.log("handleSearch");MSU_Global.log(inData);var countOutput=$(this.resultsArea).find(".result-count").get(0);var resultOutput=$(this.resultsArea).find(".result-output").get(0);if(inData.status&&inData.status=="success"){var tmpHTML="";if(inData.data.length==0){countOutput.innerHTML="0 results found"}else{var truncated=!1;if(inData.data.length>this.maxResults){countOutput.innerHTML="Displaying "+this.maxResults+" of "+inData.data.length+" results.";inData.data=inData.data.slice(0,this.maxResults);truncated=!0}else{countOutput.innerHTML="Displaying "+inData.data.length+" result"+(inData.data.length==1?"":"s")+"."}
for(var i in inData.data){tmpHTML+=inData.data[i].html}
if(truncated){tmpHTML+="<p style='text-align: right'><span class='prpl-button'><a href='/search.php?q=";tmpHTML+=encodeURIComponent(this.lastSearch);tmpHTML+="'>See Full Results</a></span></p>"}}
resultOutput.innerHTML=tmpHTML;this.resultsArea.scrollTop=0;window.a11yTools.scan(resultOutput);$(this.resultsArea).addClass("active")}};this.doSearch=function(){this.searchTimeout=null;var filterArray=new Array();for(var i in this.filters){if(this.filters[i].active){filterArray.push(this.filters[i].id)}}
var params={"action":"search","q":this.input.value,"filter":filterArray.join(",")};$.getJSON(this.url,params,this.handleSearch.bind(this))};this.pollSearch=function(){var query=this.input.value;if(query!=this.lastSearch){if(this.searchTimeout!=null){window.clearTimeout(this.searchTimeout);this.searchTimeout=null}
this.searchTimeout=window.setTimeout(this.doSearch.bind(this),200);this.lastSearch=query}};this.startPolling=function(){this.searchInterval=window.setInterval(this.pollSearch.bind(this),100)};this.stopPolling=function(){window.clearInterval(this.searchInterval);this.searchInterval=null};this.handleFilterClick=function(inEvent){var index=inEvent.target.filterIndex;if(index in this.filters){this.filters[index].active=!this.filters[index].active;if(this.filters[index].active){$(this.filterButtons[index]).addClass("active")}else{$(this.filterButtons[index]).removeClass("active")}
this.doSearch()}};this.handleFilters=function(inData){if("status" in inData&&inData.status=="success"){var filterArea=$(this.object).find(".search-toggles").get(0);if(filterArea)for(var i in inData.data)if(this.exclusions.indexOf(i)==-1){var t=inData.data[i];this.filters.push({"id":i,"label":t.labelPlural,"active":!0});var tmpLabel=MSU_Global.createElement("LABEL","filter-label active",null,t.labelPlural);var tmpCheckbox=MSU_Global.createElement("INPUT","filter-checkbox",null,null);tmpCheckbox.type="checkbox";tmpCheckbox.value="true";tmpCheckbox.checked="true";tmpCheckbox.filterIndex=this.filters.length-1;tmpLabel.insertBefore(tmpCheckbox,tmpLabel.firstChild);$(tmpCheckbox).change(this.handleFilterClick.bind(this));this.filterButtons.push(tmpCheckbox);$(tmpCheckbox).attr("aria-controls","HomepageHawkeyeResultCount HomepageHawkeyeResultOutput");filterArea.appendChild(tmpLabel)}
this.lastSearch="";if(this.input.value!=this.lastSearch){this.doSearch()}}};$(this.input).focus(this.startPolling.bind(this));$(this.input).blur(this.stopPolling.bind(this));window.ensureCSS(window.themeRoot+"/search-icons.css");if(this.input.value!=""){this.lastSearch=this.input.value;this.doSearch()}
$.getJSON(this.url,{"action":"types"},this.handleFilters.bind(this))}
function MLT_ResponsiveImage(inElement,inIsBackground){this.element=inElement;this.isBackground=inIsBackground;this.currentSize=0;this.currentPixelRatio=1;this.originalURL=null;this.aspectRatio=null;this.sizes=[250,350,500,750,1000,1250,1500];this.variance=1.1;this.preloadImage=null;this.setAspect=function(inEvent){MSU_Global.log("MLT_ResponsiveImage.setAspect");var w=inEvent.target.width;var h=inEvent.target.height;if(h&&h>0){this.aspectRatio=w/h;MSU_Global.log(w+"x"+h+", aspect="+this.aspectRatio);this.handleResize()}};this.handleResize=function(){var w=null;if(this.isBackground){var aspect=this.aspectRatio?this.aspectRatio:1.77;var cont={width:0,height:0,aspect:0};if($(this.element.parentNode).hasClass("mlt-background-fixed")){cont.width=MSU_Global.getCheckWidth();cont.height=MSU_Global.getCheckHeight();cont.aspect=cont.width/cont.height}else{cont.width=$(this.element.parentNode).width();cont.height=$(this.element.parentNode).height();cont.aspect=cont.width/cont.height}
if(aspect<cont.aspect){w=cont.width}else{w=cont.height*aspect}}else{w=$(this.element.parentNode).width()}
if(w){var newSize=this.sizes.length-1;var pixelRatio=1;for(var i=this.sizes.length-1;i>=0;i--){if(this.sizes[i]*this.variance>w){newSize=i}}
if("devicePixelRatio" in window){pixelRatio=window.devicePixelRatio}
if((newSize!=this.currentSize)||(pixelRatio!=this.currentPixelRatio)){this.originalURL=this.originalURL.replace(/^http[s]?:\/\/[^\/]+/i,"");url="/responsive-media/cache"+this.originalURL+"."+newSize+"."+(pixelRatio>=1.5?"2x":"1x")+".generic.jpg";this.preloadImage=new Image();$(this.preloadImage).load(this.setSourceCallback.bind(this));this.preloadImage.src=url;this.currentSize=newSize;this.currentPixelRatio=pixelRatio}}};this.setSourceCallback=function(){if(this.preloadImage){if(this.isBackground){$(this.element.parentNode).css("background-image","url("+this.preloadImage.src+")")}else{this.element.src=this.preloadImage.src}}
this.preloadImage=null};if(this.isBackground){MSU_Global.log("setting background: "+this.element.src);$(this.element.parentNode).css("background-image","url("+this.element.src+")")}
this.originalURL=$(this.element).attr("data-original-image");if(this.originalURL){if(this.isBackground){var tmpImg=new Image();tmpImg.onload=this.setAspect.bind(this);tmpImg.src=this.element.src}
$(window).resize(this.handleResize.bind(this));this.handleResize()}};window.MLT_ResponsiveImageHandler=new function(){this.images=new Array();this.add=function(inElement){if(this.images.indexOf(inElement)<0){if($(inElement).hasClass("mlt-responsive-image")){this.images.push(new MLT_ResponsiveImage(inElement,!1))}else if($(inElement).hasClass("mlt-responsive-background")){this.images.push(new MLT_ResponsiveImage(inElement,!0))}}};this.scan=function(inElement){$(inElement).find(".mlt-responsive-image").each(function(idx,el){MSU_Global.log("Initializing image: "+el.src);this.images.push(new MLT_ResponsiveImage(el,!1))}.bind(this));$(inElement).find(".mlt-responsive-background").each(function(idx,el){this.images.push(new MLT_ResponsiveImage(el,!0))}.bind(this))};this.init=function(){this.scan(document.body)}};function PRPL_ResponsiveTable(inElement,inOrdinal){this.el=inElement;this.ord=inOrdinal;this.el.id="ResponsiveTable"+inOrdinal;this.headings=new Array();$(this.el).find("thead th").each(function(idx,el){this.headings.push($(el).text())}.bind(this));MSU_Global.log("Responsive Table Init");MSU_Global.log(this.headings);var outCSS=new Array();for(var i=0;i<this.headings.length;i++){var tmp="";tmp+="table#"+this.el.id;tmp+=" tbody tr";tmp+=" td:nth-of-type("+(i+1)+")";tmp+=":before";tmp+="{content: \""+(this.headings[i].replace(/["]/g,"\\\""))+"\"}";outCSS.push(tmp)}
var outStyleTag=MSU_Global.createElement("STYLE");outStyleTag.type="text/css";outStyleTag.innerHTML="@media (max-width:719px) {\n"+outCSS.join("\n")+"\n}";document.head.appendChild(outStyleTag)}
window.PRPL_ResponsiveTableHandler=new function(){this.tables=new Array();this.currentOrd=0;this.AddTable=function(inElement){this.tables.push(new PRPL_ResponsiveTable(inElement,this.currentOrd));this.currentOrd++};this.init=function(){$(".responsive-table").each(function(idx,el){this.AddTable(el)}.bind(this))};return this};window.tabGroupCount=0;function PRPL_TabGroup(inElement){this.tabGroup=inElement;this.contents=new Array();this.navTray=MSU_Global.createElement("div","nav-tray");this.navButtons=new Array();this.id="TabGroup"+window.tabGroupCount;window.tabGroupCount++;this.handeKey=function(inEvent){var selected=-1;for(var i=0;i<this.navButtons.length;i++){if($(this.navButtons[i]).hasClass("current")){selected=i}}
if(selected<0){selected=0;this.switchToTab(0)}
if(inEvent.key=="Tab"||inEvent.keyCode==9){if(!inEvent.shiftKey){this.contents[selected].focus();inEvent.preventDefault()}}else if(inEvent.key=="ArrowRight"||inEvent.keyCode==39){if(selected<this.navButtons.length-1){this.switchToTab(selected+1);this.navButtons[selected+1].focus();inEvent.preventDefault()}}else if(inEvent.key=="ArrowLeft"||inEvent.keyCode==37){if(selected>0){this.switchToTab(selected-1);this.navButtons[selected-1].focus();inEvent.preventDefault()}}else if(inEvent.key=="Home"||inEvent.keyCode==36){if(selected>0){this.switchToTab(0);this.navButtons[0].focus();inEvent.preventDefault()}}else if(inEvent.key=="End"||inEvent.keyCode==35){if(selected<this.navButtons.length-1){this.switchToTab(this.navButtons.length-1);this.navButtons[this.navButtons.length-1].focus();inEvent.preventDefault()}}};this.handleNavPanelFocus=function(inEvent){var selected=-1;for(var i=0;i<this.navButtons.length;i++){if($(this.navButtons[i]).hasClass("current")){selected=i}}
if(i>0){$(this.navButtons[i]).focus();inEvent.preventDefault()}
inEvent.preventDefault()}
this.switchToTab=function(inIndex,fromClick){var i;for(i=0;i<this.contents.length;i++){if(i==inIndex){$(this.contents[i]).show();$(this.navButtons[i]).addClass("current");$(this.navButtons[i]).attr("aria-selected","true")}else{$(this.contents[i]).hide();$(this.navButtons[i]).removeClass("current");$(this.navButtons[i]).attr("aria-selected","false")}}
if(fromClick){}};this.clickTab=function(inEvent){var idx=0;var i=0;for(i=0;i<this.navButtons.length;i++){if(this.navButtons[i]==inEvent.target)idx=i}
this.switchToTab(idx,!0)};this.addTab=function(el){var h2=$(el).find("h2").get(0);var navButton=MSU_Global.createElement("A","nav-button",null,$(h2).text());navButton.href="javascript: ;";$(navButton).click(this.clickTab.bind(this));$(navButton).attr("tabindex","-1");this.navTray.appendChild(navButton);this.navButtons.push(navButton);h2.parentNode.removeChild(h2);$(navButton).attr("role","tab")
$(navButton).attr("aria-selected","false");$(el).attr("role","tabpanel");el.id=this.id+"_"+this.navButtons.length.toString();$(navButton).attr("aria-controls",el.id);$(el).attr("tabindex",-1);this.contents.push(el)};$(this.navTray).attr("role","tablist");var tmpEl=this.tabGroup.firstChild;while(tmpEl){if($(tmpEl).hasClass("tab-content")){this.addTab(tmpEl)}
tmpEl=tmpEl.nextSibling}
this.tabGroup.insertBefore(this.navTray,this.tabGroup.firstChild);var a11ylabel=MSU_Global.createElement("p","a11y-label",null,"Tab Group");this.tabGroup.insertBefore(a11ylabel,this.tabGroup.firstChild);$(this.navTray).keypress(this.handeKey.bind(this));$(this.navTray).focus(this.handleNavPanelFocus.bind(this));$(this.navTray).attr("tabindex","0");this.switchToTab(0,!1)}
window.PRPL_TabGroupHandler=new function(){this.tabGroups=new Array();this.add=function(inElement){this.tabGroups.push(new PRPL_TabGroup(inElement))};this.init=function(){MSU_Global.log("Tab Group Init");$(".page-middle .tab-group").each(function(idx,el){this.add(el)}.bind(this))};return this};window.drawerCounter=0;function PRPL_Drawer(inElement){var id="PRPLDrawer"+window.drawerCounter;window.drawerCounter++;this.obj=inElement;this.drawer=null;this.isOpen=!1;this.button=null;this.toggle=function(inEvent){if(this.isOpen){$(this.drawer).slideUp();$(this.obj).removeClass("open");$(this.button).attr("aria-expanded","false");$(this.button).focus()}else{$(this.drawer).slideDown();$(this.obj).addClass("open");$(this.button).attr("aria-expanded","true");$(this.drawer).focus()}
this.isOpen=!this.isOpen;inEvent.preventDefault()};var header=$(this.obj).find(".prpl-drawer-header").get(0);var label=$(header).text();var a=MSU_Global.createElement("A",null,null,label);a.href="#";$(a).click(this.toggle.bind(this));$(a).attr("role","button");$(a).attr("aria-controls",id);$(a).attr("aria-expanded",!1);header.innerHTML="";header.appendChild(a);this.button=a;this.drawer=$(this.obj).find(".prpl-drawer-content").get(0);if($(this.obj).hasClass("open")){$(this.drawer).show();this.isOpen=!0;$(this.button).attr("aria-expanded","true")}else{$(this.drawer).hide();this.isOpen=!1;$(this.button).attr("aria-expanded","false")}
$(this.drawer).attr("tabindex","-1");$(this.drawer).attr("id",id);$(this.drawer).attr("aria-role","region")}
window.PRPL_DrawerHandler=new function(){this.drawers=new Array();this.add=function(inElement){this.drawers.push(new PRPL_Drawer(inElement))};this.init=function(){$(".prpl-drawer").each(function(idx,el){this.add(el)}.bind(this));if(document.location.hash&&document.location.hash.length>1){var anchor=document.getElementsByName(document.location.hash.substring(1));if(anchor&&anchor.length>0){var node=anchor[0].parentNode;while(node){if($(node).hasClass("prpl-drawer")){var drawerReference=null;for(var i=0;i<this.drawers.length;i++){if(this.drawers[i].obj==node){drawerReference=this.drawers[i]}}
if(drawerReference&&drawerReference.isOpen==!1){drawerReference.toggle();var nodeOffset=$(node).offset();window.scrollTo(0,Math.max(0,nodeOffset.top-MSU_Global.getCheckWidth()*0.05))}}
node=node.parentNode}}}};return this};function PRPL_ScaledVideo(inElement){this.element=inElement;this.element.PRPL_ScaledVideo=this;this.resize=function(inEvent){var w=$(this.element.parentNode).width();var h=Math.floor(w*9.0/16.0);$(this.element).css("height",h+"px")}
$(this.element).css("width","100%");$(window).resize(this.resize.bind(this));this.resize()}
window.PRPL_ScaledVideoManager=new function(){this.videos=new Array();this.add=function(inElement){if(!("PRPL_ScaledVideo" in inElement)){this.videos.push(new PRPL_ScaledVideo(inElement))}};this.scan=function(inElement){$(inElement).find("iframe").each(function(idx,el){if(el.src.match(/youtube\.com/i)!==null||el.src.match(/vimeo\.com/i)!==null){this.add(el)}}.bind(this))}
this.init=function(){this.scan(document.body)};return this};function a11yPhoneNumber(inElement){this.el=inElement;$(this.el).addClass("initialized");this.spanEach=function(inStr){var i;var outStr="";for(i=0;i<inStr.length;i++){outStr+=inStr[i]+" "}
return outStr}
this.spaceEach=function(inStr){return(inStr.split("")).join(" ")}
var numString=String($(this.el).text().replace(/[^0-9]/gi,""));if(numString.length==10&&!($(this.el).attr("aria-label"))){var areaCode=numString.substr(0,3);var exchange=numString.substr(3,3);var numPart=numString.substr(6,4);areaCode=this.spanEach(areaCode);exchange=this.spanEach(exchange);var iNumPart=parseInt(numPart,10);if(numPart=="0000"){numPart=this.spanEach(numPart)}else if(Math.floor(numPart/10)%100==0){numPart=numPart+" "}else{var numPart1=numPart.substr(0,2);var numPart2=numPart.substr(2,2);if(parseInt(numPart1,10)<10){numPart1=this.spanEach(numPart1)}else{numPart1=numPart1+" "}
if(parseInt(numPart2,10)<10){numPart2=this.spanEach(numPart2)}else{numPart2=numPart2+" "}
numPart=numPart1+numPart2}
$(this.el).attr("aria-label",areaCode+" "+exchange+" "+numPart)}}
window.a11yTools=new function(){this.phoneNumbers=new Array();this.addPhoneNumber=function(inElement){this.phoneNumbers.push(new a11yPhoneNumber(inElement))};this.scan=function(inElement){$(inElement).find("a").each(function(idx,el){if(el.href.match(/^tel:/i)){$(el).addClass("a11y-phone-number")}}.bind(this));$(inElement).find(".a11y-phone-number").each(function(idx,el){if(!$(el).hasClass("initialized"))this.addPhoneNumber(el)}.bind(this))};this.init=function(){this.scan(document.body)};return this};function MSU_MajorsFilter(inObject){MSU_Global.log("MSU_MajorsFilter init");this.object=inObject;this.listURL="https://www.montclair.edu/hawkeye/academic-export.php?callback=?";this.searchURL="https://www.montclair.edu/hawkeye/data.php?callback=?";this.lastSearch="";this.programs=new Array();this.textInput=$(this.object).find("input").get(0);this.selectInput=$(this.object).find("select").get(0);this.randomButton=$(this.object).find(".randomizer").get(0);this.inputPollingInterval=null;this.doFilterCallback=null;this.outputArea=$(this.object).find(".results-area").get(0);this.exclusions=["the","and","of","with","in"];this.firstRun=!0;this.handleSearchData=function(inData){if(inData.status=="success"){var filter=$(this.selectInput).val();var resultArray=new Array();var maxItems=8;if(MSU_Global.getCheckWidth()>=720&&!$(document.body).hasClass("homepage")){maxItems=6}
maxItems=100000;for(var i in inData.data){var t=inData.data[i].meta.types.toLowerCase();if(filter=="all"||t.indexOf(filter.toLowerCase())>=0){resultArray.push(inData.data[i])}}
var tmpStr=""+resultArray.length+" matching programs"+(resultArray.length>maxItems?" (showing first "+maxItems+")":"")+".";if(!this.firstRun)$(this.object).find(".result-count").html(tmpStr);tmpStr="";resultArray=resultArray.slice(0,maxItems);for(i in resultArray){tmpStr+="<div class=\"result\">";tmpStr+="<span class=\"image-wrapper\">";tmpStr+="<img class=\"mlt-responsive-background\" data-original-image=\""+resultArray[i].meta.picture+"\" alt=\"\"";tmpStr+=" src=\"/responsive-media/cache/"+(resultArray[i].meta.picture)+".0.1x.generic.jpg\" />";tmpStr+="</span>";tmpStr+="<h2 class=\"title\"><a href=\""+resultArray[i].url+"\">"+resultArray[i].title+"</a></h2>";tmpStr+="<span class=\"summary\">"+resultArray[i].summary+"</span>";var types=resultArray[i].meta.types.replace(/,/gi,", ");types=this.ucwords(types);tmpStr+="<span class=\"offering\">Programs Offered: "+types+"</span>";tmpStr+="</div>"}
this.outputArea.innerHTML=tmpStr;MLT_ResponsiveImageHandler.scan(this.outputArea);this.firstRun=!1}}
this.ucwords=function(str){return(str+'').replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function($1){return $1.toUpperCase()})};this.doFilter=function(){MSU_Global.log("MSU_MajorsFilter.doFilter");this.doFilterCallback=null;this.lastSearch=$(this.textInput).val();var params={"q":$(this.textInput).val(),"action":"search","filter":"academic"};$.getJSON(this.searchURL,params,this.handleSearchData.bind(this))};this.handleData=function(inData){MSU_Global.log("MSU_MajorsFilter.handleData");MSU_Global.log(inData);if(inData.status=="success"){this.programs=inData.data;for(var i in this.programs){this.programs[i].types=this.programs[i].meta.types.split(",");this.programs[i].terms=this.programs[i].title.toLowerCase().replace(/[^a-z0-9]/g," ").replace(/^[\s\t\r\n]+/,"").replace(/[\s\t\r\n]+$/,"").replace(/[\s\t\r\n]+/g," ").split(" ")}
this.doFilter()}};this.inputFocus=function(inEvent){MSU_Global.log("MSU_MajorsFilter.inputFocus");this.inputPollingInterval=window.setInterval(this.inputPoll.bind(this),10);var docWidth=MSU_Global.getCheckWidth();var topPadding=docWidth>=720?(docWidth*0.06):(docWidth*0.3);var inputOffset=docWidth>=720?$(this.object).offset():$(this.textInput.parentElement).offset();if((inputOffset.top-topPadding)>$(window).scrollTop()){var anim=new MSU_Animator({startPos:$(window).scrollTop(),endPos:inputOffset.top-topPadding},500,function(inData,progress){progress=0.5-0.5*Math.cos(progress*Math.PI);var pos=inData.startPos+progress*(inData.endPos-inData.startPos);window.scrollTo(0,pos)},null);anim.start()}};this.inputBlur=function(inEvent){window.clearInterval(this.inputPollingInterval);this.inputPollingInterval=null};this.inputPoll=function(){var searchString=this.textInput.value;if(searchString!=this.lastSearch){if(this.doFilterCallback){window.clearTimeout(this.doFilterCallback)}
this.doFilterCallback=window.setTimeout(this.doFilter.bind(this),200);this.lastSearch=searchString}};this.changeFilter=function(){if(this.doFilterCallback){window.clearTimeout(this.doFilterCallback)}
this.doFilterCallback=window.setTimeout(this.doFilter.bind(this),200)};this.pickRandom=function(){var randIndex=Math.floor(Math.random()*this.programs.length);this.textInput.value=this.programs[randIndex].title;this.selectInput.selectedIndex=0;$(this.textInput).focus()}
$(this.textInput).focus(this.inputFocus.bind(this));$(this.textInput).blur(this.inputBlur.bind(this));$(this.selectInput).change(this.changeFilter.bind(this));$(this.randomButton).click(this.pickRandom.bind(this));$(this.object).find("a.random-link").click(this.pickRandom.bind(this));$.getJSON(this.listURL,{},this.handleData.bind(this))}
window.emergencyNotificationHandler=new function(){this.scrim=null;this.notificationObj=null;this.showButton=null;this.headline=null;this.closeButton=null;this.previousFocus=null;this.tabWrapBefore=function(){$(this.closeButton).focus()};this.tabWrapAfter=function(){$(this.headline).focus()};this.buildHTML=function(inData){this.notificationObj=MSU_Global.createElement("DIV","emergency-notice "+inData.type,"EmergencyNoticeDialog",null);$(this.notificationObj).attr("role","dialog");$(this.notificationObj).attr("aria-labelledby","EmergencyNoticeTitle");$(this.notificationObj).attr("aria-describedby","EmergencyNoticeDescription");var tabWrapBeforeButton=MSU_Global.createElement("A","tab-wrapper");tabWrapBeforeButton.href="javascript: ;";$(tabWrapBeforeButton).focus(this.tabWrapBefore.bind(this));this.notificationObj.appendChild(tabWrapBeforeButton);this.headline=MSU_Global.createElement("h2","headline","EmergencyNoticeTitle",inData.headline);$(this.headline).attr("tabindex","0");this.notificationObj.appendChild(this.headline);var description=MSU_Global.createElement("div","description","EmergencyNoticeDescription",null);description.innerHTML=inData.details;this.notificationObj.appendChild(description);var tDate=new Date(inData.timestamp*1000);var timestamp=MSU_Global.createElement("p","timestamp",null,"Notification Updated: "+tDate.toLocaleString());this.notificationObj.appendChild(timestamp);this.closeButton=MSU_Global.createElement("button","close");this.closeButton.innerHTML='<svg viewBox="0 0 30 30"><use xlink:href="#close-x"></use></svg>';$(this.closeButton).attr("aria-label","close dialog");$(this.closeButton).click(this.hideNotice.bind(this));this.notificationObj.appendChild(this.closeButton);var tabWrapAfterButton=MSU_Global.createElement("A","tab-wrapper");tabWrapAfterButton.href="javascript: ;";$(tabWrapAfterButton).focus(this.tabWrapAfter.bind(this));this.notificationObj.appendChild(tabWrapAfterButton);this.scrim=MSU_Global.createElement("DIV","emergency scrim");$(this.scrim).click(this.hideNotice.bind(this));this.showButton=MSU_Global.createElement("a","emergency-show-button "+inData.type);this.showButton.href="javascript: ;";$(this.showButton).attr("aria-label","show emergency notice");$(this.showButton).click(this.showNotice.bind(this));document.body.appendChild(this.scrim);document.body.appendChild(this.notificationObj);$(".page-header").get(0).appendChild(this.showButton)};this.showNotice=function(){$(document.body).addClass("no-scroll");$(this.scrim).fadeIn();$(this.notificationObj).fadeIn();this.previousFocus=document.activeElement;$(this.headline).focus()};this.hideNotice=function(){$(document.body).removeClass("no-scroll");$(this.scrim).fadeOut();$(this.notificationObj).fadeOut();if(this.previousFocus&&typeof($(this.previousFocus).attr("tabindex"))!="undefined"&&parseInt($(this.previousFocus).attr("tabindex"),10)>=0){MSU_Global.log("sending focus to previous object");$(this.previousFocus).focus()}else{MSU_Global.log("sending focus to first link in body");$("a").first().focus()}};this.handleData=function(inData){if(!inData.display)return!1;ensureCSS(window.themeRoot+"/emergency-icons.css");this.buildHTML(inData);var viewTimestamp=!1;var cookies=(new String(document.cookie)).split(";");for(var i=0;i<cookies.length;i++){var tmp=cookies[i].split("=");if(tmp[0]=="emergencyViewed"||tmp[0]==" emergencyViewed")viewTimestamp=parseInt(unescape(tmp[1]),10)}
if(viewTimestamp&&viewTimestamp>(inData.timestamp*1000)){}else{document.cookie="emergencyViewed="+(new Date()).getTime()+";path=/";this.showNotice()}};this.init=function(){$.getJSON("/mobile/emergency_notice.js?junkValue="+(new Date()).getTime(),{},this.handleData.bind(this))};return this};function PRPL_PhotoGalleryItem(inElement,inParent){this.obj=inElement;this.zoomed=!1;this.parent=inParent;this.obj.galleryInitialized=!0;this.toggleZoom=function(inEvent){if(this.zoomed){this.parent.setCurrent(null);$(this.obj).removeClass("enlarged");$(document.body).removeClass("no-scroll");$(this.obj).find(".open-button a").focus()}else{this.parent.setCurrent(this);$(this.obj).addClass("enlarged");$(document.body).addClass("no-scroll");$(this.obj).find(".close-button a").focus()}
this.zoomed=!this.zoomed;$(window).trigger("resize")}
this.forceClose=function(){if(this.zoomed){$(this.obj).removeClass("enlarged");this.zoomed=!1}}
$(this.obj).click(this.toggleZoom.bind(this))}
function PRPL_PhotoGallery(inElement){this.obj=inElement;this.items=new Array();this.currentItem=null;this.add=function(inElement){if(!inElement.galleryInitialized){this.items.push(new PRPL_PhotoGalleryItem(inElement,this))}};this.scan=function(){$(this.obj).find(".gallery-item").each(function(idx,el){this.add(el)}.bind(this))};this.setCurrent=function(inObj){var inCurrent=-1;for(var i=0;i<this.items.length;i++){if(inObj==this.items[i]){inCurrent=i}}
if(inCurrent>=0&&inCurrent<this.items.length){if(this.currentItem!=null){this.items[this.currentItem].forceClose()}
this.currentItem=inCurrent;$(this.obj).addClass("active")}else{this.currentItem=null;$(this.obj).removeClass("active")}}
this.goNext=function(inEvent){if(this.currentItem!==null){var newItem=this.currentItem+1;if(newItem<0)newItem=0;if(newItem>=this.items.length)newItem=this.items.length-1;if(newItem!=this.currentItem){this.items[this.currentItem].forceClose();this.items[newItem].toggleZoom()}}}
this.goPrevious=function(inEvent){if(this.currentItem!==null){var newItem=this.currentItem-1;if(newItem<0)newItem=0;if(newItem>=this.items.length)newItem=this.items.length-1;if(newItem!=this.currentItem){this.items[this.currentItem].forceClose();this.items[newItem].toggleZoom()}}}
this.scan();$(this.obj).find(".previous-button").click(this.goPrevious.bind(this));$(this.obj).find(".next-button").click(this.goNext.bind(this));this.obj.galleryInitialized=!0}
window.PRPL_PhotoGalleryHandler=new function(){this.galleries=new Array();this.add=function(inElement){if(!inElement.galleryInitialized){this.galleries.push(new PRPL_PhotoGallery(inElement))}};this.scan=function(inParent){$(inParent).find(".prpl-photo-gallery").each(function(idx,el){this.add(el)}.bind(this))}
this.init=function(){this.scan(document.body)}
return this};function MSU_CalendarFeed(inObject){this.obj=inObject;this.calendarID=$(this.obj).attr("data-calendar-id");this.url="//www.montclair.edu/includes/calendar/upcoming-events.php?callback=?";this.maxEvents=10;this.metaKey=null;this.metaValue=null;this.handleFeed=function(inData){if("status" in inData&&inData.status=="success"){console.log(inData.data);if(this.metaKey){var tmpArray=new Array();for(var i=0;i<inData.data.length;i++){var meta=inData.data[i].metaData;if((this.metaKey in meta)&&(this.metaValue==null||meta[this.metaKey]==this.metaValue)){tmpArray.push(inData.data[i])}}
inData.data=tmpArray.slice(0,this.maxEvents)}
for(var i=0;i<inData.data.length;i++){var event=inData.data[i];var calendarItem=MSU_Global.createElement("div","calendar-item");var imageHolder=MSU_Global.createElement("div","image-holder");if(event.thumbnail){var img=MSU_Global.createElement("img","mlt-responsive-background");$(img).attr("data-original-image","/cdn/calendar/"+event.thumbnail);img.src="/responsive-media/cache/cdn/calendar/"+event.thumbnail+".0.1x.generic.jpg";img.alt="Feature image for "+event.title;imageHolder.appendChild(img)}
event.date=event.date.replace(/-/gi,"/");var tDate=new Date(event.date+" 12:00:00");var dateString=MSU_Global.dayLabels[tDate.getDay()].long;dateString+=", "+MSU_Global.monthLabels[tDate.getMonth()].long;dateString+=" "+tDate.getDate();var h3=MSU_Global.createElement("h3");var preHead=MSU_Global.createElement("span","pre-heading",null,dateString);var link=MSU_Global.createElement("a",null,null,event.title);link.href="//www.montclair.edu/calendar/view-event.php?id="+event.id;h3.appendChild(preHead);h3.appendChild(document.createElement("br"));h3.appendChild(link);var summary=MSU_Global.createElement("p","summary",null,event.summary);calendarItem.appendChild(imageHolder);calendarItem.appendChild(h3);calendarItem.appendChild(summary);this.obj.appendChild(calendarItem);window.MLT_ResponsiveImageHandler.scan(this.obj)}}};if(this.calendarID){var maxEvents=parseInt($(this.obj).attr("data-max-events"),10);if(maxEvents){maxEvents=Math.max(4,Math.min(16,maxEvents))}else{maxEvents=8}
var params={"CalendarID":this.calendarID};if($(this.obj).attr("data-start-date")&&$(this.obj).attr("data-end-date")){this.maxEvents=maxEvents;params.StartDate=$(this.obj).attr("data-start-date");params.EndDate=$(this.obj).attr("data-end-date")}else if($(this.obj).attr("data-meta-key")){this.maxEvents=maxEvents;params.MaxEvents=100;this.metaKey=$(this.obj).attr("data-meta-key");if($(this.obj).attr("data-meta-value"))this.metaValue=$(this.obj).attr("data-meta-value")}else{this.maxEvents=maxEvents;params.MaxEvents=maxEvents}
$.getJSON(this.url,params,this.handleFeed.bind(this));if(!$(this.obj).hasClass("vertical")){$(this.obj).addClass("horizontal")}}}
window.MSU_CalendarFeedManager=new function(){this.feedList=new Array();this.add=function(inObject){if(!inObject.calendarInitialized){this.feedList.push(new MSU_CalendarFeed(inObject))}}
this.scan=function(inBase){$(inBase).find(".prpl-calendar-feed").each(function(idx,el){this.add(el)}.bind(this))}
this.init=function(){this.scan(document.body)}
return this};if(typeof($)=="undefined")$=jQuery;window.MSU_FontResizer=new function(){this.resize=function(){var w=MSU_Global.getCheckWidth();if(w>1200){$(document.body).css("font-size",(w*0.013)+"px")}}
this.init=function(){$(window).resize(this.resize.bind(this));this.resize();setTimeout(this.resize.bind(this),500)}
return this}
$(document.body).ready(function(){window.a11yTools.init();window.MSU_PRPLDesktopMenu.init();window.MSU_LiveSearchManager.init();window.emergencyNotificationHandler.init();window.MLT_ResponsiveImageHandler.init();window.PRPL_ResponsiveTableHandler.init();window.PRPL_TabGroupHandler.init();window.PRPL_DrawerHandler.init();window.PRPL_ScaledVideoManager.init();window.PRPL_PhotoGalleryHandler.init();$(".page-footer .footer-menu .column").each(function(idx,el){el.customHandler=new MSU_PRPLFooterFoldoutMenu(el)});$(".prpl-homepage-hero").each(function(idx,el){el.customHandler=new MSU_PRPLHomepageHero(el)});window.PRPLHomepageHeroCarouselManager.init();$(".prpl-band.homepage-hawkeye").each(function(idx,el){el.customHandler=new MSU_HomepageHawkeye(el)});$(".majors-filter").each(function(idx,el){el.customHandler=new MSU_MajorsFilter(el)});window.MSU_CalendarFeedManager.init();var ua=navigator.userAgent.toLowerCase();if((ua.indexOf('safari')!=-1)&&(ua.indexOf('chrome')<0)){var versionNo=navigator.appVersion.match(/[0-9\.]+\sSafari/);versionNo=versionNo.toString().match(/^[0-9]+\.[0-9]+/);if(parseFloat(versionNo,10)>=10){ensureCSS(window.themeRoot+"/roboto.css")}}else{ensureCSS(window.themeRoot+"/roboto.css")}
$(document.body).addClass("post-load")})