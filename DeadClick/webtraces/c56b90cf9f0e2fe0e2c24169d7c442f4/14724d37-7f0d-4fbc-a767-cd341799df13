jQuery(function($){$('.product-widget-placeholder').each(function(i,placeholder){fetch_product_widget(placeholder);});$(window).on('resize',function(){setTimeout(function(){$('.ux-slider, .product-gallery-slider').each(function(i,slider){var height=$(slider).find('.is-selected').outerHeight();if(height){$(slider).find('.flickity-viewport').css('height',height);}});},250);});$(document).on('cellSelect','.ux-slider, .product-gallery-slider',function(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){$(this).find('.ux_banner:not(.is-selected) .ux-banner-video').trigger('pause');$(this).find('.ux_banner.is-selected .ux-banner-video').trigger('play');}
var height=$(this).find('.is-selected').outerHeight();if(height){$(this).find('.flickity-viewport').css('height',height);}});$(document).on('click','.ue-product-widget .flickity-slider .slide',function(){console.log('clicked');$(this).closest('.product-gallery-slider').flickity('next');});$(document).on('submit','.ue-product-widget form',function(){var form=$(this);$.ajax({method:'POST',url:'/wp-admin/admin-ajax.php',data:$(this).serialize(),dataType:'json',beforeSend:function(){$(form).addClass('loading-content');$(form).closest('.ue-product-widget').find('.add-status-box').slideUp(function(){$(this).removeClass('status-success');});},success:function(response){display_status(form,response);},complete:function(){$(form).removeClass('loading-content');}});return false;});});function fetch_product_widget(placeholder){$(placeholder).data('action','display_product_widget');var data=$(placeholder).data();$.ajax({method:'GET',url:'/wp-admin/admin-ajax.php',data:data,beforeSend:function(){$(placeholder).addClass('loading-content');},success:function(response){$(placeholder).html(response);var swa=$(placeholder).find('.swatch-wrapper.selected .swatch-anchor');$(placeholder).find('.js-flickity').each(function(i,slider){var ii=0;if($(swa).length>0&&$(slider).is('.pw-gallery-slider-big')){ii=$(slider).find('.'+ $(swa).attr('href')).index();}
var show_dots=$(slider).data('show-dots')?true:false;$(slider).flickity({cellAlign:"left",autoPlay:false,prevNextButtons:true,imagesLoaded:true,lazyLoad:0,pageDots:show_dots,selectedAttraction:0.1,friction:0.6,rightToLeft:false,setGallerySize:true,wrapAround:true,initialIndex:ii});});setTimeout(function(){if($(placeholder).find('form').hasClass('variations_form')){$(placeholder).find('form.variations_form').wc_variation_form();$(placeholder).find('form.variations_form').trigger('check_variations',['',false]);$(placeholder).find('form.variations_form').trigger('woocommerce_variation_has_changed');}},300);},complete:function(){$(placeholder).removeClass('loading-content');}});}
function display_status(form,response){var st_box=$(form).closest('.ue-product-widget').find('.add-status-box');var tmr=$(st_box).data('timer');if(tmr)clearTimeout(tmr);if(response.status==='success'){$(st_box).addClass('status-success');$(form).trigger('item-added-via-ajax');reaload_refreshed_fragments();}
$(st_box).find('div').html(response.message);$(st_box).slideDown();tmr=setTimeout(function(){$(st_box).slideUp();},7000);}
function reaload_refreshed_fragments(){$(document.body).trigger('wc_fragment_refresh');}