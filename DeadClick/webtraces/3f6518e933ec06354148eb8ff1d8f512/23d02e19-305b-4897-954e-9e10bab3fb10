;var CTR="undefined"!=typeof CTR&&"object"==typeof CTR?CTR:{},rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,Aol_trim=Aol_trim||function(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},Aol_parseJSON=Aol_parseJSON||function(n){return"string"==typeof n&&n?(n=Aol_trim(n),window.JSON&&window.JSON.parse?window.JSON.parse(n):rvalidchars.test(n.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+n)():void Aol_log("Bad JSON: "+n)):null},Aol_bind=Aol_bind||function(n,a,t){n.attachEvent?n.attachEvent("on"+a,t):n.addEventListener&&n.addEventListener(a,t,!1)},Aol_log=Aol_log||function(n){"undefined"!=typeof window.console&&"undefined"!=typeof console.log&&"function"==typeof console.log&&console.log(n)},log=log||function(n){Aol_log(n)};CTR.isSandbox=/\.sandbox\./.test(location.hostname),CTR.unsetParams=function(){window.bN&&bN.set([["mnid",""],["plids",""],["plid",""],["lnid",""]]),CTR.isSandbox&&Aol_log("bN params reset")},Aol_bind(document,"click",CTR.unsetParams),function(n){n.fn.hasAttr=function(n){return"undefined"!=typeof this.attr(n)&&this.attr(n)!==!1},CTR.maxTimes=4,CTR.centralNavTimes=1,CTR.setBeaconForcentralNav=function(){var a=this;try{if(responsiveMenu=n(".m-header-navigation, .m-mobile-navigation"),responsiveMenuItems=responsiveMenu.find("ul").find("li").find("ul.m-header-mid-nav").find("> li"),responsiveMenuItems.length<=0)throw new Error("Main Menu not ready!");responsiveMenu.find('li[data-parent-nav="more"] a').attr({"data-beacon":'{"p": {"lnid": "lnk-more"}}'}),responsiveMenuItems.each(function(){var a=n(this);a.find("> a").attr({"data-beacon":'{"p": {"lnid": "sec'+(a.parent().parent().index()+1)+"_lnk"+(a.index()+2)+'"}}'}),0===a.index()&&a.parent().parent().find("> a").attr({"data-beacon":'{"p": {"lnid": "sec'+(a.parent().parent().index()+1)+"_lnk"+(a.index()+1)+'"}}'})}),setTimeout(function(){n(".m-header-bot-nav li").each(function(){var a=n(this).parent().hasClass("has-thumbs")?"_img-lnk":"_lnk";n(this).attr({"data-beacon":'{"p": {"lnid": "dropdownnav'+(n(this).parent().parent().index()+1)+a+(n(this).index()+1)+'"}}'}),n(this).find("> a").removeAttr("data-beacon")})},3e3)}catch(t){a.centralNavTimes<a.maxTimes&&setTimeout(function(){a.centralNavTimes++,a.setBeaconForcentralNav()},500)}},CTR.shareTimes=1,CTR.ShareButton=function(a){var t=this,e=a;try{for(i in e)if(""!==n.trim(n(e[i]).html())){if(n(e[i]).find(".aol-share > a").length<=0)throw new Error("share buttons aren't ready yet!");n(e[i]).find(".aol-share > a").each(function(a){n(this).attr("data-beacon",'{"p": {"lnid":"btn'+(a+1)+'"}}')})}}catch(o){t.shareTimes<t.maxTimes&&setTimeout(function(){t.shareTimes++,t.ShareButton(e)},500)}},CTR.setBeaconForArticleBody=function(){if(n("#socialTxt").length>=1){var a=n("#socialTxt");a.find(" > a").each(function(a){n(this).attr("data-beacon",'{"p": {"lnid":"lnk'+(a+1)+'"}}')})}var t=n(".post-tags");t.length>0&&t.find("a").length>0&&n("a",t).each(function(a){n(this).attr({"data-beacon":'{"p": {"lnid": "lnk'+(a+1)+'"}}'})})},CTR.commentsTimes=1,CTR.setBeaconForComments=function(a){var t=this,e=a;try{var i=n("#aol-comments");if(i.length<=0)throw new Error("not ready");if(e===!1){var o=n("#aol-comments-auth-link",i),r=n("#aol-comments-submit",i),d=n("#aol-comments-filter",i),s=n("div.comment-body",i),l=n(".pagination a.load-more-comments",i),c="b.rate-up",m="b.rate-down",f="a.permalink",p=0;l.attr({"data-beacon":'{"p": {"lnid": "show-comments"}}'}).addClass("bN"),o.attr({"data-beacon":'{"p": {"lnid": "sec1_lnk"}}'}).addClass("bN"),r.attr({"data-beacon":'{"p": {"lnid": "sec1_btn"}}'}).addClass("bN"),d.attr({"data-beacon":'{"p": {"lnid": "sec2_btn1"}}'}).addClass("bN"),s.each(function(a){var t=n(this),e=a+1,i="sec3";t.hasClass("featured")?(i="sec4",e=p+=1):e-=p,t.attr({"data-row-num":e}),t.find(c).attr({"data-beacon":'{"p": {"lnid": "'+i+"_ln"+e+'_btn1"}}'}).addClass("bN"),t.find(m).attr({"data-beacon":'{"p": {"lnid": "'+i+"_ln"+e+'_btn2"}}'}).addClass("bN"),t.find(f).attr({"data-beacon":'{"p": {"lnid": "'+i+"_ln"+e+'_lnk1"}}'}).addClass("bN")}),s.delegate("a.reply,a.report-abuse","click",function(){var a=n(this),t=a.attr("class"),e=a.closest(".comment-body").attr("data-row-num"),i=a.closest("div.comment");a.delay(500).queue(function(){if(-1!==t.indexOf("reply")){var o=i.find("button[id^='aol-comments-i-']");o.attr({"data-beacon":'{"p": {"lnid": "sec3_ln'+e+'_btn3"}}'}).addClass("bN"),o.parent().next("a.cancel").attr("data-beacon",'{"p": {"mlid": "col1", "mnid": "aol-comments", "lnid": "sec3_ln'+e+'_lnk8"}}').addClass("bN")}else{var r=n(".aol-message-box .confirmation");r.length>0&&n("a",r).each(function(a){n(this).attr("data-beacon",'{"p": {"mlid": "col1", "mnid": "aol-comments", "lnid": "sec5_ln'+e+"_link"+(a+1)+'"}}')})}a.dequeue()})})}else if(e!==!1&&"undefined"!=typeof e&&"object"==typeof e){var u=e.obj||!1,h=e.mo||!1,b=".moderation a.feature",v=".moderation ul.mark-comment > li",T="a.report-abuse",_="a.reply";if(u&&h){var g=u.attr("data-row-num");u.find(b).length>0&&!u.find(b).hasAttr("data-beacon")&&(u.find(b).attr({"data-beacon":'{"p": {"lnid": "sec3_ln'+g+'_lnk4"}}'}).addClass("bN"),u.find(v).each(function(a){0!=a&&n(this).attr({"data-beacon":'{"p": {"lnid": "sec3_ln'+g+"_lnk"+(4+a)+'"}}'}).addClass("bN")})),u.find(T).length>0&&!u.find(T).hasAttr("data-beacon")&&u.find(T).attr({"data-beacon":'{"p": {"lnid": "sec3_ln'+g+'_lnk2"}}'}).addClass("bN"),u.find(_).length>0&&!u.find(_).hasAttr("data-beacon")&&u.find(_).attr({"data-beacon":'{"p": {"lnid": "sec3_ln'+g+'_lnk3"}}'}).addClass("bN")}}}catch(C){t.commentsTimes<t.maxTimes&&setTimeout(function(){t.commentsTimes++,t.setBeaconForComments(e)},500)}},CTR.pingsDone=[],CTR.preparePing=function(a){var t={_bn:!1,_mn:!1,_ip:!1,_uid:!1},a=a||{};for(prop in t)a.hasOwnProperty(prop)&&(t[prop]=a[prop]);var e=t;e._uid&&e._bn&&(-1!==n.inArray(e._uid,CTR.pingsDone)||(e._ip?e._uid.match(new RegExp(e._ip,"i")):0)||(CTR.pingsDone.push(e._uid),window.bN&&(CTR.unsetParams(),bN.set("mnid",e._mn?e._mn:e._bn),bN.ping(e._bn)),CTR.isSandbox&&Aol_log(CTR.pingsDone)))},CTR.mostCommentedTimes=1,CTR.setBeaconForMostCommented=function(){var a=this;try{var t=n("#gcp-most-commented ul > li");if(t.length<=0)throw new Error("No items found yet!");t.each(function(a){n(this).attr("data-beacon",'{"p": {"plid": "", "lnid": "lnk'+(a+1)+'"}}')})}catch(e){a.mostCommentedTimes<a.maxTimes&&setTimeout(function(){a.mostCommentedTimes++,a.setBeaconForMostCommented()},500)}},CTR.GlobalHFTimes=1,CTR.setBeaconForGlobalHF=function(a){var t=this;try{if("undefined"==typeof a||"object"!=typeof a)return;for(i in a){var e=a[i].id,o=a[i].type||"lnk",r=a[i].iterate||!1;if(!(!e instanceof jQuery)){if(e.length<=0)throw new Error("DOM not ready");if(r)e.each(function(a){var t=n(this),e=t.find("a"),i=t.attr("data-beacon");(i===!1||"undefined"==typeof i)&&t.attr({"data-beacon":'{"p": {"lnid": "'+o+(a+1)+'"}}'}),void 0==e.attr("href")&&e.attr("href","javascript:;")});else{var d=e.attr("data-beacon");(d===!1||"undefined"==typeof d)&&e.attr({"data-beacon":'{"p": {"lnid": "'+o+'"}}'})}}}}catch(s){t.GlobalHFTimes<t.maxTimes&&setTimeout(function(){t.GlobalHFTimes++,t.setBeaconForGlobalHF()},500)}},CTR.mainNavTimes=1,CTR.setBeaconForMainNav=function(){var a=this;try{var t=n(".mod-channel-navigation").find("ul.mod-topnav"),e=t.find(" > li"),i=!0;if(e.length||(t=n(".main-menu"),e=t.find("ul").find("li").find("ul").find("li"),i=!1),e.length<=0)throw new Error("Main Menu not ready!");if(i){e.each(function(a,t){var e=n(t),i=e.find(" > ul");e.attr({"data-beacon":'{"p": {"lnid": "lnk'+(a+1)+'"}}'}),i.length>0&&i.find("li").each(function(a,t){n(t).attr({"data-beacon":'{"p": {"lnid": "lnk'+(a+1)+'"}}'})})});var o=n(".l-header").find(".channel-subnav");return void o.find("li").each(function(a,t){n(t).attr({"data-beacon":'{"p": {"lnid": "menu_lnk'+(a+1)+'"}}'})})}e.each(function(){var a=n(this);a.attr({"data-beacon":'{"p": {"lnid": "sec'+(a.parent().parent().index()+1)+"_lnk"+(a.index()+2)+'"}}'}),0===a.index()&&a.parent().parent().find("> a").attr({"data-beacon":'{"p": {"lnid": "sec'+(a.parent().parent().index()+1)+"_lnk"+(a.index()+1)+'"}}'})}),t.find(" > ul > li").each(function(){0==n(this).find("ul").length&&n(this).find("> a").attr({"data-beacon":'{"p": {"lnid": "sec'+(n(this).index()+1)+'_lnk1"}}'})})}catch(r){a.mainNavTimes<a.maxTimes&&setTimeout(function(){a.mainNavTimes++,a.setBeaconForMainNav()},500)}},CTR.PingForTabbedMod=function(a){"undefined"==typeof a&&(a={});var t=a.parentEle||"[data-mod='what-you-are-reading']",e=a.evtTarget||"ul.mostpopular > li > a",i=a.igPattern||"1",o=a.uidPfx||"wyr",r=a.appendTab||!1;t=n(t),t.length<=0||t.find(e).length<=0||t.find(e).bind("click",function(){var a=n(this),t=a.parent().index(),e=a.parent().hasAttr("data-beacon")?Aol_parseJSON(a.parent().attr("data-beacon")).p.lnid:Math.random().toString(36).substr(2,9),d=a.closest("ul").hasAttr("data-beacon")?a.closest("ul").attr("data-beacon"):a.closest("div[data-beacon]").attr("data-beacon");d=Aol_parseJSON(d).p.mnid,CTR.preparePing({_bn:d,_mn:a.parent().hasAttr("data-visible-mod")?a.parent().attr("data-visible-mod"):d+(r?"-"+(t+1):""),_ip:i,_uid:o+e})})}}(jQuery);