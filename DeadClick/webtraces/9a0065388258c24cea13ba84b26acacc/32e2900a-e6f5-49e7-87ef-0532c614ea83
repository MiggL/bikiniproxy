define(["jquery","wcs.context","pubsub","wcs.utils","promise!wcs.lang-msg"],function(g,b,f,a){var c=false;var e="applepay";var d=function(i,h){if(!(this instanceof d)){return new d(i,h)}this.element=i;this.$element=g(i);this.isApplePayActive=false;this.currentPageName=dataLayer[0].pageName;this.currentPageType=g("body").data("page-type");this.isHttps=window.location.protocol.indexOf("https")>-1;this.applePayPRObj=window.applePayPRObj;this.applePayMerchantId=applePayPRObj.applePayMerchantId;this.currentOrderId="";this.paymentRequest="";this.STATUS_ERROR="error";this.STATUS_SUCCESS="success";this.visaCheckoutEnabled=WCS_CONFIG.get("checkout::visaCheckoutEnabled");this.miniCartLocation=WCS_CONFIG.get("global::miniCartLocation")};d.prototype={defaults:{},init:function(){var h=this;if(!window.ApplePaySession){h._showOriginalPaypal();if(h.visaCheckoutEnabled){h._showOriginalVCOButton()}return}h._unbindApplePayButtonEvents();h._initApplePayButtonEvents();h._initializeApplePay();return h},_unbindApplePayButtonEvents:function(){if(c){console.log("APPLEPAY - _unbindApplePayButtonEvents")}var h=this;g.pubsub("unsubscribe",h.PDP_ITEM_OUT_OF_STOCK_TOKEN);g.pubsub("unsubscribe",h.PDP_ITEM_AVAILABLE_TOKEN);g.pubsub("unsubscribe",h.PDP_ITEM_NOT_AVAILABLE_TOKEN);h.$element.unbind("click",h._handleApplePayClick)},_initApplePayButtonEvents:function(){if(c){console.log("APPLEPAY - _initApplePayButtonEvents")}var h=this;h.$element.on("click",function(i){h._handleApplePayClick(i)});h.PDP_ITEM_AVAILABLE_TOKEN=g.pubsub("subscribe","WCS.PRODUCTFORM.CURRENT_SELECTION.HAS_INVENTORY",function(){h._showApplePayButton()});h.PDP_ITEM_NOT_AVAILABLE_TOKEN=g.pubsub("subscribe","WCS.PRODUCTFORM.CURRENT_SELECTION.NOT_HAS_INVENTORY",function(){h._hideApplePayButton()});h.PDP_ITEM_OUT_OF_STOCK_TOKEN=g.pubsub("subscribe","WCS.PRODUCTFORM.CURRENT_SELECTION.ALL_SELECTED.NOT_EXIST",function(){h._hideApplePayButton()})},_showOriginalPaypal:function(){var h=this;if(h.$element.hasClass("apple-pay-button-mini-cart")){g(".paypal-display-div.paypal-display-div-js .mini-cart-paypal-btn").removeClass("hidden")}else{g(".paypal-display-div.paypal-display-div-js .checkout-paypal-button-container").removeClass("hidden")}},_showOriginalVCOButton:function(){var h=this;if(h.$element.hasClass("apple-pay-button-mini-cart")){g(".visacheckout-display-div.visacheckout-display-div-js .minicart-visacheckout-button-js").removeClass("hidden")}else{g(".visacheckout-display-div.visacheckout-display-div-js .checkout-visacheckout-button-container").removeClass("hidden")}},_handleApplePayClick:function(j){if(c){console.log("APPLEPAY - _handleApplePayClick")}var h=this,i=g(".page-messaging-js .error");if(i.length){i.remove()}if(typeof g(".product-form-js").data("AddToCartForm")!=="undefined"){this.isValidForm=g(".product-form-js").data("AddToCartForm").isValidForm()}if(h.currentPageType==="pdp"&&h.$element.closest(".mini-cart-applepay-button-container").length===0){if(!this.isValidForm){return}h.catEntryId=g(".product-form-js").data("AddToCartForm").catEntryId;h.quantity=g(".product-form-js").find(".quantity-js").val()}h._submitApplePayPayment()},_showApplePayButton:function(){if(c){console.log("Showing Apple Pay Button!")}var h=this;if(h.isApplePayActive){h.$element.removeClass("hidden")}},_hideApplePayButton:function(){if(c){console.log("Hiding Apple Pay Button!")}var h=this;h.$element.addClass("hidden")},_enableApplePayOnBillingPage:function(){var h=this;g(".applepay-section, .checkout-applepay-radiobutton-container").removeClass("hidden");h._showOriginalPaypal();if(h.$element.parent().hasClass("checkout-applepay-button-container")){h._hideApplePayButton();h.$element.parent().removeClass("hidden")}},_enableApplePayOnShopcartPage:function(){var h=this;if(h.$element.parent().hasClass("checkout-applepay-button-container")){h.$element.parent().removeClass("hidden")}},_enableApplePayOnMiniCart:function(){var h=this;if(h.$element.parent().hasClass("mini-cart-applepay-button-container")){h.$element.parent().removeClass("hidden")}},_enableApplePayOnPDP:function(){g(".add-to-bag-js").addClass("applepay-enabled")},_initializeApplePay:function(){if(c){console.log("Checking if able to show Apple Pay Button....")}var h=this;if(typeof h.applePayMerchantId==="undefined"||!h.isHttps||typeof window.ApplePaySession==="undefined"){h._showOriginalPaypal();if(h.visaCheckoutEnabled){h._showOriginalVCOButton()}return false}ApplePaySession.canMakePaymentsWithActiveCard(h.applePayMerchantId).then(function(i){if(!i){h._showOriginalPaypal();if(h.visaCheckoutEnabled){h._showOriginalVCOButton()}return false}if(c){console.log("OK to Show Apple Pay Button!")}h.isApplePayActive=true;h._showApplePayButton();if(h.currentPageName==="shopcart"){h._enableApplePayOnShopcartPage()}else{if(h.$element.hasClass("apple-pay-button-mini-cart")){h._enableApplePayOnMiniCart()}else{if(h.currentPageType==="pdp"){h._enableApplePayOnPDP()}else{if(h.currentPageName==="billing-review"||h.currentPageName==="billing"){h._enableApplePayOnBillingPage()}}}}})},_getInitialPaymentRequest:function(){var h=this;var i={countryCode:h.applePayPRObj.applePayCountryCode,currencyCode:h.applePayPRObj.applePayCurrency,total:h._getLineItem("pending",1,h.applePayPRObj.totalLabel),lineItems:[h._getLineItem("pending",1,h.applePayPRObj.subTotalLabel)],shippingContact:h.applePayPRObj.shippingContact,shippingMethods:h.applePayPRObj.shippingMethods,requiredShippingContactFields:h.applePayPRObj.requiredShippingContactFields,supportedNetworks:h.applePayPRObj.supportedNetworks,merchantCapabilities:h.applePayPRObj.merchantCapabilities,requiredBillingContactFields:h.applePayPRObj.requiredBillingContactFields};return i},_getLineItem:function(j,i,h){return{type:j,amount:i,label:h}},_constructShoppingCart:function(){var i=this,h=g.Deferred();if(c){console.log("APPLEPAY - _constructShoppingCart")}if(i.catEntryId){g.ajax({type:"POST",url:"/webapp/wcs/stores/servlet/VFAjaxOrderItemAdd?",data:i._getCommonParameters()+i._getOrderIdUrlParameter("**")+"&catEntryId="+i.catEntryId+"&quantity="+i.quantity+"&outOrderType=apl",async:true}).done(function(m){var k=m.errorMessage;if(k){h.reject(m)}else{i.currentOrderId=m.orderId;var l=i._getOrderUpdateParams();i._udpateApplePayOrder(l).done(function(n){i._retrieveWCOrderInformation().done(function(o){h.resolve()}).fail(function(o){h.reject(o)})}).fail(function(n){h.reject(n)})}}).fail(function(k,l){h.reject(k)})}else{i.currentOrderId=".";var j=i._getOrderUpdateParams();i._udpateApplePayOrder(j).done(function(k){i._retrieveWCOrderInformation().done(function(l){h.resolve()}).fail(function(l){h.reject(l)})}).fail(function(k){h.reject(k)})}return h},_submitApplePayPayment:function(){if(c){console.log("APPLEPAY - _processApplePayPayment")}var i=this,h=g.Deferred();this.paymentRequest=i._getInitialPaymentRequest();if(c){console.log("_submitApplePayPayment :"+i.paymentRequest)}session=new ApplePaySession(1,i.paymentRequest);session.onvalidatemerchant=function(j){if(c){console.log("onvalidatemerchant...url is "+j.validationURL)}i._performMerchantSessionValidation(j.validationURL).done(function(k){if(c){console.log("merchantSession :"+k.merchantSession)}i._constructShoppingCart().done(function(l){session.completeMerchantValidation(JSON.parse(k))}).fail(function(l){i._cancelApplePayOrder();session.abort();i._constructErrorMessage(l.errorMessage)})}).fail(function(k){session.abort();i._constructErrorMessage(k.errorMessage)})};session.oncancel=function(j){if(c){console.log("oncancel event :")}i._cancelApplePayOrder()};session.onshippingcontactselected=function(k){if(c){console.log("onshippingcontactselected")}if(!i._validateInitialShippingContact(k.shippingContact)){session.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,i.paymentRequest.shippingMethods,i.paymentRequest.total,i.paymentRequest.lineItems)}else{var j=i._getShippingContactParams(k.shippingContact);g.when(i._udpateApplePayOrder(j)).done(function(){g.when(i._retrieveWCOrderInformation()).done(function(){session.completeShippingContactSelection(ApplePaySession.STATUS_SUCCESS,i.paymentRequest.shippingMethods,i.paymentRequest.total,i.paymentRequest.lineItems)})}).fail(function(){session.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,i.paymentRequest.shippingMethods,i.paymentRequest.total,i.paymentRequest.lineItems)})}};session.onshippingmethodselected=function(j){if(c){console.log("onshippingmethodselected :"+j.shippingMethod)}var k=i._getShippingMethodParams(j.shippingMethod);g.when(i._udpateApplePayOrder(k)).done(function(){g.when(i._retrieveWCOrderInformation()).done(function(){session.completeShippingMethodSelection(ApplePaySession.STATUS_SUCCESS,i.paymentRequest.total,i.paymentRequest.lineItems)}).fail(function(){session.completeShippingMethodSelection(ApplePaySession.STATUS_FAILURE,i.paymentRequest.total,i.paymentRequest.lineItems)})}).fail(function(){session.completeShippingMethodSelection(ApplePaySession.STATUS_FAILURE,i.paymentRequest.total,i.paymentRequest.lineItems);i._cancelApplePayOrder();session.abort()})};session.onpaymentmethodselected=function(j){if(c){console.log("onpaymentmethodselected :"+j.paymentMethod)}session.completePaymentMethodSelection(i.paymentRequest.total,i.paymentRequest.lineItems)};session.onpaymentauthorized=function(j){if(c){console.log("onpaymentauthorized :"+j.payment)}if(!i._validateFinalShippingContact(j.payment.shippingContact)){session.completePayment(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS)}else{if(!i._validateEmailAddress(j.payment.shippingContact.emailAddress)||!i._validatePhoneNumber(j.payment.shippingContact.phoneNumber)){session.completePayment(ApplePaySession.STATUS_INVALID_SHIPPING_CONTACT)}else{if(!i._validatePOBox(j.payment.shippingContact.addressLines)){session.completePayment(ApplePaySession.STATUS_FAILURE);i._cancelApplePayOrder();i._constructErrorMessage(LANG_MSG["CHECKOUT.APPLEPAY.POBOX_ERROR"])}else{if(!i._validateBillingContact(j.payment.billingContact)){session.completePayment(ApplePaySession.STATUS_INVALID_BILLING_POSTAL_ADDRESS)}else{i._sendPaymentToken(j.payment).done(function(k){if(c){console.log("OrderId:"+k.currentOrderId+" and redirect URL :"+k.redirecturl);console.log("displayErrorFromPreSourcingCall: "+k.displayErrorFromPreSourcingCall);console.log("inside sucess"+k.orderId)}i.displayErrorFromPreSourcingCall=k.displayErrorFromPreSourcingCall;if(!i.isEmpty(k.displayErrorFromPreSourcingCall)&&k.displayErrorFromPreSourcingCall){i._setApplePayPreSourcingErrorParams(k);if(i.catEntryId){if(c){console.log("apple pay PDP validation")}session.completePayment(ApplePaySession.STATUS_FAILURE);i._cancelApplePayOrder();i._constructErrorMessage()}else{if(c){console.log("apple pay validation for other pages")}session.completePayment(ApplePaySession.STATUS_FAILURE);g.pubsub("publish","SHOPCART_UPDATED");i._handleApplePayPreSourcingRedirects(k)}}else{if(!i.isEmpty(k.orderId)){session.completePayment(ApplePaySession.STATUS_SUCCESS);i._showConfirmation(k.redirecturl)}else{session.completePayment(ApplePaySession.STATUS_FAILURE);i._cancelApplePayOrder()}}}).fail(function(k){switch(k.errorMessageKey){case"_ERR_BAD_SHIPPING_ADDRESS_FROM_APPLEPAY":session.completePayment(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS);break;case"_ERR_NOT_SUPPORTED_STATE":session.completePayment(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS);break;case"_ERR_BAD_BILLING_ADDRESS_FROM_APPLEPAY":session.completePayment(ApplePaySession.STATUS_INVALID_BILLING_POSTAL_ADDRESS);break;default:session.completePayment(ApplePaySession.STATUS_FAILURE);i._cancelApplePayOrder();i._constructErrorMessage(k.errorMessage)}})}}}}};session.begin()},_retrieveWCOrderInformation:function(){var i=this,h=g.Deferred();g.ajax({type:"GET",url:"/webapp/wcs/stores/servlet/VFAjaxGetApplePayOrderView?",data:i._getCommonParameters()+i._getOrderIdUrlParameter(),async:true,cache:false}).done(function(k){var j=i._parseResponse(k);i.paymentRequest=j.data;if(c){console.log("paymentRequest :"+i.paymentRequest)}h.resolve(j.data)}).fail(function(l,k){var j=l.errorMessage;h.reject(j)});return h.promise()},_performMerchantSessionValidation:function(i){var j=this,h=g.Deferred();g.ajax({type:"POST",url:"/webapp/wcs/stores/servlet/VFAjaxApplePaySessionValidate",data:j._getCommonParameters()+"&validationURL="+i+"&host="+location.host,async:true,cache:false}).done(function(k){if(c){console.log("_performMerchantSessionValidation - "+k.merchantSession)}h.resolve(k.merchantSession)}).fail(function(k,l){h.reject(JSON.parse(k.responseText))});return h.promise()},_getCommonParameters:function(){return"storeId="+b.getStoreId()+"&catalogId="+b.getCatalogId()+"&langId="+b.getLangId()+"&URL=/"},_getShippingMethodParams:function(h){var i=this;return i._getCommonParameters()+"&shipModeId="+h.identifier+i._getOrderIdUrlParameter()},_getOrderUpdateParams:function(){var h=this;return h._getCommonParameters()+h._getOrderIdUrlParameter()+"&requestFrom="+h.currentPageName},_getShippingContactParams:function(i){var h=this;return h._getCommonParameters()+h._getContactAddressParameters(i)+h._getOrderIdUrlParameter()},_getOrderIdUrlParameter:function(h){var i=this,j;if(i.isEmpty(h)){if(i.isEmpty(this.currentOrderId)){i._handleError(i._createError(null,null,i.status))}else{j=i.currentOrderId}}else{j=h}return"&orderId="+j},isEmpty:function(h){if(typeof h==="object"){if(Array.isArray(h)){return(h.length<=0)}else{return false}}if(typeof h!=="undefined"&&typeof h==="boolean"){return false}return !(typeof h==="string"&&h.length>0)},_responseHasErrorCode:function(i){var h=this;if(i.errorMessageKey){return h._createError(i.errorCode,i.errorMessageKey,i.errorMessage)}else{return null}},_handleError:function(j,i){var h=this;return{status:h.STATUS_ERROR,args:i,error:j}},_createError:function(i,j,h){return{errorCode:i,errorMessageKey:j,errorMessage:h}},_udpateApplePayOrder:function(i){var h=g.Deferred();if(c){console.log("_udpateApplePayOrder: "+i)}g.ajax({type:"POST",url:"/webapp/wcs/stores/servlet/VFAjaxApplePayOrderUpdate",data:i,async:true}).done(function(j){h.resolve(j);if(c){console.log("OrderUpdateStatus:"+j)}}).fail(function(j,k){h.reject(JSON.parse(j.responseText))});return h.promise()},_sendPaymentToken:function(i){var j=this,h=g.Deferred();if(c){console.log("_sendPaymentToken: "+i)}g.ajax({url:"/webapp/wcs/stores/servlet/VFAjaxApplePayProcess",type:"POST",async:true,data:j._getCommonParameters()+j._getOrderIdUrlParameter()+j._getPaymentTokenParameters(i.token)+"&shippingContact="+JSON.stringify(i.shippingContact)+"&billingContact="+JSON.stringify(i.billingContact)}).done(function(k){j.currentOrderId=k.orderId;h.resolve(k)}).fail(function(k,l){h.reject(JSON.parse(k.responseText))});return h.promise()},_showConfirmation:function(i){var h=this;if(c){console.log("_showConfirmation...")}document.location.href=b.getContextRoot()+i+"?"+h._getConfirmationPageParameters()+h._getOrderIdUrlParameter()+((!h.isEmpty(h.displayErrorFromPreSourcingCall))?h._getApplePayPreSrcErrorParams():"")},_redirectPage:function(i){var h=this;if(c){console.log("_redirectPage...")}document.location.href=h._buildURLWithoutErrorParams(i)+h._getApplePayPreSrcErrorParams()+h._getOrderIdUrlParameter()},_setApplePayPreSourcingErrorParams:function(i){var h=this;if(c){console.log("_setApplePayPreSourcingErrorParams...")}h.preSourcingErrCount=0;h.itemsModified=false;h.expressShippingNotSupported=false;h.giftServicesNotSupported=false;if(!h.isEmpty(i.modifiedOrderItems)){h.itemsModified=i.modifiedOrderItems;h.preSourcingErrCount++}if(!h.isEmpty(i.expressShippingNotSupported)){h.expressShippingNotSupported=i.expressShippingNotSupported;h.preSourcingErrCount++}if(!h.isEmpty(i.giftServicesRemoved)){h.giftServicesNotSupported=i.giftServicesRemoved;h.preSourcingErrCount++}if(c){console.log("self.itemsModified"+h.itemsModified);console.log("self.expressShippingNotSupported"+h.expressShippingNotSupported);console.log("self.giftServicesNotSupported"+h.giftServicesNotSupported)}},_handleApplePayPreSourcingRedirects:function(j){var h=this;if(c){console.log("_handleApplePayPreSourcingRedirects...")}if(h.$element.closest(".mini-cart-applepay-button-container").length!==0&&h.miniCartLocation==="right"){g(".mini-cart-icon-close-js").trigger("click");h._constructErrorMessage()}else{if(j.orderId==="."){h._showConfirmation(j.redirecturl)}else{var i=window.location.href;h._redirectPage(i)}}},_buildURLWithoutErrorParams:function(i){var h=this;if(c){console.log("_buildURLWithoutErrorParams...")}if(a.hasURLParam(i,"displayErrorFromPreSourcingCall")){i=a.removeURLParam(i,"displayErrorFromPreSourcingCall")}if(a.hasURLParam(i,"expressShippingNotSupported")){i=a.removeURLParam(i,"expressShippingNotSupported")}if(a.hasURLParam(i,"modifiedOrderItems")){i=a.removeURLParam(i,"modifiedOrderItems")}if(a.hasURLParam(i,"giftServicesRemoved")){i=a.removeURLParam(i,"giftServicesRemoved")}if(a.hasURLParam(i,"orderId")){i=a.removeURLParam(i,"orderId")}return i},_getApplePayPreSrcErrorParams:function(){var h=this,i="&displayErrorFromPreSourcingCall="+h.displayErrorFromPreSourcingCall;if(c){console.log("_getApplePayPreSrcErrorParams...")}if(h.itemsModified){i+="&modifiedOrderItems="+h.itemsModified}if(h.expressShippingNotSupported){i+="&expressShippingNotSupported="+h.expressShippingNotSupported}if(h.giftServicesNotSupported){i+="&giftServicesRemoved="+h.giftServicesNotSupported}if(c){console.log("redirectURLParams..."+i)}return i},_getConfirmationPageParameters:function(){return"storeId="+b.getStoreId()+"&catalogId="+b.getCatalogId()+"&langId="+b.getLangId()},_validateEmailAddress:function(i){var h=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return h.test(i)},_validatePOBox:function(h){var i=new RegExp("(P\\.?O\\.?\\s?|post\\s+office )+Box\\s*\\d*","i");return !i.test(h)},_validatePhoneNumber:function(i){var h=this,j=new RegExp(h.applePayPRObj.applePayPhonePattern);return j.test(i)},_validateFinalShippingContact:function(k){var h=this;if(c){console.log("_validateFinalShippingContact...")}if(h.isEmpty(k)){return false}else{var i=["familyName","givenName","emailAddress","locality","postalCode","addressLines","administrativeArea","country"];for(var j=0;j<i.length;j++){if(h.isEmpty(k[i[j]])){return false}}}return true},_validateBillingContact:function(k){var h=this;if(c){console.log("_validateBillingContact...")}if(h.isEmpty(k)){return false}else{var j=["familyName","givenName","locality","postalCode","addressLines","administrativeArea","country"];for(var i=0;i<j.length;i++){if(h.isEmpty(k[j[i]])){return false}}}return true},_getPaymentTokenParameters:function(h){var i="&paymentData_data="+encodeURIComponent(h.paymentData.data)+"&paymentData_header_publicKeyHash="+encodeURIComponent(h.paymentData.header.publicKeyHash)+"&paymentData_header_ephemeralPublicKey="+encodeURIComponent(h.paymentData.header.ephemeralPublicKey)+"&paymentData_header_transactionId="+encodeURIComponent(h.paymentData.header.transactionId)+"&paymentData_signature="+encodeURIComponent(h.paymentData.signature)+"&paymentData_version="+encodeURIComponent(h.paymentData.version)+"&paymentMethod_network="+encodeURIComponent(h.paymentMethod.network);return i},_getContactAddressParameters:function(h){var i="&city="+h.locality+"&state="+h.administrativeArea+"&country="+h.country+"&zipCode="+h.postalCode;return i},_parseResponse:function(h){var j,i;j=h.replace(/(\/\*|\*\/)/g,"");i={data:JSON.parse(j)};return i},_validateInitialShippingContact:function(i){var h=this;if(h.isEmpty(i)){return false}else{if(h.isEmpty(i.locality)){return false}if(h.isEmpty(i.postalCode)){return false}if(h.isEmpty(i.administrativeArea)){return false}if(h.isEmpty(i.country)){return false}}return true},_cancelApplePayOrder:function(){var i=this,h=g.Deferred();if(c){console.log("Cancelling order...")}g.ajax({type:"POST",url:"/webapp/wcs/stores/servlet/VFAjaxApplePayCancel?",data:i._getCommonParameters()+i._getOrderIdUrlParameter()+"&reason=5",async:true}).done(function(k){var j=k.errorMessage;if(j){h.reject(j)}else{h.resolve(k)}}).fail(function(l,k){var j=l.errorMessage;h.reject(j)});i.currentOrderId="";return h.promise()},_constructErrorMessage:function(k){var h=this,i=g(".page-contents");if(c){console.log("_constructErrorMessage...")}if(i.find(".page-messaging-js").length===0){var j='<section class="page-messaging page-messaging-js"><div></div></section>';i.prepend(j)}if(h.displayErrorFromPreSourcingCall){i.find(".page-messaging-js div").html('<div class="message page-message-text page-messaging-message text-left error">'+h._composePreSourcingErrorMessage()+"</div>")}else{i.find(".page-messaging-js div").html('<p class="message error">'+k+"</p>")}window.scrollTo(0,0)},_composePreSourcingErrorMessage:function(){var h=this,i="";if(c){console.log("_composePreSourcingErrorMessage...")}if(!h.catEntryId){i="<p>"+h.applePayPRObj.omsSrcErr+"</p><ul>"}if(h.itemsModified){i+=((h.preSourcingErrCount>1||!h.catEntryId)?"<li>":"")+h.applePayPRObj.omsSrcErrItemsUnavailable+((h.preSourcingErrCount>1||!h.catEntryId)?"</li>":"")}if(h.expressShippingNotSupported){i+=((h.preSourcingErrCount>1||!h.catEntryId)?"<li>":"")+h.applePayPRObj.omsSrcErrExpediteShippingUnavailable+((h.preSourcingErrCount>1||!h.catEntryId)?"</li>":"")}if(h.giftServicesNotSupported){i+=((h.preSourcingErrCount>1||!h.catEntryId)?"<li>":"")+h.applePayPRObj.omsSrcErrGiftServicesUnavailable+((h.preSourcingErrCount>1||!h.catEntryId)?"</li>":"")}if(!h.catEntryId){i+="</ul><p>"+h.applePayPRObj.omsSrcErrOrderUpdated+"</p>"}if(c){console.log("preSourcingErrorContent "+i)}return i}};d.defaults=d.prototype.defaults;g.fn.applePay=function(h){return this.each(function(){var i=g(this).data(e);if(!i){i=new d(this,h).init();g(this).data(e,i)}})}});