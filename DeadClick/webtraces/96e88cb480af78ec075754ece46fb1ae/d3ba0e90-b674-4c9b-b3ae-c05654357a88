                     <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Invite your friends to join our website</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="shortcut icon" href="images/favicon.ico" title="Super Tell A Friend">
        <link href="stylesheets/font_styles_orange.css" rel="stylesheet" type="text/css">

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script type="text/javascript" src="jscript/jquery.slimscroll.js"></script>
        <script language="javascript" type="text/javascript">
            <!--  sort dropdown -->
            function sortDropDownListByText() {
            // Loop for each select element on the page.
            $("select").each(function() {

            // Keep track of the selected option.
            var selectedValue = $(this).val();
            // Sort all the options by text. I could easily sort these by val.
            $(this).html($("option", $(this)).sort(function(a, b) {
            return a.text == b.text ? 0 : a.text < b.text ? - 1 : 1
            }));
            // Select one option.
            $(this).val(selectedValue);
            });
            }

            <!-- char count -->

            function limitText(limitField, limitCount, limitNum) {             if (limitField.value.length > limitNum) {
            limitField.value = limitField.value.substring(0, limitNum);
            } else {
            limitCount.value = limitNum - limitField.value.length;
            }
            }
        </script>
        <!--- -->
        <!--buzz form -->
            <script type="text/javascript" src="jscript/vibrate.js"></script>
                <!--end buzz form -->

        <script language="JavaScript">
                    function stripHTML()
                    {
                    var re = /<\S[^><]*>/g
                            for (i = 0; i < arguments.length; i++)
                    {
                    arguments[i].value = arguments[i].value.replace(re, "");
                    }
                    }

            function CalcKeyCode(aChar)
            {
            var character = aChar.substring(0, 1);
                    var code = aChar.charCodeAt(0);
                    return code;
            }
            function checknothtml(val) {
            var strPass = val.value;
                    var strLength = strPass.length;
                    var lchar = val.value.charAt((strLength) - 1);
                    var cCode = CalcKeyCode(lchar);
                    if (cCode == 60 || cCode == 62) {
            var myNumber = val.value.substring(0, (strLength) - 1);
                    val.value = myNumber;
            }
            return false;
            }
            function changeusercustommessage(id)
            {
            var id2, txt, tosplit, arrle, indx, lastword, lastwordsize, allstringsize;
                    var tosplit = new Array();
                    id2 = 'usercustommessage' + id;
                    txt = document.getElementById('sendercustommessage').value;
                    //
                    tosplit = txt.split(' ');
                    arrle = tosplit.length;
                    indx = parseInt(tosplit.length) - 1;
                    if (trimAll(tosplit[indx]) != '')
            {
            lastword = tosplit[indx];
                    lastwordsize = lastword.length;
                    allstringsize = txt.length
                    if (lastwordsize > 100) //last word >100
            {
            //a=lastword.substring(0, parseInt(lastwordsize/2));
            //b=lastword.substring(parseInt(lastwordsize/2)-1,lastwordsize);
            //lastword=a+'\n '+b;
            //lastword=lastword.substring(0, parseInt(lastwordsize)-1);
            //tosplit[indx]=lastword;
            document.forms[0].sendercustommessage.value = txt.substring(0, allstringsize - lastwordsize);
                    txt = document.getElementById('sendercustommessage').value;
                    //}
                    // otherwise, update 'characters left' counter
                    //else 
                    //{
                    //txt=tosplit.join(' ');
                    //}
            }
            }

            txt = txt.replace(/\n/g, '<br>');
                    if (trimAll(txt) == "")
            {document.getElementById(id2).innerHTML = '[Your custom message]'; }
            else {
            document.getElementById(id2).innerHTML = txt; }
            }


            function submitenter(myfield, e)
            {
            var keycode;
                    if (window.event) keycode = window.event.keyCode;
            else if (e) keycode = e.which;
            else return true;
                    if (keycode == 13)
            {
            verimport();
            return false; } else
            return true;
            }
                    function submitenter2(myfield, e)                         {
            var keycode;
                    if (window.event) keycode = window.event.keyCode;
                    else if (e) keycode = e.which;
                    else return true;
                    if (keycode == 13)
            {
            veruploadfile();
                    return false;
            }
            else                             return true;
            }
            function submitenter3(myfield, e)
            {
                    var keycode;
                    if (window.event) keycode = window.event.keyCode;
                    else if (e) keycode = e.which;
                    else return true;
                    if (keycode == 13)
            {
            vermanualsend();
                    return   false;
                    }
                    else
                    return true;
            }             function submitenter4(myfield, e)
            {
            var keycode;
            if (window.event) keycode = window.event.keyCode;
            else if (e) keycode = e.which; else return true;
            if (keycode == 13)
            {
                    checkimavailability();
                    return false;
                    }
                    else                            return true; }

                    function submitenter5(myfield, e)
            {
            var keycode;                                  if (window.event) keycode = window.event.keyCode;
                    else if (e) keycode = e.which;
            else return  true;
            if (keycode == 13)
            {
                    document.getElementById('addmanualfriend').click();
                    return false;
            }
                    else
            return true;
            }


                                

                    function togglechecked()     {
            var  ch, maxtocheck, maxmaluetocheck;
                    maxtocheck = 0;
                    maxmaluetocheck = document.sendemailsform.nrcheckedcontacts.value;
            if (document.sendemailsform.elements[0].checked == false) //uns e lect all
            {
            ch = false;
                    document.sendemailsform.nrcheckedcontacts.value = '0';                         }
                    if (document.sendemailsform.elements[0].checked == true) //select all
            {
            ch = true; document.sendemailsform.nrcheckedcontacts.value = maxtocheck;
            }

                    for (var i = 1; i < document.sendemailsform.elements.length; i++)
                    {
                    var e = document.sendemailsform.elements[i];
            if (e.type == 'checkbox' && e.id != 'optintomailinglist')
            {
            if (ch)
            {
                    if (maxmaluetocheck < maxtocheck)
                    {                         if (e.checked == false){
                    e.checked = ch;
            maxmaluetocheck++; }
            }
            }                     if (!ch)
                    {
            e.checked = ch;
            }
                        
            }
             }
                    }
                    function togglechecked2(){
            var ch;
                    if (document.sendemailsform.elements[0].checked == false) {ch = false; }
                    if (document.sendemailsform.elements[0].checked == true) {ch = true; }
            for (var i = 1; i < document.sendemailsform.elements.length; i++)
            {
            var e = document.sendemailsform.elements[i];
            if (e.type == 'checkbox' && e.id != 'optintomailinglist ')
            {
            e.checked = ch;
                    }

            }
            }
            function is_one_checked()
            {
            var ischecked;
            ischecked = false;
            document.getElementById('selectatleastonecontact').style.visibility = 'hidden';
                    for (var i = 1; i < document.sendemailsform.elements.length; i++)
            {
            var e = document.sendemailsform.elements[i];
            if (e.type == 'checkbox' && e.id != 'optintomailinglist')
            {
            if (e.checked){ischecked = true; }
                    }

            }
            if (ischecked)
            {document.sendemailsform.submit(); }
            else
            {
                    document.getElementById('selectatleastonecontact').style.visibility = 'visible';
                    $('#selectatleastonecontact').delay(3000).fadeOut('slow', function() {
                    document.getElementById('selectatleastonecontact').style.visibility = 'hidden';
            document.getElementById('selectatleastonecontact').style.display = 'block';
            }); }
            }
            function updatecheckedcontacts(ischecked, id)
                    {                      var checkedcontacts, maxtocheck;
                    maxtocheck = 0;
            checkedcontacts = document.sendemailsform.nrcheckedcontacts.value;
                    if (ischecked == false)
            {
            document.sendemailsform.nrcheckedcontacts.value = parseInt(checkedcontacts) - 1;
                    document.sendemailsform.allbox2.checked = false;
                    }
            if (ischecked == true)
            {
            if (maxtocheck == document.sendemailsform.nrcheckedcontacts.value)
            {
                    document.getElementById('address_' + id).checked = false;
            } else
            {
            document.sendemailsform.nrcheckedcontacts.value = parseInt(checkedcontacts) + 1;
            }
            }
                        
            }

            function unchecktop(ischecked, id)                         {
            if (ischecked == false)
            {
            document.sendemailsform.allbox2.checked = false;
            }
            }

            function verimport()                             {
            <!-- buzz form -->
       
                    document.getElementById('message').style.visibility = 'hidden';
                    if (trimAll(document.massimport.elements[0].value) == '')
            {
            document.getElementById('message').style.visibility = 'visible';
                    document.getElementById('message').innerHTML = '<? php echo($ importerjserror5) ?>';
            document.massimport.elements[0].focus();
                    $('#message').delay(2500).fadeOut('slow', function() {
            document.getElementById('message').style.visibility = 'hidden';
                    document.getElementById('message').style.display = 'block';
            });
            return false;
                              }

            if (trimAll(document.massimport.elements[1].value) == '')
            {
            document.getElementById('message').style.visibility = 'visible';
                    document.massimport.elements[ 1].focus();
                    document.getElementById('message').innerHTML = 'Please complete your email address.';

            $('#message').delay(2500).fadeOut('slow', function() {
            document.getElementById('message').style.visibility = 'hidden';
                    document.getElementById('message').style.display = 'block';
            });
                    return false;
            }



            if (trimAll(document.massimport.elements[1].value).indexOf('@') != '-1')
            {
            document.getElementById('message').innerHTML = 'Please insert only the username.';
                    document.getElementById('message').style.visibility = 'visible';
                    document.massimport.elements[1].focus();

            $('#message').delay(2500).fadeOut('slow', function() {
            document.getElementById('message').style.visibility = 'hidden';
                    document.getElementById('message').style.display = 'block';
            });
                    return false;
            }


            if (trimAll(document.massimport.elements[3].value) == '')
            {
            document.getElementById('message').style.visibility = 'visible';
                    document.getElementById('message').innerHTML = 'Please insert your password.';
                    document.massimport.elements[3].focus();

            $('#message').delay(2500).fadeOut('slow', function() {
            document.getElementById('message').style.visibility = 'hidden';
                    document.getElementById('message').style.display = 'block';
                    });
                    return false;
                    }
            document.getElementById('message').innerHTML = "<img style=\"margin-left: 26%;\" src=images/loader.gif border=0 hspace=0 vspace=0>";
                    document.getElementById('message').style.background = 'url(none.jpg)';
                    document.getElementById('message').style.paddingLeft = '0px';
                    document.getElementById('message').style.visibility = 'visible';
                    document.massimport.masssubmit.value = 'Please wait...';
                    document.massimport.masssubmit.disabled = true;
                    document.getElementById('errorlabel').style.padding = '0';
                    document.massimport.clientname.focus();
                    window.setTimeout("document.massimport.submit()", 1000);
                    }

            function vermanualsend()
                    {
                    document.getElementById('error').style.visibility = 'hidden';
                            document.getElementById('error').innerHTML = 'Your name and email address are required. Please fill in.';
                            if (trimAll(document.manualsend.clientname.value) == '')
                            {
                            document.getElementById('error').style.visibility = 'visible';
                                    document.manualsend.clientname.focus();
                                    $('#error').delay(2500).fadeOut('slow', function() {
                            document.getElementById('error').style.visibility = 'hidden';
                                    document.getElementById('error').style.display = 'block';
                            });
                                    return false;
                                    }
                    if (trimAll(document.manualsend.fromemail.value) == '')
                            {
                            document.getElementById('error').style.visibility = 'visible';
                                    document.manualsend.fromemail.focus();
                                    $('#error').delay(2500).fadeOut('slow', function() {
                            document.getElementById('error').style.visibility = 'hidden';
                                    document.getElementById('error').style.display = 'block';
                            });
                                    return false;
                                    }

                    if (!check_email(trimAll(document.manualsend.fromemail.value)))
                            {
                            document.getElementById('error').innerHTML = 'Please insert a valid email address.';
                                    document.getElementById('error').style.visibility = 'visible';
                                    document.manualsend.fromemail.focus();
                                    $('#error').delay(2500).fadeOut('slow', function() {
                            document.getElementById('error').style.visibility = 'hidden';
                                    document.getElementById('error').style.display = 'block';
                            });
                                    return false;
                                    }
                    if (document.manualsend.totalnumberemails.value == '0')
                            {
                            document.getElementById('error').innerHTML = 'Please add at least one email address.';
                                    document.getElementById('error').style.visibility = 'visible';
                                    document.manualsend.toname.focus();
                                    $('#error').delay(2500).fadeOut('slow', function() {
                            document.getElementById('error').style.visibility = 'hidden';
                                    document.getElementById('error').style.display = 'block';
                            });
                                    return false;
                                    }
                    document.getElementById('error2').style.visibility = 'visible';
                            document.getElementById('error2').innerHTML = "<img src='images/loader2.gif' align=absmiddle border=0 hspace=3 vspace=1> <span color='#B90101'>Sending emails.Please wait...</span>";
                            document.getElementById('manualsubmit').disabled = true;
                            document.getElementById('manualsubmit').style.visibility = 'hidden';
                            window.setTimeout("document.manualsend.submit()", 1000);
                            }
            function addField(area, field, limit)
                    {

                    if (trimAll(document.manualsend.toname.value) == '')
                    {
                    document.getElementById('error').innerHTML = 'Friend name is required. Please fill in.';
                            document.getElementById('error').style.visibility = 'visible';
                            document.manualsend.toname.focus();
                            $('#error').delay(2500).fadeOut('slow', function() {
                    document.getElementById('error').style.visibility = 'hidden';
                            document.getElementById('error').style.display = 'block';
                    });
                            return false;
                    }
                    if (!check_email(trimAll(document.manualsend.toemail.value)))
                    {
                    document.getElementById('error').innerHTML = 'Please insert a valid email address.';
                            document.getElementById('error').style.visibility = 'visible';
                            document.manualsend.toemail.focus();
                            $('#error').delay(2500).fadeOut('slow', function() {
                    document.getElementById('error').style.visibility = 'hidden';
                            document.getElementById('error').style.display = 'block';
                    });
                            return false;
                    }


                    var field_area = document.getElementById(area);
                            var all_inputs = field_area.getElementsByTagName("input");
                            var last_item = all_inputs.length - 1;
                            var last = all_inputs[last_item].id;
                            var count = Number(last.split("_")[1]) + 1;
                            if (count > limit && limit > 0) return;
                            if (document.createElement)
                    {
                    var p = document.createElement("p");
                            p.innerHTML = '<input type="hidden" name="' + field + count + '" id="' + field + count + '"> ';
                            p.innerHTML += '<img src="images/user.png" border="0" align="absmiddle"> ';
                            p.innerHTML += document.manualsend.toname.value + ' [' + document.manualsend.toemail.value + ']';
                            p.innerHTML += '<a href="javascript:;" class="slink" onClick="document.manualsend.totalnumberemails.value=parseInt(document.manualsend.totalnumberemails.value)-1;this.parentNode.parentNode.removeChild(this.parentNode);" > <img src="images/user_delete.png" border="0" align="absmiddle" title="[Remove this email]"></a>';
                            field_area.appendChild(p);
                            document.getElementById(field + count).value = document.manualsend.toemail.value + ',' + document.manualsend.toname.value;
                            document.manualsend.toemail.value = '';
                            document.manualsend.toname.value='';
document.manualsend.nrofemails.value=parseInt(document.manualsend.nrofemails.value)+1;
document.manualsend.totalnumberemails.value=parseInt(document.manualsend.totalnumberemails.value)+1;
document.getElementById('error').innerHTML='';
document.getElementById('error').style.visibility='hidden';
} 
else 
{ 
field_area.innerHTML += "<input name='"+(field+count)+"' id='"+(field+count)+"' type='text' /> <a onclick='this.parentNode.parentNode.removeChild(this.parentNode);'>[Remove this email]</a><br>";
}
}


function veruploadfile()
{
var fis,a,b,c;
document.getElementById('message3').innerHTML="Incorrect file format.";
document.getElementById('message3').style.visibility='hidden';
a=document.csvmassimport.clientname.value;
b=document.csvmassimport.fromemail.value;
fis=document.getElementById('fis').value;
<!-- buzz form -->
<!-- end buzz form -->

if(trimAll(a)=='')
{
document.getElementById('message3').innerHTML="Please complete your name.";
document.getElementById('message3').style.visibility='visible';
document.csvmassimport.clientname.focus();
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
if(trimAll(b)=='')
{
document.getElementById('message3').innerHTML="Please complete your email address.";
document.getElementById('message3').style.visibility='visible';
document.csvmassimport.fromemail.focus();
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
if(!check_email(trimAll(b))) 
{
document.getElementById('message3').innerHTML='Please insert a valid email address.';
document.getElementById('message3').style.visibility='visible';
document.csvmassimport.fromemail.focus();
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
if(trimAll(fis)=='')
{
document.getElementById('message3').innerHTML="Please browse and choose the file to upload.";
document.getElementById('message3').style.visibility='visible';
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
		
if((document.csvmassimport.csvformat.options[0].selected==true)|| (document.csvmassimport.csvformat.options[1].selected==true) || (document.csvmassimport.csvformat.options[2].selected==true) ) //csv
{
		
if(verfisext1(trimAll(fis))==false)
{
document.getElementById('message3').innerHTML="Incorrect file format.";
document.getElementById('message3').style.visibility='visible';
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
}
		
if((document.csvmassimport.csvformat.options[3].selected==true)|| (document.csvmassimport.csvformat.options[4].selected==true) || (document.csvmassimport.csvformat.options[5].selected==true)|| (document.csvmassimport.csvformat.options[6].selected==true) ) //csv address book
{
		
if(verfisext1(trimAll(fis))==false)
{
document.getElementById('message3').innerHTML="Incorrect file format.";
document.getElementById('message3').style.visibility='visible';
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
}
		
if((document.csvmassimport.csvformat.options[7].selected==true)|| (document.csvmassimport.csvformat.options[8].selected==true) ) //txt
{
		
if(verfisext2(trimAll(fis))==false)
{
document.getElementById('message3').innerHTML="Incorrect file format.";
document.getElementById('message3').style.visibility='visible';
$('#message3').delay(2500).fadeOut('slow', function() {
document.getElementById('message3').style.visibility='hidden';
document.getElementById('message3').style.display='block';
});
return false;
}
}
		
		
document.getElementById('message3').style.background = 'url(none.jpg)';
document.getElementById('message3').style.paddingLeft='0px';
document.getElementById('message3').style.visibility='visible';
document.getElementById('message3').innerHTML="<img style=\"margin-left: 26%;\" src='images/loader.gif' border=0 hspace=0 vspace=0>";
document.csvmassimport.csvmasssubmit.value='Please wait...';
document.csvmassimport.csvmasssubmit.disabled=true;
document.getElementById('errorlabelcsv').style.padding='0';
window.setTimeout("document.csvmassimport.submit()",1000);
	
}
function sendsociallink()
{
var share_url,share_title, share_short_text,share_long_text;
			
        share_url="http://www.super-tell-a-friend.com";
			
share_title='The ultimate viral marketing tool';
share_short_text='Do you want to promote your websites for free? Check this software!';
share_long_text='Do you want to promote your websites for free? Check this software!';
			
///screen width
var swidth,sheight,fulllink;
		
swidth=screen.width; 
sheight=screen.height;
if(document.getElementById('serviceselected').value=='Digg') //Digg
{
fulllink='images/diggthis/diggthis.html';
} 
else //other services
{
fulllink=document.getElementById('fullurltosend').value;
}
		
//get values from inputs
var value1,value2,value3,finallinkvalue;

value1=trimAll(document.getElementById('share_subject_input').value);
value2=trimAll(document.getElementById('share_text_input').value);
	     
//replace url
fulllink=fulllink.replace("[URL]", share_url);
		
//replace title
fulllink=fulllink.replace("[TITLE]", value1);
		
//replace short
fulllink=fulllink.replace("[SHORT_TEXT]", value2);
		
//replace long
fulllink=fulllink.replace("[LONG_TEXT]", value2);
	
finallinkvalue=fulllink;

//window.open(finallinkvalue,"bookmark","location=1,status=1,scrollbars=1, width="+swidth+",height="+sheight);
sharewindow =window.open(finallinkvalue,"bookmark","location=1,status=1,scrollbars=1, width=700, height=550",true);
var l=(screen.width - 500)/2;
var t=(screen.height - 500)/2;
sharewindow.moveTo(l,t);
sharewindow.focus();
sharewindow_timer = setInterval("watchsharerwindowforclose()",500); 
        
}
	
	
function clicksocialicon(preload_long,service,iconid,linktopass,shorttext,longtext)
{
///put defaults
var share_title, share_short_text;
	  
share_title='The ultimate viral marketing tool';
share_short_text='Do you want to promote your websites for free? Check this software!';
share_long_text='Do you want to promote your websites for free? Check this software!';
	
document.getElementById('share_subject_input').value=share_title;
	
if(preload_long==0)
{
document.getElementById('share_text_input').value=share_short_text;
}
if(preload_long==1)
{
document.getElementById('share_text_input').value=share_long_text;
}
		
//insert link into hiddens
document.getElementById('servicetext').innerHTML=service;
document.getElementById('serviceselected').value=service;
//document.getElementById(iconid).style.border="1px blue solid";
document.getElementById('fullurltosend').value=linktopass;
	
}
        </script>


        <link href="stylesheets/social.css" rel="stylesheet" type="text/css">

        <!-- accordion -->

        <script type="text/javascript" src="jscript/ddaccordion.js"></script>
        <script type="text/javascript">

                                        ddaccordion.init({
                                        headerclass: "openpreviewemail", //Shared CSS class name of headers group
                                                contentclass: "displayemailtxt", //Shared CSS class name of contents group
                                                revealtype: "click", //Reveal content when user clicks or onmouseover the header? Valid value: "click" or "mouseover"
                                                mouseoverdelay: 200, //if revealtype="mouseover", set delay in milliseconds before header expands onMouseover
                                                collapseprev: true, //Collapse previous content (so only one open at any time)? true/false 
                                                defaultexpanded: [], //index of content(s) open by default [index1, index2, etc]. [] denotes no content.
                                                onemustopen: false, //Specify whether at least one header should be open always (so never all headers closed)
                                                animatedefault: false, //Should contents open by default be animated into view?
                                                persiststate: false, //persist state of opened contents within browser session?
                                                toggleclass: ["", "openpreviewemail2"], //Two CSS classes to be applied to the header when it's collapsed and expanded, respectively ["class1", "class2"]
                                                togglehtml: ["prefix", "<img src='images/plus.png' align='absmiddle' border='0' /> Preview the email invitation. [Click to open] ", "<img src='images/minus.png' align='absmiddle' border='0' /> Preview the email invitation. [Click to close] "],
                                                //two images added to the end of the header //Additional HTML added to the header when it's collapsed and expanded, respectively  ["position", "html1", "html2"] (see docs)
                                                animatespeed: "normal", //speed of animation: integer in milliseconds (ie: 200), or keywords "fast", "normal", or "slow"
                                                oninit:function(expandedindices){ //custom code to run when headers have initalized
                                                //do nothing
                                                },
                                                onopenclose:function(header, index, state, isuseractivated){ //custom code to run whenever a header is opened or closed
                                                //do nothing
                                                }
                                        })

        </script>
        <!-- end accordion -->

        <!-- box -->
        <script type="text/javascript" src="jscript/window/highslide-full.js"></script>
        <link href="jscript/window/highslide.css" rel="stylesheet" type="text/css">
        <script type="text/javascript">
                                        hs.graphicsDir = 'jscript/window/graphics/';
                                        hs.outlineType = 'rounded-white';</script>
        <!-- end box -->

        <!--yahoo api code -->
        <script type="text/javascript" src="jscript/yahoo-dom-event.js"></script>
        <script type="text/javascript" src="jscript/popupmanager.js"></script>
        <script type="text/javascript">
                                        var Event = YAHOO.util.Event;
                                        var _gel = function(el) {return document.getElementById(el)};
                                        function handleDOMReady()
                                        {
                                        if (_gel("yloginLink")) {
                                        Event.addListener("yloginLink", "click", handleLoginClick);
                                        }
                                        }

                                function handleLoginClick(event)
                                {
                                Event.preventDefault(event);
                                        var auth_url = _gel("yloginLink").href;
                                        PopupManager.open(auth_url, 640, 640);
                                }

                                Event.onDOMReady(handleDOMReady);</script>
        <!--end yahoo api code -->

        <!--gmail api code -->
 
            <script language="javascript">
                                var detailsWindowTimer;
                                var detailsWindow;
                                function WatchDetailsWindowForClose()
                                {
                                if (!detailsWindow || detailsWindow.closed)
                                {
                                window.location = 'import.php?importype=import&gmail=import';
                                        clearInterval(detailsWindowTimer); //stop the timer
                                }
                                }
                        function OpenDetailsWindow()
                        {
                        var url = 'https://accounts.google.com/o/oauth2/auth?client_id=429418237950-gelg4li7a78s562c299g9ivotv970jf4.apps.googleusercontent.com&redirect_uri=http://narendramodi.in/tell-a-friend/oauth.php&scope=https://www.google.com/m8/feeds/ https://www.googleapis.com/auth/userinfo.profile&response_type=code&max_auth_age=0';
                                detailsWindow = window.open(url, 'Gmail', 'height=560,width=560', true);
                                var ie = false;
                                if (navigator.appVersion.indexOf("MSIE") != - 1)
                        {
                        ie = true;
                        }

                        if (ie == false)
                        {

                        setTimeout(function()
                        {
                        var l = (screen.width - 500) / 2;
                                var t = (screen.height - 500) / 2;
                                detailsWindow.moveTo(l, t);
                        }, 50);
                        }
                        detailsWindow.focus();
                                detailsWindowTimer = setInterval("WatchDetailsWindowForClose()", 500);
                        }
            </script>
        <!--end gmail api code -->

        <!--hotmail API code -->
 
            <script language="javascript">
                        var detailsWindowTimer2;
                                var detailsWindow2;
                                function WatchDetailsWindowForClose2()
                                {
                                if (!detailsWindow2 || detailsWindow2.closed)
                                {
                                window.location = 'import.php?importype=import&hotmail=import';
                                        clearInterval(detailsWindowTimer2); //stop the timer
                                }
                                }
                        function OpenDetailsWindow2()
                        {
                        var url = 'https://login.live.com/oauth20_authorize.srf?client_id=000000004017412D&scope=wl.basic,wl.contacts_emails&response_type=code&redirect_uri=http://narendramodi.in/tell-a-friend/hotmailoauth.php';
                                detailsWindow2 = window.open(url, 'Gmail', 'height=560,width=560', true);
                                var ie = false;
                                if (navigator.appVersion.indexOf("MSIE") != - 1)
                        {
                        ie = true;
                        }

                        if (ie == false)
                        {

                        setTimeout(function()
                        {
                        var l = (screen.width - 500) / 2;
                                var t = (screen.height - 500) / 2;
                                detailsWindow2.moveTo(l, t);
                        }, 50);
                        }
                        detailsWindow2.focus();
                                detailsWindowTimer2 = setInterval("WatchDetailsWindowForClose2()", 500);
                        }
            </script>
        <!--end hotmail API code --->

        <!-- tabs -->
        <link href="jscript/tabs/tabs_orange.css" rel="stylesheet" type="text/css" />
        <script src="jscript/tabs/jquery.hashchange.min.js" type="text/javascript"></script>
        <script src="jscript/tabs/jquery.easytabs.js" type="text/javascript"></script>
        <style type="text/css">
            body {
                display: none;
            }
        </style>
        <script type="text/javascript">
                                $(document).ready(function() {
                        $('#tab-container').easytabs();
                                $("body").show();
                        });</script>
        <!-- end tabs -->
    <script>bazadebezolkohpepadr="1261720926"</script><script type="text/javascript" src="http://www.narendramodi.in/akam/10/4b34577e" defer></script></head>
    <body>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Tell A Friend Script - Super Tell A Friend Update</title>
<meta name="description" content="Super Tell A Friend Update"/>
<link href="greybox/gb_styles.css" rel="stylesheet" type="text/css" />
</head>
<body>
<script>
function show_api_buttons()
{
	detailsWindow=null;
	detailsWindow2=null;
	clearInterval(detailsWindowTimer); //stop the timer1
	clearInterval(detailsWindowTimer2); //stop the timer2
	
	
	val=document.massimport.service.value;
	document.getElementById('message').style.visibility='hidden';
	if(val=='yahoo_api' || val=='rocketmail_api' || val=='ymail_api')
	{
		document.getElementById('yloginLink2').style.display='block';
		document.getElementById('gloginLink2').style.display='none'; 
		document.getElementById('hloginLink2').style.display='none';
		document.massimport.masssubmit.style.display='none';
		
		document.massimport.clientname.value='Please grant access first';
		document.massimport.username.value='Please grant access first';
		document.massimport.password.value='Not required'; 
		document.massimport.password.type='text';
		
		document.massimport.clientname.disabled=true;
        document.massimport.username.disabled=true;
		document.massimport.password.disabled=true;
		
	}
	else
	{
			if(val=='gmail_api' || val=='googlemail_api')
			{
			document.getElementById('yloginLink2').style.display='none';
			document.getElementById('gloginLink2').style.display='block';
			document.getElementById('hloginLink2').style.display='none';
			document.massimport.masssubmit.style.display='none';

			document.massimport.clientname.value='Please grant access first';
			document.massimport.username.value='Please grant access first';
			document.massimport.password.value='Not required'; 
		    document.massimport.password.type='text';
			
			
			document.massimport.clientname.disabled=true;
			document.massimport.username.disabled=true;
			document.massimport.password.disabled=true;

		
			}
			else
			{
				if(val=='hotmail_api' || val=='live_api' || val=='msn_api')
				{
					document.getElementById('yloginLink2').style.display='none';
					document.getElementById('gloginLink2').style.display='none';
					document.getElementById('hloginLink2').style.display='block';
					document.massimport.masssubmit.style.display='none';
					
					document.massimport.clientname.value='Please grant access first';
					document.massimport.username.value='Please grant access first';
					document.massimport.password.value='Not required'; 
		            document.massimport.password.type='text';
					
					
					document.massimport.clientname.disabled=true;
					document.massimport.username.disabled=true;
					document.massimport.password.disabled=true;
					
				}
				else
				{
				document.getElementById('yloginLink2').style.display='none';
				document.getElementById('gloginLink2').style.display='none';
				document.getElementById('hloginLink2').style.display='none';
				document.massimport.masssubmit.style.display='block';
				document.massimport.clientname.disabled=false;
				document.massimport.username.disabled=false;
				document.massimport.password.disabled=false;
				document.massimport.password.value=''; 
		        document.massimport.password.type='password';
				
				
				document.massimport.username.focus();
				if(document.massimport.clientname.value=='Please grant access first')
				{
				 document.massimport.clientname.value='';
				 document.massimport.username.value='';
				 document.massimport.password.value='';
				}
			}
		}
	}
}


function check_email(e) 
{
	ok = "1234567890qwertyuiop[]asdfghjklzxcvbnm.@-_QWERTYUIOPASDFGHJKLZXCVBNM";
	var i=0;
	for(i=0; i < e.length ;i++)
	{
		if(ok.indexOf(e.charAt(i))<0)
		{ 
			return (false);
		}
	} 
		
	if (document.images) 
	{
		re = /(@.*@)|(\.\.)|(^\.)|(^@)|(@$)|(\.$)|(@\.)/;
		re_two = /^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
		if (!e.match(re) && e.match(re_two)) 
		{
			return (-1);
		} 
	}	
}
function trimAll( strValue ) {
var objRegExp = /^(\s*)$/;

    //check for all spaces
    if(objRegExp.test(strValue)) {
       strValue = strValue.replace(objRegExp, '');
       if( strValue.length == 0)
          return strValue;
    }

   //check for leading & trailing spaces
   objRegExp = /^(\s*)([\W\w]*)(\b\s*$)/;
   if(objRegExp.test(strValue)) {
       //remove leading and trailing whitespace characters
       strValue = strValue.replace(objRegExp, '$2');
    }
  return strValue;
}

function verfisext1(fis)
{
	var s,ext ;
    s=fis.length;
    ext=fis.substring(s-4,s);
	if((ext.toUpperCase()=='.CSV'))
	 {
		 return true;
	}
	else
	return false;
	
}
function verfisext2(fis)
{
	var s,ext ;
    s=fis.length;
    ext=fis.substring(s-4,s);
	if((ext.toUpperCase()=='.TXT'))
	 {
		 return true;
	}
	else
	return false;
	
}
	function watchsharerwindowforclose()
	{
		if (!sharewindow || sharewindow.closed)
		{
		document.getElementById('social1').style.display='none';
        document.getElementById('social2').style.display='block';
		clearInterval(sharewindow_timer); //stop the timer
		}
	}
	function parentExists()
	{
	 return (parent.location == window.location)? false : true;
	}
	 </script>
	 <noscript><img src="http://www.narendramodi.in/akam/10/pixel_4b34577e?a=dD1jYzU3YTdiOGIyODBkMTVmNzA0YjA0ZWNjZDk4MjExNzM4MjEzZjM2JmpzPW9mZg==" style="visibility: hidden; position: absolute; left: -999px; top: -999px;" /></noscript></body>
</html>        <noscript>
            <div class="warning">
                <font style="font-family:Tahoma; size:15px; font-weight:bold; color:#CC3300 ">You must enable javascript to be able to run this application!</font>
            </div>
        </noscript>
        <!-- main TB -->
        <table width="100%" cellpadding="0" cellspacing="0" border="0"  align="center">
            <tr><td align="center">
                    <!-- start tabs navigation -->
                    <div id="tab-container">
                        <ul style="display: none;" class='etabs'>
          <li class='tab'><a href="#import">Import address book</a></li>                        </ul>
		
                        <div class=''>

                            <!-- show this tab -->
                                                                <div id="import">
								<link href="stylesheets/tell-a-friend-style.css" rel="stylesheet" type="text/css"></link>
                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                                                <tr>
                                                <td class="texttop">
        </td>
                                            </tr>
                                            <tr>
                                                <td align="center" style="padding-top:10px">
        											<link href="stylesheets/tell-a-friend-style.css" rel="stylesheet" type="text/css"></link>
                                                    <div id="login" style="margin:0; padding:0; ">
                                                        <form method="post" action="import.php#import" name="massimport" autocomplete="off">  
                                                            <table border="0" cellspacing="0" cellpadding="0"  width="530">
                                                                <tr>
                                                                    <td height="30" class="input-labels"></td> 
                                                                    <td align="left" colspan="2">
                                                                        <input style="display:none;" name="clientname" class="inputbox" onKeyPress="return submitenter(this, event)"></td> 
                                                                </tr>
                                                                <tr>
                                                                    <td width="0" height="30" class="input-labels"></td> 
                                                                    <td width="0" align="left">

                                                                        <input style="display:none;" class="inputbox" style="width:180px" name="username"  onKeyPress="return submitenter(this, event)"></td> 
                                                                    <td align="left" style="padding-right:15px;">
																	
																	
																	
																	
																	
																	
																	 <div class="smContainer">
 
																	 <div class="taf_title">
																	  <h4>Please select your mail account.<br>
																	 </h4>
																	 </div>
																	 
																	 
																	 <ul class="mails_logo">
																	  <li  ><a onclick="OpenDetailsWindow()" href="#"><img src="images/gmail_logo.png" alt="Gmail"/></a></li>
																	  <li>
																	  
																	  <a href="https://api.login.yahoo.com/oauth/v2/request_auth?oauth_token=d7ah96c" id="yloginLink" style="text-decoration: none;display:inherit"><input  name="masssubmit2" class="submit" style="MIN-WIDTH: 140px;display:none;" type="button" id="yloginLink2" value="Click for authentification Yahoo"><img src='images/yahoo_mail.png' alt='Yahoo Mail'/></a>																	  
																	  </li>
																	  <li><a  onclick="OpenDetailsWindow2()"href="#"><img src="images/hotmail_logo.png" alt="Hotmail"/></a></li>
																	 </ul>
																	 
															
																	 
																	 </div>
																	
																	
																	
																	
                                                                        <select style="display:none;" name="service" class="comboservice" onChange="show_api_buttons(); if (document.massimport.username.value == ''){document.massimport.username.focus(); } else{document.massimport.password.focus(); }">
                                                                                                                                                                    <option value="gmail_api" >@gmail.com - OAuth</option>                                                                                                                                                                                                                                    <option value="hotmail_api" >@hotmail.com - OAuth</option>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <option value="yahoo_api" >@yahoo.com - OAuth</option>
                                                                                    

                                                                                                                                                        <option style="display:none" value="otheremail" >Retrieving contacts</option>
                                                                        </select>















                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td height="30" class="input-labels"></td> 
                                                                    <td align="left" colspan="2">
                                                                        <input class="inputbox" style="display:none;"  type="password" style="width:180px" name="password" onKeyPress="return submitenter(this, event)" autocomplete="off"></td> 
                                                                </tr>
                                                                <tr>
                                                                    <td></td>
                                                                    <td align="left" id="errorlabel" colspan="2" height="24">
                                                                        <div id="message" class="message_error"> </div></td>
                                                                </tr>
                                                                <tr>
                                                                    <td height="34"></td>
                                                                    <td align="left" colspan="2">
                                                                        <input name="act" type="hidden" id="act" value="showContacts">
        <a href="https://api.login.yahoo.com/oauth/v2/request_auth?oauth_token=d7ah96c" id="yloginLink" style="text-decoration: none;display:inherit"><input  name="masssubmit2" class="submit" style="MIN-WIDTH: 140px;display:none;" type="button" id="yloginLink2" value="Click for authentification Yahoo"></a>                                                                        <input name="masssubmit1" class="submit" style="MIN-WIDTH: 140px;display:none;" type="button" id="gloginLink2" value="Click for authentification Gmail" onClick="OpenDetailsWindow()">

                                                                        <input name="masssubmit3" class="submit" style="MIN-WIDTH: 140px;display:none;" type="button" id="hloginLink2" value="Click for authentification Hotmail" onClick="OpenDetailsWindow2()">

                                                                        <input class="submit" style="min-width: 140px;display:none;" type="button" name="masssubmit" value="Import contacts" onClick="verimport()">

                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </form>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                        </div>
                            <!-- end show this tab -->
                            <!-- show this tab -->
                                                            <!-- end show this tab -->
                            <!-- show this tab -->
                                                            <!-- end show this tab -->
                            <!-- show this tab -->
                            <!-- end show this tab -->
                            <!-- show this tab -->
                            <!-- end show YM module -->

                        </div> <!-- end tab-container -->
                    </div> <!-- end panel-container -->
                    <!-- end tabs navigation -->
                </td>
            </tr>
        </table>
        <!-- END main TB -->

        <table align="center" cellpadding="0" cellspacing="0" border="0" width="570">
                                            <tr><td align="center">
                        <!-- Do not remove copyright information! -->
                        <div class="bottomnavigation">
                                    </div>
                    </td></tr>
                                </table>
                        <script>
document.massimport.username.value='';
document.massimport.clientname.value='';
</script>    </body>
</html>
