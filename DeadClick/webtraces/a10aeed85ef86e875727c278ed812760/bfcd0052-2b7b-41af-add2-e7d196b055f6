var shipSmokeArray = new Array();
var shipSmokeArray2 = new Array();
var fireArray = new Array();
var smokeTimer = 0;
///
function addSmoke(x,y,scale)
{
	var obj = {};
	//obj.sx = x;
	//obj.sy = y;
	obj.x = x;
	obj.y = y;
	obj.sScale = scale+Math.random()* 0.2;
	obj.dScale = 0;
	obj.scale = 0;
	obj.alpha = 1;
	obj.rotate = Math.random()*5;
	shipSmokeArray.push(obj);
	if(goToLanding)
	{
		shipSmokeArray.splice(obj);
	}
}
function addSmoke2(x,y,scale)
{
	var obj = {};
	//obj.sx = x;
	//obj.sy = y;
	obj.x = x;
	obj.y = y;
	obj.sScale = scale+Math.random()* 0.2;
	obj.dScale = 0;
	obj.scale = 0;
	obj.alpha = 0.55;
	obj.rotate = Math.random()*5;
	shipSmokeArray2.push(obj);
	if(goToLanding)
	{
		shipSmokeArray2.splice(obj);
	}
}

function addFire(x,y,scale)
{
	var obj = {};	
	obj.x = x;
	obj.y = y;
	obj.sScale = scale+Math.random()*0.8;
	obj.dScale = 0;
	obj.scale = 0;
	obj.alpha = 0.8;
	obj.rotate = Math.random()*5;
	fireArray.push(obj);
	if(goToLanding)
	{
		fireArray.splice(obj);
	}
}
//
function drawBackground(ctx, obj)
{
	ctx.save();
	ctx.clearRect(0, 0, w, h);
	ctx.globalAlpha = obj.alpha;
	ctx.translate(obj.x, obj.y)
	ctx.scale (obj.scale, obj.scale);
	//
	ctx.drawImage(obj.pic, 0, 0, obj.pic.width, obj.pic.height);
	//
	drawShadow(ctxBackground, img_shadow)
	//
	drawTank(ctxBackground, img_tank);
	//
	drawHealth(ctxBackground, gfx_health)
	//
	drawHealth2(ctxBackground, gfx_health2)
	//
	drawContour(ctxBackground, img_tank)
	//
	drawWheel(ctxBackground, img_wheel)
	//
	drawWheel2(ctxBackground, img_wheel2)
	//
	drawTrack(ctxBackground, img_track)
	//
	drawCrash(ctxBackground, gfx_crash)
	//


	//DRAW SMOKE Background
	
	/*for(i =0;i<shipSmokeArray.length;i++)
	{
		shipSmokeArray[i].y -= 0.6;		
		shipSmokeArray[i].x -=((shipSmokeArray[i].scale+shipSmokeArray[i].sScale)/2 - 0.25);
		shipSmokeArray[i].dScale +=(shipSmokeArray[i].sScale-shipSmokeArray[i].dScale)/22;
		shipSmokeArray[i].scale +=0.005;
		shipSmokeArray[i].alpha +=(0-shipSmokeArray[i].alpha)/76;
		
		ctx.save();
			ctx.translate(shipSmokeArray[i].x,shipSmokeArray[i].y);
			ctx.scale(shipSmokeArray[i].scale+shipSmokeArray[i].dScale,shipSmokeArray[i].scale+shipSmokeArray[i].dScale);			
			ctx.rotate(shipSmokeArray[i].rotate);		
			ctx.globalAlpha = shipSmokeArray[i].alpha*obj.alpha;
			ctx.drawImage(img_smoke.pic,-30,-23);
		ctx.restore();
		if(shipSmokeArray[i].alpha<0.03)
		{
			shipSmokeArray.splice(i,1);
			i--;
		}
	}*/
	//DRAW FIRE Background
	for(i =0;i<fireArray.length;i++)
	{
		fireArray[i].y -=fireArray[i].sScale/2;
		fireArray[i].x -=fireArray[i].sScale/2.4;
		fireArray[i].dScale +=(fireArray[i].sScale-fireArray[i].dScale)/8;
		fireArray[i].scale -=0.016;
		fireArray[i].alpha +=(0-fireArray[i].alpha)/20;
		
		ctx.save();
			ctx.translate(fireArray[i].x,fireArray[i].y);
			ctx.scale(fireArray[i].scale+fireArray[i].dScale,fireArray[i].scale+fireArray[i].dScale);			
			ctx.rotate(fireArray[i].rotate);		
			ctx.globalAlpha = fireArray[i].alpha*obj.alpha;
			ctx.drawImage(img_fire.pic,-7,-10);
		ctx.restore();
		if(fireArray[i].alpha<0.03)
		{
			fireArray.splice(i,1);
			i--;
		}
	}
		////////////////
	//DRAW SMOKE Window
	/*for(i =0;i<shipSmokeArray2.length;i++)
	{
		shipSmokeArray2[i].y -= 0.3;		
		shipSmokeArray2[i].x -=((shipSmokeArray2[i].scale+shipSmokeArray2[i].sScale)/2 - 0.25);
		shipSmokeArray2[i].dScale +=(shipSmokeArray2[i].sScale-shipSmokeArray2[i].dScale)/22;
		shipSmokeArray2[i].scale +=0.005;
		shipSmokeArray2[i].alpha +=(0-shipSmokeArray2[i].alpha)/76;
		
		ctx.save();
			ctx.translate(shipSmokeArray2[i].x,shipSmokeArray2[i].y);
			ctx.scale(shipSmokeArray2[i].scale+shipSmokeArray2[i].dScale,shipSmokeArray2[i].scale+shipSmokeArray2[i].dScale);			
			ctx.rotate(shipSmokeArray2[i].rotate);		
			ctx.globalAlpha = shipSmokeArray2[i].alpha*obj.alpha;
			ctx.drawImage(img_smoke.pic,-30,-23);
		ctx.restore();
		if(shipSmokeArray2[i].alpha<0.03)
		{
			shipSmokeArray2.splice(i,1);
			i--;
		}
	}*/

	//
	drawTrack(ctxBackground, img_track)
	//
	drawRuins(ctxBackground, img_ruins)
	//
	ctx.restore();

	smokeTimer++;
	smokeTimer=smokeTimer%10;
	if(smokeTimer==0)
	{	
		// window smoke
	    //addSmoke2(158+Math.random()*10,137+Math.random()*10,0.25);	
	    //right smoke
		//addSmoke(395+Math.random()*30,215+Math.random()*10,1.4);
		if(hitsNum === 1)
		{
			//tank smoke
			//addSmoke(img_tank.x + 160 +Math.random(),192+Math.random()*10,0.6);
		}		
	}
	if(smokeTimer==5)
	{
		//right smoke
		//addSmoke(385+Math.random()*50,215+Math.random()*10,1.7);
		if(hitsNum === 2)
		{
			//tank smoke
			//addSmoke(225+Math.random()*50,215+Math.random()*5,1);
		}
	}
	
	if(smokeTimer%2==0)
	{
		//right fire
		addFire(400+Math.random()*30,230+Math.random()*5,2.5);
		//town fire
		addFire(90+Math.random()*30,230+Math.random()*5,1.2);
		if(hitsNum === 2)
		{
			//tank fire
			addFire(245+Math.random()*30,215+Math.random()*10,1.2);
		}
	}
}
function drawTank(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(obj.x , obj.y)
	ctx.scale (obj.scale, obj.scale);
	//
	ctx.beginPath();
	ctx.moveTo(181.25,49.4);
	ctx.lineTo(204.45,50.35);
	ctx.lineTo(208.78,54.554);
	ctx.lineTo(209.2,60.651);
	ctx.lineTo(213,66.2011);
	ctx.lineTo(212.9,69.3501);
	ctx.lineTo(210.25,69.4511);
	ctx.lineTo(210.95,72.1511);
	ctx.lineTo(211.2,76);
	ctx.lineTo(208.099,80.9);
	ctx.lineTo(204.349,83.549);
	ctx.lineTo(203.5488,84.849);
	ctx.lineTo(201.1,85);
	ctx.lineTo(199.6508,87.6);
	ctx.lineTo(196.2,88.2);
	ctx.lineTo(195.7,89.45);
	ctx.lineTo(191.95,90.849);
	ctx.lineTo(191.6498,92.299);
	ctx.lineTo(188,92.9);
	ctx.lineTo(187.55,94.599);
	ctx.lineTo(183.4502,94.95);
	ctx.lineTo(183,95.8);
	ctx.lineTo(97.2,100.95);
	ctx.lineTo(79.8,101.1);
	ctx.lineTo(75.25,100);
	ctx.lineTo(63.8,95.35);
	ctx.lineTo(63.094,95.951);
	ctx.lineTo(60.49,96.201);
	ctx.lineTo(59.844,95.3009);
	ctx.lineTo(58.196,95.1008);
	ctx.lineTo(57.8,95.9);
	ctx.lineTo(55.8,96.299);
	ctx.lineTo(54.25,95.599);
	ctx.lineTo(52.2,95.799);
	ctx.lineTo(51.7,96.549);
	ctx.lineTo(49.4,96.9);
	ctx.lineTo(48.9,95.95);
	ctx.lineTo(47.1,95.95);
	ctx.lineTo(46.65,97.1);
	ctx.lineTo(43.4,97);
	ctx.lineTo(42.946,95.9);
	ctx.lineTo(41.24,95.9);
	ctx.lineTo(40.5,97.35);
	ctx.lineTo(36.9,97);
	ctx.lineTo(36.4,95.9);
	ctx.lineTo(34.25,96.3);
	ctx.lineTo(30.2,95.55);
	ctx.lineTo(26.55,94.4);
	ctx.lineTo(15.9,88.7);
	ctx.lineTo(7.801,83.3);
	ctx.lineTo(4.701,79.85);
	ctx.lineTo(3.15,78.95);
	ctx.lineTo(2.65,77.45);
	ctx.lineTo(3.7,76.85);
	ctx.lineTo(2.8003,74.75);
	ctx.lineTo(3.1504,72.4);
	ctx.lineTo(1.9,71.3);
	ctx.lineTo(3.95,70);
	ctx.lineTo(4.95,65.15);
	ctx.lineTo(7.2,63.85);
	ctx.lineTo(6.85,63.1);
	ctx.bezierCurveTo(6.183,63.167,5.449,63.333,4.6495,63.6);
	ctx.bezierCurveTo(3.0494,64.134,1.8995,64.967,1.1993,66.1);
	ctx.lineTo(-0.15,64.9);
	ctx.bezierCurveTo(0.65,63.633,2.117,62.406,4.25,61.2);
	ctx.bezierCurveTo(8.517,58.804,14.017,57.75,20.75,58.054);
	ctx.lineTo(21.15,54.304);
	ctx.lineTo(22.547,52.85);
	ctx.lineTo(28.348,55.5);
	ctx.bezierCurveTo(32.15,54.134,36.416,52.833,41.15,51.6);
	ctx.bezierCurveTo(50.65,49.167,57.75,48.35,62.45,49.15);
	ctx.lineTo(64.5,46.85);
	ctx.lineTo(70.5,45.9);
	ctx.lineTo(69,44.95);
	ctx.lineTo(69,40);
	ctx.lineTo(48.9,38.45);
	ctx.lineTo(47.35,39.75);
	ctx.lineTo(31.25,39.8);
	ctx.lineTo(31.1,32.094);
	ctx.lineTo(47.25,31);
	ctx.lineTo(49.15,33.05);
	ctx.lineTo(70.9,32.65);
	ctx.lineTo(71.75,31.598);
	ctx.lineTo(70.05,27.9);
	ctx.lineTo(70.05,26.047);
	ctx.lineTo(70.75,25.196);
	ctx.lineTo(77.4,24.645);
	ctx.lineTo(77.31,23.395);
	ctx.lineTo(78.51,22.696);
	ctx.lineTo(80.01,23.645);
	ctx.lineTo(82.31,22.696);
	ctx.lineTo(82.22,21.094);
	ctx.lineTo(83.6502,21.094);
	ctx.lineTo(84.2501,22.544);
	ctx.lineTo(88.3501,22.594);
	ctx.lineTo(88.3501,20.493);
	ctx.lineTo(90.61,20.294);
	ctx.lineTo(91.2,22.442);
	ctx.lineTo(100.95,21.993);
	ctx.lineTo(101.3,23.89);
	ctx.lineTo(104.35,25.34);
	ctx.lineTo(120.8,24.942);
	ctx.lineTo(121.5,0.14147);
	ctx.lineTo(122.95,24.79);
	ctx.lineTo(135.6,24.79);
	ctx.lineTo(140,33.69);
	ctx.lineTo(144.7,38.84);
	ctx.lineTo(145.7,38.84);
	ctx.lineTo(146.0498,33.29);
	ctx.lineTo(148.78,32.99);
	ctx.lineTo(150.35,38.74);
	ctx.lineTo(151.3,39);
	ctx.lineTo(151.12,40.65);
	ctx.lineTo(146.3,42);
	ctx.lineTo(148.05,44.6);
	ctx.lineTo(147.9502,46.7);
	ctx.lineTo(147.0992,47.906);
	ctx.lineTo(149.4,46.7);
	ctx.lineTo(174.049,47.906);
	ctx.lineTo(181.25,49.4);
	ctx.closePath();
	ctx.moveTo(168.5,88.1);
	ctx.lineTo(173.2,92.901);
	ctx.lineTo(170.88,92.8);
	ctx.lineTo(169.7497,91.75);
	ctx.lineTo(168.6498,93.4);
	ctx.lineTo(165.6498,92.95);
	ctx.lineTo(168.5,88.1);
	ctx.closePath();
	ctx.moveTo(119.85,95.35);
	ctx.lineTo(122.85,95.1);
	ctx.lineTo(123.651,94.25);
	ctx.lineTo(125.151,94.75);
	ctx.lineTo(127.55,94.75);
	ctx.lineTo(124.9,92.3);
	ctx.lineTo(118.5,93.5);
	ctx.lineTo(119.85,95.35);
	ctx.closePath();
	ctx.moveTo(97.6,92.95);
	ctx.lineTo(100.85,95.45);
	ctx.lineTo(97,95.9);
	ctx.lineTo(95.65,94.849);
	ctx.lineTo(93.75,96.549);
	ctx.lineTo(91,95.45);
	ctx.lineTo(92.7,94);
	ctx.lineTo(97.6,92.95);
	ctx.closePath();
	ctx.moveTo(146.85,94.1);
	ctx.lineTo(145.7,93.15);
	ctx.lineTo(144.6,94.5);
	ctx.lineTo(142.9008,94.025);
	ctx.lineTo(146.3,89.9);
	ctx.bezierCurveTo(149.067,92.4,150.3,93.65,150,93.65);
	ctx.lineTo(146.85,94.1);
	ctx.closePath();
	ctx.moveTo(22.85,85.95);
	ctx.lineTo(18.75,83.05);
	ctx.lineTo(22.7,81.3);
	ctx.lineTo(22.85,85.95);
	ctx.closePath();
	ctx.moveTo(49.5,91.7);
	ctx.lineTo(48.3,92.95);
	ctx.lineTo(44.446,92.3);
	ctx.bezierCurveTo(46.1829,90.5,47.196,88.75,47.49,87.05);
	ctx.lineTo(48.79,86.55);
	ctx.lineTo(51,89.2);
	ctx.bezierCurveTo(52.667,91.033,53.9,92.167,54.7,92.599);
	ctx.lineTo(53.85,93.2);
	ctx.lineTo(50.4,93.05);
	ctx.lineTo(49.5,91.7);
	ctx.closePath();
	//
	var pattern = ctx.createPattern(img_tank.pic, "no-repeat");
	ctx.fillStyle = pattern;
	ctx.fill();
	//
	//drawTrack(ctxBackground, img_tank)
	//

	ctx.restore();

}
//
function drawShadow(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(img_tank.x , img_tank.y + 75)
	ctx.scale (obj.scale, obj.scale);
	//
	ctx.drawImage(obj.pic, 0, 0, obj.pic.width, obj.pic.height);
	//
	ctx.restore();

}

function drawHealth(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(img_tank.x + 63, img_tank.y)
	ctx.scale (obj.scaleX, obj.scaleY);
	//
	ctx.fillStyle = "rgb(255,255,255)"
	ctx.fillRect(0,0,60,8)
	ctx.strokeStyle = "black"
	ctx.strokeRect(0,0,60,8)

	//
	ctx.restore();

}
function drawHealth2(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(img_tank.x + 63 , img_tank.y)
	ctx.scale (obj.scaleX, obj.scaleY);
	//
	ctx.fillStyle = "rgb(237,22,19)"
	ctx.fillRect(0,0,60,8)

	//
	ctx.restore();

}
//
function drawCrash(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(img_tank.x, img_tank.y)
	ctx.scale (obj.scale, obj.scale);
	//
	ctx.beginPath();
	ctx.moveTo(125.45,39.1);
	ctx.bezierCurveTo(123.547,40.237,121.763,41.762,120.099,43.6754);
	ctx.bezierCurveTo(118.441,45.585,115.95,46.0474,112.6241,45.075);
	ctx.bezierCurveTo(109.299,44.103,106.5911,43.378,104.4991,42.906);
	ctx.bezierCurveTo(102.4022,42.4291,100.718,41.2461,99.4491,39.351);
	ctx.bezierCurveTo(98.8492,38.4831,98.4491,37.4161,98.2491,36.156);
	ctx.bezierCurveTo(98.117,34.783,98,33.8,97.9,33.2);
	ctx.bezierCurveTo(97.5,31.1333,95.851,29.9333,92.95,29.6);
	ctx.bezierCurveTo(91.215,29.402,88.1151,29.036,83.65,28.5);
	ctx.bezierCurveTo(79.1891,27.959,78.4391,27.159,81.4,26.1);
	ctx.bezierCurveTo(84.3591,25.0433,89.926,25.5433,98.11,27.6);
	ctx.lineTo(107.51,25.703);
	ctx.bezierCurveTo(114.01,24.902,117.8162,25.6664,118.952,28.004);
	ctx.bezierCurveTo(119.551,29.203,121.72,31.3336,125.42,34.406);
	ctx.bezierCurveTo(127.634,36.233,127.65,37.8,125.45,39.1);
	ctx.closePath();
	ctx.moveTo(94.15,41);
	ctx.lineTo(49.156,38.1);
	ctx.lineTo(31.257,39.25);
	ctx.lineTo(31.257,32.85);
	ctx.lineTo(47.656,31.5);
	ctx.lineTo(48.156,33);
	ctx.lineTo(94.15,33);
	ctx.lineTo(96.2,35.55);
	ctx.bezierCurveTo(97.133,37.583,96.45,39.4,94.15,41);
	ctx.closePath();
	ctx.moveTo(29.7,58.65);
	ctx.bezierCurveTo(32.467,55.3826,35.367,54.683,38.4,56.549);
	ctx.bezierCurveTo(39.933,57.516,41.16,58.816,42.16,60.449);
	ctx.bezierCurveTo(33.165,71.088,28.998,70.487,29.7,58.65);
	ctx.closePath();
	ctx.moveTo(24.85,70.75);
	ctx.bezierCurveTo(25.817,69.184,28.733,68.467,33.6,68.6);
	ctx.bezierCurveTo(38.5,68.734,40.6664,69.701,40.1,71.5);
	ctx.bezierCurveTo(39.8674,72.267,38.767,74.017,36.804,76.75);
	ctx.bezierCurveTo(35.167,78.983,34.35,81.184,34.35,83.35);
	ctx.bezierCurveTo(34.35,85.451,35.767,86.817,38.6,87.451);
	ctx.bezierCurveTo(41.633,88.116,43.267,88.800,43.5,89.500);
	ctx.bezierCurveTo(43.9,90.833,41.683,91.917,36.85,92.750);
	ctx.bezierCurveTo(32.317,93.517,28.867,93.684,26.5,93.250);
	ctx.bezierCurveTo(24.833,92.951,22,91.401,18,88.6008);
	ctx.lineTo(12.5,84.500);
	ctx.bezierCurveTo(10.3,82.634,10.383,81.417,12.75,80.8508);
	ctx.bezierCurveTo(12.917,80.8178,15.783,80.5678,21.35,80.1008);
	ctx.bezierCurveTo(23.683,79.901,24.783,78.651,24.652,76.3508);
	ctx.bezierCurveTo(24.483,73.116,24.55,71.25,24.85,70.75);
	ctx.closePath();
	ctx.moveTo(89,48.45);
	ctx.bezierCurveTo(99.667,49.317,107.384,49.6174,112.15,49.35);
	ctx.bezierCurveTo(119.917,48.9164,122.116,49.683,118.75,51.65);
	ctx.bezierCurveTo(115.75,53.3826,111.884,54.66,107.15,55.599);
	ctx.bezierCurveTo(104.2491,56.129,101.274,56.453,98.2251,56.5746);
	ctx.bezierCurveTo(95.177,56.66,91.885,56.717,88.351,56.624);
	ctx.bezierCurveTo(84.8141,56.5294,80.9311,56.570,76.7,56.749);
	ctx.lineTo(69.4,57);
	ctx.bezierCurveTo(65.5,56.1,64.25,55.066,65.65,53.9);
	ctx.bezierCurveTo(66.584,53.167,69.334,51.733,73.9,49.6);
	ctx.bezierCurveTo(76.467,48.2,81.5,47.817,89,48.45);
	ctx.closePath();
	ctx.moveTo(27.85,61.35);
	ctx.bezierCurveTo(27.683,62.651,27.402,63.6174,27,64.25);
	ctx.bezierCurveTo(26.533,64.95,25.483,66.033,23.85,67.5);
	ctx.bezierCurveTo(21.453,69.667,19.916,71.134,19.25,71.9);
	ctx.bezierCurveTo(17.983,73.433,17.733,74.549,18.5,75.25);
	ctx.bezierCurveTo(18.933,75.65,18.817,76.2,18.15,76.9);
	ctx.bezierCurveTo(17.517,77.599,16.65,78.15,15.54,78.549);
	ctx.bezierCurveTo(12.652,79.652,9.5689,79.5761,6.29,78.3241);
	ctx.bezierCurveTo(3.0269,77.0681,2.29387,74.7681,4.09,71.424);
	ctx.bezierCurveTo(5.9079,68.0821,6.7909,66.141,6.7498,65.599);
	ctx.bezierCurveTo(6.65,64.833,6.733,64.017,7,63.15);
	ctx.bezierCurveTo(7.533,61.483,8.733,60.466,10.6,60.099);
	ctx.bezierCurveTo(11.767,59.866,13.133,59.916,14.7,60.2485);
	ctx.bezierCurveTo(15.7329,60.481,17.083,60.1484,18.75,59.2485);
	ctx.bezierCurveTo(20.883,58.1145,23,57.849,25.1,58.449);
	ctx.bezierCurveTo(27.133,59.05,28.05,60.017,27.85,61.35);
	ctx.closePath();
	ctx.moveTo(63.25,51.5);
	ctx.bezierCurveTo(55.617,65.2,50.283,67.15,47.25,57.35);
	ctx.bezierCurveTo(48.45,51.684,51.467,49.017,56.3,49.35);
	ctx.bezierCurveTo(58.733,49.483,61.05,50.2,63.25,51.5);
	ctx.closePath();
	ctx.moveTo(36.7,82.1);
	ctx.bezierCurveTo(35.8674,81.1,36.6664,79.533,39.1,77.401);
	ctx.lineTo(42.95,74.500);
	ctx.bezierCurveTo(45.95,69.567,49.183,67.000,52.656,66.800);
	ctx.bezierCurveTo(54.156,66.734,55.156,67.333,55.656,68.6008);
	ctx.bezierCurveTo(56.2176,70.000,56.0671,72.000,55.2,74.6008);
	ctx.bezierCurveTo(53.6664,79.2018,56.75,84.083,64.45,89.250);
	ctx.bezierCurveTo(68.3171,91.817,72.3171,93.934,76.45,95.6008);
	ctx.lineTo(73.351,97.1008);
	ctx.bezierCurveTo(65.583,95.2,60.5,93.783,58.1,92.85);
	ctx.bezierCurveTo(56.9,92.384,55.017,91.151,52.45,89.151);
	ctx.bezierCurveTo(50.054,87.250,48.433,86.201,47.6,86.000);
	ctx.bezierCurveTo(45.304,85.567,43.4164,85.151,41.95,84.750);
	ctx.bezierCurveTo(39.283,83.983,37.533,83.1,36.7,82.1);
	ctx.closePath();
	//
	ctx.fillStyle = "black";
	ctx.fill()
	//
	ctx.restore();
}
//
function drawRuins(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(obj.x, obj.y)
	ctx.scale (obj.scale, obj.scale);
	//
	ctx.beginPath();
	ctx.moveTo(459.85,-0.15);
	ctx.lineTo(459.85,383.85);
	ctx.lineTo(-0.1,384.1);
	ctx.lineTo(-0.1502,248.12);
	ctx.lineTo(21.25,247.852);
	ctx.lineTo(22,243.352);
	ctx.lineTo(24.85,243.3);
	ctx.lineTo(32.25,248.3);
	ctx.lineTo(43.5,247.852);
	ctx.lineTo(44.85,247.3);
	ctx.lineTo(45.85,242.53);
	ctx.lineTo(57.75,247.253);
	ctx.lineTo(66,247.1);
	ctx.lineTo(70.25,245.6);
	ctx.lineTo(77.25,248);
	ctx.lineTo(81,248);
	ctx.lineTo(89.6,245.25);
	ctx.lineTo(103.85,249.85);
	ctx.lineTo(111.75,248);
	ctx.lineTo(117.25,251.6);
	ctx.lineTo(238.75,256.25);
	ctx.bezierCurveTo(240.217,254.55,242.15,252.8,244.55,251);
	ctx.bezierCurveTo(249.352,247.434,254.0332,245.434,258.6,245);
	ctx.lineTo(263.25,241.6);
	ctx.lineTo(267.1,240.85);
	ctx.lineTo(264.85,237);
	ctx.lineTo(266,233.5);
	ctx.lineTo(264.5,230);
	ctx.lineTo(266.25,227.85);
	ctx.lineTo(264.75,224.5);
	ctx.lineTo(266,222.25);
	ctx.lineTo(265.5,217.85);
	ctx.lineTo(268.85,212.1);
	ctx.lineTo(267.85,204.75);
	ctx.lineTo(272.75,200.75);
	ctx.lineTo(273.1,197.35);
	ctx.lineTo(258.75,186.5);
	ctx.lineTo(262.35,181.6);
	ctx.lineTo(283.25,196.6);
	ctx.lineTo(290.85,196.6);
	ctx.lineTo(291.5,182.35);
	ctx.lineTo(311.75,180.75);
	ctx.lineTo(327.75,177);
	ctx.lineTo(332,180.1);
	ctx.lineTo(332.25,216.5);
	ctx.lineTo(352,208.85);
	ctx.lineTo(358.85,209.25);
	ctx.lineTo(358.35,167.85);
	ctx.lineTo(333,167.85);
	ctx.lineTo(335.5,154.25);
	ctx.lineTo(347.85,154.85);
	ctx.bezierCurveTo(352.884,152.7168,355.017,151.6,354.25,151.5);
	ctx.bezierCurveTo(353.483,151.4,343.65,150.767,324.75,149.6);
	ctx.lineTo(325.1,139.35);
	ctx.lineTo(331.85,135.85);
	ctx.lineTo(335.35,128.35);
	ctx.lineTo(345,126.85);
	ctx.lineTo(345.1,120.75);
	ctx.lineTo(334.1,117.5);
	ctx.lineTo(334.1,115.35);
	ctx.lineTo(340.5,114.85);
	ctx.lineTo(345.1,115.5);
	ctx.lineTo(345.25,101.75);
	ctx.lineTo(348.75,102.5);
	ctx.lineTo(356,102.25);
	ctx.lineTo(356.85,118.85);
	ctx.lineTo(368.75,123);
	ctx.lineTo(368.1,83);
	ctx.lineTo(372,80.6);
	ctx.lineTo(372.35,68.85);
	ctx.lineTo(374.35,66);
	ctx.lineTo(435.85,57.85);
	ctx.lineTo(447.75,58.1);
	ctx.lineTo(444.85,-0.1499858);
	ctx.lineTo(459.85,-0.1499858);
	ctx.closePath();
	ctx.moveTo(421.1,194.85);
	ctx.lineTo(422.25,194.6);
	ctx.lineTo(422.25,180);
	ctx.lineTo(424.25,181.1);
	ctx.lineTo(424.35,194.35);
	ctx.lineTo(426,195.1);
	ctx.lineTo(425.5,189.25);
	ctx.lineTo(427.25,188.5);
	ctx.lineTo(427.75,181.1);
	ctx.lineTo(429.1,179.85);
	ctx.lineTo(429.5,188.75);
	ctx.lineTo(431.5,188.85);
	ctx.lineTo(431.35,181.85);
	ctx.lineTo(432.85,181.85);
	ctx.lineTo(430.6,160);
	ctx.bezierCurveTo(430.6,159.5,426.434,163.167,418.1,171);
	ctx.lineTo(427,160);
	ctx.lineTo(415.5,160.35);
	ctx.lineTo(394.5,165.6);
	ctx.lineTo(395.25,215);
	ctx.bezierCurveTo(395.283,215.033,398.75,215.25,405.65,215.65);
	ctx.bezierCurveTo(409.116,215.8492,412.566,216.049,416,216.25);
	ctx.lineTo(412.85,211.85);
	ctx.lineTo(421.35,202.75);
	ctx.lineTo(421.1,194.85);
	ctx.closePath();
	ctx.moveTo(438.1,160.85);
	ctx.lineTo(434.35,160.85);
	ctx.lineTo(435.35,182);
	ctx.bezierCurveTo(435.35,181.933,435.401,181.933,435.5,182);
	ctx.bezierCurveTo(435.533,182.033,435.566,182.067,435.6,182.1);
	ctx.lineTo(437.6,181.6);
	ctx.lineTo(436.6,174);
	ctx.lineTo(438.5,174);
	ctx.lineTo(438.1,160.85);
	ctx.closePath();
	ctx.moveTo(393.35,103.85);
	ctx.lineTo(386.5,104.1);
	ctx.lineTo(387.25,118.35);
	ctx.bezierCurveTo(387.25,118.317,388.316,118.25,390.45,118.1499);
	ctx.bezierCurveTo(391.483,118.0839,392.533,118.0329,393.599,117.9999);
	ctx.lineTo(393.35,103.85);
	ctx.closePath();
	ctx.moveTo(386,87.85);
	ctx.lineTo(392.25,87.5);
	ctx.lineTo(392,73.75);
	ctx.lineTo(385.85,74.5);
	ctx.lineTo(386,87.85);
	ctx.closePath();
	ctx.moveTo(392.1,89.6);
	ctx.lineTo(386.25,90);
	ctx.lineTo(386.75,102.25);
	ctx.lineTo(392.6,102.5);
	ctx.lineTo(392.1,89.6);
	ctx.closePath();
	ctx.moveTo(398.75,72.75);
	ctx.lineTo(394.75,73.35);
	ctx.lineTo(396.1,117.85);
	ctx.lineTo(400,117.85);
	ctx.lineTo(398.75,72.75);
	ctx.closePath();
	ctx.moveTo(430.35,69.5);
	ctx.lineTo(416.75,70.6);
	ctx.lineTo(418.5,116.75);
	ctx.lineTo(432.6,115.35);
	ctx.lineTo(430.35,69.5);
	ctx.closePath();
	//
	var pattern = ctx.createPattern(img_ruins.pic, "no-repeat");
	ctx.fillStyle = pattern;
	ctx.fill();
	//
	ctx.restore();
}

function drawContour(ctx,obj)
{
	ctx.save();
	ctx.globalAlpha = contourAlpha;
	ctx.translate(obj.x, obj.y)
	ctx.scale (obj.scale, obj.scale);
	//
    ctx.beginPath();
	ctx.moveTo(181.25,49.4);
	ctx.lineTo(204.45,50.35);
	ctx.lineTo(208.78,54.554);
	ctx.lineTo(209.2,60.651);
	ctx.lineTo(213,66.2011);
	ctx.lineTo(212.9,69.3501);
	ctx.lineTo(210.25,69.4511);
	ctx.lineTo(210.95,72.1511);
	ctx.lineTo(211.2,76);
	ctx.lineTo(208.099,80.9);
	ctx.lineTo(204.349,83.549);
	ctx.lineTo(203.5488,84.849);
	ctx.lineTo(201.1,85);
	ctx.lineTo(199.6508,87.6);
	ctx.lineTo(196.2,88.2);
	ctx.lineTo(195.7,89.45);
	ctx.lineTo(191.95,90.849);
	ctx.lineTo(191.6498,92.299);
	ctx.lineTo(188,92.9);
	ctx.lineTo(187.55,94.599);
	ctx.lineTo(183.4502,94.95);
	ctx.lineTo(183,95.8);
	ctx.lineTo(97.2,100.95);
	ctx.lineTo(79.8,101.1);
	ctx.lineTo(75.25,100);
	ctx.lineTo(63.8,95.35);
	ctx.lineTo(63.094,95.951);
	ctx.lineTo(60.49,96.201);
	ctx.lineTo(59.844,95.3009);
	ctx.lineTo(58.196,95.1008);
	ctx.lineTo(57.8,95.9);
	ctx.lineTo(55.8,96.299);
	ctx.lineTo(54.25,95.599);
	ctx.lineTo(52.2,95.799);
	ctx.lineTo(51.7,96.549);
	ctx.lineTo(49.4,96.9);
	ctx.lineTo(48.9,95.95);
	ctx.lineTo(47.1,95.95);
	ctx.lineTo(46.65,97.1);
	ctx.lineTo(43.4,97);
	ctx.lineTo(42.946,95.9);
	ctx.lineTo(41.24,95.9);
	ctx.lineTo(40.5,97.35);
	ctx.lineTo(36.9,97);
	ctx.lineTo(36.4,95.9);
	ctx.lineTo(34.25,96.3);
	ctx.lineTo(30.2,95.55);
	ctx.lineTo(26.55,94.4);
	ctx.lineTo(15.9,88.7);
	ctx.lineTo(7.801,83.3);
	ctx.lineTo(4.701,79.85);
	ctx.lineTo(3.15,78.95);
	ctx.lineTo(2.65,77.45);
	ctx.lineTo(3.7,76.85);
	ctx.lineTo(2.8003,74.75);
	ctx.lineTo(3.1504,72.4);
	ctx.lineTo(1.9,71.3);
	ctx.lineTo(3.95,70);
	ctx.lineTo(4.95,65.15);
	ctx.lineTo(7.2,63.85);
	ctx.lineTo(6.85,63.1);
	ctx.bezierCurveTo(6.183,63.167,5.449,63.333,4.6495,63.6);
	ctx.bezierCurveTo(3.0494,64.134,1.8995,64.967,1.1993,66.1);
	ctx.lineTo(-0.15,64.9);
	ctx.bezierCurveTo(0.65,63.633,2.117,62.406,4.25,61.2);
	ctx.bezierCurveTo(8.517,58.804,14.017,57.75,20.75,58.054);
	ctx.lineTo(21.15,54.304);
	ctx.lineTo(22.547,52.85);
	ctx.lineTo(28.348,55.5);
	ctx.bezierCurveTo(32.15,54.134,36.416,52.833,41.15,51.6);
	ctx.bezierCurveTo(50.65,49.167,57.75,48.35,62.45,49.15);
	ctx.lineTo(64.5,46.85);
	ctx.lineTo(70.5,45.9);
	ctx.lineTo(69,44.95);
	ctx.lineTo(69,40);
	ctx.lineTo(48.9,38.45);
	ctx.lineTo(47.35,39.75);
	ctx.lineTo(31.25,39.8);
	ctx.lineTo(31.1,32.094);
	ctx.lineTo(47.25,31);
	ctx.lineTo(49.15,33.05);
	ctx.lineTo(70.9,32.65);
	ctx.lineTo(71.75,31.598);
	ctx.lineTo(70.05,27.9);
	ctx.lineTo(70.05,26.047);
	ctx.lineTo(70.75,25.196);
	ctx.lineTo(77.4,24.645);
	ctx.lineTo(77.31,23.395);
	ctx.lineTo(78.51,22.696);
	ctx.lineTo(80.01,23.645);
	ctx.lineTo(82.31,22.696);
	ctx.lineTo(82.22,21.094);
	ctx.lineTo(83.6502,21.094);
	ctx.lineTo(84.2501,22.544);
	ctx.lineTo(88.3501,22.594);
	ctx.lineTo(88.3501,20.493);
	ctx.lineTo(90.61,20.294);
	ctx.lineTo(91.2,22.442);
	ctx.lineTo(100.95,21.993);
	ctx.lineTo(101.3,23.89);
	ctx.lineTo(104.35,25.34);
	ctx.lineTo(135.6,24.79);
	ctx.lineTo(140,33.69);
	ctx.lineTo(144.7,38.84);
	ctx.lineTo(145.7,38.84);
	ctx.lineTo(146.0498,33.29);
	ctx.lineTo(148.78,32.99);
	ctx.lineTo(150.35,38.74);
	ctx.lineTo(151.3,39);
	ctx.lineTo(151.12,40.65);
	ctx.lineTo(146.3,42);
	ctx.lineTo(148.05,44.6);
	ctx.lineTo(147.9502,46.7);
	ctx.lineTo(147.0992,47.906);
	ctx.lineTo(149.4,46.7);
	ctx.lineTo(174.049,47.906);
	ctx.lineTo(181.25,49.4);
	ctx.closePath();
	//
	ctx.strokeStyle = "red";
	ctx.lineWidth= 1.5;
	ctx.stroke()

	ctx.restore();
}
//
function drawWheel(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(obj.x, obj.y)
	ctx.scale (0.75, 0.9);
	ctx.rotate(radian(obj.rot));
	ctx.translate(- obj.pic.width/2, - obj.pic.height/2);
	//
    ctx.drawImage(obj.pic, 0, 0, obj.pic.width, obj.pic.height);
	//
	ctx.restore();
}
function drawWheel2(ctx, obj)
{
	ctx.save();
	ctx.globalAlpha = obj.alpha;
	ctx.translate(obj.x, obj.y)
	ctx.scale (0.72, 0.87);
	ctx.rotate(radian(obj.rot));
	ctx.translate(- obj.pic.width/2, - obj.pic.height/2);
	//
    ctx.drawImage(obj.pic, 0, 0, obj.pic.width, obj.pic.height);
	//
	ctx.restore();
}
function drawTrack(ctx, obj)
{
	ctx.save()
	ctx.globalAlpha = obj.alpha;
	ctx.scale (obj.scale, obj.scale);
	ctx.translate(img_tank.x, img_tank.y)
	//
	//left track
	ctx.beginPath();
	ctx.moveTo(3.2,71.2);
	ctx.bezierCurveTo(2.133,75.766,3.033004,79.066,5.9,81.099);
	ctx.bezierCurveTo(10.467,84.366,18.967,89.033,31.4,95.099);
	ctx.lineTo(34.25,95.099);
	ctx.lineTo(11.149,78.599);
	ctx.bezierCurveTo(10.517,78.1331,10.0328,77.349,9.7,76.2491);
	ctx.bezierCurveTo(9.067,74.049,9.5828,71.4161,11.25,68.349);
	ctx.lineTo(8.9,65.1);
	ctx.lineTo(5.65,65);
	ctx.lineTo(3.2,71.2);
    ctx.closePath()
    ctx.clip();
    //
    
    ctx.translate(obj.x, obj.y)
    var pattern = ctx.createPattern(img_track.pic, "repeat");
	ctx.fillStyle = pattern;
    ctx.fillRect(0,0,300,100)
    ///
    ctx.restore()

	//right track
	ctx.save()
	ctx.globalAlpha = obj.alpha;
	ctx.scale (obj.scale, obj.scale);
	ctx.translate(img_tank.x, img_tank.y)
	//
	ctx.beginPath();
    ctx.moveTo(43.3,63.85);
	ctx.bezierCurveTo(40.967,65.85,39.844,68.5671,39.946,72);
	ctx.bezierCurveTo(40.083,76.533,40.666,79.667,41.696,81.4);
	ctx.bezierCurveTo(42.99,83.7,45.967,85.9,50.594,88);
	ctx.bezierCurveTo(57.166,91,66.583,94.533,78.85,98.6);
	ctx.lineTo(79.19,96.5);
	ctx.lineTo(55.1,83);
	ctx.bezierCurveTo(53.30004,81,52.083,78.684,51.45,76.05);
	ctx.bezierCurveTo(50.25,70.817,52.633,66.634,58.6,63.5);
	ctx.lineTo(58.45,61.85);
	ctx.lineTo(46.85,61.85);
	ctx.lineTo(43.3,63.85);
	ctx.closePath();
	///
    ctx.clip();

    //
    ctx.translate(obj.x, obj.y)
    var pattern = ctx.createPattern(img_track.pic, "repeat");
	ctx.fillStyle = pattern;
    ctx.fillRect(0,0,300,100)
    //
    ctx.restore()
}
