(function() {
    var WSJVideo = function(element, settings) {
        this._self = this;
        this._version = '3.7.64';
        this._container = element;
        this._height = this._container.offsetHeight;
        this._width = this._container.offsetWidth;
        this._isVertical = ((this._width / this._height) < 1);
        this._videoId = this._container.getAttribute("id");
        this._video;
		this._textTrack;
        this._audio;
        this._audioThumb;
        this._vrWrapper;
        this._vrComponents;
        this._hlsPlayer;
        this._wrapper;
        this._controls;
        this._context;
        this._videodata;
        this._hlsAvailable = false;
        this._isFullScreen = false;
        this._isAudio = false;
        this._currentTime = 0;
        this._sizeTimer;
        this._volume = 1;
        this._muted = false;
        this._hlsLoadAttempted = false;
        this.parseXml, this._availableCaptions = [];
		this._setMuted = false;
        this._fields = 'fields=type,video174kMP4Url,video320kMP4Url,video664kMP4Url,video1264kMP4Url,video1864kMP4Url,video2564kMP4Url,hls,videoMP4List,adZone,thumbnailList,guid,state,secondsUntilStartTime,author,description,name,linkURL,videoStillURL,duration,videoURL,adCategory,catastrophic,linkShortURL,doctypeID,youtubeID,titletag,rssURL,wsj-section,wsj-subsection,allthingsd-section,allthingsd-subsection,sm-section,sm-subsection,provider,formattedCreationDate,keywords,keywordsOmni,column,editor,emailURL,emailPartnerID,showName,omniProgramName,omniVideoFormat,linkRelativeURL,touchCastID,omniPublishDate,audioURL,adTagParams,gptCustParams,format,forceClosedCaptions,captionsVTT';
        this._isIpad, this._isIphone, this._isAndroid, this._isIE, this._isMobile = false, this._androidV, this._isTwitter, this._isOperaMini, this._isChrome, this._safariV = -1, this._safariInit = false, this._safariHandler;
		var ua = window.navigator.userAgent.toLowerCase(),
            myNav = navigator.userAgent.toLowerCase();
        this._isIpad = ua.match(/(ipad)/i), this._isIpad = null == this._isIpad ? !1 : !0, this._isIphone = ua.match(/(iphone)/i), this._isIphone = null == this._isIphone ? !1 : !0, this._isAndroid = ua.match(/(android)/i), this._isAndroid = null === this._isAndroid || void 0 == typeof this._isAndroid ? !1 : !0, this._androidV = parseFloat(ua.slice(ua.indexOf("android") + 8)), this._isIE = -1 != myNav.indexOf("msie") ? parseInt(myNav.split("msie")[1]) : !1, this._isOperaMini = ua.match(/(Android; Opera Mini)/i), this._isChrome = ua.match(/(Chrome)/i);
        this._iOS = parseFloat(
                ('' + (/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0,''])[1])
                    .replace('undefined', '3_2').replace('_', '.').replace('_', '')
            ) || 0;
        if (!this._isIE) {
            if (!!(navigator.userAgent.match(/Trident/) && !navigator.userAgent.match(/MSIE/))) {
                this._isIE = 11;
            }
        }
        this._isSafariMac = (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Mac') != -1 && navigator.userAgent.indexOf('Chrome') == -1);
		try{if(this._isSafariMac)
			this._safariV = parseInt(ua.match("version[ /]+[0-9]*")[0].split("/")[1]);
		}catch(e){this._safariV = -1;}
        this._isSafari = (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1);
        this._isMobile = Boolean(this._isAndroid || myNav.match(/webos/i) || this._isIphone || this._isIpad || myNav.match(/ipod/i) || myNav.match(/blackberry/i) || myNav.match(/windows phone/i));

        if (ua == 'mozilla/5.0 (x11; linux x86_64; rv:45.0) gecko/20100101 firefox/45.0') { // bot blocking
            this._container.innerHTML = '<div class="videoErrorMsg"><strong>Playback on your browser is not currently supported.</strong></div>';
            return;
        }

        this._bitrateList, this._selectedBitrate = "video664kMP4Url", this._skipToTime = 0;

        // Controls //
        this._playBtn;
        this._playOverlay;
        this._buffering;
        this._timeDisplay;
        this._fullscreenBtn;
        this._volumeBtn;
        this._ccBtn;
        this._ccList;
        this._fbBtn;
        this._twitterBtn;
        this._langSelected = '', this._currentTrack;
        this._bitList;
        this._volumeBtnGraphics;
        this._volumeSlider;
        this._scrubBar;
        this._scrubProgress;
        this._adProgress;
        this._adsSkipButton;
        this._scrubLoaded;
        this._thumb;
        this._thumbContent;
        this._thumbHint;
        this._thumbDuration;
        this._startClick;
        this._shareScreen;
        this._clickForSoundScreen;
        this._ajax = {};
        this._configLoaded = !("playerid" in settings);
        this._futureTimer, this._startTime;
        this._videoMsg;
        this._isStalled = false;

        // Ads //
        this._adPaused = true;
        this._adStarted = false;
        this._adsManager;
        this._adsLoader;
        this._adsBlocked = false;
        this._adContainer;
        this._adDisplayContainer;
        this._adMode = false;
        this._adDuration = 0;
        this._adPlayNumber = 1;
        this._adTimer;
		this._adTimeoutTimer;
		this._adTimeoutFail = false;
		this._adResponseTimeout = 5000;
        this._currentAd;
        this._adInfo;
        this._adId;
        this._adTagUsed = "none"; // for diagonstics
        this._captionsLangs = {
            'eng': 'English',
            'spa': 'Spanish',
            'jap': 'Japanese',
            'por': 'Portuguese'
        };
        this.BUCKET_HASH_MAP = [
            '2qgQ1WCa3A', // 0
            'ixi4E5ylqa', // 1
            '830nwKog3K', // 2
            'K8ZnHJ5Uyn', // 3
            '91GjW1q7Zg', // 4
            'rGgki1wrhs', // 5
            'q85AaJVP78', // 6
            '1p6sdUNJWD', // 7
            '63L1D4y2F9', // 8
            'HY0f8Of9M1'  // 9
        ];
        this._skipAvailable = false;
        this._adCountdownText;
        this._videoSkipIcon;

        // Tracking //
        this._trackingMilestones = [false, false, false, false];
        this._moatManager = false;
        this._moatAdManager = false;
        this._pingMilestone = -1;
        this._isChained = false;
        this._isLive = false;
        this._contentStartTracked = false;
        this._comscoreC3 = "13047035";
        this._comscoreMeta = {
            ns_st_ci: "", // Content Asset ID
            c3: this._comscoreC3, // Dictionary Classification Value
            c4: "*null", // Unused Dictionary Classification Value
            c6: "*null" // Unused Dictionary Classification Value
        };
        this._comscoreTag = new ns_.StreamingTag({
            customerC2: '6035148'
        });
        this._adErrorTracked = true;
        this._adErrorEvent = false;
        this._tObject = {};
        this._pageEvents = "";
        this._events = {
            // 		Start,clicked away, ad error, playback error, ads disabled, ping, ad start, ad complete, editorial start, 25%, 50%, 75%, 100%, ads not supported, ad error during playback, 116 118 catastrophic ad Start, 117 119 blank ad start
            'video': ['event36', 'event40', 'event41', 'event42', 'event46', 'event67', 'event73', 'event74', 'event96', 'event97', 'event98', 'event99', 'event100', 'event113', 'event115', 'event116', 'event117'],
            'audio': ['event101', 'event102', 'event113', 'event104', 'event105', 'event67', 'event106', 'event107', 'event108', 'event109', 'event110', 'event111', 'event112', 'event113', 'event114', 'event118', 'event119']
        };
        this._currentEvents = this._events.video; //this._currentEvents[15]

        // state //
        this._contentInitialized = false;
        this._adsRequestPending = false;
        this._playRequested = false;
        this._clickForSoundEnabled = false;

        // flash crap //
        this._flash;
        this._flashContainer;
        this._flashInit = false;
        this._flashEvents;
        this._fPlaying = false;

        this._bucket = "";

        var defaults = {
            autoplay: false,
			loop:false,
            adsEnabled: true,
            shareEnabled: true,
            allowPlayerPopup: false,
            chainVideos: false,
            disableHtmlControls: false,
            shareDomain: null,
            api: 'https://video-api.wsj.com/api-video/',
            clickForSound: false,
            resetOnComplete: false,
            type: '',
            query: '',
            contentType: 'article',
            disableEndscreen: false,
            noThumb: false,
            larsId: '91',
            larsAdId: '1259',
            disableSeekBarThumbnails: true,
            allowFullScreen: true,
            adTag: '',
            useHttps: true,
            count: 1,
            moduleId: '',
            adZone: '',
            lnid: '',
            plid: '',
            msrc: null,
            collapseable: false,
            disableDVR: null,
            maxBitrateIndex: null,
            enableCaptions: true,
            loaderThumb: false,
            adSkipTime: 15,
            playlist: null,
            suggestionsType: "column",
            suggestionsQuery: '',
            suggestionsGroupId: '',
            sAccount: false,
            imaLibrary: 'https://imasdk.googleapis.com/js/sdkloader/ima3.js',
            site: '',
            directLinks: false,
            playlistQuery: '',
            touchCastID: null,
            relativeLinks: false,
            disableChainPlay: false,
            thumb: null,
            callback: null,
            fireTv: false,
            useHLS: true,
            startFullScreen: false,
            playInline:(!this._isVertical && this._iOS >= 10 && this._isIphone),
			suppressHeadline:false
        };

        this.hlsConfig = {
            autoStartLoad: true,
            startPosition: -1,
            capLevelToPlayerSize: true,
            debug: false,
            initialLiveManifestSize: 1,
            maxBufferLength: 10,
            maxMaxBufferLength: 10,
            maxBufferSize: 60 * 1000 * 1000,
            maxBufferHole: 0.5,
            maxSeekHole: 2,
            lowBufferWatchdogPeriod: 0.5,
            highBufferWatchdogPeriod: 3,
            nudgeOffset: 0.1,
            nudgeMaxRetry: 3,
            maxFragLookUpTolerance: 0.2,
            liveSyncDurationCount: 3,
            liveMaxLatencyDurationCount: 10,
            enableWorker: true,
            enableSoftwareAES: true,
            manifestLoadingTimeOut: 10000,
            manifestLoadingMaxRetry: 6,
            manifestLoadingRetryDelay: 500,
            manifestLoadingMaxRetryTimeout: 64000,
            startLevel: undefined,
            levelLoadingTimeOut: 10000,
            levelLoadingMaxRetry: 6,
            levelLoadingRetryDelay: 500,
            levelLoadingMaxRetryTimeout: 64000,
            fragLoadingTimeOut: 20000,
            fragLoadingMaxRetry: 6,
            fragLoadingRetryDelay: 500,
            fragLoadingMaxRetryTimeout: 64000,
            startFragPrefech: false,
            appendErrorMaxRetry: 3,
            enableCEA708Captions: true,
            stretchShortVideoTrack: false,
            forceKeyFrameOnDiscontinuity: true,
            abrEwmaFastLive: 5.0,
            abrEwmaSlowLive: 9.0,
            abrEwmaFastVoD: 4.0,
            abrEwmaSlowVoD: 15.0,
            abrEwmaDefaultEstimate: 500000,
            abrBandWidthFactor: 0.8,
            abrBandWidthUpFactor: 0.7,
            minAutoBitrate: 0
        };
        var url = (window.location != window.parent.location) ? document.referrer : document.location.href;
		
        if(this._isIphone && !defaults.playInline)
            defaults.disableHtmlControls = true;
        if(settings.clickForSound == false)
            settings.clickForSound = "disabled";

        this._settings = this.extend(defaults, settings);

        if (navigator.userAgent.indexOf('amazon-fireos') != -1) { // allows testing amazon fire on desktop
            this._settings.useHLS = false;
            this._isMobile = false;
        } else {
            this._settings.fireTv = false;
        }
		if (this._isMobile){
			if(this._settings.autoplay == "mobile"){ // Forces inline autoplay on mobile but prevents ads
				this._settings.autoplay = true;
				this._settings.adsEnabled = false;
				this._settings.playInline = true;
                if(this._settings.clickForSound !== "disabled")
				    this._settings.clickForSound = true;
			}else{
				this._settings.autoplay = false;
			}
		}
        if (!this._isMobile)
            this._settings.startFullScreen = false;
        if (this._isMobile || this._isIE || this._isSafariMac) {
            this._settings.useHLS = false;
        }
		if (this._isIE) {
            this._settings.enableCaptions = false;
        }
        var svgSupported = true;

        if(this._iOS && this._iOS < 10 || typeof SVGRect == "undefined") { // IOS 9 cannot render SVG
            svgSupported = false;
        }

        // CONTROLS //
        this._graphics = [];
        // this._graphics['play-overlay'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="80px" height="80px" viewBox="0 0 80 80" enable-background="new 0 0 80 80" xml:space="preserve"><path opacity="0.5" fill="#1C75BC" d="M0,40c0-11.042,3.906-20.469,11.719-28.281S28.959,0,40,0s20.468,3.906,28.281,11.719 S80,28.958,80,40s-3.906,20.469-11.719,28.281S51.042,80,40,80s-20.469-3.906-28.281-11.719S0,51.042,0,40L0,40z"/><path fill="#FFFFFF" d="M27.443,16.19l36.168,24.076L27.443,64.395V16.19z"/></svg>';
        this._graphics['pause'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g><path transform="translate(15 16)" id="ytp-11_1_" fill="#FFFFFF" d="M-7.5-8h6V8h-6 M1.5-8h6V8h-6"></path></g></svg>';
        this._graphics['play'] = '<svg version="1.1" id="Layer_2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g><polygon transform="translate(16 16)" fill="#FFFFFF" points="-7.5,-8 -7.5,8 7.5,0"></polygon></g></svg>';
        this._graphics['fullscreen'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path fill="#FFFFFF" d="M9,20H6v6h7v-3H9V20z M6,15h3v-4h4V8H6V15z M23,23h-4v3h7v-6h-3V23z M19,8v3h4v4h3V8H19z"/></svg>';
        this._graphics['exit-fullscreen'] = '<svg shape-rendering="optimizeSpeed" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path fill="#FFFFFF" d="M10,24h3v-6H6v3h4V24z M13,8h-3v4H6v3h7V8z M22,21h4v-3h-6.715v6H22V21z M26,15v-3h-4V8h-2.715v7H26z"/></svg>';
        this._graphics['volume-mute'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g><g><path fill="#FFFFFF" d="M6,19h3.635l7.615,5l0,0V8l0,0l-7.615,5H6"/></g><polygon fill="#FFFFFF" points="26,13.434 25.066,12.5 22.5,15.066 19.934,12.5 19,13.434 21.566,16 19,18.566 19.934,19.5 22.5,16.934 25.066,19.5 26,18.566 23.433,16"/></g></svg>';
        this._graphics['volume-full'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g><g><path fill="#FFFFFF" d="M6,19h3.635l7.615,5l0,0V8l0,0l-7.615,5H6"/></g></g><path fill="#FFFFFF" d="M23.61,8.833c-0.083-0.083-0.219-0.083-0.302,0L21.9,10.241c-0.04,0.04-0.063,0.095-0.063,0.151s0.022,0.11,0.063,0.15c1.42,1.42,2.202,3.304,2.202,5.307c0,2.002-0.782,3.887-2.202,5.307c-0.04,0.04-0.063,0.094-0.063,0.151c0,0.056,0.022,0.11,0.063,0.149l1.408,1.409c0.04,0.04,0.094,0.063,0.151,0.063c0.057,0,0.11-0.022,0.15-0.063c1.877-1.877,2.911-4.369,2.911-7.017S25.487,10.71,23.61,8.833z"/><path fill="#FFFFFF" d="M20.037,11.853c-0.052,0-0.101,0.021-0.136,0.057l-1.269,1.269c-0.036,0.036-0.057,0.084-0.057,0.136c0,0.051,0.021,0.1,0.057,0.136c0.642,0.642,0.996,1.494,0.996,2.4c0,0.905-0.354,1.758-0.996,2.4c-0.036,0.036-0.057,0.085-0.057,0.136s0.021,0.1,0.057,0.136l1.269,1.269c0.074,0.074,0.196,0.074,0.271,0c1.054-1.055,1.635-2.453,1.635-3.94c0-1.486-0.581-2.886-1.635-3.94C20.137,11.873,20.087,11.854,20.037,11.853z"/></svg>';
        this._graphics['loading'] = '<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path opacity="0.4" fill="#000000" enable-background="new" d="M20.266,4.773c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.945,14.946,14.945c8.253,0,14.945-6.689,14.945-14.945C35.211,11.465,28.52,4.773,20.266,4.773z M20.266,31.354c-6.425,0-11.634-5.209-11.634-11.634S13.841,8.085,20.266,8.085s11.632,5.209,11.632,11.634S26.691,31.354,20.266,31.354z"/><path fill="#009EFF" d="M9.375,15.219l-3.031-1.313c-1.013,2.329-1.561,4.873-1.25,7.578l-0.101,0.01l3.366-0.354l-0.076-0.025C8.234,18.984,8.587,17.033,9.375,15.219z"></path></svg>';
        this._graphics['share'] = '<svg version="1.1" id="Layer_2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g><path fill="#FFFFFF" d="M21,23.613H8V12.386h2.995c0,0,0.733-1.231,2.224-2.387H7c-0.552,0-1,0.531-1,1.193v13.614 C6,25.463,6.448,26,7,26h15c0.552,0,1-0.531,1-1.193v-6.811l-2,1.962V23.613z M19.334,13.998v3.992L26,12.023L19.334,6v3.73 C11.271,9.73,11,19.995,11,19.995C13.281,15.528,14.959,13.998,19.334,13.998z"/></g></svg>';
        this._graphics['cc'] = '<svg width="100%" height="100%" viewBox="0 0 32 32"  enable-background="new 0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g><path id="svg_1" d="m6,10.6l20,0l0,12l-20,0l0,-12zm9.435,8.215l-0.67,0.18l-0.809,0.068c-0.787,-0.008 -1.395,-0.231 -1.827,-0.67s-0.651,-1.044 -0.657,-1.814c0.017,-0.846 0.255,-1.478 0.716,-1.895c0.461,-0.417 1.046,-0.625 1.757,-0.625c0.318,0.003 0.601,0.032 0.848,0.086l0.631,0.196l0.37,-1.412c-0.16,-0.084 -0.404,-0.161 -0.734,-0.228c-0.33,-0.068 -0.725,-0.104 -1.185,-0.108c-1.208,0.008 -2.209,0.365 -3.003,1.069c-0.794,0.706 -1.206,1.711 -1.235,3.018c0.001,1.109 0.343,2.022 1.024,2.738c0.681,0.718 1.695,1.088 3.041,1.113c0.473,-0.005 0.882,-0.043 1.228,-0.112c0.346,-0.068 0.599,-0.145 0.76,-0.224l-0.255,-1.38zm6.644,0l-0.669,0.18l-0.81,0.068c-0.787,-0.008 -1.396,-0.231 -1.827,-0.67c-0.433,-0.438 -0.651,-1.044 -0.657,-1.814c0.016,-0.846 0.255,-1.478 0.716,-1.895c0.462,-0.417 1.048,-0.625 1.757,-0.625c0.317,0.003 0.602,0.032 0.849,0.086l0.631,0.196l0.37,-1.412c-0.16,-0.084 -0.404,-0.161 -0.733,-0.228c-0.33,-0.068 -0.726,-0.104 -1.186,-0.108c-1.208,0.008 -2.209,0.365 -3.003,1.069c-0.795,0.706 -1.205,1.711 -1.235,3.018c0.002,1.109 0.343,2.022 1.024,2.738c0.682,0.718 1.695,1.088 3.041,1.113c0.472,-0.005 0.883,-0.043 1.229,-0.112c0.346,-0.068 0.599,-0.145 0.759,-0.224l-0.256,-1.38z" fill="#FFFFFF"/></g></svg>';
        this._graphics['bitrate'] = '<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Layer_1"></g><g id="Layer_2"><g><path id="ytp-svg-39_1_" fill="#FFFFFF" d="M26,17.5v-3h-2.655c-0.189-0.956-0.567-1.845-1.089-2.633L24.122,10L22,7.878 l-1.866,1.866c-0.789-0.521-1.678-0.899-2.634-1.1V6h-3v2.645c-0.967,0.2-1.855,0.578-2.645,1.1L9.988,7.878L7.866,10l1.867,1.867 c-0.522,0.788-0.9,1.677-1.089,2.633H6v3h2.645c0.2,0.956,0.578,1.845,1.1,2.633l-1.878,1.878l2.122,2.122l1.878-1.877 c0.789,0.521,1.678,0.899,2.634,1.089V26h3v-2.655c0.956-0.189,1.833-0.567,2.622-1.089L22,24.133l2.122-2.122l-1.878-1.878 c0.522-0.788,0.9-1.677,1.101-2.633H26z M16,20.5c-2.488,0-4.5-2.022-4.5-4.5c0-2.489,2.012-4.5,4.5-4.5 c2.478,0,4.5,2.011,4.5,4.5C20.5,18.478,18.478,20.5,16,20.5L16,20.5z"/></g></g></svg>';
        this._graphics['click-for-sound'] = '<svg height="36px" version="1.1" viewBox="0 0 36 36" width="36px"><use class="ytp-svg-shadow" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ytp-svg-13"></use><path class="ytp-svg-fill" d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z M19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z" id="ytp-svg-13"></path><svg class="ytp-svg-sound-mute-group" style="opacity: 0;"><use class="ytp-svg-shadow" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ytp-svg-14"></use><path class="ytp-svg-fill" d="M 26.11,15.73 24.85,14.5 22.52,16.76 20.20,14.5 18.94,15.73 21.26,18 18.94,20.26 20.20,21.5 22.52,19.23 24.85,21.5 26.11,20.26 23.79,18 l 2.32,-2.26 0,0 z" id="ytp-svg-14"></path></svg></svg>';
        this._graphics['share-fb'] = '<a id="share-link-fb-'+this._videoId+'"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="-19.5 60.5 32 32" enable-background="new -19.5 60.5 32 32" xml:space="preserve"><g id="Page-1"><g id="facebook"><path id="Path" fill="#FFFFFF" d="M1.166,76.504h-2.714V86h-4.034v-9.496H-7.5v-3.349h1.918v-2.176c0-1.551,0.758-3.979,4.064-3.979h2.987v3.267h-2.183c-0.452-0.024-0.838,0.313-0.864,0.755c-0.003,0.055,0,0.107,0.008,0.158v1.976H1.5L1.166,76.504z"/></g></g></svg></a>';
        this._graphics['share-twitter'] = '<a id="share-link-twitter-'+this._videoId+'" target="_blank"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><g id="Logo__x2014__FIXED"><g><path fill="#FFFFFF" d="M12.837,25.5c7.613,0,11.776-7.313,11.776-13.642c0-0.206,0-0.411-0.006-0.618c0.807-0.673,1.51-1.523,2.065-2.486c-0.742,0.384-1.542,0.635-2.382,0.757c0.855-0.59,1.511-1.533,1.824-2.655c-0.799,0.553-1.687,0.944-2.632,1.159C22.726,7.08,21.652,6.5,20.464,6.5c-2.284,0-4.141,2.15-4.141,4.796c0,0.375,0.042,0.739,0.106,1.095c-3.439-0.196-6.49-2.113-8.533-5.011C7.542,8.09,7.34,8.912,7.34,9.792c0,1.664,0.734,3.132,1.841,3.991c-0.679-0.027-1.315-0.243-1.874-0.598c0,0.019,0,0.038,0,0.065c0,2.318,1.429,4.264,3.318,4.703c-0.347,0.111-0.71,0.168-1.089,0.168c-0.266,0-0.525-0.025-0.775-0.084c0.525,1.908,2.059,3.292,3.867,3.33c-1.421,1.29-3.206,2.056-5.142,2.056c-0.331,0-0.663-0.021-0.985-0.065C8.324,24.705,10.504,25.5,12.837,25.5"/></g></g></svg></a>';
        this._graphics['share2'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path fill="#FFFFFF" d="M21.667,26H6V8.5h15.667V26z M7.294,24.555h13.08V9.945H7.294V24.555z"/><path fill="#FFFFFF" d="M10.432,21.397c0,0,0.447-6.415,3.11-8.591c2.898-2.367,5.095-1.782,5.095-1.782s0.149,0.042-0.262-1.738c-0.425-1.842-0.798-2.441-0.336-2.253c0.462,0.188,7.691,5.727,7.691,5.727s0.546,0.751,0.084,1.127c-0.462,0.376-7.523,5.774-7.523,5.774s-0.672,0.281-0.336-0.845c0.336-1.127,0.631-2.488,0.589-2.911l-0.042-0.423c0,0-2.064-0.333-3.929,1C13.04,17.577,10.432,21.397,10.432,21.397"/></svg>';
        if(this._iOS && this._iOS < 10 || typeof SVGRect == "undefined"){ // IOS 9 cannot render SVG
            this._graphics['play-overlay'] = '<img style="margin:0 auto;" height="50" width="50" src="' + this._settings.api + 'player/v3/css/play-overlay.png" />';
        }else{
            this._graphics['play-overlay'] = '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 52 52" enable-background="new 0 0 52 52" xml:space="preserve"><g id="XMLID_2_" opacity="1"><path fill="#FFFFFF" d="M26,51.5C11.9,51.5,0.5,40.1,0.5,26C0.5,11.9,11.9,0.5,26,0.5c14.1,0,25.5,11.4,25.5,25.5C51.5,40.1,40.1,51.5,26,51.5z"/><path fill="#FFFFFF" d="M26,1c13.8,0,25,11.2,25,25S39.8,51,26,51S1,39.8,1,26S12.2,1,26,1 M26,0C11.7,0,0,11.7,0,26s11.7,26,26,26 s26-11.7,26-26S40.3,0,26,0L26,0z"/></g><polygon id="XMLID_1_" fill="#333333" points="19.6,37.5 19.6,14.5 37.8,25.5 "/></svg>';
        }
        // adding ajax //
        this._ajax.x = function() {
            if (typeof XMLHttpRequest !== 'undefined') {
                return new XMLHttpRequest();
            }
            var versions = [
                "MSXML2.XmlHttp.6.0",
                "MSXML2.XmlHttp.5.0",
                "MSXML2.XmlHttp.4.0",
                "MSXML2.XmlHttp.3.0",
                "MSXML2.XmlHttp.2.0",
                "Microsoft.XmlHttp"
            ];

            var xhr;
            for (var i = 0; i < versions.length; i++) {
                try {
                    xhr = new ActiveXObject(versions[i]);
                    break;
                } catch (e) {}
            }
            return xhr;
        };

        this._ajax.send = function(url, callback, fail, method, data, sync) {
            try {
                var x = this.x();
                x.open(method, url, sync);
				x.data = data;
                x.onerror = function(){fail(); console.log("Error loading config.");}
                x.onreadystatechange = function() {
                    if (x.status == 200) {
                        if (x.readyState == 4) {
                            if (callback) {
                                callback(x.responseText, x.data);
                                x.onreadystatechange = null;
                                x = null;
                            }
                        }
                    } else {
                        if (x.status != 0) {
                            if (fail) {
                                x.onreadystatechange = null;
                                x = null;
                                fail();
                            }
                        }
                    }
                };
                x.send(data)
            } catch (e) {
                if (fail) {
                    if (x) x.onreadystatechange = null;
                    fail();
                }
            }
        };

        this._ajax.get = function(url, callback, fail, data) {
            this.send(url, callback, fail, 'GET', data, true)
        };

        this.base64 = {
            _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
            encode: function(r) {
                var t, e, o, h, a, n, c, d = "",
                    i = 0;
                for (r = this._utf8_encode(r); i < r.length;) t = r.charCodeAt(i++), e = r.charCodeAt(i++), o = r.charCodeAt(i++), h = t >> 2, a = (3 & t) << 4 | e >> 4, n = (15 & e) << 2 | o >> 6, c = 63 & o, isNaN(e) ? n = c = 64 : isNaN(o) && (c = 64), d = d + this._keyStr.charAt(h) + this._keyStr.charAt(a) + this._keyStr.charAt(n) + this._keyStr.charAt(c);
                return d
            },
            decode: function(r) {
                var t, e, o, h, a, n, c, d = "",
                    i = 0;
                for (r = r.replace(/[^A-Za-z0-9\+\/\=]/g, ""); i < r.length;) h = this._keyStr.indexOf(r.charAt(i++)), a = this._keyStr.indexOf(r.charAt(i++)), n = this._keyStr.indexOf(r.charAt(i++)), c = this._keyStr.indexOf(r.charAt(i++)), t = h << 2 | a >> 4, e = (15 & a) << 4 | n >> 2, o = (3 & n) << 6 | c, d += String.fromCharCode(t), 64 != n && (d += String.fromCharCode(e)), 64 != c && (d += String.fromCharCode(o));
                return d = this._utf8_decode(d)
            },
            _utf8_encode: function(r) {
                r = r.replace(/\r\n/g, "\n");
                for (var t = "", e = 0; e < r.length; e++) {
                    var o = r.charCodeAt(e);
                    128 > o ? t += String.fromCharCode(o) : o > 127 && 2048 > o ? (t += String.fromCharCode(o >> 6 | 192), t += String.fromCharCode(63 & o | 128)) : (t += String.fromCharCode(o >> 12 | 224), t += String.fromCharCode(o >> 6 & 63 | 128), t += String.fromCharCode(63 & o | 128))
                }
                return t
            },
            _utf8_decode: function(r) {
                for (var t = "", e = 0, o = c1 = c2 = 0; e < r.length;) o = r.charCodeAt(e), 128 > o ? (t += String.fromCharCode(o), e++) : o > 191 && 224 > o ? (c2 = r.charCodeAt(e + 1), t += String.fromCharCode((31 & o) << 6 | 63 & c2), e += 2) : (c2 = r.charCodeAt(e + 1), c3 = r.charCodeAt(e + 2), t += String.fromCharCode((15 & o) << 12 | (63 & c2) << 6 | 63 & c3), e += 3);
                return t
            }
        };

        if (typeof window.DOMParser != "undefined") {
            this.parseXml = function(xmlStr) {
                return (new window.DOMParser()).parseFromString(xmlStr, "text/xml");
            };
        } else if (typeof window.ActiveXObject != "undefined" &&
            new window.ActiveXObject("Microsoft.XMLDOM")) {
            this.parseXml = function(xmlStr) {
                var xmlDoc = new window.ActiveXObject("Microsoft.XMLDOM");
                xmlDoc.async = "false";
                xmlDoc.loadXML(xmlStr);
                return xmlDoc;
            };
        } else {
            throw new Error("No XML parser found");
        }
    }

    WSJVideo.prototype = {

        init: function() {
            var self = this;
            if (!this._configLoaded) {
                try {
                    var playerConigUrl = this._settings.api + "player/config/v3/" + this._settings.playerid + ".json?callback=cbfn";
                    this._ajax.get(playerConigUrl, externalConfigLoaded, externalConfigError, null);
                } catch (e) {
                    self._configLoaded = true;
                }
                return;
            }

            function externalConfigLoaded(data) {
                self._configLoaded = true;
                var itms = JSON.parse(data);
                self._externalConfig = itms.items[0];
                try {
                    self._settings = self.extend(self._settings, self._externalConfig);
                } catch (error) {
                }
                self.init();
            };

            function externalConfigError(e) {
                self._configLoaded = true;
                self.init();
            }

            var cVolume = this.getCookie("djvideovol");
            if (cVolume != "") {
                this._volume = cVolume;
                if(this._volume < 0)
                    this._volume = 0;
            }

            var cLang = this.getCookie("djvideolang");
            if (cLang != "") {
                this._langSelected = cLang;
            }
            if(this._iOS)
                this._langSelected = '';
            /*
             try {
             var bkt = this.getCookie("usr_bkt");
             if (bkt == ""){
             this._bucket = "";
             }else if (this.BUCKET_HASH_MAP.indexOf(bkt) < 5){
             if(this._settings.adsEnabled) {
             this._bucket = "b";
             this._settings.adsEnabled = this._settings.adsEnabled;
             }
             }else if(this.BUCKET_HASH_MAP.indexOf(bkt) >= 5){
             this._bucket = "a";
             this._settings.adsEnabled = false;
             }
             }catch(e){this._bucket = "";}
             */
            this._bucket = "";
            console.log("v " + this._version + this._bucket);

            var adPlayNum = this.getCookie("djadplaynum");
            if (adPlayNum != "") {
                this._adPlayNumber = parseInt(adPlayNum);
                if (isNaN(this._adPlayNumber))
                    this._adPlayNumber = 0;
            }

            var cMute = this.getCookie("djvideomute");
            if (cMute != "") {
                if (cMute == 1) {
                    this._muted = true;
                }
            }

            var cBit = this.getCookie("djvideobit");
            if (cBit != "") {
                this._selectedBitrate = cBit;

            }

            if (!svid)
                this.setupTracking();

            this.setupPlayer();

            if (typeof(this._settings.callback) == "function") {
                this._settings.callback();
            }

            this._flashEvents = {
                ready: function(flashTime) {
                    self._flash = getFlashMovieObject("flash" + self._videoId);
                    self._fPlaying  = false;
                    self._flashInit = true;
                    self.startVideo();
                },
                manifest: function(duration, levels_, loadmetrics) {
                    self._flash.playerPlay(-1);
                    self._controls.style.display = "block";
                },
                complete: function(a, b, c) {

                },
                state: function(a, b, c) {
                    if(a == "PAUSED"){
                        self._fPlaying  = false;
                        self.onPaused(a);
                        self._buffering.style.display = "none";
                    }else if(a == "PLAYING"){
                        self._fPlaying  = true;
                        self.onPlaying(a);
                        self._buffering.style.display = "none";
                    }else if(a == "PAUSED_BUFFERING"){
                        self._fPlaying  = false;
                        self.onPaused(a);
                        self._buffering.style.display = "block";
                    }else if(a == "PLAYING_BUFFERING"){
                        self._fPlaying  = true;
                        self.onPlaying(a);
                        self._buffering.style.display = "block";
                    }
                },
                position: function(a, b, c) {
                    self.onProgress(a);
                },
                error: function(a, b, c) {

                }
            }

            this.onHLSMediaAttached = this.onHLSMediaAttached.bind(this);
            this.onHlsError = this.onHlsError.bind(this);
            this.onHLSLevelLoaded = this.onHLSLevelLoaded.bind(this);

            window["flashlsCallback" + this._videoId] = function(e, a){
                self._flashEvents[e].apply(null, a);
            };
            return this;
        },

        setupPlayer: function() {
            var self = this;
            this._container.className = this._container.className + " video-player";
            var clickForSoundString = '';
            if(this._settings.autoplay && (this._isMobile || this._settings.clickForSound == true))
                clickForSoundString = ' autoplay muted ';
            var inlineString = '';
            if(this._settings.playInline)
                inlineString = ' playsinline';
			if(this._settings.loop)
				inlineString += ' loop';
            this._container.innerHTML = '<div class="video-wrapper" id="wrapper-' + this._videoId + '" ><div id="flashContainer-' + this._videoId + '" class="flashVideo"></div><video src="" id="videoplayer-' + this._videoId + '" width="100%" height="100%" preload="none" '+clickForSoundString+inlineString+' controls crossorigin="anonymous">Your browser does not support HTML5 video.</video><div class="video-play-overlay" id="video-play-overlay-' + this._videoId + '"></div><div class="video-loading" id="video-loading-' + this._videoId + '"><div class="video-loading-inner"><div></div></div></div><div class="video-adContainer" id="adContainer-' + this._videoId + '"></div><div class="video-controls" id="video-controls-' + this._videoId + '" >' + this.returnControls() + '</div><div id="video-ad-skip-' + this._videoId + '" class="adSkip"><div class="skipTxt">Skip Ad</div><div class="videoSkipCountdown" id="video-ad-countdown-' + this._videoId + '"> in 15</div><div class="videoSkipIcon" id="videoSkipIcon-' + this._videoId + '"></div></div><img class="wsjvideo_poster" id="poster-' + this._videoId + '" /><audio width="100%" height="100%" id="audioplayer_' + this._videoId + '" controls>Your browser does not support the audio tag.</audio><div id="vrWrapper_' + this._videoId + '" class="vrWrapper"></div><div class="video-share" id="video-share-' + this._videoId + '"></div><div class="video-thumb" id="video-thumb-' + this._videoId + '"></div><div class="video-sound" id="video-sound-' + this._videoId + '">'+this._graphics['click-for-sound']+' <span>Click For Sound</span></div><div class="video-thumb" id="video-thumb-' + this._videoId + '"></div></div>';

            this._video = document.getElementById("videoplayer-" + this._videoId);
            this._video.scope = this;
            this._wrapper = document.getElementById("wrapper-" + this._videoId);
            this._wrapper.scope = this;
            this._buffering = document.getElementById("video-loading-" + this._videoId);
            this._thumb = document.getElementById('video-thumb-' + this._videoId);
            this._countdownTxt;
            this._adContainer = document.getElementById('adContainer-' + this._videoId);
            this._audio = document.getElementById('audioplayer_' + this._videoId);
            this._audio.scope = this;
            this._audioPoster = document.getElementById('poster-' + this._videoId);
            this._vrWrapper = document.getElementById('vrWrapper_' + this._videoId);
            this._clickForSoundScreen = document.getElementById('video-sound-' + this._videoId);
            this._flashContainer = document.getElementById('flashContainer-' + this._videoId);
            //this._vrWrapper.style.display = "none";
            this._audio.style.display = "none";

            this.setupListeners(true);
            if (!this._settings.disableHtmlControls) {
                this._controls = document.getElementById("video-controls-" + this._videoId);
                this._controls.hideTime = 0;
                this._playOverlay = document.getElementById("video-play-overlay-" + this._videoId);
                this._playBtn = document.getElementById("video-play-pause-" + this._videoId);
                this._fullscreenBtn = document.getElementById('video-fullscreen-' + this._videoId);
                this._volumeBtn = document.getElementById('video-volume-' + this._videoId);
                this._volumeBtnGraphics = document.getElementById('video-volume-g-' + this._videoId);
                this._volumeSlider = document.getElementById('video-volume-slider-' + this._videoId);
                this._volumeSetting = document.getElementById('video-volume-v-' + this._videoId);
                this._volumeBG = document.getElementById('video-volume-b-' + this._videoId);
                this._volumeHandle = document.getElementById('video-volume-h-' + this._videoId);
                this._timeDisplay = document.getElementById('video-time-' + this._videoId);
                this._scrubBar = document.getElementById('video-scrub-' + this._videoId);
                this._scrubProgress = document.getElementById('video-scrub-progress-' + this._videoId);
                this._adProgress = document.getElementById('video-ad-progress-' + this._videoId);
                this._scrubLoaded = document.getElementById('video-scrub-loaded-' + this._videoId);
                this._shareScreen = document.getElementById('video-share-' + this._videoId);
                this._shareBtn = document.getElementById('video-share-b-' + this._videoId);
                this._ccBtn = document.getElementById('video-cc-' + this._videoId);
                this._bitBtn = document.getElementById('video-bit-' + this._videoId);
                this._ccList = document.getElementById('captionsList-' + this._videoId);
                this._bitList = document.getElementById('bitrateList-' + this._videoId);
                this._adsSkipButton = document.getElementById('video-ad-skip-' + this._videoId);
                this._adCountdownText = document.getElementById('video-ad-countdown-' + this._videoId);
                this._videoSkipIcon = document.getElementById('videoSkipIcon-' + this._videoId);
                this._twitterBtn = document.getElementById('share-twitter-' + this._videoId);
                this._fbBtn = document.getElementById('share-fb-' + this._videoId);

                this._twitterBtn.addEventListener('click', function(){
                    self._video.pause();
                    window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(self._videodata.linkURL) + '&text=' + encodeURIComponent(self._videodata.name),'targetWindow','toolbar=no,location=0,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=250');
                });
                this._fbBtn.addEventListener('click', function(){
                    self._video.pause();
                    window.open('https://www.facebook.com/sharer/sharer.php?u=' + self._videodata.linkURL + '&t=' + self._videodata.name,'targetWindow','toolbar=no,location=0,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=250');
                });

                this._ccBtn.style.display = "none";
                if (this._isIpad || this._isAndroid) {
                    this._volumeBtn.style.display = "none";
                    this._bitBtn.style.display = "none";
                }
                if(!this._settings.shareEnabled){
                    this._shareBtn.style.display = "none";
                    this._twitterBtn.style.display = "none";
                    this._fbBtn.style.display = "none";
                }
                this._adsSkipButton.display = "none";
                this._bitBtn.style.display = "none";
                this.addUserEventListeners();
                this._video.controls = false;
            } else {
                document.getElementById("video-controls-" + this._videoId).style.display = "none";
                if (!this._settings.fireTv)
                    this._video.controls = true;
				else
					this._video.controls = false;
            }

            this._height = this._wrapper.offsetHeight;
            this._width = this._wrapper.offsetWidth;

            // EXTERNAL //
            this._container._self = this;
            this._container.resumeVideo = this.eResumeVideo;
            this._container.pauseVideo = this.ePauseVideo;
            this._container.playVideo = this.ePlayVideo;
            this._container.killVideo = this.eKillVideo;
            this._container.loadVideo = this.eLoadVideo;
            this._container.setMute = this.eMute;
            this._container.updatePlaylist = this.eUpdatePlaylist;
            this._container.isPlaying = this.eIsPlaying;
            this._container.getStatus = this.eGetStatus;
            this._container.vidoraShownList = this.eVidoraShownList;
            this._container.seek = this.eSeek;

            if (this._settings.guid || (this._settings.type !== "" && this._settings.query !== "")) {
                this.loadVideo(false);
            }
            if (!this._isMobile) {
                this.muteUnMute(this._muted, false);
                this.onMuteUnMute(this);
                this.setVolume(this._volume, false);
            } else {
                if(!this._settings.clickForSound){
                    this.muteUnMute(false, true);
                    this.setVolume(1, true);
                }else if(this._settings.clickForSound === "disabled"){
                    this.muteUnMute(true, false);
                }
            }
            var clickForSoundHandler = function(event) {

                self._clickForSoundScreen.style.display = "none";
                self._clickForSoundEnabled = false;
                self._video.muted = false;
                if(self._controls)
                    self._controls.style.display = "block";
                if(self._settings.adsEnabled){
                    self._adDisplayContainer.initialize();
                    self.requestAds();
                }
                self._wrapper.removeEventListener('click', clickForSoundHandler, false);
            }
            if(this._settings.clickForSound && this._settings.clickForSound !== "disabled"){
                this._clickForSoundEnabled = true;
                if(this._controls)
                    this._controls.style.display = "none";
                this._wrapper.addEventListener('click', clickForSoundHandler);
            }else{
                this._clickForSoundScreen.style.display = "none";
            }
            if (this._iOS != 0) {
                this._video.addEventListener('webkitendfullscreen', function(e) {
                    self.onScreenChange(e);
                });
                this._video.addEventListener('webkitbeginfullscreen', function(e) {
                    self.onScreenChange(e);
                });
            } else {
                this._wrapper.addEventListener(screenfull.raw.fullscreenchange, function(e) {
                    self.onScreenChange(e);
                });
            }
            this.onResize();
        },

        initVideo: function() {

            var self = this;
            this._contentInitialized = false;
            if (this._settings.adsEnabled && !this._adsBlocked) { //  Ads Lib
                if (typeof(google) === 'undefined') {
                    this.loadScript(this._settings.imaLibrary, function() {
                        self.initVideo();
                    }, function() { // error
                        self._adsBlocked = true;
                        self.initVideo();
                    });
                    return;
                }
            } else {
                this._adContainer.style.display = "none";
            }

            if (this._settings.useHLS) {
                if (typeof(Hls) === 'undefined') {
                    this._hlsLoadAttempted = true;
					
                    this.loadScript("//video-api.wsj.com/api-video/player/v3/js/hls.min.js", function() {
                        self.initVideo();
						
                    }, function() { // error
                        self._settings.useHLS = false;
                        self.initVideo();
                    });
                    return;
                }
            }

            if(this._videodata.doctypeID == "469")
                this._settings.chainVideos = false;

            if (this._videodata.state == "future") {
                this._startTime = new Date();
                var now = new Date();
                var nam = (!this._videodata.showName) ? this._videodata.name : this._videodata.showName;
                end = new Date(now.valueOf() + (this._videodata.secondsUntilStartTime * 1000));

                if (this._videodata.videoStillURL) {
                    this._container.style.backgroundImage = 'url(' + this._videodata.videoStillURL + ')';
                }

                this._videoMsg = document.createElement("div");
                this._videoMsg.innerHTML = '<p class="videoMsg">This video will play automatically in: <span id="countdown_' + this._videoId + '"></span></p>';
                this._container.appendChild(this._videoMsg);
                this._buffering.style.display = "none";
                this._wrapper.style.display = "none";

                this._countdownTxt = document.getElementById('countdown_' + this._videoId);
                this.showRemaining();
                this._futureTimer = setInterval(function() {
                    self.showRemaining()
                }, 1000);
                return;
            }

            if (this._settings.adsEnabled && !this._adsBlocked) {
                google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);
                this._adDisplayContainer = new google.ima.AdDisplayContainer(this._adContainer, this._video);
                this._adsLoader = new google.ima.AdsLoader(this._adDisplayContainer);
                this._adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE);
                this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, function(evt) {
                    self.onAdsManagerLoaded(evt)
                }, false);
                this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, function(evt) {
                    self.onAdError(evt)
                }, false);
                this._buffering.style.display = "block";
            }
			
			this.trigger(this._wrapper, 'onInitialize', this._videodata);
			
            if (this._settings.autoplay) {
                this.startVideo();
            } else {
                if (!self._settings.isAudio)
                    this.setupThumbnail();
            }
        },

        addHLSEventListeners: function(){
            var self = this;
            this._hlsPlayer.off(Hls.Events.MEDIA_ATTACHED, this.onHLSMediaAttached);
            this._hlsPlayer.off(Hls.Events.ERROR, this.onHlsError);
            this._hlsPlayer.off(Hls.Events.LEVEL_LOADED, this.onHLSLevelLoaded);

            this._hlsPlayer.on(Hls.Events.MEDIA_ATTACHED, this.onHLSMediaAttached);
            this._hlsPlayer.on(Hls.Events.ERROR, this.onHlsError);
            this._hlsPlayer.on(Hls.Events.LEVEL_LOADED, this.onHLSLevelLoaded);
        },

        onHLSMediaAttached: function(a,b,c,d){
            this._hlsPlayer.loadSource(this._videodata.hls);
        },

        onHLSLevelLoaded: function(e,d){
            this._duration = d.details.totalduration;
        },

        onHlsError: function(e, d){
            if(d.fatal || d.details == "bufferAppendingError") {
                switch(d.type) {
                    case Hls.ErrorTypes.MEDIA_ERROR:
                        this._hlsPlayer.recoverMediaError();
                        break;
                    case Hls.ErrorTypes.NETWORK_ERROR:
                        this._hlsPlayer.startLoad();
                        break;
                    default:
                        this._hlsPlayer.destroy();
                        break;
                }
            }
            if(d.details == Hls.ErrorDetails.BUFFER_STALLED_ERROR){
                this.onBuffering(e);
                return;
            }
        },

        setupTracking: function() {
            var overrideOAccount = false;
            try {
                var oAccount = location.search.split('oAccount=')[1];
				if (this._settings.oAccount) // some users have used oAccount as a typo  Catch for that.
                    this._settings.sAccount = this._settings.oAccount;
                if (this._settings.sAccount)
                    oAccount = this._settings.sAccount;
                if (oAccount) {
                    s_account = oAccount;
                    overrideOAccount = true;
                }
            } catch (e) {}
            if (!overrideOAccount) {
                var s_account = "djglobal,djwsj";
                try {
                    var url = (window.location != window.parent.location) ? document.referrer : document.location.href;
                    if (url.indexOf("wsj.com") !== -1) {
                        s_account = "djglobal,djwsj";
                    }
                    if (url.indexOf('live.wsj.com') !== -1) {
                        s_account = "djglobal,djwsjlive";
                    }
                    if (url.indexOf("cwsj.com") !== -1) {
                        s_account = "djglobal,djwsjchina";
                    }
                    if (url.indexOf("cn.wsj.com") !== -1) {
                        s_account = "djglobal,djwsjchina";
                    }
                    if (url.indexOf("jwsj.com") !== -1) {
                        s_account = "djglobal,djjapanwsj";
                    }
                    if (url.indexOf("kr.wsj.com") !== -1) {
                        s_account = "djglobal,djwsjkorea";
                    }
                    if (url.indexOf("indo.wsj.com") !== -1) {
                        s_account = "djglobal,djwsjindonesia";
                    }
                    if (url.indexOf("marketwatch.com") !== -1) {
                        s_account = "djglobal,djmarketwatch";
                    }
                    if (url.indexOf("barrons.com") !== -1) {
                        s_account = "djglobal,djbarrons";
                    }
                    if (url.indexOf("wsj.de") !== -1) {
                        s_account = "djglobal,djwsjgermany";
                    }
                    if (url.indexOf('allthingsd.com') !== -1) {
                        s_account = "djglobal,djatd";
                    }
                    if (url.indexOf('wsj.com.tr') !== -1) {
                        s_account = "djglobal,djwsjturkey";
                    }
                    if (url.indexOf('efinancialnews.com') !== -1) {
                        s_account = "djglobal,djefinancialnews";
                    }
                    if (url.indexOf('mansionglobal.com') !== -1) {
                        s_account = "djmansionglobal";
                    }
                    if (url.indexOf('twitter.com/i/cards') !== -1) {
                        s_account = "djglobal,djwsjlive";
                    }
                    if (url.indexOf('heatst.com') !== -1) {
                        s_account = "djheatstreetprod";
                    }
                } catch (e) {
                    s_account = "djglobal,djwsjlive";
                }
            }
            svid = s_gi(s_account);
            svid.charSet = "ISO-8859-1";
            svid.currencyCode = "USD";
            svid.trackDownloadLinks = true;
            svid.trackExternalLinks = false;
            svid.trackInlineStats = true;
            svid.linkDownloadFileTypes = "exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";
            svid.linkInternalFilters = "javascript:,wsj.com,wallstreetjournal.com,bankrate.com,smartmoney.com,barrons.com,marketgauge.com,marketwatch.com,bigcharts.com,virtualstockexchange.com,hulbertinteractive.com,collegejournal.com,careercast.com,careerjournal.com,careerjournalasia.com,realestatejournal.com,loopnet.com,opinionjournal.com,politicaldiary.com,startupjournal.com,homefair.com,myplan.com,contacts.zoominfo.com,secure.theladders.com,selectrecruiters.com,kennedyinfo.com,allisontaylor.com,wsj.careerdev.org,wsj.resumeedge.com,newhomesource.com,blacksguide.com,rej.informars.com,wsj.miniplan.com,wsj.knowledgestorm.com,entrepreneur.com,toolkit.prnewswire.com,tsnn.com,allthingsd.com,traffic.outbrain.com,fins.com,wallstreetjournal.de";
            svid.linkLeaveQueryString = false;
            try {
                if (window.location.indexOf("https://") == 0) {
                    svid.ssl = true;
                }
            } catch (e) {}
            svid.visitorNamespace = "dowjones";
            svid.trackingServer = "om.dowjoneson.com";
            svid.trackingServerSecure = "oms.dowjoneson.com";
			
			svid.visitor = Visitor.getInstance("CB68E4BA55144CAA0A4C98A5@AdobeOrg", {
				 trackingServer: "om.dowjoneson.com", 
				 trackingServerSecure: "oms.dowjoneson.com", 
				 marketingCloudServer: "om.dowjoneson.com",
				 marketingCloudServerSecure: "oms.dowjoneson.com"
			});
        },

        onCCSelected: function(lang, id, setCookie) {
            var self = this;
            if(setCookie){
                this._langSelected = lang;
                document.cookie = "djvideolang=" + this._langSelected+ "; path=/";
            }
            var track;
            while (this._video.firstChild) {
                this._video.removeChild(this._video.firstChild);
            }
            track = document.createElement("track");
            track.kind = "subtitles";
            track.label = "English";
            track.srclang = "en";
            track.mode = "showing";
            this._video.appendChild(track);
            this._video.tTrack = track;
            track.addEventListener("load", function() {
                this.mode = "showing";
                try{
                    self._video.textTracks[0].mode = "showing"; // thanks Firefox
                }catch(e){}
                try {
                    var cues = self._video.textTracks[0].cues;
                    for (v in cues) {
                        if(cues[v].line == "auto")
                            cues[v].line = -3;
                    }
                } catch (e) {}
            });

            track.addEventListener("error", function(e, err) {
				console.log("Captions failed to load.");
            });

            try {
                this._video.textTracks[0].mode = "showing";
            } catch (e) {}

            track.src = id;
            this.onCloseCC();
        },

        loadCaptions: function() {
            var self = this;
            this._availableCaptions = [];
            while (this._video.firstChild) {
                this._video.removeChild(this._video.firstChild);
            }
			if(this._ccBtn)
            	this._ccBtn.style.display = "none";
            if(this._videodata.forceClosedCaptions){
                if(this._langSelected == '')
                    this._langSelected = 'English';
            }else{
                this._langSelected = this.getCookie("djvideolang");
            }
			
			var rLoaded = function(e,d) {
				if (self._ccBtn)
					self._ccBtn.style.display = "block";
				var cap = {
					"id": d.url,
					"lang": d.label
				};
				
				self._availableCaptions.push(cap);

				if (cap.lang == self._langSelected) {
					self.onCCSelected(cap.lang, cap.id, false);
				}
			}
			
			var rFail = function(e,d) {
				console.log("Captions failed to load.");
            }
			
			if(this._videodata.captionsVTT !== null){
				var caps = this._videodata.captionsVTT;
				for (var i = 0; i < caps.length; i++) {
					this._ajax.get(caps[i].url, rLoaded, rFail, caps[i]);
				}
			}

        },

        eVidoraShownList: function(list) {
            for (gid in list) {
                try {
                    window.vidora.push(["send", "shown", list[gid]]);
                } catch (e) {}
            }
        },

        startVideo: function(e) {
            var self = this;
            this._thumb.style.display = "none";
            this._playRequested = true;
            if(this._controls)
                this._controls.style.display = "block";
            if(this._isIE && (this._videodata.state == "live" || this._videodata.state == "processing") ){
                this._controls.style.display = "none";
                if(!this._flashInit){
                    this._buffering.style.display = "none"
                    this._flashContainer.innerHTML = '<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="" id="flash' + this._videoId + '" width="100%" height="100%"><param name="movie"  value="'+this._settings.api+'player/v3/flashlsChromeless.swf?inline=1" /><param name="quality" value="autohigh" /><param name="swliveconnect" value="true" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="#0" /><param name="allowFullScreen" value="false" /><param name="wmode" value="opaque" /><param name="FlashVars" value="callback=flashlsCallback' + this._videoId + '" /><embed src="'+this._settings.api+'player/v3/flashlsChromeless.swf?inline=1" width="100%" height="100%" style="position:absolute; z-index:1;" name="flash' + this._videoId + '" quality="autohigh" bgcolor="#0" align="middle" allowFullScreen="false" allowScriptAccess="always" type="application/x-shockwave-flash" swliveconnect="true" wmode="opaque" FlashVars="callback=flashlsCallback' + this._videoId + '" pluginspage="https://www.macromedia.com/go/getflashplayer" ></embed></object><div class="getFlash"><strong>Live video is not supported on IE wihtout Flash enabled.</strong><p>Install and enable Flash or use Chrome / Firefox</p><p><a href="https://get.adobe.com/flashplayer/">Get Flash Player</a></p></div>';
                    this._flashContainer.style.display = "block";
                    return; // exit and wait for flash to load
                }
            }
			if (this._adsManager) {
				this._adsManager.stop();
			}
            this.onNewVideo();
            
            if (this._videodata.state == "live" && this._controls) {
                this._shareBtn.style.display = "none";
                this._twitterBtn.style.display = "none";
                this._fbBtn.style.display = "none";
                this._ccBtn.style.display = "none";
                this._buffering.style.display = "block"
                if (this._videodata.disableDVR == 1 || this._videodata.duration == 0) {
                    this._timeDisplay.innerHTML = " Loading.. ";
                    this._scrubBar.style.display = "none";
                }
            }
				
            this.setVideoSource();
            this._video.load();
			if (self._settings.adsEnabled && !this._adsBlocked) {
				self._adDisplayContainer.initialize();
			}
            if (this._videodata.format == 'vr' ) {
                if(this._isIE || (this._isSafariMac && window == window.top)) {
                    this.displayVrMsg();
                }else{
                    this.initVrPlayback(this._vrWrapper);
                    //self._controls.classList.add('static');
                    console.log("Loading VR Libs..");
                    return;
                }
            } else {
                this._vrWrapper.style.display = "none";
                this._video.style.display = "block";
            }
            if (!this._sizeTimer) {
                this._sizeTimer = setInterval(function() {
                    self.checkStatus();
                }, 500);
            }
            if (this._adsBlocked) {
                this.onAdError(null);
            } else if (!this._settings.adsEnabled) {
                this.trackAdsDisabled();
            }
			self._video.autoplay = "autoplay";
			var promise = self._video.play();
			
			if (promise !== undefined) {
				promise.then(function(value) {
					if (self._settings.adsEnabled && !self._adsBlocked && !self._clickForSoundEnabled && self._videodata.catastrophic !== "1" && self._videodata.adCategory !== "catastrophic") {
						if (self._settings.adsEnabled && !this._adsBlocked) {
							self._adDisplayContainer.initialize();
						}
						self._video.pause();
						self.requestAds();
					}
				}, function(reason) {
					self._clickForSoundScreen.style.display = "none";
					self.setupThumbnail();
				});
			}
			
            try {
                this._comscoreTag.stop();
                this._comscoreTag.playContentPart(this._comscoreMeta);
            } catch (e) {}
        },

        setVideoSource: function() {
            var self = this;
            if(this._flash){
                this._video.setAttribute("src", "");
                this._flash.playerLoad(this._videodata.hls);
                return;
            }
            this._hlsAvailable = false;
            if(this._isAudio){
                this._video.setAttribute("src", this._videodata.video320kMP4Url);
            } else if (this._isSafariMac && this._videodata.format == 'vr') { // safari desktop security issue hack
                var urlNoProtocol = this._videodata.videoMP4List[3].url.replace(/^https?\:\/\//i, "");
                this._video.setAttribute("src", '//'+window.location.hostname+'/'+urlNoProtocol);
            }  else if (this._iOS != 0 || this._settings.fireTv || this._isSafariMac || this._androidV >= 4.4) {
                this._video.setAttribute("src", this._videodata.hls);
            }else {
                if (this._settings.useHLS) {
                    if(this._hlsPlayer){
                        var detachSetup = function(){
                            self._hlsPlayer.off(Hls.Events.MEDIA_DETACHED, detachSetup);
                            self._video.src = self._videodata.hls;
                            self._hlsPlayer = new Hls(self.hlsConfig);
                            self._hlsPlayer.startLevel = 3;
                            self.addHLSEventListeners();
                            self._hlsPlayer.attachMedia(self._video);
                        }
                        this._hlsPlayer.on(Hls.Events.MEDIA_DETACHED, detachSetup);
                        this._hlsPlayer.destroy();
                    }else{
                        this._hlsPlayer = new Hls(this.hlsConfig);
                        self._hlsPlayer.startLevel = 3;
                        this.addHLSEventListeners();
                        this._hlsPlayer.attachMedia(this._video);
                    }
                } else {
                    if (this._videodata.video664kMP4Url) {
                        this._video.setAttribute("src", this._videodata.video664kMP4Url);
                    } else if (this._videodata.videoMP4List[2]) {
                        this._video.setAttribute("src", this._videodata.videoMP4List[2].url);
                    } else {
                        this._video.setAttribute("src", this._videodata.videoMP4List[0].url);
                    }
                }
            }
        },

        showRemaining: function() {
            var n = new Date();
            var sec = n.getTime() - this._startTime.getTime();
            var now = new Date(this._startTime.valueOf() + sec);
            var distance = end - now;
            if (distance < 0) {
                clearInterval(this._futureTimer);
                this._countdownTxt.innerHtml = 'Loading...';
                this._videodata.state = "flive";
                this._wrapper.style.display = "block";
                this._settings.autoplay = true;
                this._videoMsg.parentNode.removeChild(this._videoMsg);
                this.initVideo();
                return;
            }
            var hours = Math.floor(distance / 3600000);
            var minutes = Math.floor((distance % 3600000) / 60000);
            var seconds = Math.floor((distance % 60000) / 1000);
            var txt = "";
            if (hours > 0) {
                txt += ("0" + hours).slice(-2) + ':';
            }
            if (minutes > 0) {
                txt += ("0" + minutes).slice(-2) + ':';
            }
            txt += ("0" + seconds).slice(-2);
            if (this._countdownTxt)
                this._countdownTxt.innerHTML = txt;
        },

        trackAdsDisabled: function() {
            if (!this._settings.adsEnabled) {
                this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[4]; // event46 , event105;
                this._tObject.pev2 = "Ads_Disabled_Via_Player_Param";
                this._tObject.eVar46 = "none";
                this._tObject.eVar49 = "none";
                this._tObject.eVar50 = "none";
                this._tObject.pe = 'lnk_o';
                svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                this._tObject.linkTrackEvents = this._tObject.events = "";
            }
        },

        checkStatus: function() {
            if (this._width != this._wrapper.offsetWidth || this._height != this._wrapper.offsetHeight) {
                this.onResize();
            }
			if(this._video.offsetHeight != this._wrapper.offsetHeight){
				this._video.style.height = this._wrapper.offsetHeight+"px";
			}
            if (this._controls) { // if mouse not over video, remove cc list
                if (this._wrapper.parentElement.querySelector(':hover') !== this._wrapper) {
                    this.onCloseCC();
                    this.onCloseBit();
                }
            }
        },

        loadVideo: function(autoStart) {
            try {
                var self = this._self;
                this._video.pause();
                this._buffering.style.display = "block";
                if (this._adsManager) {
                    this._adsManager.stop();
                }
                var guidLoaded = function(evt) {
                    var itms = JSON.parse(evt);
                    self._videodata = itms.items[0];
                    self._duration = self._videodata.duration;
                    try {
                        self._settings.guid = self._videodata.guid
                    } catch (e) {}

                    if (self._settings.msrc) {
                        self._videodata.msrc = self._settings.msrc;
                    }

                    if (self._videodata.error) {
                        self.showError(self._videodata.error);
                    } else {
                        if (autoStart) {
                            self.startVideo();
                        } else {
                            self.initVideo();
                        }
                    }
                }

                var guidLoadFail = function(evt) {
                    self.showError('');
                }

                var httpParam = "";
                if (this._settings.useHttps)
                    httpParam = "&https=1";

                var playerConigUrl = "";
                if (this._settings.guid) {
                    playerConigUrl = this._settings.api + 'find_all_videos.asp?type=guid&count=1' + httpParam + '&query=' + this._settings.guid + '&' + this._fields;
                } else if (this._settings.type !== "" && this._settings.query !== "") {
                    playerConigUrl = this._settings.api + 'find_all_videos.asp?type=' + this._settings.type + '&count=1' + httpParam + '&query=' + this._settings.query + '&' + this._fields;
                    if(this._settings.groupId !== "")
                        playerConigUrl += '&groupid='+this._settings.groupId;
                }
            } catch (e) {}

            this._ajax.get(playerConigUrl, guidLoaded, guidLoadFail, null);
        },

        returnControls: function(cid) {
            var rtn = "";
            if (!this._settings.disableHtmlControls) {
                rtn += '<button class="video-play-pause f-l" id="video-play-pause-' + this._videoId + '">' + this._graphics['play'] + '</button>';
                rtn += '<div class="video-volume f-l" id="video-volume-' + this._videoId + '"><div class="video-volume-slider" id="video-volume-slider-' + this._videoId + '"><div id="video-volume-b-' + this._videoId + '" class="video-volume-b"></div><div id="video-volume-v-' + this._videoId + '" class="video-volume-v"></div><div id="video-volume-h-' + this._videoId + '" class="video-volume-h"></div></div><span class="video-volume-g-videoplayer" id="video-volume-g-' + this._videoId + '">' + this._graphics['volume-full'] + '</span></div>';
                rtn += '<div class="video-time f-l" id="video-time-' + this._videoId + '">0:00 / 0:00</div>';

                rtn += '<button class="video-fullscreen f-r" id="video-fullscreen-' + this._videoId + '">' + this._graphics['fullscreen'] + '</button>';
                rtn += '<button class="video-share-b f-r" id="video-share-b-' + this._videoId + '">' + this._graphics['share'] + '</button>';
                rtn += '<button class="video-bit f-r" id="video-bit-' + this._videoId + '">' + this._graphics['bitrate'] + '</button>';
                rtn += '<button class="video-cc f-r" id="video-cc-' + this._videoId + '">' + this._graphics['cc'] + '</button>';
                rtn += '<button class="share-fb f-r" id="share-fb-' + this._videoId + '">' + this._graphics['share-fb'] + '</button>';
                rtn += '<button class="share-twitter f-r" id="share-twitter-' + this._videoId + '">' + this._graphics['share-twitter'] + '</button>';
                rtn += '<div class="bitrateList" id="bitrateList-' + this._videoId + '"></div>';
                rtn += '<div class="captionsList" id="captionsList-' + this._videoId + '"></div>';
                rtn += '<div class="video-scrub video-scrub-hover" id="video-scrub-' + this._videoId + '"><div class="video-scrub-padding"></div><div class="video-scrub-loaded" id="video-scrub-loaded-' + this._videoId + '"></div><div class="video-scrub-background"></div><div class="video-ad-progress" id="video-ad-progress-' + this._videoId + '"></div><div class="video-scrub-progress" id="video-scrub-progress-' + this._videoId + '"></div></div>';
            }
            return rtn;
        },

        // ADS //
        getAdTag: function() {
            var adsRequest = new google.ima.AdsRequest();
            if (this._settings.adTag) {
                adsRequest.adTagUrl = this._settings.adTag;
            } else {
                var adData = [];

                if (this._settings.site != '' && typeof(this._settings.site) != "undefined")
                    adData.site = this._settings.site;
                else
                    adData.site = "video.wsj.com";

                if (this._settings.plid) {
                    adData.plid = this._settings.plid;
                } else {
                    if (this._videodata.plid)
                        adData.plid = this._videodata.plid;
                    else
                        adData.plid = "video_articleembed";
                }

                adData.gptParams = this._videodata.gptCustParams;

                if (this._settings.lnid) {
                    var lSplit = adData.gptParams.split("%26lnid%3D");
                    if (lSplit.length > 0) {
                        adData.gptParams = lSplit[0] + '%26lnid%3D' + this._settings.lnid;
                    }
                }
                var subString = "%26sub%3Dno";
                try {
                    if (this.getCookie('REMOTE_USER')) {
                        subString = "%26sub%3Dyes";
                    }
                } catch (e) {}

                var msrc = "";
                if (this._settings.msrc) {
                    msrc = "%26msrc%3D" + this._settings.msrc;
                }
                var d = new Date();
                var timestamp = d.getTime();
                adsRequest.adTagUrl = "https://pubads.g.doubleclick.net/gampad/ads?sz=4x4&gdfp_req=1&iu=/2/" + adData.site + "&ciu_szs=300x50,300x600,300x250&url=[referrer_url]&correlator=[timestamp]&env=vp&unviewed_position_start=1&output=vast&impl=s&hl=en&cust_params=" + adData.gptParams + msrc + "%26adview%3D" + this._adPlayNumber + subString + "%26flash%3Dno%26plid%3D" + adData.plid;

            }

            adsRequest.adType = "video";
            return adsRequest;
        },

        getThumbnail: function() {
            try {
                if (!this._settings.thumb) {
                    if (this._videodata.thumbnailList) {
                        var rtn = false;
                        var list = this._videodata.thumbnailList;
                        var aspect = (((this._width / this._height) > 1) ? 1 : 0);
                        for (i = 0, len = list.length; i < len; i = i + 1) {
                            if (list[i].width > this._width) {
                                rtn = list[i].url;
                            }
                            if ((aspect == 1 && list[i].aspectRatio < 1) || aspect == 0 && list[i].aspectRatio > 1)
                                continue;

                            if (list[i].width > this._width) {
                                return list[i].url
                            }
                        }
                        if (rtn)
                            return rtn;
                        else
                            return this._videodata.thumbnailList[this._videodata.thumbnailList.length - 1].url; // last resort
                    } else {
                        return this._videodata.thumbnailURL;
                    }
                } else {
                    return this._settings.thumb;
                }
            } catch (e) {
                return this._videodata.thumbnailURL;
            }
        },
		
		setupSafariThumbnail: function(e) {
			this._safariInit = true;
            var self = this;
            var thumb = this.getThumbnail();
            var Hw = 'height: 25%; width: 15%;';
            var center = '';
            var hint = 'videoHint_80';
            try {
                if(this._isVertical){
                    hint = (this._wrapper.offsetWidth < 200) ? 'videoHint_50' : 'videoHint_80';
                    center = 'style="top:47%; left:'+(Math.round(this._width / 2) - 40)+'px;"';
                    Hw = 'height: 15%; width: 100%; top:40%; left:0;';
                }else{
                    hint = (this._wrapper.offsetWidth < 400) ? 'videoHint_50' : 'videoHint_80';
                }
            } catch (err) {}
            var thumbHtml = '<div class="vidThumb" style="background-image:url(' + thumb + ');">';
            thumbHtml += '<div class="video-thumb-content"><div id="video-thumb-hint-' + this._videoId + '" class="video-hint">' + this._graphics['play-overlay'] + '</div></div>';
            this._thumb.innerHTML =  thumbHtml;
            this.onResize();

            this._safariHandler = function(e) {
				self._safariInit = true;
				self._thumb.style.display = "none";
				self.playPause();
            } 
			this._thumb.removeEventListener('click', this._safariHandler, false);
            this._thumb.addEventListener('click', this._safariHandler, false);
			this._thumb.style.display = "block";
        },
		
        setupThumbnail: function(e) {

            var self = this;
            var thumb = this.getThumbnail();
            var Hw = 'height: 25%; width: 15%;';
            var center = '';
            var hint = 'videoHint_80';
            try {
                if(this._isVertical){
                    hint = (this._wrapper.offsetWidth < 200) ? 'videoHint_50' : 'videoHint_80';
                    center = 'style="top:47%; left:'+(Math.round(this._width / 2) - 40)+'px;"';
                    Hw = 'height: 15%; width: 100%; top:40%; left:0;';
                }else{
                    hint = (this._wrapper.offsetWidth < 400) ? 'videoHint_50' : 'videoHint_80';
                }
            } catch (err) {}
			
            var thumbHtml = '<div class="vidThumb" style="background-image:url(' + thumb + ');"><div class="video-thumb-content"><div id="video-thumb-hint-' + this._videoId + '" class="video-hint">' + this._graphics['play-overlay'] + '</div>';
			if(!this._settings.suppressHeadline)
				thumbHtml += '<div id="video-thumb-text-' + this._videoId + '" class="video-thumb-text"><span class="video-title">'+this._videodata.name+'</span></div>';
			thumbHtml += '</div>';
            this._thumb.innerHTML =  thumbHtml;
            this._thumbContent = document.getElementById('video-thumb-text-' + this._videoId);
            this._thumbHint = document.getElementById('video-thumb-hint-' + this._videoId);
            this._thumbDuration = document.getElementById('video-duration-' + this._videoId);
            this.onResize();

            var clickHandler = function(e) {
                self.startVideo(e);
                if (self._isAndroid && self._settings.startFullScreen && !self._isFullScreen) {
                    self.toggleFullScreen();
                }
                self._thumb.removeEventListener(e.type, clickHandler, false);
                self._thumb.onmouseover =  null;
                self._thumb.onmouseout = null;
            } // end click handler
            this._thumb.addEventListener('click', clickHandler);
            if (!this._isIpad) {
                this._thumb.onmouseover = function(e){
                    if(self._thumbHint) {
                        if (!self._thumbHint.origHeight)
                            self._thumbHint.origHeight = self._thumbHint.offsetHeight;
                        self._thumbHint.style.height = (self._thumbHint.origHeight + 5) + "px";
                    }
                };
                this._thumb.onmouseout = function(e){
                    if(self._thumbHint) {
                        self._thumbHint.style.height = self._thumbHint.origHeight + "px";
                    }
                };
            }
			this._thumb.style.display = "block";
            this._video.style.display = "none";
            if (this._playOverlay)
                this._playOverlay.style.display = "none";
        },

        showError: function(msg) {
            this._wrapper.innerHTML = '<p class="videoMsg">We are sorry, we are unable to load this video.<br /><span>' + msg + '</span></p>';
            return;
        },

        requestAds: function() {
            var self = this;
            var adsRequest = this.getAdTag();
            this._adTagUsed = adsRequest.adTagUrl;
            adsRequest.linearAdSlotWidth = this._width;
            adsRequest.linearAdSlotHeight = this._height - 40;
            adsRequest.nonLinearAdSlotWidth = this._width;
            adsRequest.nonLinearAdSlotHeight = this._height - 40;
            this._adsLoader.requestAds(adsRequest);
			this.startAdTimeoutTimer();
            this.trigger(this._wrapper, 'adRequested');
        },

        onAdsManagerLoaded: function(adsManagerLoadedEvent) {
            var self = this;
			if (this._adTimeoutTimer) {
                clearInterval(this._adTimeoutTimer);
				if(this._adTimeoutFail == true){
					this._adTimeoutFail = false;
					return;	
				}	
            }
            var adsRenderingSettings = new google.ima.AdsRenderingSettings();
			adsRenderingSettings.loadVideoTimeout = 3000;
            adsRenderingSettings.mimeTypes = ['video/mp4'];
            adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = true;
            adsRenderingSettings.uiElements = [google.ima.UiElements.AD_ATTRIBUTION]; // hide countdown as it interferes with the skip button
            this._adsManager = adsManagerLoadedEvent.getAdsManager(this._video, adsRenderingSettings);
            if (this._muted)
                this._adsManager.setVolume(0);
            else
                this._adsManager.setVolume(this._volume);
            this._adsManager.setVolume(0);
            this._adsManager.init(this._width, this._height - 47, google.ima.ViewMode.NORMAL);
            this.adListeners();
            this._adMode = true;
            this._adsManager.start();
        },

        onBuffering: function(e) {
            var self = this;
            if( !self._video.paused && !self._adMode){
                self._buffering.style.display = 'block';
            }
        },

        onProgress: function(e) {

            var bufferedProg = 0;
            if(!this.scope)
                this.scope = this;

            this.scope._isStalled = false;
            if (!this.scope._adMode) {

                var dur = this.scope._videodata.duration;
                var tm = this.scope._video.currentTime;
                if(this.scope._flash){
                    dur = e.duration;
                    tm = e.position;
                }
                if(this.scope._controls && this.scope._isMobile){
                    if(tm > this.scope._controls.hideTime + 3){
                        this.scope._controls.style.display = "none";
                    }
                }

                if ( ( this.scope._videodata.state == "live" || this.scope._videodata.state == "flive" ) && this.scope._controls) {
                    this.scope._duration = dur;
                    this.scope._shareBtn.style.display = "none";
                    this.scope._ccBtn.style.display = "none";
                    this.scope._buffering.style.display = "none";
                    this.scope._playBtn.style.display = "block";
                    // if (this.scope._videodata.disableDVR == 1 || dur == 0) {
                    this.scope._timeDisplay.innerHTML = " LIVE ";
                    this.scope._scrubBar.style.display = "none";
                    return;
                    //}
                }

                if (this.scope._isAudio) {
                    this.scope._currentTime = this.scope._audio.currentTime;

                    if (this.scope._audio.buffered.length > 0) {
                        bufferedProg = this.scope._audio.buffered.end(this.scope._audio.buffered.length - 1) / this.scope._duration;
                    }
                } else {
                    this.scope._currentTime = tm;
                }
                if (this.scope._buffering) {
                    if (this.scope._currentTime > 1) {
                        this.scope._buffering.style.display = "none";
                    }
                }
                var percProg = (this.scope._currentTime / this.scope._duration) * 100;
                this.scope.trackProgress(percProg, this.scope._currentTime); // tracking
                if (this.scope._scrubProgress)
                    this.scope._scrubProgress.style.width = percProg + "%";
                if (this.scope._scrubLoaded)
                    this.scope._scrubLoaded.style.width = bufferedProg + "%";
                if (this.scope._timeDisplay)
                    this.scope._timeDisplay.innerHTML = (this.scope.gTimeFormat(this.scope._currentTime) + ' / ' + this.scope.gTimeFormat(this.scope._duration));
            }
        },

        onLoadedmetadata: function(evt) {
            if (this.scope._videodata.state == "live") {
                this.scope._duration = this.duration;
            }
        },

        onNewVideo: function() {
            this._contentStartTracked = false;
            this._contentInitialized = true;
            this._adErrorTracked = false;
            this._adStarted = false;
            this._duration = this._videodata.duration;
            this.trigger(this._wrapper, 'newVideo', this._videodata);
            this.trigger(this._wrapper, 'onNewVideo', this._videodata);
            this.trackInit();
            if (this._adErrorEvent !== false) {
                this._adErrorEvent = false;
                this.onAdError(this._adErrorEvent);
            }
            this._trackingMilestones = [false, false, false, false];

            this._pingMilestone = -1;
            this._video.setAttribute('poster', this.getThumbnail());
            this._settings.thumb = false;
            if(this._controls)
                this._controls.hideTime = 0;
            if (this._settings.enableCaptions && !this._flash){
                this.loadCaptions();
            }else{
                if(this._ccBtn)
                    this._ccBtn.style.display = "none";
            }
        },

        // LISTERNERS //

        setupListeners: function(enable) {
            this._video.removeEventListener('loadedmetadata', this.onLoadedmetadata);
            this._video.removeEventListener('timeupdate', this.onProgress);
            this._video.removeEventListener('onerror ', this.onVideoError);
            this._video.removeEventListener('playing', this.onPlaying);
            this._video.removeEventListener('pause', this.onPaused);
            //this._video.removeEventListener('stalled', this.onBuffering);
            this._video.removeEventListener('ended', this.onVideoComplete);
            this._audio.removeEventListener('timeupdate', this.onProgress);
            this._audio.removeEventListener('playing', this.onPlaying);
            this._audio.removeEventListener('pause', this.onPaused);
            this._audio.removeEventListener('loadedmetadata', this.onLoadedmetadata);
            this._audio.removeEventListener('ended', this.onVideoComplete);
            if(!this._isMobile) {
                this._wrapper.removeEventListener("mouseover", this.onRollOver);
                this._wrapper.removeEventListener("mouseout", this.onRollOut);
                this._wrapper.addEventListener("mouseover", this.onRollOver);
                this._wrapper.addEventListener("mouseout", this.onRollOut);
            }

            if (enable) { // enable or disable depending on ad playback
                this._video.addEventListener('loadedmetadata', this.onLoadedmetadata);
                this._video.addEventListener('timeupdate', this.onProgress);
                this._video.addEventListener('onerror ', this.onVideoError);
                this._video.addEventListener('playing', this.onPlaying);
                this._video.addEventListener('pause', this.onPaused);
                //this._video.addEventListener('stalled', this.onBuffering);
                this._video.addEventListener('ended', this.onVideoComplete);
                this._video.addEventListener('canplay', this.onCanPlay);
                this._audio.addEventListener('timeupdate', this.onProgress);
                this._audio.addEventListener('playing', this.onPlaying);
                this._audio.addEventListener('pause', this.onPaused);
                this._audio.addEventListener('loadedmetadata', this.onLoadedmetadata);
                this._audio.addEventListener('ended', this.onVideoComplete);
                this._wrapper.removeEventListener("touchstart", this.onMobileTouch);
            }
        },
		
		videoClickEvent: function(e){
			 if (this.scope._settings.startFullScreen && !this.scope._isFullScreen && this.scope._isAndroid) {
				this.scope.toggleFullScreen();
				if (!this.scope._isMobile)
					this.scope.playPause(e);
			} else {
				if(this.scope._controls.style.display != "none" && this.scope._contentInitialized){
					this.scope.playPause(e);
				}
				this.scope._controls.style.display = "block";
				this.scope._controls.hideTime = this.scope._video.currentTime;
			}
		},

        addUserEventListeners: function() {
            var self = this;
            document.onkeydown = function(evt) {
                evt = evt || window.event;
                if (evt.keyCode == 27) {
                    self.onEscpaeKey();
                }
            };
            this._playBtn.addEventListener('click', function(e) {
                self.playPause(e);
            });
            this._shareBtn.addEventListener('click', function(e) {
                self.showSharing(e);
            });
            if (this._controls) {
				if(this._isMobile)
               	 	this._video.addEventListener('touchend', this.videoClickEvent, false);
				 else
				 	this._video.addEventListener('click', this.videoClickEvent, false);
            }
            this._scrubBar.addEventListener('click', function(e) {
                if (!self._adMode) {
                    var parentOffset = this.getBoundingClientRect();
                    var relX = e.pageX - parentOffset.left;
                    var relY = e.pageY - parentOffset.top;
                    self.onSeek(relX / this.offsetWidth);
                }
            });
            this._fullscreenBtn.scope = this;
            this._fullscreenBtn.addEventListener('click', self.toggleFullScreen);
            this._volumeBtnGraphics.addEventListener('click', function(e) {
                self.muteUnMute(null, true);
            });
            this._volumeSlider._dragging = false;
            this._volumeSlider.addEventListener("mousedown", function(e) {
                self.onVolumeInteraction(e, this);
            });

            this._volumeSlider.addEventListener("mouseup", function(e) {
                this._dragging = false;
            });
            this._volumeSlider.addEventListener("mouseleave", function(e) {
                this._dragging = false;
            });
            this._volumeSlider.addEventListener("mousemove", function(e) {
                if (this._dragging) {
                    self.onVolumeInteraction(e, this);
                }
            });
            this._container.addEventListener('onMuteUnMute', function(e) {
                self.onMuteUnMute(self);
            });
            this._ccBtn.addEventListener('click', function(e) {
                self.onCC(self);
            });
            this._bitBtn.addEventListener('click', function(e) {
                self.onBit(self);
            });
            this._adsSkipButton.addEventListener('click', function(e) {
                if (self._skipAvailable)
                    self.skipAd();
            });
            this._adContainer.addEventListener('click', function(e) {
                if (self._settings.startFullScreen && !self._isFullScreen && self._isAndroid) {
                    self.toggleFullScreen();
                }
                return false;
            });

            try {
                document.addEventListener(screenfull.raw.fullscreenchange, function() {
                    self.onResize();
                });
            } catch (e) {} // IE issue
        },

        onVolumeInteraction: function(e, volCon) {
            var parentOffset = volCon.getBoundingClientRect();
            var x = e.pageX - parentOffset.left;
            var vol = (x / volCon.offsetWidth);
            this.setVolume(vol, true);
            volCon._dragging = true;
        },

        onCloseCC: function() {
            this._ccList.active = false;
            this._ccList.style.maxHeight = "0";
            this._ccList.innerHTML = "";
        },

        onCC: function(scope) {
            this.onCloseBit();
            if (!this._ccList.active) {
                this._ccList.active = true;
            } else {
                this.onCloseCC();
                return;
            }

            var self = this;

            this._ccList.innerHTML = "";

            var cclist = '<ul class="ccList">';

            var sel = "";
            if (this._langSelected == '')
                sel = 'selected';
            cclist += '<li class="captionBtn ' + sel + '"><a data-lang="" data-id="" class="clink">No Captions</a></li>';
            for (i = 0; i < this._availableCaptions.length; i++) {
                sel = '';
                if (this._langSelected == this._availableCaptions[i].lang)
                    sel = 'selected';
                cclist += '<li class="captionBtn ' + sel + '"><a data-lang="' + this._availableCaptions[i].lang + '" data-id="' + this._availableCaptions[i].id + '" class="clink">' + this._availableCaptions[i].lang + '</a></li>';
            }
            cclist += '</ul>';
            this._ccList.innerHTML = cclist;
            this._ccList.style.maxHeight = (this._availableCaptions.length * 30) + 30 + "px";
            if (!this._ccList.hasListener) {
                this._ccList.hasListener = true;
                this._ccList.addEventListener('click', function(e) {
                    if (e.target.classList.contains('clink')) {
                        self.onCCSelected(e.target.getAttribute("data-lang"), e.target.getAttribute("data-id"), true);
                    }
                });
            }
        },

        onBit: function(scope) {
            this.onCloseCC();
            if (!this._bitList.active) {
                this._bitList.active = true;
            } else {
                this.onCloseBit();
                return;
            }

            var self = this;
            var availableBits = this._videodata.videoMP4List;
            this._bitList.innerHTML = "";

            var blist = '<ul class="bitList">';

            var sel = "";
            if (this._selectedBitrate == '')
                sel = 'selected';

            for (i = 0; i < availableBits.length; i++) {
                sel = '';
                if (this._selectedBitrate == availableBits[i].bitrate)
                    sel = 'selected';
                blist += '<li class="bitrateBtn ' + sel + '"><a data-bit="' + availableBits[i].bitrate + '" class="clink">' + availableBits[i].bitrate + 'kbs</a></li>';
            }
            blist += '</ul>';
            this._bitList.innerHTML = blist;
            this._bitList.style.maxHeight = (availableBits.length * 30) + 30 + "px";
            this._bitList.addEventListener('click', function(e) {
                if (e.target.classList.contains('clink')) {
                    self.onBitSelected(e.target.getAttribute("data-bit"));
                }
            });
        },

        onCloseBit: function() {
            this._bitList.active = false;
            this._bitList.style.maxHeight = "0";
            this._bitList.innerHTML = "";
        },


        onBitSelected: function(sBit) {
            if (sBit != "") {
                this._selectedBitrate = sBit;
                document.cookie = "djvideobit=" + this._selectedBitrate + "; path=/";
                var availableBits = this._videodata.videoMP4List;
                var selectedBit;
                for (var i = 0; i < availableBits.length; i++) {
                    if (availableBits[i].bitrate == sBit) {
                        selectedBit = availableBits[i];
                        break;
                    }
                }
                var curSource = this._video.getAttribute("src").split("#t=")[0];
                if (curSource != selectedBit.url) {
                    var isPaused = this._video.paused;
                    this._video.setAttribute("src", selectedBit.url + "#t=" + Math.round(this._currentTime));

                    if (!isPaused) {
                        this._video.play();
                        this._buffering.style.display = "block";
                    }
                }
            }
            this.onCloseBit();
        },
        onEscpaeKey: function(evt) {
            if (this._shareScreen)
                this._shareScreen.style.display = "none";
        },
        onCanPlay: function(evt) {

        },
        onRollOver: function(evt) {
            //if (this.scope._controls)
            //this.scope._controls.classList.add('control_static');
        },
        onRollOut: function(evt) {
            // if (this.scope._controls)
            //this.scope._controls.classList.remove('control_static');
        },
        onVideoComplete: function(evt) {
            this.scope.trigger(this.scope._wrapper, 'videoComplete', {
                guid: this.scope._videodata.guid
            });
            this.scope.trigger(this.scope._wrapper, 'onVideoComplete', {
                guid: this.scope._videodata.guid
            });

            try {
                this.scope._comscoreTag.stop();
            } catch (e) {}

            if (this.scope._adsLoader)
                this.scope._adsLoader.contentComplete();

            if (!this.scope._adMode) {
                if (this.scope._settings.resetOnComplete) {
                    this.scope.setupThumbnail();
                    this.scope._thumb.style.display = "block";
                    if (this.scope._iOS != 0) {
                        this.scope._video.webkitExitFullScreen();
                    }
                } else if (this.scope._settings.chainVideos) {
                    this.scope._video.pause();
                    this.scope.chainVideo();
                }else{
                    this.scope._video.currentTime = 0;
                }
            }
        },

        chainVideo: function() {
            var self = this;
            this._isChained = true;
            try {
                if (this._settings.playlist) {
                    for (var i = 0; i < this._settings.playlist.length; i++) {
                        if (this._settings.playlist[i].guid == this._videodata.guid) {
                            var tmp = this._settings.playlist.splice(i, 1);
                            this._settings.playlist.push(tmp[0]);
                            break;
                        }
                    }
                }
            } catch (e) {}

            if (this._settings.playlist !== null) {
                if (this._settings.playlist instanceof Object) {
                    this._videodata = this._settings.playlist[0];
                    this._settings.guid = this._videodata.guid;
                    if (!this._settings.disableChainPlay) {
                        this.loadVideo(true);
                    } else {
                        this.trigger(this._wrapper, 'onSuggestionPlay', this._videodata);
                    }

                }
            } else {

                var httpParam = "";
                if (this._settings.useHttps)
                    httpParam = "&https=1";
					
				var qStr = "";
				if(this._videodata.column !== null)
                	qStr = '&type=' + this._settings.suggestionsType + '&query='+this._videodata.column.replace("&", "%26").replace(" ", "%20");
				else
					qStr = '&type=' + this._settings.suggestionsType + '&query=news';
					
                try {
                    if (this._settings.suggestionsDoctype) {
                        qStr = "&doctype=" + this._settings.suggestionsDoctype;
                    } else if (this._settings.suggestionsQuery !== "") {
                        qStr = '&type=' + this._settings.suggestionsType + '&query=' + this._settings.suggestionsQuery.replace("&", "%26");
                    } else if (!this._videodata.column) {
						if (this._videodata['wsj-subsection']) {
                            qStr = '&type=wsj-subsection&query=' + this._videodata['wsj-subsection'].replace("&", "%26").replace(" ", "%20");
                        } else if (this._videodata['wsj-section']) {
                            qStr = '&type=wsj-subsection&query=' + this._videodata['wsj-section'].replace("&", "%26");
                        }  
                    }
                    if (this._settings.suggestionsGroupId != "") {
                        qStr += '&groupid=' + this._settings.suggestionsGroupId;
                    }else if(document.location.href.indexOf("www.wsj.com") !== -1){
                        qStr += '&groupid=4276'
                    }
                } catch (e) {}
				
                this._ajax.get(this._settings.api + 'find_all_videos.asp?count=15' + httpParam + qStr + '&fields=' + this._fields, onRecommendations, onRecommendations, null);
            }

            function onRecommendations(j) {
                var jd = JSON.parse(j);
                if (jd.items) {
                    self._settings.playlist = jd.items;
                } else {
                    self._settings.playlist = jd;
                }

                try {
                    if (self._settings.playlist) {
                        for (var i = 0; i < self._settings.playlist.length; i++) {
                            if (self._settings.playlist[i].guid == self._videodata.guid) {
                                var tmp = self._settings.playlist.splice(i, 1);
                                self._settings.playlist.push(tmp[0]);
                                break;
                            }
                        }
                    }
                } catch (e) {}
				if(self._settings.playlist.length > 0)
                	self.chainVideo();
            }
        },

        onPlaying: function(e) {
            this.scope._isStalled = false;
            if (!this.scope._playRequested) { // prevents video playing if pause requested during buffering
                this.scope._video.pause();
                this.scope._playRequested = true;
                return;
            }
            this.scope._video.style.display = "block";
            if (!this.scope._playRequested || !this.scope._adMode && this.scope._playBtn)
                this.scope._playBtn.innerHTML = this.scope._graphics['pause'];
            if (this.scope._playOverlay)
                this.scope._playOverlay.style.display = 'none';

            if (this.scope._settings.startFullScreen && !this.scope._isFullScreen) {
                this.scope.toggleFullScreen();
            }
            try {
                var overrideUrl = (window != window.top) ? this.scope._videodata.linkURL : document.location.href;
                PARSELY.video.trackPlay(
                    this.scope._videodata.guid,
                    {
                        title: this.scope._videodata.name,
                        section: this.scope._tObject.eVar20,
                        pub_date_tmsp: Date.now(),
                        authors: this.scope._videodata.author.toString(),
                        image_url: this.scope._videodata.videoStillURL,
                        tags: [this.scope._tObject.eVar70, this.scope._videodata.duration]
                    }
                    ,overrideUrl
                );
            } catch (e) {}
            try {
                this._comscoreTag.playContentPart(this._comscoreMeta);
            } catch (e) {}
            try {
                this.scope.trigger(this.scope._wrapper, "onPlayerStateChange", {
                    isPlaying: this.scope.eIsPlaying(),
                    isFullscreen: this.scope._isFullScreen
                });
            } catch (e) {}
        },
        onPaused: function(e) {
            if(!this.scope)
                this.scope = this;

            if (this.scope._playBtn)
                this.scope._playBtn.innerHTML = this.scope._graphics['play'];
            if (this.scope._playOverlay)
                this.scope._playOverlay.style.display = 'block';
            try {
                this._comscoreTag.stop();
            } catch (e) {}
            try {
                var overrideUrl = (window != window.top) ? this.scope._videodata.linkURL : document.location.href;
                PARSELY.video.trackPause(
                    this.scope._videodata.guid,
                    {
                        title: this.scope._videodata.name,
                        urlOverride: (window.location != window.parent.location) ? document.referrer : document.location.href,
                        section: this.scope._tObject.eVar20,
                        pub_date_tmsp: Date.now(),
                        authors: this.scope._videodata.author.toString(),
                        image_url: this.scope._videodata.videoStillURL,
                        tags: [this.scope._tObject.eVar70, this.scope._videodata.duration]
                    },overrideUrl
                );
            } catch (e) {}
            try {
                this.scope.trigger(this.scope._wrapper, "onPlayerStateChange", {
                    isPlaying: this.scope.eIsPlaying(),
                    isFullscreen: this.scope._isFullScreen
                });
            } catch (e) {}
        },

        onSeek: function(perc) {
            this._buffering.style.display = "block";
            var sec = Math.round(this._duration * perc);
            if(this._flash){
                this._flash.playerSeek(sec);
            }else{
                if (this._isAudio) {
                    this._audio.currentTime = sec;
                } else {
                    this._video.currentTime = sec;
                }
            }
        },

        onVideoError: function(e) {

        },

        onResize: function() { // update sizes for important elements
            var self = this;

            this._height = this._wrapper.offsetHeight;
            this._width = this._wrapper.offsetWidth;

            var adHeight = this._height;
            try {
                if (this._controls && !this._settings.startFullScreen && this._controls.offsetTop != 0) {
                    adHeight = this._controls.offsetTop;
                }
            } catch (e) {}
            if (this._adContainer && this._adsManager) {
                var vMode = google.ima.ViewMode.NORMAL;
                if (screenfull) {
                    if (screenfull.isFullscreen) {
                        vMode = google.ima.ViewMode.FULLSCREEN;
                    }
                }
                this._adsManager.resize(this._width, adHeight, vMode);
            }
            // Thumbnail sizing //
            if(this._thumbHint) {
                var hintSize = 36;
                if(this._width > 149)
                    hintSize = 50;
                if(this._width > 389)
                    hintSize = 60;
                if(this._width > 630)
                    hintSize = 70;
                this._thumbHint.style.height = hintSize+"px";
                this._thumbHint.firstChild.style.width = hintSize+"px";
                this._thumbHint.firstChild.style.height = hintSize+"px";
            }
            if ( this._thumbContent && this._thumbHint){
                if(this._height < 299) {
                    if(this._thumbDuration) {
                        this._thumbDuration.style.display = "inline";
                        this._thumbDuration.style.marginLeft = "10px";
                    }
                }
                if(this._width <= 470){
                    this._thumbContent.style.fontSize = "15px";
                    this._thumbContent.style.lineHeight = "22px";
                    if(this._thumbDuration) {
                        this._thumbDuration.style.fontSize = "13px";
                        this._thumbDuration.style.lineHeight = "22px";
                    }
                }
                var availableH = Math.round(Math.round(this._height / 2) - Math.round(this._thumbHint.clientHeight / 2)) / 2;
                this._thumbContent.style.bottom = Math.round(availableH - Math.round(this._thumbContent.clientHeight / 2))+"px";
            }

            if (this._controls) {
                if (this._width < 200) {
                    this._volumeBtn.style.display = "none";
                } else {
                    this._volumeBtn.style.display = "inline-block";
                }
            }
        },

        onScreenChange: function(e) {
            if (!this._iOS != 0) {
                this._isFullScreen = screenfull.isFullscreen;
            } else {
                this._isFullScreen = this._video.webkitDisplayingFullscreen;
            }
            if (this._settings.startFullScreen) {
                if (!this._isFullScreen) {
                    if (this._adsManager) {
                        this._adsManager.pause();
                        this._adsSkipButton.style.display = "none";
                        this._buffering.style.display = "none";
                    }
                    this._video.pause();
                    if (this._controls) {
                        this._controls.style.display = "none";
                        this._buffering.style.display = "none";
                        this._video.controls = false;
                    }
                } else if (this._isAndroid) {
                    this._controls.style.display = "block";
                }
            }
            try {
                this.trigger(this._wrapper, "onPlayerStateChange", {
                    isPlaying: this.eIsPlaying(),
                    isFullscreen: this._isFullScreen
                });
            } catch (e) {}
        },

        muteUnMute: function(mute, setCookie) {
            var muteVal = (mute == null) ? !this._muted : mute;
            if (muteVal) {
                if(this._flash)
                    this._flash.playerVolume(0);
                this._video.muted = true;
                this._audio.muted = true;
                this._muted = true;
                if (this._adsManager) {
                    this._adsManager.setVolume(0);
                }
                if (this._volumeBtnGraphics)
                    this._volumeBtnGraphics.innerHTML = this._graphics['volume-mute'];
                if (setCookie)
                    document.cookie = "djvideomute=1; path=/";
            } else {
                if(this._flash)
                    this._flash.playerVolume(parseFloat(this._volume) * 100);
                this._video.muted = false;
                this._audio.muted = false;
                if (this._adsManager) {
                    this._adsManager.setVolume(this._volume);
                }
                if (this._volumeBtnGraphics)
                    this._volumeBtnGraphics.innerHTML = this._graphics['volume-full'];
                this._muted = false;
                if (setCookie)
                    document.cookie = "djvideomute=0; path=/";
            }
            this.trigger(this._wrapper, 'onMuteUnMute', {});
        },

        onMuteUnMute: function(scope) {
            if (scope._volumeBtnGraphics) {
                if (scope._muted) {
                    scope._volumeBtnGraphics.innerHTML = scope._graphics['volume-mute'];
                } else {
                    scope._volumeBtnGraphics.innerHTML = scope._graphics['volume-full'];
                }
            }
            scope.showVolume();
        },

        setVolume: function(v, userSet) {
            if(parseFloat(v) > 1)
                v = 1;

            if(this._flash)
                this._flash.playerVolume(parseFloat(this._volume) * 100);
            if (this._adsManager)
                this._adsManager.setVolume(v);
            this._video.volume = v;
            this._audio.volume = v;
            this.showVolume();
            if (userSet){
                this._volume = v;
                document.cookie = "djvideovol=" + v +"; path=/";
                document.cookie = "djvideovol=" + v +";";
                this.muteUnMute(false, true);
            }
        },

        showVolume: function() {
			if(this._controls){
				var v = parseFloat(this._volume);
				var w = this._volumeBG.offsetWidth;
				if(w == 0)
					w = 80;
					
				if (this._muted)
					v = 0;
				if (this._volumeSetting) {
					this._volumeSetting.style.width = Math.round(w * v) + "px";
				}
				if (this._volumeHandle) {
					this._volumeHandle.style.left = Math.round(w * v) + "px";
				}
			}
        },

        showSharing: function() {
            var self = this;
            var linkUrl = this._videodata.linkURL;
            var url = (window.location != window.parent.location) ? document.referrer : document.location.href;
            var shareSite = "";
            if (this._settings.shareDomain !== null) {
                linkUrl = this._settings.shareDomain + this._videodata.linkRelativeURL;
            }else if(url.indexOf("marketwatch.com") !== -1) {
                this._settings.shareDomain = "http://www.marketwatch.com";
                shareSite = '&site=video.marketwatch.com';
                linkUrl = "http://www.marketwatch.com" + this._videodata.linkRelativeURL;
            }else if(url.indexOf("barrons.com") !== -1) {
                this._settings.shareDomain = "http://www.barrons.com";
                shareSite = '&site=video.barrons.com';
                linkUrl = "http://www.barrons.com" + this._videodata.linkRelativeURL;
            }
            var closeScreen = function(e) {
                e.currentTarget.parentNode.style.display = "none";
                document.getElementById('closeBtn-' + self._videoId).removeEventListener("click", self);
              //  self._adContainer.classList.remove('disableMouse');
            }

            //this._adContainer.classList.add('disableMouse');

            var icons = '<div class="closeBtn" id="closeBtn-' + this._videoId + '"><svg height="100%" viewBox="0 0 24 24" width="100%"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="#fff"></path></svg></div><table  class="share-wrapper"><tr><td valign="middle"><table class="shareTable"><tr><td><label>Video Link</label></td></tr><tr><td><input onclick="this.setSelectionRange(0, this.value.length)" id="embed-form-' + this._videoId + '" type="text" value="' + linkUrl + '" ></input></td></tr><tr><td><label>Video Embed</label></td></tr><tr><td><input onclick="this.setSelectionRange(0, this.value.length)" id="embed-form-' + this._videoId + '" type="text" value="<iframe allowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; marginheight=&quot;0&quot; marginwidth=&quot;0&quot; width=&quot;512&quot; height=&quot;288&quot; src=&quot;https://video-api.wsj.com/api-video/player/v3/iframe.html?guid=' + this._videodata.guid + '&shareDomain='+this._settings.shareDomain+shareSite+'&quot;></iframe>" /></td></tr><tr><td><label>Social Links</label></td></tr><tr><td><ul class="share-buttons"><li><a href="https://www.facebook.com/sharer/sharer.php?u=' + linkUrl + '&t=' + this._videodata.name + '" title="Share on Facebook" target="_blank"><img src="' + this._settings.api + 'player/v3/css/sharing/Facebook.svg"></a></li><li><a href="https://twitter.com/intent/tweet?url=' + linkUrl + '&text=' + this._videodata.name + '" target="_blank" title="Tweet"><img src="' + this._settings.api + 'player/v3/css/sharing/Twitter.svg"></a></li><li><a href="mailto:?subject=' + this._videodata.name + '&body=Description:' + linkUrl + '" target="_blank" title="Email"><img src="' + this._settings.api + 'player/v3/css/sharing/Email.svg"></a></li></ul></td></tr></table></td></tr></table>';

            this._shareScreen.innerHTML = icons;
            this._shareScreen.style.display = "block";

            document.getElementById('closeBtn-' + this._videoId).addEventListener('click', closeScreen);
            if (this._video)
                this._video.pause();

            if (this._adsManager)
                this._adsManager.pause();
        },

        adListeners: function() {
            var self = this;
            this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,
                function(e) {
                    self.onAdError(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,
                function(e) {
                    self.onContentPauseRequested(e);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,
                function(e) {
                    self.onContentResumeRequested(e);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,
                function(e) {

                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,
                function(e) {
                    self.onAdComplete(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,
                function(e) {
                    self.onAdLoaded(e);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,
                function(e) {
                    self.onAdStarted(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,
                function(e) {
                    self.onAdPaused(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,
                function(e) {
                    self.onAdResumed(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,
                function(e) {
                    self.onAdSkipped(e, self);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,
                function(e) {
                    self.onAdClicked(e);
                });
            this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,
                function(e) {
                    self.onSkippableChanged(e);
                });
        },

        onAdClicked: function(e) {
            this._adsManager.pause();
        },

        onAdStarted: function(e) {

            this._adStarted = true;
            this._skipAvailable = false;
            this._currentAd = e.getAd();
            this.onResize();
            this.setupListeners(false);
            this._vrWrapper.style.display = "none";
			try{
				if(this._video.textTracks[0])
					this._video.textTracks[0].mode = "hidden";
			}catch(e){}
			//this._adContainer.classList.add('disableMouse');
            if (this._isMobile && !this._settings.startFullScreen) {
            	//this._adContainer.classList.add('disableMouse');
            }
            if (this._controls) {
                this._scrubProgress.style.display = "none";
                this._playBtn.innerHTML = this._graphics['pause'];
            }
            try {
                this.trigger(this._wrapper, 'adStarted');
				if (this._currentAd.getDuration() < 2)
					this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[16]; // 117 119 blank ad start
				else
					this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[6]; // event73 , event106
                try {
                    scope.setTrackingVars();
                } catch (e) {};
                this._tObject.pageName = 'WSJLive_Video_Ad';
                this._tObject.eVar4 = 'WSJLive_Video_Ad';
                this._tObject.eVar46 = "none";
                this._tObject.eVar49 = this._adId;

                this._tObject.eVar50 = this._adTagUsed;
                try {
                    var ordIndex = this._adTagUsed.indexOf(';ord=');
                    if (ordIndex != -1)
                        this._tObject.eVar50 = this._adTagUsed.substring(0, ordIndex);
                } catch (e) {}
                this._tObject.pev2 = "Video_Ad_Started";

                this._tObject.pe = 'lnk_o';
                svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                try {
                    this._comscoreTag.stop();
                } catch (e) {}
                try {
                    this._comscoreTag.playAdvertisement();
                } catch (e) {}
            } catch (e) {}

            try {
                var companionAdsRtn = [];
                var s = new google.ima.CompanionAdSelectionSettings();
                s.resourceType = google.ima.CompanionAdSelectionSettings.ResourceType.STATIC;
                s.sizeCriteria = google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;
                var cAds = this._currentAd.getCompanionAds(1600, 1600, s);
                if (cAds.length) {
                    for (var i = 0; i < cAds.length; i++) {
                        companionAdsRtn[i] = {
                            url: cAds[i].h,
                            clickUrl: "",
                            height: cAds[i].l.height,
                            width: cAds[i].l.width,
                            type: "html"
                        };
                    }
                }
                try {
                    this.trigger(this._wrapper, "onCompanions", {
                        availableAds: companionAdsRtn
                    });
                } catch (e) {}
            } catch (e) {
                try {
                    this.trigger(this._wrapper, "onCompanions", {
                        availableAds: []
                    });
                } catch (e) {}
            }

            if (this._currentAd.isLinear()) {
                if (this._controls) {
                    this._scrubBar.classList.remove('video-scrub-hover');
                    this._controls.classList.add('video-advertisment');
                    this._buffering.style.display = "none";
                    this._adProgress.style.display = "block";
                    this._adContainer.style.display = "block";
                    this._controls.style.display = "block";

                    if (this._adsManager.isCustomPlaybackUsed()) {
                        this._video.style.display = "block";
                    } else {
                        this._video.style.display = "none";
                    }

                    if(this._isSafariMac && this._safariV >= 11 && !this._safariInit && !this._isMobile){
						//this.setupSafariThumbnail();	
					}

                    if (!this._settings.startFullScreen) {
                        this._playBtn.innerHTML = this._graphics['pause'];
                    }
                }
                try {
                    this.trigger(this._wrapper, "onPlayerStateChange", {
                        isPlaying: false,
                        isFullscreen: this._isFullScreen
                    });
                } catch (e) {}

                this._adMode = true;
                this._adPaused = false;

                if (this._muted)
                    this._adsManager.setVolume(0);
                else
                    this._adsManager.setVolume(this._volume);

                this.showVolume();
                this._adInfo = this._currentAd.getAdPodInfo();
                this._adDuration = this._currentAd.getDuration();
                var skipEnabled = true;
                try{
                    if(this._currentAd.getUiElements().indexOf("countdown") >= 0){
                        skipEnabled = false;
                    }
                }catch(e){}
                if (this._adsSkipButton && this._adDuration > 16 && skipEnabled)
                    this._adsSkipButton.style.display = "block";
                this.startAdTimer();
                var t1 = "video.wsj.com";
                if (this._settings.site != '' && typeof(this._settings.site) != "undefined")
                    t1 = this._settings.site;

                var ids = {
                    "level1": t1,
                    "level2": this._currentAd.getTitle(),
                    "level3": this._currentAd.getAdId(),
                    "slicer1": this.getDomain(document.domain)
                };
                this._moatAdManager = initMoatTracking(this._video, ids, this._adDuration, 'dowjonesjsvideo585726540105', this._adTagUsed);
                this._moatAdManager.dispatchEvent({
                    "type": "AdVideoStart",
                    "adVolume": this._volume
                });
                if(this._settings.startFullScreen && !this._isFullScreen && this._isMobile) { // if a user exits fullscreen when ad is buffering prevent playing
                    this._adsManager.pause();
                }
            } else {
                this._video.play();
            }

        },

        skipAd: function(evt) {
            if (this._adsManager) {
                this._adsManager.skip();
                this._adsManager.stop();
            }
        },

        onAdSkipped: function(evt, scope) {
            this.onAdRemoved();
        },

        onSkippableChanged: function(evt) {

        },

        onAdComplete: function(evt, scope) {
            this.onAdRemoved();
            this._adStarted = false;
            scope.trigger(scope._wrapper, 'adComplete');
            scope._tObject.linkTrackEvents = scope._tObject.events = scope._currentEvents[7]; // event74 , event107
            scope._tObject.pageName = 'WSJLive_Video_Ad';
            scope._tObject.eVar4 = 'WSJLive_Video_Ad';
            scope._tObject.pev2 = "Video_Ad_Complete";
            scope._tObject.eVar46 = "none";
            scope._tObject.eVar49 = scope._adId;
            scope._tObject.eVar50 = scope._adTagUsed;
            try {
                var ordIndex = scope._adTagUsed.indexOf(';ord=');
                if (ordIndex != -1)
                    scope._tObject.eVar50 = scope._adTagUsed.substring(0, ordIndex);
            } catch (e) {}
            scope._tObject.pe = 'lnk_o';
            svid.tl(scope, 'o', scope._tObject.pev2, scope._tObject);
            this._ajax.get("https://video-api.wsj.com/enf/wsjdn-video.asp?source=" + scope._settings.larsAdId + "&guid={" + scope._settings.guid + "}");
        },

        onAdResumed: function(evt) {
            if (this._adMode) {
                this._adPaused = false;
                if (this._playBtn)
                    this._playBtn.innerHTML = this._graphics['pause'];
                if (this._playOverlay)
                    this._playOverlay.style.display = 'none';
            }

            if (this._settings.startFullScreen && !this._isFullScreen) {
                this.toggleFullScreen();
            }
            try {
                this._comscoreTag.playAdvertisement();
            } catch (e) {}

            try {
                this.trigger(this._wrapper, "onPlayerStateChange", {
                    isPlaying: true,
                    isFullscreen: this._isFullScreen
                });
            } catch (e) {}
        },

        onAdPaused: function(evt) {
            if (this._adMode) {
                this._adPaused = true;
                if (this._playBtn)
                    this._playBtn.innerHTML = this._graphics['play'];

                if (this._playOverlay)
                    this._playOverlay.style.display = 'block';
                try {
                    this._comscoreTag.stop();
                } catch (e) {}
            }

            try {
                this.trigger(this._wrapper, "onPlayerStateChange", {
                    isPlaying: false,
                    isFullscreen: this._isFullScreen
                });
            } catch (e) {}
        },

        startAdTimer: function() {
            var self = this;
            this._adTime = 0;
            if (this._adTimer) {
                clearInterval(this._adTimer);
            }
            this._adTimer = setInterval(function() {
                self.adTick();
            }, 500);
        },
		
		startAdTimeoutTimer: function() {
            var self = this;
			this._adTimeoutFail = false;
            if (this._adTimeoutTimer) {
                clearInterval(this._adTimeoutTimer);
            }
            this._adTimeoutTimer = setInterval(function() {
				self._adTimeoutFail = true;
                self.adResponseTimeout();
            }, self._adResponseTimeout);
        },
		
		adResponseTimeout: function(evt) {
			this.onAdError("timeout");
			this._settings.adsEnabled = false;
		},

        adTick: function(evt) {
            if (!this._adPaused && this._adsManager.getRemainingTime() > 0) {
                var adProg = (this._adDuration - this._adsManager.getRemainingTime()) / this._adDuration;
                if (adProg > 0) {
                    if(this._buffering)
                        this._buffering.style.display = "none";
                }

                try {
                    this.trigger(this._wrapper, "onAdTimeUpdate", {
                        percent: adProg,
                        duration: this._adDuration
                    });
                } catch (e) {}

                this._adTime++;
                if (this._adTime > 60) {
                    clearInterval(this._adTimer);
                }
                if (this._adDuration > 15) {
                    if (this._adTime > 30) {
                        if (this._adCountdownText) {
                            this._videoSkipIcon.style.display = "inline-block";
                            this._adCountdownText.innerHTML = "";
                        }
                        this._skipAvailable = true;
                    } else {
                        if (this._adCountdownText) {
                            this._videoSkipIcon.style.display = "none";
                            var tmLeft = Math.round(15 - Math.floor(this._adTime / 2));
                            if (tmLeft == 0) {
                                this._adCountdownText.innerHTML = "";
                                this._videoSkipIcon.style.display = "inline-block";
                            } else {

                                this._adCountdownText.innerHTML = " in " + Math.round(15 - Math.floor(this._adTime / 2));
                            }
                        }
                    }
                } else {
                    if(this._adsSkipButton)
                        this._adsSkipButton.style.display = "none";
                }

                if (this._adsManager) {
                    if (this._adsManager.getRemainingTime() < 1)
                        clearInterval(this._adTimer);
                }
                try {
                    if (this._adProgress) {
                        this._adProgress.style.width = Math.round(this._scrubBar.offsetWidth * adProg) + "px";
                    }
                    if (this._timeDisplay)
                        this._timeDisplay.innerHTML = this.gTimeFormat(this._adsManager.getRemainingTime()) + ' Advertisement';
                } catch (e) {}
            }
        },

        onAdRemoved: function() {
            this._adStarted = false;
            this._adMode = false;
            this._skipAvailable = false;
            this.setupListeners(true);
			
			try{
				if(this._video.textTracks[0])
					this._video.textTracks[0].mode = "showing";
			}catch(e){}

            if (this._adsSkipButton) {
                this._adsSkipButton.style.display = "none";
            }
            if (this._adContainer) {
                this._adContainer.style.display = "none";
            }
            if (this._videodata.format == 'vr') {
                this._vrWrapper.style.display = "block";
            }

            if (this._controls) {
                this._scrubProgress.style.display = "block";
                this._adProgress.style.display = "none";
                this._scrubBar.classList.add('video-scrub-hover');
                this._controls.classList.remove('video-advertisment');
                this._playOverlay.style.display = "none";
                //if (this._isIpad) {
                //  this._controls.style.display = "none";
                //this._video.setAttribute('controls', true);
                //}
            }

            if (this._adsManager) {
                if (!this._adsManager.isCustomPlaybackUsed()) {
                    this._video.style.display = "block";
                }
            }
            try {
                this._moatAdManager.dispatchEvent({
                    "type": "AdStopped",
                    "adVolume": this._volume
                });
            } catch (e) {}
            clearInterval(this._adTimer);
            try {
                this._comscoreTag.stop();
            } catch (e) {}
        },

        onAdLoaded: function(evt) {
            try {
                var tempAd = evt.getAd();
                var wrappersStr = "";
                var wrappers = tempAd.getWrapperAdIds();
                for (w in wrappers) {
                    wrappersStr += wrappers[w] + ",";
                }
                if (tempAd.getAdId()) {
                    this._adId = wrappersStr + tempAd.getAdId();
                } else {
                    this._adId = "none";
                }

            } catch (e) {
                this._adId = "none";
            }
            this.trigger(this._wrapper, 'adLoaded', tempAd);
        },

        onContentPauseRequested: function() {
            this._video.pause();
        },

        onContentResumeRequested: function() {

            this.onAdRemoved();
            if (this._playOverlay)
                this._playOverlay.style.display = "none";
            this._video.play();
        },

        onAdError: function(evt) {
			
			if (this._adTimeoutTimer) {
                clearInterval(this._adTimeoutTimer);
            }
            if (this._adErrorTracked) {
                this._adErrorEvent = evt;
                return;
            }
            this._adErrorTracked = true;
            try {
                this._adsLoading = false;
                var omnitureErrorObj = {
                    type: "",
                    code: "",
                    msg: ""
                };
                if (evt === null) {
                    omnitureErrorObj.code = "0";
                    omnitureErrorObj.msg = "Ads Blocked";
                    this.onAdRemoved();
                }else if (evt === "timeout") {
                    omnitureErrorObj.code = "0";
                    omnitureErrorObj.msg = "No IMA Loader Response After 5 Seconds";
					
                    this.onAdRemoved();
                } else {
                    var err = evt.getError(); // DONT SEND TRACKING FOR ERROR CODE 900
                    omnitureErrorObj.code = err.getErrorCode();
                    omnitureErrorObj.msg = err.getMessage();
                    if ((typeof(omnitureErrorObj.msg) !== 'undefined') && (omnitureErrorObj.msg !== null)) {
                        var innerEr = err.getInnerError();
                        if ((typeof(innerEr) !== 'undefined') && (innerEr !== null)) {
                            omnitureErrorObj.msg = omnitureErrorObj.msg + " - " + innerEr;
                        }
                    } else {
                        omnitureErrorObj.msg = 'A null was recieved from ima getMessage';
                    }
                    if (err.getErrorCode() != 900) { // error can be ignored per google ima team
                        this.onAdRemoved();
                    }
                }
            } catch (e) {}
            this._video.play();
            if (!this._adStarted) {
                this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[2]; // event41 , event103
            } else {
                this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[14]; // event114 , event115
            }
            try {
                this.setTrackingVars();
            } catch (e) {};
            this._tObject.eVar46 = omnitureErrorObj.msg;
            this._tObject.eVar49 = this._adId;
            this._tObject.eVar50 = this._adTagUsed;
            try {
                var ordIndex = this._adTagUsed.indexOf(';ord=');
                if (ordIndex != -1)
                    this._tObject.eVar50 = this._adTagUsed.substring(0, this._adTagUsed.indexOf(';ord='));
            } catch (e) {}
            if (this._isAudio) {
                this._tObject.pev2 = "Ads Not Supported";
            } else {
                this._tObject.pev2 = "Ad_Error";
            }

            this._tObject.pe = 'lnk_o';
            svid.tl(this, 'o', this._tObject.pev2, this._tObject);
            this._tObject.eVar50 = "none";
            this.trigger(this._wrapper, 'adError', omnitureErrorObj);
        },

        // COMMANDS //

        goFullScreen: function() {

        },

        toggleFullScreen: function(evt) {
            var scope = this;
            if (evt) {
                scope = evt.currentTarget.scope;
            }
            if (scope._iOS) {
                scope._video.webkitEnterFullscreen();
            } else {
                if (!evt) {
                    screenfull.toggle(scope._wrapper);
                } else {
                    screenfull.toggle(evt.currentTarget.scope._wrapper);
                }
            }
            this._isFullScreen = !this._isFullScreen;
        },

        playPause: function(e) {
            if(this._flash){
                if(this._fPlaying)
                    this._flash.playerPause();
                else
                    this._flash.playerResume();
                return;
            }
            if (!this._adMode) {
                if (this._isAudio) {
                    if (this._audio.paused) {
                        this._audio.play();
                    } else {
                        this._audio.pause();
                    }
                } else {
                    if (this._video.paused) {
                        this._video.play();
                        this._playRequested = true;
                        this._playBtn.innerHTML = this._graphics['pause'];
                    } else {
                        this._video.pause();
                        this._playRequested = false;
                        this._playBtn.innerHTML = this._graphics['play'];
                    }
                }
            } else {
                if (this._adsManager) {
                    if (this._adPaused) {
                        this._playRequested = true;
                        this.onAdResumed();
                        this._adsManager.resume();
                        if(this._adsManager.isCustomPlaybackUsed())
                            this._video.play();
                    } else {
                        this._playRequested = false;
                        this._adsManager.pause();
                        this.onAdPaused();
                        if(this._adsManager.isCustomPlaybackUsed())
                            this._video.pause();
                    }
                }
            }
        },

        // EXTERNAL
        eResumeVideo: function(e) {
            this._self._playRequested = true;
            if (this._self._adMode) {
                this._self._adsManager.resume();
            } else {
                if (this._self._video.paused) {
                    this._self._video.play();
                    this._self._playRequested = true;
                }
            }
        },

        eSeek: function(tm, perc) {
            if (this._self._video && !this._self._adMode) {
                if (perc) {
                    var sec = Math.round(this._self._duration * (tm / 100));
                    this._self._video.currentTime = sec;
                } else {
                    this._self._video.currentTime = tm;
                }
            }
        },

        ePauseVideo: function(e) {
            this._self._playRequested = false;
            if(this._self._flash){
                this.self._flash.playerPause();
                return;
            }
            if (this._self._adMode) {
                this._self._adsManager.pause();
            } else {
                if (!this._self._video.paused) {
                    this._self._video.pause();
                }
            }
        },

        eKillVideo: function(e){
            if(this._self._adsManager)
                this._self._adsManager.stop();
        },

        eIsPlaying: function() {
            if (!this._self._video.paused || this._self._video.seeking || (this._self._adPaused == false && this._self._adMode)) {
                return true;
            } else {
                if (this._self._adMode && this._self._playRequested)
                    return true;
                else
                    return false;
            }
        },

        ePlayVideo: function(vDat) {
            this._self._videodata = vDat;
            if (!this._self._videodata.hls) {
                this._self._settings.guid = this._self._videodata.guid;
                this._self.loadVideo(true);
                return;
            } else {
                this._self.startVideo();
            }
        },

        eLoadVideo: function(d) {
            this._self._settings.guid = d.guid;
            if (d.vidora)
                this._self._isChained = false;
            if (!this._self._contentInitialized && this._self._isMobile) {
                window.location.href = d.linkURL;
            } else {
                this._self.loadVideo(true);
                if (this._self._shareScreen)
                    this._self._shareScreen.style.display = "none";
            }
        },

        eUpdatePlaylist: function(p) {
            try {
                if (p.items)
                    this._self._settings.playlist = p.items;
            } catch (e) {
                this._self._settings.playlist = p;
            };
        },

        eMute: function(m) {
            this._self.muteUnMute(m, false);
        },

        eGetStatus: function() {
            return {
                isPlaying: this._self.eIsPlaying(),
                isFullscreen: this._self._isFullScreen
            };
        },

        // VR //
        initVrPlayback: function(){
            var self = this;
            if (typeof(THREE) === 'undefined') {
                this.loadScript('//video-api.wsj.com/api-video/player/v3/js/three.min.js', function() {
                    self.initVrPlayback();
                }, function() { // error
                    self.startVideo();
                });
                return;
            }
            this._vrWrapper.style.display = "block";
            var texture_placeholder;
            this._vrComponents = {};
            this._vrComponents.isUserInteracting = false;
            onMouseDownMouseX = 0, onMouseDownMouseY = 0,
                lon = 180, onMouseDownLon = 0,
                lat = 0, onMouseDownLat = 0,
                phi = 0, theta = 0;
            var mesh;
            this._vrComponents.camera = new THREE.PerspectiveCamera( 75, parseInt(getComputedStyle(this._vrWrapper).width) / parseInt(getComputedStyle(this._vrWrapper).height), 1, 1100 );
            if(this._isAndroid){
                this._vrComponents.controls = new THREE.DeviceOrientationControls( this._vrComponents.camera );
            }
            this._vrComponents.camera.target = new THREE.Vector3( 0, 0, 0 );
            this._vrComponents.scene = new THREE.Scene();

            var geometry = new THREE.SphereGeometry( 500, 60, 40 );
            geometry.scale( - 1, 1, 1 );

            this._video.crossOrigin = "anonymous";
            //this._video.src = videoUrl;
            var texture = new THREE.VideoTexture( this._video );
            texture.minFilter = THREE.LinearFilter;
            texture.generateMipmaps = false;

            var material   = new THREE.MeshBasicMaterial( { map : texture } );

            mesh = new THREE.Mesh( geometry, material );
            this._vrComponents.scene.add( mesh );

            this._vrComponents.renderer = new THREE.WebGLRenderer();
            this._video.crossOrigin = 'anonymous';
            var context = this._vrComponents.renderer.getContext();
            if(!context.getExtension("OES_texture_half_float_linear")){
                //alert("VR Not Supported.");
                //return false;
            }
            this._vrComponents.renderer.setPixelRatio( this._vrWrapper.devicePixelRatio );
            this._vrComponents.renderer.setSize( parseInt(getComputedStyle(this._vrWrapper).width),parseInt(getComputedStyle(this._vrWrapper).height) );
            this._vrWrapper.appendChild( this._vrComponents.renderer.domElement );
            this._video.style.display = 'none';

            //this._vrComponents.effect = new THREE.StereoEffect( this._vrComponents.renderer );
            //this._vrComponents.effect.setSize( parseInt(getComputedStyle(this._vrWrapper).width),parseInt(getComputedStyle(this._vrWrapper).height) );

            //$jQ111(window).resize(function() {
            onWindowResize();
            //});
            this._video.play();
            animate();

            if(this._isMobile){
                this._vrWrapper.addEventListener( 'touchstart', onDocumentMouseDown, false );
                this._vrWrapper.addEventListener( 'touchmove', onDocumentMouseMove, false );
                this._vrWrapper.addEventListener( 'touchend', onDocumentMouseUp, false );
            }else{
                document.addEventListener( 'mousedown', onDocumentMouseDown, false );
                document.addEventListener( 'mousemove', onDocumentMouseMove, false );
                document.addEventListener( 'mouseup', onDocumentMouseUp, false );
            }

            window.onresize = onWindowResize;

            function onDocumentMouseDown( e ) {
                e.preventDefault();
                if(typeof e.touches !== 'undefined'){
                    e.clientX = e.touches[0].clientX;
                    e.clientY = e.touches[0].clientY;
                }
                self._vrComponents.isUserInteracting = true;
                if(self._vrComponents.controls)
                    self._vrComponents.controls.disconnect();
                onMouseDownMouseX = e.clientX;
                onMouseDownMouseY = e.clientY;
                onMouseDownLon = lon;
                onMouseDownLat = lat;
                if(self._isMobile){
                    if(self._controls.style.display != "none"){
                        self.playPause(e);
                    }
                    self._controls.style.display = "block";
                    self._controls.style.bottom = "0px";
                    self._controls.hideTime = self._video.currentTime;
                }
            }

            function onDocumentMouseMove( e ) {
                if ( self._vrComponents.isUserInteracting === true ) {
                    if(typeof e.touches !== 'undefined'){
                        e.clientX = e.touches[0].clientX;
                        e.clientY = e.touches[0].clientY;
                    }
                    if(e.target.width){
                        lon = ( onMouseDownMouseX - e.clientX ) * .15 + onMouseDownLon;
                        lat = ( e.clientY - onMouseDownMouseY ) * .15 + onMouseDownLat;
                        if(self._vrComponents.controls)
                            self._vrComponents.controls.update();
                    }
                }
            }

            function onDocumentMouseUp( e ) {
                self._vrComponents.isUserInteracting = false;
                if(self._vrComponents.controls)
                    self._vrComponents.controls.connect();
            }

            function onWindowResize() {
                self._vrComponents.camera.aspect = self._vrWrapper.clientWidth / self._vrWrapper.clientHeight;
                self._vrComponents.camera.updateProjectionMatrix();
                self._vrComponents.renderer.setSize( self._vrWrapper.clientWidth, self._vrWrapper.clientHeight );
            }

            function animate() {
                //onWindowResize();
                requestAnimationFrame( animate );
                update();
            }

            function update() {

                lat = Math.max( - 85, Math.min( 85, lat ) );

                phi = THREE.Math.degToRad( 90 - lat );
                theta = THREE.Math.degToRad( lon );

                self._vrComponents.camera.target.x = 500 * Math.sin( phi ) * Math.cos( theta );
                self._vrComponents.camera.target.y = 500 * Math.cos( phi );
                self._vrComponents.camera.target.z = 500 * Math.sin( phi ) * Math.sin( theta );

                self._vrComponents.camera.lookAt( self._vrComponents.camera.target );
                if(self._vrComponents.controls)
                    self._vrComponents.controls.update();

                /*
                 // distortion
                 camera.position.copy( camera.target ).negate();
                 */

                self._vrComponents.renderer.render( self._vrComponents.scene, self._vrComponents.camera );
                //self._vrComponents.effect.render( self._vrComponents.scene, self._vrComponents.camera );
            }
            return true;
        },

        displayVrMsg: function(){
            var self = this;
            this._vrWrapper.style.display = "none";
            if(this._controls)
                this._controls.style.display = "none";
            this._buffering.style.display = "none";
            var pauseV = function(){
                self.ePauseVideo();
            }
            var html = '<span class="closebtn">&times;</span>360 videos are not available in this browser.<br />Please try with the Chrome browser'
            var div = document.createElement('div');
            div.className = 'vr-alert';
            div.innerHTML = html;
            this._wrapper.appendChild(div);
            setTimeout(function(){ div.classList.add('vr-down'); }, 500);
            div.onclick =  function(){div.style.display = "none"; self.chainVideo();};
            document.getElementById("vrLearnMore").onclick =  function(){self._video.pause();};

        },

        // TRACKING //
        trackInit: function() {
            this._ajax.get("https://video-api.wsj.com/enf/wsjdn-video.asp?source=" + this._settings.larsId + "&guid={" + this._settings.guid + "}");
            this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[0]; // event36 , event101

            this._tObject.eVar10 = this._tObject.pageName;

            try {
                this.setTrackingVars();
            } catch (e) {};

            if (this._isAudio)
                this._tObject.pev2 = "Podcast_Start";
            else
                this._tObject.pev2 = "Video_Start";

            this._tObject.eVar46 = "none";
            this._tObject.eVar49 = "none";
            this._tObject.eVar50 = "none";
            this._tObject.pe = 'lnk_o';
            svid.tl(this, 'o', this._tObject.pev2, this._tObject);
            try {
                this._comscoreTag.playContentPart(this._comscoreMeta);
            } catch (e) {}
            try {
                var ids = {
                    "level1": this._videodata['wsj-section'],
                    "level2": this._videodata['wsj-subsection'],
                    "level3": this._videodata.guid,
                    "slicer1": this.getDomain(document.domain)
                };
                this._moatManager = initMoatTracking(this._video, ids, this._videodata.duration, 'dowjonesjsvideocontent394324437046', this._videodata.hls);
                this._moatManager.dispatchEvent({
                    "type": "AdVideoStart",
                    "adVolume": this._volume
                });
            } catch (e) {}
            try {
                window.vidora.push(["send", "play", this._videodata.guid]);
            } catch (e) {}
        },

        trackContentStarted: function() {
            this._contentStartTracked = true;

            this._adPlayNumber = (this._adPlayNumber > 3) ? 1 : this._adPlayNumber + 1;
            document.cookie = "djadplaynum=" + this._adPlayNumber.toString()+"; path=/";

            try {
                this.setTrackingVars();
            } catch (e) {};

            this._tObject.eVar10 = this._tObject.pageName;

            this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[8]; // event96 , event108

            if (this._isAudio) {
                this._tObject.pev2 = "Podcast_Content Started";
            } else {
                this._tObject.pev2 = "Video_Content Started";
            }
            this._tObject.eVar46 = "none";
            this._tObject.eVar49 = "none";
            this._tObject.eVar50 = "none";
            this._tObject.pe = 'lnk_o';
            svid.tl(this, 'o', this._tObject.pev2, this._tObject);
            this._tObject.linkTrackEvents = this._tObject.events = "";

            try {
                this._comscoreTag.playContentPart(this._comscoreMeta);
            } catch (e) {}
        },

        trackProgress: function(perc, tm) {
            if (!this._adMode) {
                if (perc > 1 && !this._contentStartTracked) {
                    this.trackContentStarted();
                }

                if (!this._trackingMilestones[0] && (perc >= 25)) {

                    this._trackingMilestones[0] = true;
                    this._tObject.pageName = this._tObject.eVar10;
                    try {
                        this._moatManager.dispatchEvent({
                            "type": "AdVideoFirstQuartile",
                            "adVolume": this._volume
                        });
                    } catch (e) {}
                    this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[9]; // event97 , event109

                    try {
                        this.setTrackingVars();
                    } catch (e) {};

                    if (this._isAudio) {
                        this._tObject.pev2 = "Podcast_Milestone 1/4";
                    } else {
                        this._tObject.pev2 = "Video_Milestone 1/4";
                    }

                    this._tObject.eVar46 = "none";
                    this._tObject.eVar49 = "none";
                    this._tObject.eVar50 = "none";
                    this._tObject.pe = 'lnk_o';
                    svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                    this._tObject.linkTrackEvents = this._tObject.events = "";

                }
                if (!this._trackingMilestones[1] && (perc >= 50)) {
                    this._trackingMilestones[1] = true;
                    try {
                        this._moatManager.dispatchEvent({
                            "type": "AdVideoMidpoint",
                            "adVolume": this._volume
                        });
                    } catch (e) {}
                    this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[10]; // event98 , event110

                    try {
                        this.setTrackingVars();
                    } catch (e) {};
                    this._tObject.pageName = this._tObject.eVar10;
                    if (this._isAudio) {
                        this._tObject.pev2 = "Podcast_Milestone 2/4";
                    } else {
                        this._tObject.pev2 = "Video_Milestone 2/4";
                    }
                    this._tObject.eVar46 = "none";
                    this._tObject.eVar49 = "none";
                    this._tObject.eVar50 = "none";
                    this._tObject.pe = 'lnk_o';
                    svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                    this._tObject.linkTrackEvents = this._tObject.events = "";

                }
                if (!this._trackingMilestones[2] && (perc >= 75)) {
                    this._trackingMilestones[2] = true;
                    try {
                        this._moatManager.dispatchEvent({
                            "type": "AdVideoThirdQuartile",
                            "adVolume": this._volume
                        });
                    } catch (e) {}
                    this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[11]; // event99 , event111

                    try {
                        this.setTrackingVars();
                    } catch (e) {};
                    this._tObject.pageName = this._tObject.eVar10;
                    if (this._isAudio) {
                        this._tObject.pev2 = "Podcast_Milestone 3/4";
                    } else {
                        this._tObject.pev2 = "Video_Milestone 3/4";
                    }
                    this._tObject.eVar46 = "none";
                    this._tObject.eVar49 = "none";
                    this._tObject.eVar50 = "none";
                    this._tObject.pe = 'lnk_o';
                    svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                    this._tObject.linkTrackEvents = this._tObject.events = "";

                }
                if (!this._trackingMilestones[3] && (perc >= 95)) {
                    this._trackingMilestones[3] = true;
                    try {
                        this._moatManager.dispatchEvent({
                            "type": "AdStopped",
                            "adVolume": this._volume
                        });
                    } catch (e) {}
                    this._tObject.linkTrackEvents = this._tObject.events = this._currentEvents[12]; // event100 , event112

                    try {
                        this.setTrackingVars();
                    } catch (e) {};
                    this._tObject.pageName = this._tObject.eVar10;
                    if (this._isAudio) {
                        this._tObject.pev2 = "Podcast_Milestone 4/4";
                    } else {
                        this._tObject.pev2 = "Video_Milestone 4/4";
                    }
                    this._tObject.eVar46 = "none";
                    this._tObject.eVar49 = "none";
                    this._tObject.eVar50 = "none";
                    this._tObject.pe = 'lnk_o';
                    svid.tl(this, 'o', this._tObject.pev2, this._tObject);
                    this._tObject.linkTrackEvents = this._tObject.events = "";

                }
            }
            if (Math.floor(tm / 15) > this._pingMilestone) {
                this._pingMilestone = Math.floor(tm / 15);
                try {
                    window.vidora.push(["send", "playhead_update", this._videodata.guid, {
                        params: {
                            playhead_time: tm,
                            duration: this._videodata.duration
                        }
                    }])
                } catch (e) {}
            }

            this.trigger(this._wrapper, "onTimeUpdate", {
                percent: perc,
                time: tm,
                duration: this._duration
            });
        },

        setTrackingVars: function() {
            var data = this._videodata;
            var pageValues = this.getVideoContent();
            var isIframe = (window != window.top);
            var url = document.location.href;
            if(this._settings.shareDomain)
                url = this._settings.shareDomain;
            var pageTitle = document.title;
            var channel = "";

            var typePrefix = 'video_';
            var wsjTypePrefix = 'WSJLive_';
            var wsjVideoPrefix = 'WSJLive_Video_';
            var embededOnsite = 'video embedded onsite';
            var embededOffsite = 'video embedded offsite';

            if (this._videodata.type == "audio" || this._videodata.type == "podcast") {
                this._isAudio = true;

                typePrefix = 'podcast_';
                wsjTypePrefix = 'DJPodcasts_';
                embededOnsite = 'podcast embedded onsite';
                embededOffsite = 'podcast embedded offsite';
                wsjVideoPrefix = 'DJPodcasts_Podcast_';
                pageValues.prop2 = 'WSJ_Podcast Center';
                this._currentEvents = this._events.audio;
            } else {
                this._isAudio = false;
                this._currentEvents = this._events.video;
            }

            this._isLive = false;
            if (data.state) {
                if (data.state == "live") {
                    this._isLive = true;
                }
            }
            try {
                if (window['s']) {
                    channel = s.channel;
                } else {
                    channel = this.getDomain(url);
                }
            } catch (e) {
                channel = this.getDomain(document.domain);
            }

            var prefix = "wsj";
            this._tObject.linkTrackVars = "pageName,events,channel,pageType,eVar3,eVar4,eVar5,eVar10,eVar11,eVar13,eVar14,eVar15,eVar16,eVar17,eVar18,eVar20,eVar21,eVar26,eVar31,eVar32,eVar45,eVar46,eVar49,eVar50,eVar67,eVar37,eVar38,eVar39,eVar40,eVar53,eVar54,eVar25,eVar55,eVar61,eVar68,eVar25,eVar29,eVar52,eVar62,eVar66,eVar69,eVar70,eVar75";

            this._tObject.debugTracking = false;
            this._tObject.trackLocal = true;
            this._tObject.server = "om.dowjoneson.com";
            this._tObject.account = "djglobal,djwsjlive";

            try {
                if (url.indexOf("wsj.com") !== -1) {
                    this._tObject.account = "djglobal,djwsj";
                }
                if (url.indexOf('live.wsj.com') !== -1) {
                    this._tObject.account = "djglobal,djwsjlive";
                }
                if (url.indexOf('wsj.com/video') !== -1) {
                    this._tObject.account = "djglobal,djwsjlive";
                }
                if (url.indexOf("cwsj.com") !== -1) {
                    this._tObject.account = "djglobal,djwsjchina";
                }
                if (url.indexOf("cn.wsj.com") !== -1) {
                    this._tObject.account = "djglobal,djwsjchina";
                }
                if (url.indexOf("jwsj.com") !== -1) {
                    this._tObject.account = "djglobal,djjapanwsj";
                }
                if (url.indexOf("kr.wsj.com") !== -1) {
                    this._tObject.account = "djglobal,djwsjkorea";
                }
                if (url.indexOf("indo.wsj.com") !== -1) {
                    this._tObject.account = "djglobal,djwsjindonesia";
                }
                if (url.indexOf("marketwatch.com") !== -1) {
                    this._tObject.account = "djglobal,djmarketwatch";
                }
                if (url.indexOf("barrons.com") !== -1) {
                    this._tObject.account = "djglobal,djbarrons";
                }
                if (url.indexOf("wsj.de") !== -1) {
                    this._tObject.account = "djglobal,djwsjgermany";
                }
                if (url.indexOf('allthingsd.com') !== -1) {
                    this._tObject.account = "djglobal,djatd";
                }
                if (url.indexOf('wsj.com.tr') !== -1) {
                    this._tObject.account = "djglobal,djwsjturkey";
                }
                if (url.indexOf('efinancialnews.com') !== -1) {
                    this._tObject.account = "djglobal,djefinancialnews";
                }
                if (url.indexOf('mansionglobal.com') !== -1) {
                    this._tObject.account = "djmansionglobal";
                }
            } catch (e) {
                this._tObject.account = "djglobal,djwsjlive";
            }

            if (this._settings.sAccount)
                this._tObject.account = this._settings.sAccount;

            if (channel === false) {
                this._tObject.channel = "WSJ"; // WSJ, MarketWatch, Barrons Online
            } else {
                this._tObject.channel = channel;
            }
            this._tObject.pageType = ""; //

            this._tObject.eVar3 = ""; //user uuid

            if (this._videodata.type == "audio" || this._videodata.type == "podcast") {
                this._tObject.pageName = "DJPodcasts_Podcast_" + this._videodata.name + "_" + this._videodata.duration;
            } else {
                this._tObject.pageName = "WSJLive_Video_" + this._videodata.name + "_" + this._videodata.duration;
            }
            this._tObject.eVar4 = this._tObject.pageName;

            try {
                var modValue = location.search.split('?mod=')[1];
                if (modValue)
                    this._tObject.eVar5 = modValue;
                else
                    this._tObject.eVar5 = "";
            } catch (e) {}
            this._tObject.eVar10 = wsjVideoPrefix + data.name + "_" + data.duration;
            this._tObject.eVar11 = this._tObject.channel; // WSJDN site where video is being played
            this._tObject.eVar13 = typePrefix + data.doctypeID; // doc type ID from player; in old implementation, this went into c8
            this._tObject.eVar14 = data.adZone; // video ad zone; in old implementation, this went into c13
            this._tObject.eVar15 = wsjTypePrefix + data.author; // name of video creator; in old implementation, this went into c21

            if (this._settings.showName) {
                this._tObject.eVar16 = typePrefix + settings.showName;
            } else if (data.omniProgramName) {
                this._tObject.eVar16 = data.omniProgramName;
            } else {
                this._tObject.eVar16 = typePrefix + data.column;
            }

            if (channel === false) {
                this._tObject.eVar17 = (!isIframe) ? document.domain : embededOffsite; // if viewed offsite, [subdomain.domain.com]
                this._tObject.eVar18 = embededOffsite; // page name of page where video is played.
                this._comscoreC3 = "13047035";
            } else {
                if (channel == "MarketWatch") {
                    this._comscoreC3 = "13047034";
                } else if (channel == "Barrons Online" || channel == 'barrons-video') {
                    this._comscoreC3 = "13047031";
                } else if (channel == "AllThingsD") {
                    this._comscoreC3 = "13047033";
                } else if (channel == "SmartMoney") {
                    this._comscoreC3 = "3005492";
                } else if (channel == "FINS") {
                    this._comscoreC3 = "13047038";
                } else {
                    this._comscoreC3 = "13047035";
                }

                if (channel == "AllThingsD") {
                    prefix = "allthingsd";
                } else if (channel == "SmartMoney") {
                    prefix = "sm";
                }
                this._tObject.eVar17 = null; // if viewed offsite, [subdomain.domain.com]
                this._tObject.eVar18 = channel; // page name of page where video is played.
            }

            if (data[prefix + '-section']) {
                var ln = wsjVideoPrefix + data[prefix + '-section'];
                if (data[prefix + '-subsection']) {
                    ln += "_" + data[prefix + '-subsection'];
                }
                this._tObject.eVar20 = ln; // describes the tabs where video is viewed on the WSJ Live site; in old implementation, this went into c22/c19
            } else {
                this._tObject.eVar20 = null; // describes the tabs where video is viewed on the WSJ Live site; in old implementation, this went into c22/c19
            }

            this._tObject.eVar21 = typePrefix + data.guid; // page name of page where video is played.

            this._tObject.eVar26 = "WSJ_free"; // whether user is a wsjdn subscriber; in old implementation, this went into c27
            try {
                if (this.getCookie('REMOTE_USER')) {
                    this._tObject.eVar26 = "WSJ_sub_yes";
                } else {
                    this._tObject.eVar26 = "WSJ_free";
                }
            } catch (e) {}

            this._tObject.eVar27 = "Homepage";
            var d = new Date();
            var utc = d.getTime() + (d.getTimezoneOffset() * 60000);
            var easternDate = new Date(utc + (3600000 * -5.0));
            var weekday = new Array(7);
            weekday[0] = "Sunday";
            weekday[1] = "Monday";
            weekday[2] = "Tuesday";
            weekday[3] = "Wednesday";
            weekday[4] = "Thursday";
            weekday[5] = "Friday";
            weekday[6] = "Saturday";

            this._tObject.eVar31 = weekday[easternDate.getDay()]; // current day
            this._tObject.eVar32 = easternDate.getHours() + ":" + easternDate.getMinutes(); // time
            var keywords = wsjTypePrefix + "null";
            if (data.keywords) {
                if (data.keywords.length > 0) {
                    keywords = wsjTypePrefix;
                    var i;
                    for (i = 0; i < data.keywords.length; i = i + 1) {
                        keywords += data.keywords[i] + "|";
                    }
                    keywords = keywords.substr(0, keywords.length - 1);
                } else {
                    keywords = wsjTypePrefix + "null";
                }
            }
            this._tObject.eVar45 = "html - " + this._version + this._bucket;
            try {
                if ((typeof(google.ima.VERSION) !== 'undefined') && (google.ima.VERSION !== null)) {
                    this._tObject.eVar45 = this._tObject.eVar45 + " - ima:" + google.ima.VERSION;
                }
            } catch (e) {}

            this._tObject.eVar46 = "none";
            this._tObject.eVar49 = "none";
            this._tObject.eVar50 = "none";

            this._tObject.eVar67 = keywords;

            if (channel === false) {
                this._tObject.eVar4 = embededOffsite;
                this._tObject.eVar37 = embededOffsite;
                this._tObject.eVar38 = embededOffsite;
                this._tObject.eVar39 = embededOffsite;
                this._tObject.eVar40 = embededOffsite;
                this._tObject.eVar53 = embededOffsite;
                this._tObject.eVar54 = embededOffsite;
                this._tObject.eVar25 = embededOffsite;
                this._tObject.eVar55 = embededOffsite;
                this._tObject.eVar61 = embededOffsite;
                this._tObject.eVar68 = typePrefix + "emb";
                this._tObject.eVar29 = embededOffsite;
                if (this._isLive) {
                    this._tObject.eVar69 = typePrefix + "live";
                } else {
                    this._tObject.eVar69 = typePrefix + "vod_program";
                }
            } else {
                if (pageValues.pageName !== undefined) {
                    this._tObject.eVar4 = pageValues.pageName;
                } else if (pageValues.eVar4 !== undefined) {
                    this._tObject.eVar4 = pageValues.eVar4;
                }
                this._tObject.eVar29 = (pageValues.prop26 !== undefined) ? pageValues.prop26 : embededOnsite;
                this._tObject.eVar37 = (pageValues.prop3 !== undefined) ? pageValues.prop3 : embededOnsite;
                this._tObject.eVar38 = (pageValues.prop19 !== undefined) ? pageValues.prop19 : embededOnsite;
                this._tObject.eVar39 = (pageValues.prop4 !== undefined) ? pageValues.prop4 : embededOnsite;
                this._tObject.eVar40 = (pageValues.prop4 !== undefined) ? pageValues.prop4 : embededOnsite;
                this._tObject.eVar53 = (pageValues.prop19 !== undefined) ? pageValues.prop19 : embededOnsite;
                this._tObject.eVar25 = (pageValues.prop2 !== undefined) ? pageValues.prop2 : embededOnsite;
                this._tObject.eVar54 = (pageValues.prop2 !== undefined) ? pageValues.prop2 : embededOnsite;
                this._tObject.eVar55 = (pageValues.prop26 !== undefined) ? pageValues.prop26 : embededOnsite;
                this._tObject.eVar61 = (pageValues.prop21 !== undefined) ? pageValues.prop21 : embededOnsite;
                this._tObject.eVar68 = (pageValues.prop19 !== undefined) ? typePrefix + "emb" : typePrefix + "emb";

                if (url.indexOf('twitter.com/i/cards') !== -1) {
                    this._isTwitter = true;
                    this._tObject.eVar68 = typePrefix + "twitter";
                }

                this._tObject.eVar68 += this.getMeta('article.template');

                if (this._isLive) {
                    this._tObject.eVar69 = typePrefix + "live";
                } else {
                    try {
                        if (data.omniVideoFormat) {
                            this._tObject.eVar69 = data.omniVideoFormat;
                        } else {
                            if (data.doctypeID == "31" || data.doctypeID == 31) {
                                this._tObject.eVar69 = typePrefix + "vod_program";
                            } else if (data.column.indexOf("clip") != -1) {
                                this._tObject.eVar69 = typePrefix + "clip";
                            } else if (data.doctypeID == "471" || data.doctypeID == 471) {
                                this._tObject.eVar69 = typePrefix + "sponsored";
                            } else {
                                this._tObject.eVar69 = typePrefix + "vod_non-program";
                            }
                        }
                    } catch (err) {
                        this._tObject.eVar69 = typePrefix + "vod_non-program";
                    }
                }
            }

            if (this._isChained)
                this._tObject.eVar69 = this._tObject.eVar69 + '_autochain';

            var createdDate;
            if (data.omniPublishDate) {
                createdDate = data.omniPublishDate;
            } else {
                if (data.formattedCreationDate) {
                    createdDate = typePrefix + data.formattedCreationDate;
                } else {
                    var month = ("0" + (easternDate.getMonth() + 1)).slice(-2);
                    var date = ("0" + easternDate.getDate()).slice(-2);
                    createdDate = typePrefix + easternDate.getFullYear() + month + date + "_" + easternDate.getHours() + ":" + easternDate.getMinutes();
                }
            }
            try {
                this._tObject.eVar62 = this.getHostName(document.referrer);
            } catch (e) {}
            this._tObject.eVar66 = createdDate;
            try {
                this._tObject.eVar70 = (data.column != null) ? data.column : "No Column";
            } catch (e) {}
            this._tObject.eVar75 = url.split('?')[0];

            var trackVarsArray = this._tObject.linkTrackVars.split(",");
            for (var i = 0; i <= trackVarsArray.length; i++) {
                if (trackVarsArray[i] in this._settings) {
                    this._tObject[trackVarsArray[i]] = this._settings[trackVarsArray[i]];
                }
            }

            this._comscoreMeta.ns_st_ci = data.guid;
            this._comscoreMeta.c3 = this._comscoreC3;
        },

        getHostName: function(url) {
            var match = url.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);
            if (match != null && match.length > 2 && typeof match[2] === 'string' && match[2].length > 0) {
                return match[2];
            } else {
                return null;
            }
        },

        getVideoContent: function() {
            try {
                if (window != window.top) {
                    if (window.parent.s !== undefined) {
                        return window.parent.s;
                    }
                } else {
                    if (window.s !== undefined) {
                        return window.s;
                    }
                }
                return false;
            } catch (e) {
                return false;
            }
        },
        // END TRACKING FUNCTIONS //
        // UTILITY //
        hasFlashVersionOrBetter: function(major, minor) {
            minor = minor || 0;
            var v;
            if (navigator.plugins && navigator.plugins.length > 0) {

                var type = 'application/x-shockwave-flash';
                var mimeTypes = navigator.mimeTypes;
                if (mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin && mimeTypes[type].enabledPlugin.description) {
                    v = mimeTypes[type].enabledPlugin.description.replace(/^.*?([0-9]+)\.([0-9])+.*$/, '$1,$2').split(',');
                }
            }
            else {
                var flashObj = null;
                try { flashObj = new ActiveXObject('ShockwaveFlash.ShockwaveFlash'); } catch (ex) { return false; }
                if (flashObj != null) {
                    var fV;
                    try { fV = flashObj.GetVariable("$version"); } catch (err) { return false; }
                    v = fV.replace(/^.*?([0-9]+,[0-9]+).*$/, '$1').split(',');
                }
            }
            if (v) {

                var majorVersion = parseInt(v[0], 10);
                return major > majorVersion || major == majorVersion && minor >= parseInt(v[1], 10);
            }
            return false;
        },

        getMeta: function(key) {
            try {
                var metas = document.getElementsByTagName('meta');
                for (var i = 0; i < metas.length; i++) {
                    if (metas[i].getAttribute("name") == key) {
                        return "_" + metas[i].getAttribute("content");
                    }
                }
                return "";
            } catch (e) {
                return "";
            }
        },

        getDomain: function(domain) {
            "use strict";
            if (domain.indexOf("cwsj.com") !== -1) {
                return "WSJ China";
            }
            if (domain.indexOf("cn.wsj.com") !== -1) {
                return "WSJ China";
            }
            if (domain.indexOf("jwsj.com") !== -1) {
                return "WSJ Japan";
            }
            if (domain.indexOf("kr.wsj.com") !== -1) {
                return "WSJ Korea";
            }
            if (domain.indexOf("indo.wsj.com") !== -1) {
                return "WSJ Indonesia";
            }
            if (domain.indexOf("wsj.com") !== -1) {
                return "WSJ";
            }
            if (domain.indexOf("marketwatch.com") !== -1) {
                return "MarketWatch";
            }
            if (domain.indexOf("barrons.com") !== -1) {
                return "Barrons Online";
            }
            if (domain.indexOf("wsj.de") !== -1) {
                return "WSJ Germany";
            }
            if (domain.indexOf('allthingsd.com') !== -1) {
                return "AllThingsD";
            }
            if (domain.indexOf('smartmoney.com') !== -1) {
                return "SmartMoney";
            }
            if (domain.indexOf('fxtrader') !== -1) {
                return "DJFXTrader";
            }
            if (domain.indexOf('fins.com') !== -1) {
                return "FINS";
            }
            return false;
        },

        extend: function(defaults, options) {
            var extended = {};
            var prop;
            for (prop in defaults) {
                if (Object.prototype.hasOwnProperty.call(defaults, prop)) {
                    extended[prop] = defaults[prop];
                }
            }
            for (prop in options) {
                if (Object.prototype.hasOwnProperty.call(options, prop)) {
                    extended[prop] = options[prop];
                }
            }
            return extended;
        },

        loadScript: function(url, callback, error) {
            var self = this;
            var script = document.createElement("script")
            script.type = "text/javascript";

            if (script.readyState) { //IE
                script.onreadystatechange = function() {
                    if (script.readyState == "loaded" ||
                        script.readyState == "complete") {
                        script.onreadystatechange = null;
                        callback();
                    }
                };
            } else { //Others
                script.onload = function() {
                    callback(self);
                };
                script.onerror = function() {
                    error(self);
                };
            }
            script.src = url;
            document.getElementsByTagName("head")[0].appendChild(script);
        },

        gTimeFormat: function(seconds) {
            var m = Math.floor(seconds / 60) < 10 ? "0" + Math.floor(seconds / 60) : Math.floor(seconds / 60);
            var s = Math.floor(seconds - (m * 60)) < 10 ? "0" + Math.floor(seconds - (m * 60)) : Math.floor(seconds - (m * 60));
            if (isNaN(s)) {
                return "00:00";

            } else {
                return m + ":" + s;
            }
        },

        trigger: function(obj, evt, data) {
            var fireOnThis = obj;
            if (document.createEvent) {
                var evObj = new CustomEvent('build', data);
                evObj.data = data;
                evObj.initEvent(evt, true, true);
                fireOnThis.dispatchEvent(evObj);
            } else if (document.createEventObject) { //IE
                var evObj = document.createEventObject();
                evObj.data = data;
                fireOnThis.fireEvent('on' + evt, evObj);
            }
        },

        getCookie: function(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1);
                if (c.indexOf(name) != -1) return c.substring(name.length, c.length);
            }
            return "";
        }
    }

    var _wrap = function(selector) {
        this.length = 1;
        if ((typeof selector).toLowerCase() === "string") {
            var e = document.querySelectorAll(selector);
            if (e.length > 0)
                this.element = e[0];
        } else {
            this.element = selector;
        }
        this.WSJVideo = function(params) {
            var chart = new WSJVideo(this.element, params);
            var instance = chart.init();
            this.element.data = function() {
                return this.element;
            }
            return this.element;
        }
        try {
            this.data = this.element.data;
        } catch (e) {}
        return this;
    };

    window.$jQ111 = function(selector) {
        return new _wrap(selector);
    };
})();

(function () {
    function CustomEvent ( event, params ) {
        params = params || { bubbles: false, cancelable: false, detail: undefined };
        var evt = document.createEvent( 'CustomEvent' );
        evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );
        return evt;
    }
    CustomEvent.prototype = window.Event.prototype;
    window.CustomEvent = CustomEvent;
})();

window.Visitor = window.Visitor || function (q,w){function x(d){return function(b){b=b||s.location.href;try{var c=a.Xa(b,d);if(c)return m.Hb(c)}catch(e){}}}function B(a){function b(a,d,b){b=b?b+="|":b;return b+(a+"="+encodeURIComponent(d))}for(var c="",e=0,f=a.length;e<f;e++){var g=a[e],h=g[0],g=g[1];g!=j&&g!==u&&(c=b(h,g,c))}return function(a){var d=m.Da(),a=a?a+="|":a;return a+("TS="+d)}(c)}if(!q)throw"Visitor requires Adobe Marketing Cloud Org ID";var a=this;a.version="2.1.0";var s=window,l=s.Visitor;l.version=a.version;
s.s_c_in||(s.s_c_il=[],s.s_c_in=0);a._c="Visitor";a._il=s.s_c_il;a._in=s.s_c_in;a._il[a._in]=a;s.s_c_in++;a.na={La:[]};var v=s.document,j=l.Pb;j||(j=null);var F=l.Qb;F||(F=void 0);var i=l.Va;i||(i=!0);var k=l.Sa;k||(k=!1);var n={r:!!s.postMessage,Ra:1,ea:864E5,ba:"adobe_mc",ca:"adobe_mc_sdid",w:/^[0-9a-fA-F\-]+$/,Qa:5,Ta:/^\d+$/,fa:/vVersion\|((\d+\.)?(\d+\.)?(\*|\d+))(?=$|\|)/};a.Rb=n;a.ka=function(a){var b=0,c,e;if(a)for(c=0;c<a.length;c++)e=a.charCodeAt(c),b=(b<<5)-b+e,b&=b;return b};a.u=function(a,
b){var c="0123456789",e="",f="",g,h,j=8,k=10,l=10;b===o&&(y.isClientSideMarketingCloudVisitorID=i);if(1==a){c+="ABCDEF";for(g=0;16>g;g++)h=Math.floor(Math.random()*j),e+=c.substring(h,h+1),h=Math.floor(Math.random()*j),f+=c.substring(h,h+1),j=16;return e+"-"+f}for(g=0;19>g;g++)h=Math.floor(Math.random()*k),e+=c.substring(h,h+1),0==g&&9==h?k=3:(1==g||2==g)&&10!=k&&2>h?k=10:2<g&&(k=10),h=Math.floor(Math.random()*l),f+=c.substring(h,h+1),0==g&&9==h?l=3:(1==g||2==g)&&10!=l&&2>h?l=10:2<g&&(l=10);return e+
f};a.Ya=function(){var a;!a&&s.location&&(a=s.location.hostname);if(a)if(/^[0-9.]+$/.test(a))a="";else{var b=a.split("."),c=b.length-1,e=c-1;1<c&&2>=b[c].length&&(2==b[c-1].length||0>",ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,be,bf,bg,bh,bi,bj,bm,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,cl,cm,cn,co,cr,cu,cv,cw,cx,cz,de,dj,dk,dm,do,dz,ec,ee,eg,es,et,eu,fi,fm,fo,fr,ga,gb,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,im,in,io,iq,ir,is,it,je,jo,jp,kg,ki,km,kn,kp,kr,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,na,nc,ne,nf,ng,nl,no,nr,nu,nz,om,pa,pe,pf,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,rs,ru,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,yt,".indexOf(","+
b[c]+","))&&e--;if(0<e)for(a="";c>=e;)a=b[c]+(a?".":"")+a,c--}return a};a.cookieRead=function(a){var a=encodeURIComponent(a),b=(";"+v.cookie).split(" ").join(";"),c=b.indexOf(";"+a+"="),e=0>c?c:b.indexOf(";",c+1);return 0>c?"":decodeURIComponent(b.substring(c+2+a.length,0>e?b.length:e))};a.cookieWrite=function(d,b,c){var e=a.cookieLifetime,f,b=""+b,e=e?(""+e).toUpperCase():"";c&&"SESSION"!=e&&"NONE"!=e?(f=""!=b?parseInt(e?e:0,10):-60)?(c=new Date,c.setTime(c.getTime()+1E3*f)):1==c&&(c=new Date,f=
c.getYear(),c.setYear(f+2+(1900>f?1900:0))):c=0;return d&&"NONE"!=e?(v.cookie=encodeURIComponent(d)+"="+encodeURIComponent(b)+"; path=/;"+(c?" expires="+c.toGMTString()+";":"")+(a.cookieDomain?" domain="+a.cookieDomain+";":""),a.cookieRead(d)==b):0};a.h=j;a.z=function(a,b){try{"function"==typeof a?a.apply(s,b):a[1].apply(a[0],b)}catch(c){}};a.M=function(d,b){b&&(a.h==j&&(a.h={}),a.h[d]==F&&(a.h[d]=[]),a.h[d].push(b))};a.t=function(d,b){if(a.h!=j){var c=a.h[d];if(c)for(;0<c.length;)a.z(c.shift(),b)}};
a.s=function(a,b,c,e){c=encodeURIComponent(b)+"="+encodeURIComponent(c);b=m.Fb(a);a=m.wb(a);if(-1===a.indexOf("?"))return a+"?"+c+b;var f=a.split("?"),a=f[0]+"?",e=m.ib(f[1],c,e);return a+e+b};a.Xa=function(a,b){var c=RegExp("[\\?&#]"+b+"=([^&#]*)").exec(a);if(c&&c.length)return decodeURIComponent(c[1])};a.eb=x(n.ba);a.fb=x(n.ca);a.ha=function(){var d=a.fb(void 0);d&&d.SDID&&d[G]===q&&(a._supplementalDataIDCurrent=d.SDID,a._supplementalDataIDCurrentConsumed.SDID_URL_PARAM=i)};a.ga=function(){var d=
a.eb();if(d&&d.TS&&!(Math.floor((m.Da()-d.TS)/60)>n.Qa||d[G]!==q)){var b=d[o],c=a.setMarketingCloudVisitorID;b&&b.match(n.w)&&c(b);a.j(t,-1);d=d[r];b=a.setAnalyticsVisitorID;d&&d.match(n.w)&&b(d)}};a.cb=function(d){function b(d){m.Ga(d)&&a.setCustomerIDs(d)}function c(d){d=d||{};a._supplementalDataIDCurrent=d.supplementalDataIDCurrent||"";a._supplementalDataIDCurrentConsumed=d.supplementalDataIDCurrentConsumed||{};a._supplementalDataIDLast=d.supplementalDataIDLast||"";a._supplementalDataIDLastConsumed=
d.supplementalDataIDLastConsumed||{}}if(d)try{if(d=m.Ga(d)?d:m.Gb(d),d[a.marketingCloudOrgID]){var e=d[a.marketingCloudOrgID];b(e.customerIDs);c(e.sdid)}}catch(f){throw Error("`serverState` has an invalid format.");}};a.l=j;a.$a=function(d,b,c,e){b=a.s(b,"d_fieldgroup",d,1);e.url=a.s(e.url,"d_fieldgroup",d,1);e.m=a.s(e.m,"d_fieldgroup",d,1);y.d[d]=i;e===Object(e)&&e.m&&"XMLHttpRequest"===a.pa.F.G?a.pa.rb(e,c,d):a.useCORSOnly||a.ab(d,b,c)};a.ab=function(d,b,c){var e=0,f=0,g;if(b&&v){for(g=0;!e&&2>
g;){try{e=(e=v.getElementsByTagName(0<g?"HEAD":"head"))&&0<e.length?e[0]:0}catch(h){e=0}g++}if(!e)try{v.body&&(e=v.body)}catch(k){e=0}if(e)for(g=0;!f&&2>g;){try{f=v.createElement(0<g?"SCRIPT":"script")}catch(l){f=0}g++}}!b||!e||!f?c&&c():(f.type="text/javascript",f.src=b,e.firstChild?e.insertBefore(f,e.firstChild):e.appendChild(f),e=a.loadTimeout,p.d[d]={requestStart:p.p(),url:b,xa:e,va:p.Ca(),wa:0},c&&(a.l==j&&(a.l={}),a.l[d]=setTimeout(function(){c(i)},e)),a.na.La.push(b))};a.Wa=function(d){a.l!=
j&&a.l[d]&&(clearTimeout(a.l[d]),a.l[d]=0)};a.la=k;a.ma=k;a.isAllowed=function(){if(!a.la&&(a.la=i,a.cookieRead(a.cookieName)||a.cookieWrite(a.cookieName,"T",1)))a.ma=i;return a.ma};a.b=j;a.c=j;var H=l.gc;H||(H="MC");var o=l.nc;o||(o="MCMID");var G=l.kc;G||(G="MCORGID");var I=l.hc;I||(I="MCCIDH");var M=l.lc;M||(M="MCSYNCS");var K=l.mc;K||(K="MCSYNCSOP");var L=l.ic;L||(L="MCIDTS");var C=l.jc;C||(C="MCOPTOUT");var E=l.ec;E||(E="A");var r=l.bc;r||(r="MCAID");var D=l.fc;D||(D="AAM");var A=l.dc;A||(A=
"MCAAMLH");var t=l.cc;t||(t="MCAAMB");var u=l.oc;u||(u="NONE");a.N=0;a.ja=function(){if(!a.N){var d=a.version;a.audienceManagerServer&&(d+="|"+a.audienceManagerServer);a.audienceManagerServerSecure&&(d+="|"+a.audienceManagerServerSecure);a.N=a.ka(d)}return a.N};a.oa=k;a.f=function(){if(!a.oa){a.oa=i;var d=a.ja(),b=k,c=a.cookieRead(a.cookieName),e,f,g,h,l=new Date;a.b==j&&(a.b={});if(c&&"T"!=c){c=c.split("|");c[0].match(/^[\-0-9]+$/)&&(parseInt(c[0],10)!=d&&(b=i),c.shift());1==c.length%2&&c.pop();
for(d=0;d<c.length;d+=2)if(e=c[d].split("-"),f=e[0],g=c[d+1],1<e.length?(h=parseInt(e[1],10),e=0<e[1].indexOf("s")):(h=0,e=k),b&&(f==I&&(g=""),0<h&&(h=l.getTime()/1E3-60)),f&&g&&(a.e(f,g,1),0<h&&(a.b["expire"+f]=h+(e?"s":""),l.getTime()>=1E3*h||e&&!a.cookieRead(a.sessionCookieName))))a.c||(a.c={}),a.c[f]=i}if(!a.a(r)&&m.o()&&(c=a.cookieRead("s_vi")))c=c.split("|"),1<c.length&&0<=c[0].indexOf("v1")&&(g=c[1],d=g.indexOf("["),0<=d&&(g=g.substring(0,d)),g&&g.match(n.w)&&a.e(r,g))}};a._appendVersionTo=
function(d){var b="vVersion|"+a.version,c=Boolean(d)?a._getCookieVersion(d):null;c?m.jb(c,a.version)&&(d=d.replace(n.fa,b)):d+=(d?"|":"")+b;return d};a.hb=function(){var d=a.ja(),b,c;for(b in a.b)!Object.prototype[b]&&a.b[b]&&"expire"!=b.substring(0,6)&&(c=a.b[b],d+=(d?"|":"")+b+(a.b["expire"+b]?"-"+a.b["expire"+b]:"")+"|"+c);d=a._appendVersionTo(d);a.cookieWrite(a.cookieName,d,1)};a.a=function(d,b){return a.b!=j&&(b||!a.c||!a.c[d])?a.b[d]:j};a.e=function(d,b,c){a.b==j&&(a.b={});a.b[d]=b;c||a.hb()};
a.Za=function(d,b){var c=a.a(d,b);return c?c.split("*"):j};a.gb=function(d,b,c){a.e(d,b?b.join("*"):"",c)};a.Wb=function(d,b){var c=a.Za(d,b);if(c){var e={},f;for(f=0;f<c.length;f+=2)e[c[f]]=c[f+1];return e}return j};a.Yb=function(d,b,c){var e=j,f;if(b)for(f in e=[],b)Object.prototype[f]||(e.push(f),e.push(b[f]));a.gb(d,e,c)};a.j=function(d,b,c){var e=new Date;e.setTime(e.getTime()+1E3*b);a.b==j&&(a.b={});a.b["expire"+d]=Math.floor(e.getTime()/1E3)+(c?"s":"");0>b?(a.c||(a.c={}),a.c[d]=i):a.c&&(a.c[d]=
k);c&&(a.cookieRead(a.sessionCookieName)||a.cookieWrite(a.sessionCookieName,"1"))};a.ia=function(a){if(a&&("object"==typeof a&&(a=a.d_mid?a.d_mid:a.visitorID?a.visitorID:a.id?a.id:a.uuid?a.uuid:""+a),a&&(a=a.toUpperCase(),"NOTARGET"==a&&(a=u)),!a||a!=u&&!a.match(n.w)))a="";return a};a.k=function(d,b){a.Wa(d);a.i!=j&&(a.i[d]=k);p.d[d]&&(p.d[d].Nb=p.p(),p.J(d));y.d[d]&&y.Na(d,k);if(d==H){y.isClientSideMarketingCloudVisitorID!==i&&(y.isClientSideMarketingCloudVisitorID=k);var c=a.a(o);if(!c||a.overwriteCrossDomainMCIDAndAID){c=
"object"==typeof b&&b.mid?b.mid:a.ia(b);if(!c){if(a.D){a.getAnalyticsVisitorID(j,k,i);return}c=a.u(0,o)}a.e(o,c)}if(!c||c==u)c="";"object"==typeof b&&((b.d_region||b.dcs_region||b.d_blob||b.blob)&&a.k(D,b),a.D&&b.mid&&a.k(E,{id:b.id}));a.t(o,[c])}if(d==D&&"object"==typeof b){c=604800;b.id_sync_ttl!=F&&b.id_sync_ttl&&(c=parseInt(b.id_sync_ttl,10));var e=a.a(A);e||((e=b.d_region)||(e=b.dcs_region),e&&(a.j(A,c),a.e(A,e)));e||(e="");a.t(A,[e]);e=a.a(t);if(b.d_blob||b.blob)(e=b.d_blob)||(e=b.blob),a.j(t,
c),a.e(t,e);e||(e="");a.t(t,[e]);!b.error_msg&&a.C&&a.e(I,a.C)}if(d==E){c=a.a(r);if(!c||a.overwriteCrossDomainMCIDAndAID)(c=a.ia(b))?c!==u&&a.j(t,-1):c=u,a.e(r,c);if(!c||c==u)c="";a.t(r,[c])}a.idSyncDisableSyncs?z.Ea=i:(z.Ea=k,c={},c.ibs=b.ibs,c.subdomain=b.subdomain,z.Ib(c));if(b===Object(b)){var f;a.isAllowed()&&(f=a.a(C));f||(f=u,b.d_optout&&b.d_optout instanceof Array&&(f=b.d_optout.join(",")),c=parseInt(b.d_ottl,10),isNaN(c)&&(c=7200),a.j(C,c,i),a.e(C,f));a.t(C,[f])}};a.i=j;a.v=function(d,b,
c,e,f){var g="",h,k=m.yb(d);if(a.isAllowed())if(a.f(),g=a.a(d,N[d]===i),(!g||a.c&&a.c[d])&&(!a.disableThirdPartyCalls||k)){if(d==o||d==C?h=H:d==A||d==t?h=D:d==r&&(h=E),h){if(b&&(a.i==j||!a.i[h]))a.i==j&&(a.i={}),a.i[h]=i,a.$a(h,b,function(b){a.a(d)||(p.d[h]&&(p.d[h].timeout=p.p(),p.d[h].xb=!!b,p.J(h)),b&&y.Na(h,i),b="",d==o?b=a.u(0,o):h==D&&(b={error_msg:"timeout"}),a.k(h,b))},f);a.M(d,c);if(g)return g;b||a.k(h,{id:u});return""}}else g||(d===o?(a.M(d,c),g=a.u(0,o),a.setMarketingCloudVisitorID(g)):
d===r?(a.M(d,c),g="",a.setAnalyticsVisitorID(g)):(g="",e=i));if((d==o||d==r)&&g==u)g="",e=i;c&&e&&a.z(c,[g]);return g};a._setMarketingCloudFields=function(d){a.f();a.k(H,d)};a.setMarketingCloudVisitorID=function(d){a._setMarketingCloudFields(d)};a.D=k;a.getMarketingCloudVisitorID=function(d,b){if(a.isAllowed()){a.marketingCloudServer&&0>a.marketingCloudServer.indexOf(".demdex.net")&&(a.D=i);var c=a.B("_setMarketingCloudFields");return a.v(o,c.url,d,b,c)}return""};a.bb=function(d){a.getAudienceManagerBlob(d,
i)};l.AuthState={UNKNOWN:0,AUTHENTICATED:1,LOGGED_OUT:2};a.A={};a.K=k;a.C="";a.setCustomerIDs=function(d){if(a.isAllowed()&&d){a.f();var b,c;for(b in d)if(!Object.prototype[b]&&(c=d[b]))if("object"==typeof c){var e={};c.id&&(e.id=c.id);c.authState!=F&&(e.authState=c.authState);a.A[b]=e}else a.A[b]={id:c};var d=a.getCustomerIDs(),e=a.a(I),f="";e||(e=0);for(b in d)Object.prototype[b]||(c=d[b],f+=(f?"|":"")+b+"|"+(c.id?c.id:"")+(c.authState?c.authState:""));a.C=a.ka(f);a.C!=e&&(a.K=i,a.bb(function(){a.K=
k}))}};a.getCustomerIDs=function(){a.f();var d={},b,c;for(b in a.A)Object.prototype[b]||(c=a.A[b],d[b]||(d[b]={}),c.id&&(d[b].id=c.id),d[b].authState=c.authState!=F?c.authState:l.AuthState.UNKNOWN);return d};a._setAnalyticsFields=function(d){a.f();a.k(E,d)};a.setAnalyticsVisitorID=function(d){a._setAnalyticsFields(d)};a.getAnalyticsVisitorID=function(d,b,c){if(!m.o()&&!c)return a.z(d,[""]),"";if(a.isAllowed()){var e="";c||(e=a.getMarketingCloudVisitorID(function(){a.getAnalyticsVisitorID(d,i)}));
if(e||c){var f=c?a.marketingCloudServer:a.trackingServer,g="";a.loadSSL&&(c?a.marketingCloudServerSecure&&(f=a.marketingCloudServerSecure):a.trackingServerSecure&&(f=a.trackingServerSecure));var h={};if(f){var f="http"+(a.loadSSL?"s":"")+"://"+f+"/id",e="d_visid_ver="+a.version+"&mcorgid="+encodeURIComponent(a.marketingCloudOrgID)+(e?"&mid="+encodeURIComponent(e):"")+(a.idSyncDisable3rdPartySyncing?"&d_coppa=true":""),j=["s_c_il",a._in,"_set"+(c?"MarketingCloud":"Analytics")+"Fields"],g=f+"?"+e+"&callback=s_c_il%5B"+
a._in+"%5D._set"+(c?"MarketingCloud":"Analytics")+"Fields";h.m=f+"?"+e;h.sa=j}h.url=g;return a.v(c?o:r,g,d,b,h)}}return""};a._setAudienceManagerFields=function(d){a.f();a.k(D,d)};a.B=function(d){var b=a.audienceManagerServer,c="",e=a.a(o),f=a.a(t,i),g=a.a(r),g=g&&g!=u?"&d_cid_ic=AVID%01"+encodeURIComponent(g):"";a.loadSSL&&a.audienceManagerServerSecure&&(b=a.audienceManagerServerSecure);if(b){var c=a.getCustomerIDs(),h,j;if(c)for(h in c)Object.prototype[h]||(j=c[h],g+="&d_cid_ic="+encodeURIComponent(h)+
"%01"+encodeURIComponent(j.id?j.id:"")+(j.authState?"%01"+j.authState:""));d||(d="_setAudienceManagerFields");b="http"+(a.loadSSL?"s":"")+"://"+b+"/id";e="d_visid_ver="+a.version+"&d_rtbd=json&d_ver=2"+(!e&&a.D?"&d_verify=1":"")+"&d_orgid="+encodeURIComponent(a.marketingCloudOrgID)+"&d_nsid="+(a.idSyncContainerID||0)+(e?"&d_mid="+encodeURIComponent(e):"")+(a.idSyncDisable3rdPartySyncing?"&d_coppa=true":"")+(f?"&d_blob="+encodeURIComponent(f):"")+g;f=["s_c_il",a._in,d];c=b+"?"+e+"&d_cb=s_c_il%5B"+
a._in+"%5D."+d;return{url:c,m:b+"?"+e,sa:f}}return{url:c}};a.getAudienceManagerLocationHint=function(d,b){if(a.isAllowed()&&a.getMarketingCloudVisitorID(function(){a.getAudienceManagerLocationHint(d,i)})){var c=a.a(r);!c&&m.o()&&(c=a.getAnalyticsVisitorID(function(){a.getAudienceManagerLocationHint(d,i)}));if(c||!m.o())return c=a.B(),a.v(A,c.url,d,b,c)}return""};a.getLocationHint=a.getAudienceManagerLocationHint;a.getAudienceManagerBlob=function(d,b){if(a.isAllowed()&&a.getMarketingCloudVisitorID(function(){a.getAudienceManagerBlob(d,
i)})){var c=a.a(r);!c&&m.o()&&(c=a.getAnalyticsVisitorID(function(){a.getAudienceManagerBlob(d,i)}));if(c||!m.o()){var c=a.B(),e=c.url;a.K&&a.j(t,-1);return a.v(t,e,d,b,c)}}return""};a._supplementalDataIDCurrent="";a._supplementalDataIDCurrentConsumed={};a._supplementalDataIDLast="";a._supplementalDataIDLastConsumed={};a.getSupplementalDataID=function(d,b){!a._supplementalDataIDCurrent&&!b&&(a._supplementalDataIDCurrent=a.u(1));var c=a._supplementalDataIDCurrent;a._supplementalDataIDLast&&!a._supplementalDataIDLastConsumed[d]?
(c=a._supplementalDataIDLast,a._supplementalDataIDLastConsumed[d]=i):c&&(a._supplementalDataIDCurrentConsumed[d]&&(a._supplementalDataIDLast=a._supplementalDataIDCurrent,a._supplementalDataIDLastConsumed=a._supplementalDataIDCurrentConsumed,a._supplementalDataIDCurrent=c=!b?a.u(1):"",a._supplementalDataIDCurrentConsumed={}),c&&(a._supplementalDataIDCurrentConsumed[d]=i));return c};l.OptOut={GLOBAL:"global"};a.getOptOut=function(d,b){if(a.isAllowed()){var c=a.B("_setMarketingCloudFields");return a.v(C,
c.url,d,b,c)}return""};a.isOptedOut=function(d,b,c){return a.isAllowed()?(b||(b=l.OptOut.GLOBAL),(c=a.getOptOut(function(c){a.z(d,[c==l.OptOut.GLOBAL||0<=c.indexOf(b)])},c))?c==l.OptOut.GLOBAL||0<=c.indexOf(b):j):k};a.appendVisitorIDsTo=function(d){var b=n.ba,c=B([[o,a.a(o)],[r,a.a(r)],[G,a.marketingCloudOrgID]]);try{return a.s(d,b,c)}catch(e){return d}};a.appendSupplementalDataIDTo=function(d,b){b=b||a.getSupplementalDataID(m.sb(),!0);if(!b)return d;var c=n.ca,e;e="SDID="+encodeURIComponent(b)+"|"+
(G+"="+encodeURIComponent(a.marketingCloudOrgID));try{return a.s(d,c,e)}catch(f){return d}};a.ra={postMessage:function(a,b,c){var e=1;b&&(n.r?c.postMessage(a,b.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):b&&(c.location=b.replace(/#.*$/,"")+"#"+ +new Date+e++ +"&"+a))},X:function(a,b){var c;try{if(n.r)if(a&&(c=function(c){if("string"===typeof b&&c.origin!==b||"[object Function]"===Object.prototype.toString.call(b)&&!1===b(c.origin))return!1;a(c)}),window.addEventListener)window[a?"addEventListener":"removeEventListener"]("message",
c,!1);else window[a?"attachEvent":"detachEvent"]("onmessage",c)}catch(e){}}};var m={O:function(){if(v.addEventListener)return function(a,b,c){a.addEventListener(b,function(a){"function"===typeof c&&c(a)},k)};if(v.attachEvent)return function(a,b,c){a.attachEvent("on"+b,function(a){"function"===typeof c&&c(a)})}}(),map:function(a,b){if(Array.prototype.map)return a.map(b);if(void 0===a||a===j)throw new TypeError;var c=Object(a),e=c.length>>>0;if("function"!==typeof b)throw new TypeError;for(var f=Array(e),
g=0;g<e;g++)g in c&&(f[g]=b.call(b,c[g],g,c));return f},za:function(a,b){return this.map(a,function(a){return encodeURIComponent(a)}).join(b)},Fb:function(a){var b=a.indexOf("#");return 0<b?a.substr(b):""},wb:function(a){var b=a.indexOf("#");return 0<b?a.substr(0,b):a},ib:function(a,b,c){a=a.split("&");c=c!=j?c:a.length;a.splice(c,0,b);return a.join("&")},yb:function(d,b,c){if(d!==r)return k;b||(b=a.trackingServer);c||(c=a.trackingServerSecure);d=a.loadSSL?c:b;return"string"===typeof d&&d.length?
0>d.indexOf("2o7.net")&&0>d.indexOf("omtrdc.net"):k},Ga:function(a){return Boolean(a&&a===Object(a))},zb:function(d,b){return 0>a._compareVersions(d,b)},jb:function(d,b){return 0!==a._compareVersions(d,b)},Mb:function(a){document.cookie=encodeURIComponent(a)+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},o:function(){return!!a.trackingServer||!!a.trackingServerSecure},Gb:function(a,b){function c(a,d){var e,j,i=a[d];if(i&&"object"===typeof i)for(e in i)Object.prototype.hasOwnProperty.call(i,
e)&&(j=c(i,e),void 0!==j?i[e]=j:delete i[e]);return b.call(a,d,i)}if("object"===typeof JSON&&"function"===typeof JSON.parse)return JSON.parse(a,b);var e;e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;a=""+a;e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");},Da:function(){return Math.round((new Date).getTime()/1E3)},Hb:function(a){for(var b={},a=a.split("|"),c=0,e=a.length;c<e;c++){var f=a[c].split("=");b[f[0]]=decodeURIComponent(f[1])}return b},sb:function(a){for(var a=a||5,b="";a--;)b+="abcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(36*Math.random())];return b}};a.Xb=m;a.pa={F:function(){var a="none",b=i;"undefined"!==
typeof XMLHttpRequest&&XMLHttpRequest===Object(XMLHttpRequest)&&("withCredentials"in new XMLHttpRequest?a="XMLHttpRequest":"undefined"!==typeof XDomainRequest&&XDomainRequest===Object(XDomainRequest)&&(b=k),0<Object.prototype.toString.call(window.Ob).indexOf("Constructor")&&(b=k));return{G:a,$b:b}}(),tb:function(){return"none"===this.F.G?j:new window[this.F.G]},rb:function(d,b,c){var e=this;b&&(d.U=b);try{var f=this.tb();f.open("get",d.m+"&ts="+(new Date).getTime(),i);"XMLHttpRequest"===this.F.G&&
(f.withCredentials=i,f.timeout=a.loadTimeout,f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.onreadystatechange=function(){if(4===this.readyState&&200===this.status)a:{var a;try{if(a=JSON.parse(this.responseText),a!==Object(a)){e.n(d,j,"Response is not JSON");break a}}catch(b){e.n(d,b,"Error parsing response as JSON");break a}try{for(var c=d.sa,f=window,g=0;g<c.length;g++)f=f[c[g]];f(a)}catch(i){e.n(d,i,"Error forming callback function")}}});f.onerror=function(a){e.n(d,a,
"onerror")};f.ontimeout=function(a){e.n(d,a,"ontimeout")};f.send();p.d[c]={requestStart:p.p(),url:d.m,xa:f.timeout,va:p.Ca(),wa:1};a.na.La.push(d.m)}catch(g){this.n(d,g,"try-catch")}},n:function(d,b,c){a.CORSErrors.push({ac:d,error:b,description:c});d.U&&("ontimeout"===c?d.U(i):d.U(k))}};var z={Ua:3E4,da:649,Pa:k,id:j,W:[],S:j,Ba:function(a){if("string"===typeof a)return a=a.split("/"),a[0]+"//"+a[2]},g:j,url:j,ub:function(){var d="http://fast.",b="?d_nsid="+a.idSyncContainerID+"#"+encodeURIComponent(v.location.href);
this.g||(this.g="nosubdomainreturned");a.loadSSL&&(d=a.idSyncSSLUseAkamai?"https://fast.":"https://");d=d+this.g+".demdex.net/dest5.html"+b;this.S=this.Ba(d);this.id="destination_publishing_iframe_"+this.g+"_"+a.idSyncContainerID;return d},mb:function(){var d="?d_nsid="+a.idSyncContainerID+"#"+encodeURIComponent(v.location.href);"string"===typeof a.L&&a.L.length&&(this.id="destination_publishing_iframe_"+(new Date).getTime()+"_"+a.idSyncContainerID,this.S=this.Ba(a.L),this.url=a.L+d)},Ea:j,ya:k,Z:k,
H:j,pc:j,Eb:j,qc:j,Y:k,I:[],Cb:[],Db:[],Ha:n.r?15:100,T:[],Ab:[],ta:i,Ka:k,Ja:function(){return!a.idSyncDisable3rdPartySyncing&&(this.ya||a.Tb)&&this.g&&"nosubdomainreturned"!==this.g&&this.url&&!this.Z},Q:function(){function a(){e=document.createElement("iframe");e.sandbox="allow-scripts allow-same-origin";e.title="Adobe ID Syncing iFrame";e.id=c.id;e.style.cssText="display: none; width: 0; height: 0;";e.src=c.url;c.Eb=i;b();document.body.appendChild(e)}function b(){m.O(e,"load",function(){e.className=
"aamIframeLoaded";c.H=i;c.q()})}this.Z=i;var c=this,e=document.getElementById(this.id);e?"IFRAME"!==e.nodeName?(this.id+="_2",a()):"aamIframeLoaded"!==e.className?b():(this.H=i,this.Fa=e,this.q()):a();this.Fa=e},q:function(d){var b=this;d===Object(d)&&(this.T.push(d),this.Jb(d));if((this.Ka||!n.r||this.H)&&this.T.length)this.J(this.T.shift()),this.q();!a.idSyncDisableSyncs&&this.H&&this.I.length&&!this.Y&&(this.Pa||(this.Pa=i,setTimeout(function(){b.Ha=n.r?15:150},this.Ua)),this.Y=i,this.Ma())},Jb:function(a){var b,
c,e;if((b=a.ibs)&&b instanceof Array&&(c=b.length))for(a=0;a<c;a++)e=b[a],e.syncOnPage&&this.ua(e,"","syncOnPage")},J:function(a){var b=encodeURIComponent,c,e,f,g,h;if((c=a.ibs)&&c instanceof Array&&(e=c.length))for(f=0;f<e;f++)g=c[f],h=[b("ibs"),b(g.id||""),b(g.tag||""),m.za(g.url||[],","),b(g.ttl||""),"","",g.fireURLSync?"true":"false"],g.syncOnPage||(this.ta?this.P(h.join("|")):g.fireURLSync&&this.ua(g,h.join("|")));this.Ab.push(a)},ua:function(d,b,c){var e=(c="syncOnPage"===c?i:k)?K:M;a.f();var f=
a.a(e),g=k,h=k,j=Math.ceil((new Date).getTime()/n.ea);f?(f=f.split("*"),h=this.Kb(f,d.id,j),g=h.pb,h=h.qb,(!g||!h)&&this.Aa(c,d,b,f,e,j)):(f=[],this.Aa(c,d,b,f,e,j))},Kb:function(a,b,c){var e=k,f=k,g,h,j;for(h=0;h<a.length;h++)g=a[h],j=parseInt(g.split("-")[1],10),g.match("^"+b+"-")?(e=i,c<j?f=i:(a.splice(h,1),h--)):c>=j&&(a.splice(h,1),h--);return{pb:e,qb:f}},Bb:function(a){if(a.join("*").length>this.da)for(a.sort(function(a,c){return parseInt(a.split("-")[1],10)-parseInt(c.split("-")[1],10)});a.join("*").length>
this.da;)a.shift()},Aa:function(d,b,c,e,f,g){var h=this;if(d){if("img"===b.tag){var d=b.url,c=a.loadSSL?"https:":"http:",i,k,l;for(e=0,i=d.length;e<i;e++){k=d[e];l=/^\/\//.test(k);var n=new Image;m.O(n,"load",function(b,c,d,e){return function(){h.W[b]=j;a.f();var g=a.a(f),i=[];if(g){var g=g.split("*"),k,l,m;for(k=0,l=g.length;k<l;k++)m=g[k],m.match("^"+c.id+"-")||i.push(m)}h.Oa(i,c,d,e)}}(this.W.length,b,f,g));n.src=(l?c:"")+k;this.W.push(n)}}}else this.P(c),this.Oa(e,b,f,g)},P:function(d){var b=
encodeURIComponent;this.I.push((a.Ub?b("---destpub-debug---"):b("---destpub---"))+d)},Oa:function(d,b,c,e){d.push(b.id+"-"+(e+Math.ceil(b.ttl/60/24)));this.Bb(d);a.e(c,d.join("*"))},Ma:function(){var d=this,b;this.I.length?(b=this.I.shift(),a.ra.postMessage(b,this.url,this.Fa.contentWindow),this.Cb.push(b),setTimeout(function(){d.Ma()},this.Ha)):this.Y=k},X:function(a){var b=/^---destpub-to-parent---/;"string"===typeof a&&b.test(a)&&(b=a.replace(b,"").split("|"),"canSetThirdPartyCookies"===b[0]&&
(this.ta="true"===b[1]?i:k,this.Ka=i,this.q()),this.Db.push(a))},Ib:function(d){if(this.url===j||d.subdomain&&"nosubdomainreturned"===this.g)this.g="string"===typeof a.qa&&a.qa.length?a.qa:d.subdomain||"",this.url=this.ub();d.ibs instanceof Array&&d.ibs.length&&(this.ya=i);this.Ja()&&(a.idSyncAttachIframeOnWindowLoad?(l.aa||"complete"===v.readyState||"loaded"===v.readyState)&&this.Q():this.kb());"function"===typeof a.idSyncIDCallResult?a.idSyncIDCallResult(d):this.q(d);"function"===typeof a.idSyncAfterIDCallResult&&
a.idSyncAfterIDCallResult(d)},lb:function(d,b){return a.Vb||!d||b-d>n.Ra},kb:function(){function a(){b.Z||(document.body?b.Q():setTimeout(a,30))}var b=this;a()}};a.Sb=z;a.timeoutMetricsLog=[];var p={ob:window.performance&&window.performance.timing?1:0,Ia:window.performance&&window.performance.timing?window.performance.timing:j,$:j,R:j,d:{},V:[],send:function(d){if(a.takeTimeoutMetrics&&d===Object(d)){var b=[],c=encodeURIComponent,e;for(e in d)d.hasOwnProperty(e)&&b.push(c(e)+"="+c(d[e]));d="http"+
(a.loadSSL?"s":"")+"://dpm.demdex.net/event?d_visid_ver="+a.version+"&d_visid_stg_timeout="+a.loadTimeout+"&"+b.join("&")+"&d_orgid="+c(a.marketingCloudOrgID)+"&d_timingapi="+this.ob+"&d_winload="+this.vb()+"&d_ld="+this.p();(new Image).src=d;a.timeoutMetricsLog.push(d)}},vb:function(){this.R===j&&(this.R=this.Ia?this.$-this.Ia.navigationStart:this.$-l.nb);return this.R},p:function(){return(new Date).getTime()},J:function(a){var b=this.d[a],c={};c.d_visid_stg_timeout_captured=b.xa;c.d_visid_cors=
b.wa;c.d_fieldgroup=a;c.d_settimeout_overriden=b.va;b.timeout?b.xb?(c.d_visid_timedout=1,c.d_visid_timeout=b.timeout-b.requestStart,c.d_visid_response=-1):(c.d_visid_timedout="n/a",c.d_visid_timeout="n/a",c.d_visid_response="n/a"):(c.d_visid_timedout=0,c.d_visid_timeout=-1,c.d_visid_response=b.Nb-b.requestStart);c.d_visid_url=b.url;l.aa?this.send(c):this.V.push(c);delete this.d[a]},Lb:function(){for(var a=0,b=this.V.length;a<b;a++)this.send(this.V[a])},Ca:function(){return"function"===typeof setTimeout.toString?
-1<setTimeout.toString().indexOf("[native code]")?0:1:-1}};a.Zb=p;var y={isClientSideMarketingCloudVisitorID:j,MCIDCallTimedOut:j,AnalyticsIDCallTimedOut:j,AAMIDCallTimedOut:j,d:{},Na:function(a,b){switch(a){case H:b===k?this.MCIDCallTimedOut!==i&&(this.MCIDCallTimedOut=k):this.MCIDCallTimedOut=b;break;case E:b===k?this.AnalyticsIDCallTimedOut!==i&&(this.AnalyticsIDCallTimedOut=k):this.AnalyticsIDCallTimedOut=b;break;case D:b===k?this.AAMIDCallTimedOut!==i&&(this.AAMIDCallTimedOut=k):this.AAMIDCallTimedOut=
b}}};a.isClientSideMarketingCloudVisitorID=function(){return y.isClientSideMarketingCloudVisitorID};a.MCIDCallTimedOut=function(){return y.MCIDCallTimedOut};a.AnalyticsIDCallTimedOut=function(){return y.AnalyticsIDCallTimedOut};a.AAMIDCallTimedOut=function(){return y.AAMIDCallTimedOut};a.idSyncGetOnPageSyncInfo=function(){a.f();return a.a(K)};a.idSyncByURL=function(d){var b,c=d||{};b=c.minutesToLive;var e="";a.idSyncDisableSyncs&&(e=e?e:"Error: id syncs have been disabled");if("string"!==typeof c.dpid||
!c.dpid.length)e=e?e:"Error: config.dpid is empty";if("string"!==typeof c.url||!c.url.length)e=e?e:"Error: config.url is empty";if("undefined"===typeof b)b=20160;else if(b=parseInt(b,10),isNaN(b)||0>=b)e=e?e:"Error: config.minutesToLive needs to be a positive number";b={error:e,rc:b};if(b.error)return b.error;var e=d.url,f=encodeURIComponent,c=z,g,e=e.replace(/^https:/,"").replace(/^http:/,"");g=m.za(["",d.dpid,d.dpuuid||""],",");d=["ibs",f(d.dpid),"img",f(e),b.ttl,"",g];c.P(d.join("|"));c.q();return"Successfully queued"};
a.idSyncByDataSource=function(d){if(d!==Object(d)||"string"!==typeof d.dpuuid||!d.dpuuid.length)return"Error: config or config.dpuuid is empty";d.url="//dpm.demdex.net/ibs:dpid="+d.dpid+"&dpuuid="+d.dpuuid;return a.idSyncByURL(d)};a._compareVersions=function(a,b){if(a===b)return 0;var c=a.toString().split("."),e=b.toString().split("."),f;a:{f=c.concat(e);for(var g=0,h=f.length;g<h;g++)if(!n.Ta.test(f[g])){f=k;break a}f=i}if(!f)return NaN;for(;c.length<e.length;)c.push("0");for(;e.length<c.length;)e.push("0");
a:{for(f=0;f<c.length;f++){g=parseInt(c[f],10);h=parseInt(e[f],10);if(g>h){c=1;break a}if(h>g){c=-1;break a}}c=0}return c};a._getCookieVersion=function(d){d=d||a.cookieRead(a.cookieName);return(d=n.fa.exec(d))&&1<d.length?d[1]:null};a._resetAmcvCookie=function(d){var b=a._getCookieVersion();(!b||m.zb(b,d))&&m.Mb(a.cookieName)};0>q.indexOf("@")&&(q+="@AdobeOrg");a.marketingCloudOrgID=q;a.cookieName="AMCV_"+q;a.sessionCookieName="AMCVS_"+q;a.cookieDomain=a.Ya();a.cookieDomain==s.location.hostname&&
(a.cookieDomain="");a.loadSSL=0<=s.location.protocol.toLowerCase().indexOf("https");a.loadTimeout=3E4;a.CORSErrors=[];a.marketingCloudServer=a.audienceManagerServer="dpm.demdex.net";var N={};N[A]=i;N[t]=i;if(w&&"object"==typeof w){for(var J in w)!Object.prototype[J]&&(a[J]=w[J]);a.idSyncContainerID=a.idSyncContainerID||0;a.resetBeforeVersion&&a._resetAmcvCookie(a.resetBeforeVersion);a.ga();a.ha();a.f();J=a.a(L);var O=Math.ceil((new Date).getTime()/n.ea);!a.idSyncDisableSyncs&&z.lb(J,O)&&(a.j(t,-1),
a.e(L,O));a.getMarketingCloudVisitorID();a.getAudienceManagerLocationHint();a.getAudienceManagerBlob();a.cb(a.serverState)}else a.ga(),a.ha();if(!a.idSyncDisableSyncs){z.mb();m.O(window,"load",function(){l.aa=i;p.$=p.p();p.Lb();var a=z;a.Ja()&&a.Q()});try{a.ra.X(function(a){z.X(a.data)},z.S)}catch(P){}}}
Visitor.getInstance=function(q,w){var x,B=window.s_c_il,a;0>q.indexOf("@")&&(q+="@AdobeOrg");if(B)for(a=0;a<B.length;a++)if((x=B[a])&&"Visitor"==x._c&&x.marketingCloudOrgID==q)return x;return new Visitor(q,w)};(function(){function q(){w.aa=x}var w=window.Visitor,x=w.Va,B=w.Sa;x||(x=!0);B||(B=!1);window.addEventListener?window.addEventListener("load",q):window.attachEvent&&window.attachEvent("onload",q);w.nb=(new Date).getTime()})();

var visitor = Visitor.getInstance("CB68E4BA55144CAA0A4C98A5@AdobeOrg", {
	 trackingServer: "om.dowjoneson.com", 
	 trackingServerSecure: "oms.dowjoneson.com", 
	 marketingCloudServer: "om.dowjoneson.com",
	 marketingCloudServerSecure: "oms.dowjoneson.com"
});


var s_code = '',s_objectID;
var svid;

function AppMeasurement(){var a=this;a.version="2.1.0";var h=window;h.s_c_in||(h.s_c_il=[],h.s_c_in=0);a._il=h.s_c_il;a._in=h.s_c_in;a._il[a._in]=a;h.s_c_in++;a._c="s_c";var n=h.AppMeasurement.Ob;n||(n=null);var p=h,l,r;try{for(l=p.parent,r=p.location;l&&l.location&&r&&""+l.location!=""+r&&p.location&&""+l.location!=""+p.location&&l.location.host==r.host;)p=l,l=p.parent}catch(s){}a.P=function(a){try{console.log(a)}catch(b){}};a.La=function(a){return""+parseInt(a)==""+a};a.replace=function(a,b,d){return!a||
0>a.indexOf(b)?a:a.split(b).join(d)};a.escape=function(c){var b,d;if(!c)return c;c=encodeURIComponent(c);for(b=0;7>b;b++)d="+~!*()'".substring(b,b+1),0<=c.indexOf(d)&&(c=a.replace(c,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return c};a.unescape=function(c){if(!c)return c;c=0<=c.indexOf("+")?a.replace(c,"+"," "):c;try{return decodeURIComponent(c)}catch(b){}return unescape(c)};a.vb=function(){var c=h.location.hostname,b=a.fpCookieDomainPeriods,d;b||(b=a.cookieDomainPeriods);if(c&&!a.cookieDomain&&
!/^[0-9.]+$/.test(c)&&(b=b?parseInt(b):2,b=2<b?b:2,d=c.lastIndexOf("."),0<=d)){for(;0<=d&&1<b;)d=c.lastIndexOf(".",d-1),b--;a.cookieDomain=0<d?c.substring(d):c}return a.cookieDomain};a.c_r=a.cookieRead=function(c){c=a.escape(c);var b=" "+a.d.cookie,d=b.indexOf(" "+c+"="),f=0>d?d:b.indexOf(";",d);c=0>d?"":a.unescape(b.substring(d+2+c.length,0>f?b.length:f));return"[[B]]"!=c?c:""};a.c_w=a.cookieWrite=function(c,b,d){var f=a.vb(),e=a.cookieLifetime,g;b=""+b;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=
e&&"NONE"!=e&&((g=""!=b?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1==d&&(d=new Date,g=d.getYear(),d.setYear(g+5+(1900>g?1900:0))));return c&&"NONE"!=e?(a.d.cookie=a.escape(c)+"="+a.escape(""!=b?b:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toGMTString()+";":"")+(f?" domain="+f+";":""),a.cookieRead(c)==b):0};a.K=[];a.ia=function(c,b,d){if(a.Ea)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,k=["webkitvisibilitychange",
"visibilitychange"];g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.ja)for(a.ja=1,d=0;d<k.length;d++)a.d.addEventListener(k[d],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&(a.ja=0,a.delayReady())});f=1;e=0}else d||a.p("_d")&&(f=1);f&&(a.K.push({m:c,a:b,t:e}),a.ja||setTimeout(a.delayReady,a.maxDelay));return f};a.delayReady=function(){var c=(new Date).getTime(),b=0,d;for(a.p("_d")?b=1:a.xa();0<a.K.length;){d=a.K.shift();if(b&&!d.t&&d.t>c){a.K.unshift(d);
setTimeout(a.delayReady,parseInt(a.maxDelay/2));break}a.Ea=1;a[d.m].apply(a,d.a);a.Ea=0}};a.setAccount=a.sa=function(c){var b,d;if(!a.ia("setAccount",arguments))if(a.account=c,a.allAccounts)for(b=a.allAccounts.concat(c.split(",")),a.allAccounts=[],b.sort(),d=0;d<b.length;d++)0!=d&&b[d-1]==b[d]||a.allAccounts.push(b[d]);else a.allAccounts=c.split(",")};a.foreachVar=function(c,b){var d,f,e,g,k="";e=f="";if(a.lightProfileID)d=a.O,(k=a.lightTrackVars)&&(k=","+k+","+a.na.join(",")+",");else{d=a.g;if(a.pe||
a.linkType)k=a.linkTrackVars,f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(k=a[e].Mb,f=a[e].Lb));k&&(k=","+k+","+a.G.join(",")+",");f&&k&&(k+=",events,")}b&&(b=","+b+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!k||0<=k.indexOf(","+e+","))&&(!b||0<=b.indexOf(","+e+","))&&c(e,g)};a.r=function(c,b,d,f,e){var g="",k,m,h,t,l=0;"contextData"==c&&(c="c");if(b){for(k in b)if(!(Object.prototype[k]||e&&k.substring(0,e.length)!=e)&&b[k]&&(!d||0<=d.indexOf(","+(f?f+
".":"")+k+","))){h=!1;if(l)for(m=0;m<l.length;m++)k.substring(0,l[m].length)==l[m]&&(h=!0);if(!h&&(""==g&&(g+="&"+c+"."),m=b[k],e&&(k=k.substring(e.length)),0<k.length))if(h=k.indexOf("."),0<h)m=k.substring(0,h),h=(e?e:"")+m+".",l||(l=[]),l.push(h),g+=a.r(m,b,d,f,h);else if("boolean"==typeof m&&(m=m?"true":"false"),m){if("retrieveLightData"==f&&0>e.indexOf(".contextData."))switch(h=k.substring(0,4),t=k.substring(4),k){case "transactionID":k="xact";break;case "channel":k="ch";break;case "campaign":k=
"v0";break;default:a.La(t)&&("prop"==h?k="c"+t:"eVar"==h?k="v"+t:"list"==h?k="l"+t:"hier"==h&&(k="h"+t,m=m.substring(0,255)))}g+="&"+a.escape(k)+"="+a.escape(m)}}""!=g&&(g+="&."+c)}return g};a.usePostbacks=0;a.yb=function(){var c="",b,d,f,e,g,k,m,h,l="",p="",q=e="";if(a.lightProfileID)b=a.O,(l=a.lightTrackVars)&&(l=","+l+","+a.na.join(",")+",");else{b=a.g;if(a.pe||a.linkType)l=a.linkTrackVars,p=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(l=a[e].Mb,p=a[e].Lb));
l&&(l=","+l+","+a.G.join(",")+",");p&&(p=","+p+",",l&&(l+=",events,"));a.events2&&(q+=(""!=q?",":"")+a.events2)}if(a.visitor&&a.visitor.getCustomerIDs){e=n;if(g=a.visitor.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],"object"==typeof f&&(e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState)));e&&(c+=a.r("cid",e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(c+=a.r("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<b.length;d++){e=b[d];g=a[e];f=e.substring(0,
4);k=e.substring(4);g||("events"==e&&q?(g=q,q=""):"marketingCloudOrgID"==e&&a.visitor&&(g=a.visitor.marketingCloudOrgID));if(g&&(!l||0<=l.indexOf(","+e+","))){switch(e){case "customerPerspective":e="cp";break;case "marketingCloudOrgID":e="mcorgid";break;case "supplementalDataID":e="sdid";break;case "timestamp":e="ts";break;case "dynamicVariablePrefix":e="D";break;case "visitorID":e="vid";break;case "marketingCloudVisitorID":e="mid";break;case "analyticsVisitorID":e="aid";break;case "audienceManagerLocationHint":e=
"aamlh";break;case "audienceManagerBlob":e="aamb";break;case "authState":e="as";break;case "pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,255));break;case "pageURLRest":e="-g";break;case "referrer":e="r";break;case "vmk":case "visitorMigrationKey":e="vmt";break;case "visitorMigrationServer":e="vmf";a.ssl&&a.visitorMigrationServerSecure&&(g="");break;case "visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case "charSet":e="ce";break;
case "visitorNamespace":e="ns";break;case "cookieDomainPeriods":e="cdp";break;case "cookieLifetime":e="cl";break;case "variableProvider":e="vvp";break;case "currencyCode":e="cc";break;case "channel":e="ch";break;case "transactionID":e="xact";break;case "campaign":e="v0";break;case "latitude":e="lat";break;case "longitude":e="lon";break;case "resolution":e="s";break;case "colorDepth":e="c";break;case "javascriptVersion":e="j";break;case "javaEnabled":e="v";break;case "cookiesEnabled":e="k";break;case "browserWidth":e=
"bw";break;case "browserHeight":e="bh";break;case "connectionType":e="ct";break;case "homepage":e="hp";break;case "events":q&&(g+=(""!=g?",":"")+q);if(p)for(k=g.split(","),g="",f=0;f<k.length;f++)m=k[f],h=m.indexOf("="),0<=h&&(m=m.substring(0,h)),h=m.indexOf(":"),0<=h&&(m=m.substring(0,h)),0<=p.indexOf(","+m+",")&&(g+=(g?",":"")+k[f]);break;case "events2":g="";break;case "contextData":c+=a.r("c",a[e],l,e);g="";break;case "lightProfileID":e="mtp";break;case "lightStoreForSeconds":e="mtss";a.lightProfileID||
(g="");break;case "lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case "retrieveLightProfiles":e="mtsr";break;case "deleteLightProfiles":e="mtsd";break;case "retrieveLightData":a.retrieveLightProfiles&&(c+=a.r("mts",a[e],l,e));g="";break;default:a.La(k)&&("prop"==f?e="c"+k:"eVar"==f?e="v"+k:"list"==f?e="l"+k:"hier"==f&&(e="h"+k,g=g.substring(0,255)))}g&&(c+="&"+e+"="+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(c+=a.e)}return c};a.D=function(a){var b=a.tagName;if("undefined"!=
""+a.Rb||"undefined"!=""+a.Hb&&"HTML"!=(""+a.Hb).toUpperCase())return"";b=b&&b.toUpperCase?b.toUpperCase():"";"SHAPE"==b&&(b="");b&&(("INPUT"==b||"BUTTON"==b)&&a.type&&a.type.toUpperCase?b=a.type.toUpperCase():!b&&a.href&&(b="A"));return b};a.Ha=function(a){var b=h.location,d=a.href?a.href:"",f,e,g;f=d.indexOf(":");e=d.indexOf("?");g=d.indexOf("/");d&&(0>f||0<=e&&f>e||0<=g&&f>g)&&(e=a.protocol&&1<a.protocol.length?a.protocol:b.protocol?b.protocol:"",f=b.pathname.lastIndexOf("/"),d=(e?e+"//":"")+(a.host?
a.host:b.host?b.host:"")+("/"!=d.substring(0,1)?b.pathname.substring(0,0>f?0:f)+"/":"")+d);return d};a.L=function(c){var b=a.D(c),d,f,e="",g=0;return b&&(d=c.protocol,f=c.onclick,!c.href||"A"!=b&&"AREA"!=b||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==b||"SUBMIT"==b?(c.value?e=c.value:c.innerText?e=c.innerText:c.textContent&&(e=c.textContent),g=3):"IMAGE"==b&&c.src&&(e=c.src):e=a.Ha(c),e)?{id:e.substring(0,
100),type:g}:0};a.Pb=function(c){for(var b=a.D(c),d=a.L(c);c&&!d&&"BODY"!=b;)if(c=c.parentElement?c.parentElement:c.parentNode)b=a.D(c),d=a.L(c);d&&"BODY"!=b||(c=0);c&&(b=c.onclick?""+c.onclick:"",0<=b.indexOf(".tl(")||0<=b.indexOf(".trackLink("))&&(c=0);return c};a.Gb=function(){var c,b,d=a.linkObject,f=a.linkType,e=a.linkURL,g,k;a.oa=1;d||(a.oa=0,d=a.clickObject);if(d){c=a.D(d);for(b=a.L(d);d&&!b&&"BODY"!=c;)if(d=d.parentElement?d.parentElement:d.parentNode)c=a.D(d),b=a.L(d);b&&"BODY"!=c||(d=0);
if(d&&!a.linkObject){var m=d.onclick?""+d.onclick:"";if(0<=m.indexOf(".tl(")||0<=m.indexOf(".trackLink("))d=0}}else a.oa=1;!e&&d&&(e=a.Ha(d));e&&!a.linkLeaveQueryString&&(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var l=0,p=0,n;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(m=e.toLowerCase(),g=m.indexOf("?"),k=m.indexOf("#"),0<=g?0<=k&&k<g&&(g=k):g=k,0<=g&&(m=m.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),k=0;k<g.length;k++)(n=g[k])&&m.substring(m.length-(n.length+
1))=="."+n&&(f="d");if(a.trackExternalLinks&&!f&&(m=e.toLowerCase(),a.Ka(m)&&(a.linkInternalFilters||(a.linkInternalFilters=h.location.hostname),g=0,a.linkExternalFilters?(g=a.linkExternalFilters.toLowerCase().split(","),l=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(k=0;k<g.length;k++)n=g[k],0<=m.indexOf(n)&&(p=1);p?l&&(f="e"):l||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,
f||(f=a.pageURL,e=0),h.s_objectID&&(b.id=h.s_objectID,d=b.type=1),f&&b&&b.id&&c&&(a.e="&pid="+a.escape(f.substring(0,255))+(e?"&pidt="+e:"")+"&oid="+a.escape(b.id.substring(0,100))+(b.type?"&oidt="+b.type:"")+"&ot="+c+(d?"&oi="+d:"")))};a.zb=function(){var c=a.oa,b=a.linkType,d=a.linkURL,f=a.linkName;b&&(d||f)&&(b=b.toLowerCase(),"d"!=b&&"e"!=b&&(b="o"),a.pe="lnk_"+b,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",c=1);a.abort&&(c=0);if(a.trackClickMap||a.trackInlineStats||a.ActivityMap){var b={},
d=0,e=a.cookieRead("s_sq"),g=e?e.split("&"):0,k,m,h,e=0;if(g)for(k=0;k<g.length;k++)m=g[k].split("="),f=a.unescape(m[0]).split(","),m=a.unescape(m[1]),b[m]=f;f=a.account.split(",");k={};for(h in a.contextData)h&&!Object.prototype[h]&&"a.activitymap."==h.substring(0,14)&&(k[h]=a.contextData[h],a.contextData[h]="");a.e=a.r("c",k)+(a.e?a.e:"");if(c||a.e){c&&!a.e&&(e=1);for(m in b)if(!Object.prototype[m])for(h=0;h<f.length;h++)for(e&&(g=b[m].join(","),g==a.account&&(a.e+=("&"!=m.charAt(0)?"&":"")+m,b[m]=
[],d=1)),k=0;k<b[m].length;k++)g=b[m][k],g==f[h]&&(e&&(a.e+="&u="+a.escape(g)+("&"!=m.charAt(0)?"&":"")+m+"&u=0"),b[m].splice(k,1),d=1);c||(d=1);if(d){e="";k=2;!c&&a.e&&(e=a.escape(f.join(","))+"="+a.escape(a.e),k=1);for(m in b)!Object.prototype[m]&&0<k&&0<b[m].length&&(e+=(e?"&":"")+a.escape(b[m].join(","))+"="+a.escape(m),k--);a.cookieWrite("s_sq",e)}}}return c};a.Ab=function(){if(!a.Kb){var c=new Date,b=p.location,d,f,e=f=d="",g="",k="",h="1.2",l=a.cookieWrite("s_cc","true",0)?"Y":"N",n="",q="";
if(c.setUTCDate&&(h="1.3",(0).toPrecision&&(h="1.5",c=[],c.forEach))){h="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(h="1.7",c.reduce&&(h="1.8",h.trim&&(h="1.8.1",Date.parse&&(h="1.8.2",Object.create&&(h="1.8.5")))))}catch(r){}}d=screen.width+"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?a.w.innerWidth:a.d.documentElement.offsetWidth;k=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),
n=a.b.Qb(b)?"Y":"N"}catch(s){}try{a.b.addBehavior("#default#clientCaps"),q=a.b.connectionType}catch(u){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=h;a.javaEnabled=e;a.cookiesEnabled=l;a.browserWidth=g;a.browserHeight=k;a.connectionType=q;a.homepage=n;a.Kb=1}};a.Q={};a.loadModule=function(c,b){var d=a.Q[c];if(!d){d=h["AppMeasurement_Module_"+c]?new h["AppMeasurement_Module_"+c](a):{};a.Q[c]=a[c]=d;d.cb=function(){return d.hb};d.ib=function(b){if(d.hb=b)a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],
1)||b(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.cb,set:d.ib}):d._olc=1}catch(f){d._olc=1}}b&&(a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],1)||b(a,d))};a.p=function(c){var b,d;for(b in a.Q)if(!Object.prototype[b]&&(d=a.Q[b])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[c]&&d[c]()))return 1;return 0};a.Cb=function(){var c=Math.floor(1E13*Math.random()),b=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=
a.cookieRead(d);if(b){b*=100;f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,c))return 0;f=c}if(f%1E4>b)return 0}return 1};a.R=function(c,b){var d,f,e,g,k,h;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)if(g=f[e],(k=c[g])||c["!"+g]){if(!b&&("contextData"==g||"retrieveLightData"==g)&&a[g])for(h in a[g])k[h]||(k[h]=a[g][h]);a[g]=k}};a.Ua=function(c,b){var d,f,e,g;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)g=f[e],c[g]=a[g],b||c[g]||(c["!"+g]=1)};a.ub=function(a){var b,d,f,e,g,k=0,h,
l="",n="";if(a&&255<a.length&&(b=""+a,d=b.indexOf("?"),0<d&&(h=b.substring(d+1),b=b.substring(0,d),e=b.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=b.substring(d),b=b.substring(0,d),0<=e.indexOf("google")?k=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")&&(k=",p,ei,"),k&&h)))){if((a=h.split("&"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("="),0<d&&0<=k.indexOf(","+e.substring(0,d)+",")?
l+=(l?"&":"")+e:n+=(n?"&":"")+e;l&&n?h=l+"&"+n:n=""}d=253-(h.length-n.length)-b.length;a=b+(0<d?g.substring(0,d):"")+"?"+h}return a};a.$a=function(c){var b=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];b||(b=a.d.webkitVisibilityState);if(b&&"prerender"==b){if(c)for(b=0;b<d.length;b++)a.d.addEventListener(d[b],function(){var b=a.d.visibilityState;b||(b=a.d.webkitVisibilityState);"visible"==b&&c()});return!1}return!0};a.ea=!1;a.I=!1;a.kb=function(){a.I=!0;a.j()};a.ca=!1;a.V=!1;
a.gb=function(c){a.marketingCloudVisitorID=c;a.V=!0;a.j()};a.fa=!1;a.W=!1;a.lb=function(c){a.visitorOptedOut=c;a.W=!0;a.j()};a.Z=!1;a.S=!1;a.Wa=function(c){a.analyticsVisitorID=c;a.S=!0;a.j()};a.ba=!1;a.U=!1;a.Ya=function(c){a.audienceManagerLocationHint=c;a.U=!0;a.j()};a.aa=!1;a.T=!1;a.Xa=function(c){a.audienceManagerBlob=c;a.T=!0;a.j()};a.Za=function(c){a.maxDelay||(a.maxDelay=250);return a.p("_d")?(c&&setTimeout(function(){c()},a.maxDelay),!1):!0};a.da=!1;a.H=!1;a.xa=function(){a.H=!0;a.j()};a.isReadyToTrack=
function(){var c=!0,b=a.visitor,d,f,e;a.ea||a.I||(a.$a(a.kb)?a.I=!0:a.ea=!0);if(a.ea&&!a.I)return!1;b&&b.isAllowed()&&(a.ca||a.marketingCloudVisitorID||!b.getMarketingCloudVisitorID||(a.ca=!0,a.marketingCloudVisitorID=b.getMarketingCloudVisitorID([a,a.gb]),a.marketingCloudVisitorID&&(a.V=!0)),a.fa||a.visitorOptedOut||!b.isOptedOut||(a.fa=!0,a.visitorOptedOut=b.isOptedOut([a,a.lb]),a.visitorOptedOut!=n&&(a.W=!0)),a.Z||a.analyticsVisitorID||!b.getAnalyticsVisitorID||(a.Z=!0,a.analyticsVisitorID=b.getAnalyticsVisitorID([a,
a.Wa]),a.analyticsVisitorID&&(a.S=!0)),a.ba||a.audienceManagerLocationHint||!b.getAudienceManagerLocationHint||(a.ba=!0,a.audienceManagerLocationHint=b.getAudienceManagerLocationHint([a,a.Ya]),a.audienceManagerLocationHint&&(a.U=!0)),a.aa||a.audienceManagerBlob||!b.getAudienceManagerBlob||(a.aa=!0,a.audienceManagerBlob=b.getAudienceManagerBlob([a,a.Xa]),a.audienceManagerBlob&&(a.T=!0)),c=a.ca&&!a.V&&!a.marketingCloudVisitorID,b=a.Z&&!a.S&&!a.analyticsVisitorID,d=a.ba&&!a.U&&!a.audienceManagerLocationHint,
f=a.aa&&!a.T&&!a.audienceManagerBlob,e=a.fa&&!a.W,c=c||b||d||f||e?!1:!0);a.da||a.H||(a.Za(a.xa)?a.H=!0:a.da=!0);a.da&&!a.H&&(c=!1);return c};a.o=n;a.u=0;a.callbackWhenReadyToTrack=function(c,b,d){var f;f={};f.pb=c;f.ob=b;f.mb=d;a.o==n&&(a.o=[]);a.o.push(f);0==a.u&&(a.u=setInterval(a.j,100))};a.j=function(){var c;if(a.isReadyToTrack()&&(a.jb(),a.o!=n))for(;0<a.o.length;)c=a.o.shift(),c.ob.apply(c.pb,c.mb)};a.jb=function(){a.u&&(clearInterval(a.u),a.u=0)};a.eb=function(c){var b,d,f=n,e=n;if(!a.isReadyToTrack()){b=
[];if(c!=n)for(d in f={},c)f[d]=c[d];e={};a.Ua(e,!0);b.push(f);b.push(e);a.callbackWhenReadyToTrack(a,a.track,b);return!0}return!1};a.wb=function(){var c=a.cookieRead("s_fid"),b="",d="",f;f=8;var e=4;if(!c||0>c.indexOf("-")){for(c=0;16>c;c++)f=Math.floor(Math.random()*f),b+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;c=b+"-"+d}a.cookieWrite("s_fid",c,1)||(c=0);return c};a.t=a.track=function(c,b){var d,f=new Date,e="s"+Math.floor(f.getTime()/
108E5)%10+Math.floor(1E13*Math.random()),g=f.getYear(),g="t="+a.escape(f.getDate()+"/"+f.getMonth()+"/"+(1900>g?g+1900:g)+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+" "+f.getDay()+" "+f.getTimezoneOffset());a.visitor&&a.visitor.getAuthState&&(a.authState=a.visitor.getAuthState());a.p("_s");a.eb(c)||(b&&a.R(b),c&&(d={},a.Ua(d,0),a.R(c)),a.Cb()&&!a.visitorOptedOut&&(a.analyticsVisitorID||a.marketingCloudVisitorID||(a.fid=a.wb()),a.Gb(),a.usePlugins&&a.doPlugins&&a.doPlugins(a),a.account&&
(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(f.getTime()/1E3)),f=h.location,a.pageURL||(a.pageURL=f.href?f.href:f),a.referrer||a.Va||(f=a.Util.getQueryParam("adobe_mc_ref",null,null,!0),a.referrer=f||void 0===f?void 0===f?"":f:p.document.referrer),a.Va=1,a.referrer=a.ub(a.referrer),a.p("_g")),a.zb()&&!a.abort&&(a.visitor&&!a.supplementalDataID&&a.visitor.getSupplementalDataID&&(a.supplementalDataID=a.visitor.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?
!1:!0)),a.Ab(),g+=a.yb(),a.Fb(e,g),a.p("_t"),a.referrer=""))),c&&a.R(d,1));a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=h.s_objectID=a.pe=a.pev1=a.pev2=a.pev3=a.e=a.lightProfileID=0};a.za=[];a.registerPreTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.za.push([c,b]):a.debugTracking&&a.P("DEBUG: Non function type passed to registerPreTrackCallback")};a.bb=function(c){a.wa(a.za,
c)};a.ya=[];a.registerPostTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.ya.push([c,b]):a.debugTracking&&a.P("DEBUG: Non function type passed to registerPostTrackCallback")};a.ab=function(c){a.wa(a.ya,c)};a.wa=function(c,b){if("object"==typeof c)for(var d=0;d<c.length;d++){var f=c[d][0],e=c[d][1];e.unshift(b);if("function"==typeof f)try{f.apply(null,e)}catch(g){a.debugTracking&&a.P(g.message)}}};a.tl=a.trackLink=function(c,b,d,f,e){a.linkObject=
c;a.linkType=b;a.linkName=d;e&&(a.l=c,a.A=e);return a.track(f)};a.trackLight=function(c,b,d,f){a.lightProfileID=c;a.lightStoreForSeconds=b;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var c,b;for(c=0;c<a.g.length;c++)if(b=a.g[c],"prop"==b.substring(0,4)||"eVar"==b.substring(0,4)||"hier"==b.substring(0,4)||"list"==b.substring(0,4)||"channel"==b||"events"==b||"eventList"==b||"products"==b||"productList"==b||"purchaseID"==b||"transactionID"==b||"state"==b||"zip"==b||"campaign"==b)a[b]=
void 0};a.tagContainerMarker="";a.Fb=function(c,b){var d,f=a.trackingServer;d="";var e=a.dc,g="sc.",h=a.visitorNamespace;f?a.trackingServerSecure&&a.ssl&&(f=a.trackingServerSecure):(h||(h=a.account,f=h.indexOf(","),0<=f&&(h=h.substring(0,f)),h=h.replace(/[^A-Za-z0-9]/g,"")),d||(d="2o7.net"),e=e?(""+e).toLowerCase():"d1","2o7.net"==d&&("d1"==e?e="112":"d2"==e&&(e="122"),g=""),f=h+"."+e+"."+g+d);d=a.ssl?"https://":"http://";e=a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks;d+=
f+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(e?"10":"1")+"/JS-"+a.version+(a.Jb?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")+"/"+c+"?AQB=1&ndh=1&pf=1&"+(e?"callback=s_c_il["+a._in+"].doPostbacks&et=1&":"")+b+"&AQE=1";a.bb(d);a.sb(d);a.ka()};a.Ta=/{(%?)(.*?)(%?)}/;a.Nb=RegExp(a.Ta.source,"g");a.tb=function(c){if("object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];if("string"==typeof d.c&&"aa."==d.id.substr(0,3))for(var f=d.c.match(a.Nb),e=0;e<f.length;++e){var g=
f[e],h=g.match(a.Ta),l="";"%"==h[1]&&"timezone_offset"==h[2]?l=(new Date).getTimezoneOffset():"%"==h[1]&&"timestampz"==h[2]&&(l=a.xb());d.c=d.c.replace(g,a.escape(l))}}};a.xb=function(){var c=new Date,b=new Date(6E4*Math.abs(c.getTimezoneOffset()));return a.k(4,c.getFullYear())+"-"+a.k(2,c.getMonth()+1)+"-"+a.k(2,c.getDate())+"T"+a.k(2,c.getHours())+":"+a.k(2,c.getMinutes())+":"+a.k(2,c.getSeconds())+(0<c.getTimezoneOffset()?"-":"+")+a.k(2,b.getUTCHours())+":"+a.k(2,b.getUTCMinutes())};a.k=function(a,
b){return(Array(a+1).join(0)+b).slice(-a)};a.ta={};a.doPostbacks=function(c){if("object"==typeof c)if(a.tb(c),"object"==typeof a.AudienceManagement&&"function"==typeof a.AudienceManagement.isReady&&a.AudienceManagement.isReady()&&"function"==typeof a.AudienceManagement.passData)a.AudienceManagement.passData(c);else if("object"==typeof c&&"object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];"object"==typeof d&&"string"==typeof d.c&&"string"==typeof d.id&&"aa."==d.id.substr(0,
3)&&(a.ta[d.id]=new Image,a.ta[d.id].alt="",a.ta[d.id].src=d.c)}};a.sb=function(c){a.i||a.Bb();a.i.push(c);a.ma=a.C();a.Ra()};a.Bb=function(){a.i=a.Db();a.i||(a.i=[])};a.Db=function(){var c,b;if(a.ra()){try{(b=h.localStorage.getItem(a.pa()))&&(c=h.JSON.parse(b))}catch(d){}return c}};a.ra=function(){var c=!0;a.trackOffline&&a.offlineFilename&&h.localStorage&&h.JSON||(c=!1);return c};a.Ia=function(){var c=0;a.i&&(c=a.i.length);a.q&&c++;return c};a.ka=function(){if(a.q&&(a.B&&a.B.complete&&a.B.F&&a.B.va(),
a.q))return;a.Ja=n;if(a.qa)a.ma>a.N&&a.Pa(a.i),a.ua(500);else{var c=a.nb();if(0<c)a.ua(c);else if(c=a.Fa())a.q=1,a.Eb(c),a.Ib(c)}};a.ua=function(c){a.Ja||(c||(c=0),a.Ja=setTimeout(a.ka,c))};a.nb=function(){var c;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;c=a.C()-a.Oa;return a.offlineThrottleDelay<c?0:a.offlineThrottleDelay-c};a.Fa=function(){if(0<a.i.length)return a.i.shift()};a.Eb=function(c){if(a.debugTracking){var b="AppMeasurement Debug: "+c;c=c.split("&");var d;for(d=0;d<c.length;d++)b+=
"\n\t"+a.unescape(c[d]);a.P(b)}};a.fb=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.Y=!1;var q;try{q=JSON.parse('{"x":"y"}')}catch(u){q=null}q&&"y"==q.x?(a.Y=!0,a.X=function(a){return JSON.parse(a)}):h.$&&h.$.parseJSON?(a.X=function(a){return h.$.parseJSON(a)},a.Y=!0):a.X=function(){return null};a.Ib=function(c){var b,d,f;a.fb()&&2047<c.length&&("undefined"!=typeof XMLHttpRequest&&(b=new XMLHttpRequest,"withCredentials"in b?d=1:b=0),b||"undefined"==typeof XDomainRequest||(b=
new XDomainRequest,d=2),b&&(a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks)&&(a.Y?b.Ba=!0:b=0));!b&&a.Sa&&(c=c.substring(0,2047));!b&&a.d.createElement&&(0!=a.usePostbacks||a.AudienceManagement&&a.AudienceManagement.isReady())&&(b=a.d.createElement("SCRIPT"))&&"async"in b&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(b.type="text/javascript",b.setAttribute("async","async"),d=3):b=0);b||(b=new Image,b.alt="",b.abort||"undefined"===typeof h.InstallTrigger||
(b.abort=function(){b.src=n}));b.Da=function(){try{b.F&&(clearTimeout(b.F),b.F=0)}catch(a){}};b.onload=b.va=function(){a.ab(c);b.Da();a.rb();a.ga();a.q=0;a.ka();if(b.Ba){b.Ba=!1;try{a.doPostbacks(a.X(b.responseText))}catch(d){}}};b.onabort=b.onerror=b.Ga=function(){b.Da();(a.trackOffline||a.qa)&&a.q&&a.i.unshift(a.qb);a.q=0;a.ma>a.N&&a.Pa(a.i);a.ga();a.ua(500)};b.onreadystatechange=function(){4==b.readyState&&(200==b.status?b.va():b.Ga())};a.Oa=a.C();if(1==d||2==d){var e=c.indexOf("?");f=c.substring(0,
e);e=c.substring(e+1);e=e.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,"");1==d?(b.open("POST",f,!0),b.send(e)):2==d&&(b.open("POST",f),b.send(e))}else if(b.src=c,3==d){if(a.Ma)try{f.removeChild(a.Ma)}catch(g){}f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);a.Ma=a.B}b.F=setTimeout(function(){b.F&&(b.complete?b.va():(a.trackOffline&&b.abort&&b.abort(),b.Ga()))},5E3);a.qb=c;a.B=h["s_i_"+a.replace(a.account,",","_")]=b;if(a.useForcedLinkTracking&&a.J||a.A)a.forcedLinkTrackingTimeout||(a.forcedLinkTrackingTimeout=
250),a.ha=setTimeout(a.ga,a.forcedLinkTrackingTimeout)};a.rb=function(){if(a.ra()&&!(a.Na>a.N))try{h.localStorage.removeItem(a.pa()),a.Na=a.C()}catch(c){}};a.Pa=function(c){if(a.ra()){a.Ra();try{h.localStorage.setItem(a.pa(),h.JSON.stringify(c)),a.N=a.C()}catch(b){}}};a.Ra=function(){if(a.trackOffline){if(!a.offlineLimit||0>=a.offlineLimit)a.offlineLimit=10;for(;a.i.length>a.offlineLimit;)a.Fa()}};a.forceOffline=function(){a.qa=!0};a.forceOnline=function(){a.qa=!1};a.pa=function(){return a.offlineFilename+
"-"+a.visitorNamespace+a.account};a.C=function(){return(new Date).getTime()};a.Ka=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(c){var b,d,f;a.Jb=c;for(b=0;b<a._il.length;b++)if((d=a._il[b])&&"s_l"==d._c&&d.tagContainerName==c){a.R(d);if(d.lmq)for(b=0;b<d.lmq.length;b++)f=d.lmq[b],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(b in c=a[f],f=d.ml[f],f)!Object.prototype[b]&&("function"!=
typeof f[b]||0>(""+f[b]).indexOf("s_c_il"))&&(c[b]=f[b]);if(d.mmq)for(b=0;b<d.mmq.length;b++)f=d.mmq[b],a[f.m]&&(c=a[f.m],c[f.f]&&"function"==typeof c[f.f]&&(f.a?c[f.f].apply(c,f.a):c[f.f].apply(c)));if(d.tq)for(b=0;b<d.tq.length;b++)a.track(d.tq[b]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(c,b,d,f){var e,g="";b||(b=a.pageURL?a.pageURL:h.location);d=d?d:"&";if(!c||!b)return g;b=""+b;e=b.indexOf("?");if(0>
e)return g;b=d+b.substring(e+1)+d;if(!f||!(0<=b.indexOf(d+c+d)||0<=b.indexOf(d+c+"="+d))){e=b.indexOf(d+c+"=");if(0>e)return g;b=b.substring(e+d.length+c.length+1);e=b.indexOf(d);0<=e&&(b=b.substring(0,e));0<b.length&&(g=a.unescape(b));return g}}};a.G="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" ");
a.g=a.G.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.na="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.O=a.na.slice(0);a.Aa="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData usePostbacks registerPreTrackCallback registerPostTrackCallback AudienceManagement".split(" ");
for(l=0;250>=l;l++)76>l&&(a.g.push("prop"+l),a.O.push("prop"+l)),a.g.push("eVar"+l),a.O.push("eVar"+l),6>l&&a.g.push("hier"+l),4>l&&a.g.push("list"+l);l="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID".split(" ");a.g=a.g.concat(l);a.G=a.G.concat(l);a.ssl=0<=h.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.offlineThrottleDelay=
0;a.offlineFilename="AppMeasurement.offline";a.Oa=0;a.ma=0;a.N=0;a.Na=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=h;a.d=h.document;try{if(a.Sa=!1,navigator){var v=navigator.userAgent;if("Microsoft Internet Explorer"==navigator.appName||0<=v.indexOf("MSIE ")||0<=v.indexOf("Trident/")&&0<=v.indexOf("Windows NT 6"))a.Sa=!0}}catch(w){}a.ga=function(){a.ha&&(h.clearTimeout(a.ha),a.ha=n);a.l&&a.J&&a.l.dispatchEvent(a.J);a.A&&("function"==typeof a.A?a.A():
a.l&&a.l.href&&(a.d.location=a.l.href));a.l=a.J=a.A=0};a.Qa=function(){a.b=a.d.body;a.b?(a.v=function(c){var b,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||c&&c["s_fe_"+a._in])){if(a.Ca)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.v,!1);else{a.b.removeEventListener("click",a.v,!0);a.Ca=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=c.srcElement?c.srcElement:c.target;try{if(!a.clickObject||a.M&&a.M==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||
a.clickObject.parentNode))a.clickObject=0;else{var k=a.M=a.clickObject;a.la&&(clearTimeout(a.la),a.la=0);a.la=setTimeout(function(){a.M==k&&(a.M=0)},1E4);f=a.Ia();a.track();if(f<a.Ia()&&a.useForcedLinkTracking&&c.target){for(e=c.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.Ka(g)||(g=0),d=e.target,c.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||h.name&&d==h.name))){try{b=a.d.createEvent("MouseEvents")}catch(l){b=
new h.MouseEvent}if(b){try{b.initMouseEvent("click",c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}catch(n){b=0}b&&(b["s_fe_"+a._in]=b.s_fe=1,c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),c.preventDefault(),a.l=c.target,a.J=b)}}}}}catch(p){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.v):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&
a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&h.MouseEvent)&&(a.Ca=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.v,!0)),a.b.addEventListener("click",a.v,!1))):setTimeout(a.Qa,30)};a.Qa();a.loadModule("ActivityMap")}
function s_gi(a){var h,n=window.s_c_il,p,l,r=a.split(","),s,q,u=0;if(n)for(p=0;!u&&p<n.length;){h=n[p];if("s_c"==h._c&&(h.account||h.oun))if(h.account&&h.account==a)u=1;else for(l=h.account?h.account:h.oun,l=h.allAccounts?h.allAccounts:l.split(","),s=0;s<r.length;s++)for(q=0;q<l.length;q++)r[s]==l[q]&&(u=1);p++}u||(h=new AppMeasurement);h.setAccount?h.setAccount(a):h.sa&&h.sa(a);return h}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);
function s_pgicq(){var a=window,h=a.s_giq,n,p,l;if(h)for(n=0;n<h.length;n++)p=h[n],l=s_gi(p.oun),l.setAccount(p.un),l.setTagContainer(p.tagContainerName);a.s_giq=0}s_pgicq();

/*! vidora-client 1.2.7 10-01-2015 */
!function(a,b,c){function d(a){Qb.console&&console.log&&console.log(a)}function e(a){Qb.console&&console.error&&console.error(a)}function f(a){throw new Error(a)}function g(a,b){return a.forEach(b)}function h(a,b){for(var c in a)b(c)}function i(a,b){return a.map(b)}function j(a){return String(a)}function k(a){return"undefined"==typeof a}function l(a){return null===a}function m(a){return k(a)||l(a)}function n(a){return"string"==typeof a}function o(a){return!l(a)&&"object"==typeof a}function p(a){return!m(a)&&a.constructor===Array}function q(a){return"function"==typeof a}function r(a,b){return m(a)?b:a}function s(a,b){var c=r(a,{}),d=r(b,{});for(var e in d)c[e]=d[e];return c}function t(a){var b=r(a,{});return o(b)||f("Options should be an object."),b}function u(a){return JSON.parse(a)}function v(a){return JSON.stringify(a)}function w(a){var b=encodeURIComponent(a),c=b.replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");return c}function x(a,b){return b>a?-1:a>b?1:0}function y(a){var b=[];for(var c in a){var d=a[c],e=k(d)?[c]:[c,d];b.push(e)}b.sort(function(a,b){return x(a,b)});var f=i(b,function(a){return i(a,w).join("=")}),g=f.join("&");return g}function z(){var a=new Date;return a.getTime()}function A(a,b){return a.indexOf(b)>=0}function B(){var a=Sb.userAgent;return A(a,"MSIE ")||A(a,"Trident/")||A(a,"Edge/")}function C(a){var b=new Uint16Array(a);crypto.getRandomValues(b);for(var c=[],d=0;d<b.length;d++)c.push(b[d]);return c}function D(){return Math.random()}function E(){return Math.floor(65536*D())}function F(a){for(var b=[],c=0;Tb>c&&a>c;c++)b.push(65535&(E()^z()));for(;a>c;c++)b.push(E());return b}function G(){var a=i(Vb(10),function(a){var b=(a>>1).toString(32);return Wb.slice(b.length)+b});return a.join("")}function H(a){var b="string"==typeof a.setItem;return!m(a)&&!b}function I(a,b,c){try{return a.setItem(b,v(c)),!0}catch(d){return e(d),!1}}function J(a,b){var c=a.getItem(b);return m(c)?null:u(c)}function K(a,b){a.removeItem(b)}function L(a,b){for(var c=0;c<a.length;c++){var d=a.key(c);b(d)}}function M(){return H(Xb)}function N(a,b){return I(Xb,a,b)}function O(a){return J(Xb,a)}function P(a){K(Xb,a)}function Q(a){L(Xb,a)}function R(a,b,c,d){var e=[];if(e.push(a+"="+encodeURIComponent(b)),c){var f=new Date;f.setTime(f.getTime()+1e3*c);var g="expires="+f.toUTCString();e.push(g)}e.push("path=/"),d&&e.push("domain="+d);var h=e.join("; ");Rb.cookie=h}function S(a){for(var b=Rb.cookie.split("; "),c=0;c<b.length;c++){var d=b[c],e=d.indexOf("=");if(-1!==e){var f=d.slice(0,e);if(f===a){var g=d.slice(e+1);return decodeURIComponent(g)}}}return null}function T(){return z()+":"+D()}function U(a){return a+cc}function V(a){return 0===a.indexOf(bc)&&-1!==a.indexOf(cc)}function W(a){return 0===a.indexOf(bc)&&-1===a.indexOf(cc)}function X(a){var b=U(a),c=0,d=setInterval(function(){c+=1,N(b,c)},_b);return d}function Y(a){return O(a)}function Z(a){P(a),setTimeout(function(){P(a)},100)}function $(a,b){var c=U(a);b&&clearInterval(b),Z(c)}function _(a){return O(a)}function ab(a,b){N(a,b)}function bb(a){var b=U(a);P(a),Z(b)}function cb(a,b,c){var d=bc+T(),e=X(d);return ab(d,{data:a,guid:c,retry:0}),{key:d,guid:c,clock:e}}function db(a){return cb(a,0,T())}function eb(a){var b=a.key,c=a.clock;$(b,c),bb(b)}function fb(a){if(a.length>Yb){a.sort();for(var b=a.length-Zb,c=0;b>c;c++){var d=a.shift();bb(d)}}}function gb(a){h(a,function(b){var c=a[b],d=Y(b);(m(d)||d===c)&&(delete a[b],Z(b))})}function hb(a,b){var c=[];return g(b,function(b){U(b)in a||c.push(b)}),c}function ib(a,b){var c=[];g(a,function(a){var b=_(a);if(m(b));else{var d=b.retry+1;if($b>d){var e=cb(b.data,d,b.guid);c.push(e)}}bb(a)}),g(c,function(a){var c=a.key,d=_(c);b(a,d.data,d.guid)})}function jb(){var a={};return Q(function(b){V(b)&&(a[b]=Y(b))}),a}function kb(){var a=[];return Q(function(b){W(b)&&a.push(b)}),a}function lb(a,b){if(!dc){dc=!0;var c=kb(),d=jb();fb(c);var e=function(){gb(d);var e=hb(d,c);ib(e,a),dc=!1,b&&b()};setTimeout(e,ac)}}function mb(a,b,c){d("XHR Request Succeded: "+c.url)}function nb(a,b,c){e("XHR Request Failed: "+c.url+" "+a)}function ob(a,b,c){e("XHR Timeout: "+c.url)}function pb(a){return a}function qb(a){return a}function rb(a,b,c){var d=new XMLHttpRequest;d.open(a,b.url,c);var e="onSuccess"in b?b.onSuccess:mb,f="onError"in b?b.onError:nb,g="onTimeout"in b?b.onTimeout:ob,h="unmarshall"in b?b.unmarshall:pb;return"crossDomainCredentials"in b&&(d.withCredentials=b.crossDomainCredentials===!0),"timeoutMs"in b&&(d.timeout=b.timeoutMs,d.ontimeout=function(){g.call({},b)}),d.onload=function(){d.readyState===ec&&200===d.status?e.call({},h(d.responseText),d.status,b):f.call({},d.statusText,d.status,d.readyState,b)},d.onerror=function(){var a="Unknown Error.";m(d.status)&&m(d.statusText)?a="Unknown Error.":"statusText"in d&&(a=d.statusText),f.call({},a,d.status,d.readyState,b)},d}function sb(a,b){var c=rb(a,b,!0);if("data"in b){var d="marshall"in b?b.marshall:qb;"dataType"in b&&c.setRequestHeader("Content-type",b.dataType),c.send(d(b.data))}else c.send();return c}function tb(a){sb("GET",a)}function ub(a){sb("POST",a)}function vb(a,b){delete Qb[gc][b],hc.removeChild(a)}function wb(a){var b="cb_"+z().toString(16)+"_"+D().toString(16),c=Rb.createElement("script");Qb[gc][b]=function(d){vb(c,b),a.onSuccess.call({},d,ic,a)};var d=function(){b in Qb[gc]&&(vb(c,b),a.onError.call({},"jsonp error",jc,0,fc,a))};c.onerror=d,c.onload=d,c.onreadystatechange=function(){("loaded"===c.readyState||"complete"===c.readyState)&&d()},c.type="text/javascript",c.src=a.url+"&format=jsonp&callback="+encodeURIComponent(b),hc.appendChild(c)}function xb(){return!m(Sb[kc])}function yb(a,b){return Sb[kc](a,b)}function zb(a,b,c){function d(){a(e),e=[]}var e=[],f=setTimeout(function(){},0);return{add:function(a){clearTimeout(f),e.push(a),e.length>=c?d():f=setTimeout(d,b)},flush:function(){clearTimeout(f),d()}}}function Ab(){}function Bb(a,b){if(s(b,nc),b.data.guid=a.guid,xb()&&m(b.onSuccess)){var c=yb(b.url,b.marshall(b.data));c&&sc(a)}else{var d=b.onSuccess||Ab;b.onSuccess=function(){sc(a),d()},ub(b)}}function Cb(a,b,c){var d=m(c._baseURI)?a._apiHost:c._baseURI,e=s(s({api_key:a.token},c.query),c._params),f=w(a.getUserId()),g=b.replace("%user_id%",f);return d+"/"+a.apiVersion+g+"?"+y(e)}function Db(a,b,c){var d=t(c),e=Cb(a,b,d),f={url:e};s(f,oc),"success"in d&&(f.onSuccess=d.success),"error"in d&&(f.onError=d.error);var g=B()?wb:tb;g(f)}function Eb(a,b){return n(a)?a:b(a)}function Fb(a,b){if(m(a))return a;for(var c={},d=0;d<b.length;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c}function Gb(a,b,c){var d=t(c),e=s({api_key:a.token},d._params),f=r(d._baseURI,a._analyticsHost),g=f+"/"+a.apiVersion+"/validate?"+y(e),h={url:g,data:{data:b}},i=rc(h);"success"in d&&(h.onSuccess=d.success),Bb(i,h)}function Hb(a,b){var c=i(b,function(a){return a[0]});Gb(a,c)}function Ib(a,b,c,d){d.query=Fb(d.query,c),Db(a,b,d)}function Jb(a,b,c){a in c&&(b[a]=c[a])}function Kb(a){m(a)?f("Vidora API constructed without any options."):o(a)?"apiKey"in a||f("Vidora API constructed without an API Key"):f("Vidora API should be constructed with an option object.");var b=s({},a);this.token=b.apiKey,this.apiVersion="v1";var c=this;this._queue=zb(function(a){Hb(c,a)},500,30),this._analyticsHost=lc,this._apiHost=mc,this._sendMode=pc,this._build=Pb,this._userId=null,tc(Bb)}function Lb(a){a.call({},Cc,Dc)}function Mb(a){var b=a[0],c=a.slice(1);b in Cc||f("Invalid api call '"+b+"'"),Cc[b].apply(Cc,c)}function Nb(a){p(a)?Mb(a):q(a)?Lb(a):f("typeof call item '"+typeof a+"' not supported.")}function Ob(a,b,c){if(a[c]&&a[c]._init===!0)return void e(Ac+" included twice!");Qb=a,Rb=b;var d=a[c];c in a||(a[c]={}),a[c]._init=!0,a[c].push=Mb,a[c].ready=Lb,d&&(d.ready=Lb,d.push=Mb,g(d._q,Nb),d=null)}var Pb={version:"1.2.7",rev:"70defd4dcf46f60d01ad6075900d8e0381a4299b"},Qb=window,Rb=document,Sb=navigator,Tb=1,Ub=!k(Qb.Uint16Array)&&!k(Qb.crypto),Vb=Ub?C:F,Wb="000",Xb=(Qb.sessionStorage,Qb.localStorage),Yb=50,Zb=Yb,$b=3,_b=5,ac=3*_b,bc="vidoraRequest:",cc=".clock",dc=!1,ec=4,fc=2,gc="_vidora_jsonp";Qb[gc]=Qb[gc]||{};var hc=Rb.head||Rb.body||Rb,ic=-200,jc=-400,kc="sendBeacon",lc="https://a.vidora.com",mc="//api.vidora.com",nc={marshall:v,dataType:"text/plain"},oc={unmarshall:u},pc=0,qc=1,rc=Ab,sc=Ab,tc=Ab;M()&&(rc=db,sc=eb,tc=lb),Kb.prototype.config=function(a){var b=t(a);"analyticsHost"in b&&(this._analyticsHost=b.analyticsHost),"apiHost"in b&&(this._apiHost=b.apiHost)},Kb.prototype.send=function(a,b,c){for(var d=p(b)?b:[b],e=this.getUserId(),g=this.getSessionId(),h=0;h<d.length;h++){var i=d[h],k=t(c),l={type:Eb(a,j),user_id:Eb(e,j),session_id:Eb(g,j)};m(i)||(l.content_id=Eb(i,j)),s(l,k.params);var n={};Jb("success",n,k),Jb("error",n,k),Jb("timeout",n,k);var o=this._sendMode;switch(("click"===l.type||k.quicksend)&&(o=qc),o){case qc:this._queue.add([l,n]),this._queue.flush();break;case pc:this._queue.add([l,n]);break;default:f()}}};var uc="/users/%user_id%",vc="/groups";Kb.prototype.getItems=function(a){Ib(this,uc+"/recommendations",["category","type","limit"],a)};var wc=["group_ids"];Kb.prototype.getGroupRankings=function(a){Ib(this,uc+vc+"/rankings",wc,a)},Kb.prototype._pncItems=function(a){Db(this,"/pnc"+uc+vc+"/items",a)};var xc=5256e3,yc="vidoraUserId";Kb.prototype.getUUID=function(){var a=S(yc);return l(a)&&(a=G(),R(yc,a,xc)),a};var zc=G().slice(0,10);Kb.prototype.getSessionId=function(){return zc},Kb.prototype.setUserId=function(a){this._userId=a},Kb.prototype.getUserId=function(){return l(this._userId)&&(this._userId=this.getUUID()),this._userId};var Ac="vidora-client",Bc=Kb,Cc=null,Dc={};Dc._i=function(a,b){var c=s({apiKey:a},b);Cc=new Bc(c),d(Ac+" "+Cc._build.version+" "+Cc._build.rev)},Dc._create=function(a){return new Bc(a)},Ob(a,b,c)}(window,document,"vidora");

/*Copyright (c) 2011-2016 Moat Inc. All Rights Reserved.*/
function initMoatTracking(a,c,d,h,k){var f=document.createElement("script"),b=[];c={adData:{ids:c,duration:d,url:k},dispatchEvent:function(a){this.sendEvent?(b&&(b.push(a),a=b,b=!1),this.sendEvent(a)):b.push(a)}};d="_moatApi"+Math.floor(1E8*Math.random());var e,g;try{e=a.ownerDocument,g=e.defaultView||e.parentWindow}catch(l){e=document,g=window}g[d]=c;f.type="text/javascript";a&&a.insertBefore(f,a.childNodes[0]||null);f.src="https://z.moatads.com/"+h+"/moatvideo.js#"+d;return c};
// flash
function getFlashMovieObject(a){return window.document[a]?window.document[a]:navigator.appName.indexOf("Microsoft Internet")!=-1?document.getElementById(a):document.embeds&&document.embeds[a]?document.embeds[a]:void 0}
(function(a,b,c,d,e){var f={_q:[]};f.ready=f.push=function(a){f._q.push(a)},c in a||(a[c]=f),a[c].ready(function(a,b){b._i(d,e)})})(window, document, "vidora","wsj.E4B14D56D6D304BA4A96A94B14D11AA9");
//vidora
window.vidora.ready(function (api) {
    console.log("Vidora API finished initializing!");
});
//parsely
document.addEventListener('DOMContentLoaded', function () {
    (function(d) {
        var site = "wsj.com" // replace with the domain of your site (e.g. parsely.com)
        try{var url=window.location!=window.parent.location?document.referrer:document.location.href;url.indexOf("wsj.com")!==-1&&(site="wsj.com"),url.indexOf("wsj.de")!==-1&&(site="marketwatch.com"),url.indexOf("marketwatch.com")!==-1&&(site="marketwatch.com"),url.indexOf("barrons.com")!==-1&&(site="barrons.com"),url.indexOf("mansionglobal.com")!==-1&&(site="mansionglobal.com"),url.indexOf("heatst.com")!==-1&&(site="heatst.com"),url.indexOf("efinancialnews.com")!==-1&&(site="efinancialnews.com"),url.indexOf("moneyish.com")!==-1&&(site="moneyish.com")}catch(a){site="wsj.com"}
        var b = d.body,
            e = d.createElement("div");
        e.innerHTML = '<span id="parsely-cfg" data-parsely-site="'+site+'"></span>';
        e.id = "parsely-root";
        e.style.display = "none";
        b.appendChild(e);
    })(document);
    (function(s, p, d) {
        var h=d.location.protocol, i=p+"-"+s,
            e=d.getElementById(i), r=d.getElementById(p+"-root"),
            u=h==="https:"?"d1z2jf7jlzjs58.cloudfront.net"
                :"static."+p+".com";
        if (e) return;
        e = d.createElement(s); e.id = i; e.async = true;
        e.src = h+"//"+u+"/p.js"; r.appendChild(e);
    })("script", "parsely", document);
});

// COMSCORE SOURCE //
function udm_(a,b){var c="comScore=",d=document,e=d.cookie,f="",g="indexOf",h="substring",i="length",j=2048,k,l="&ns_",m="&",n,o,p,q,r=window,s=r.encodeURIComponent||escape;if(e[g](c)+1)for(p=0,o=e.split(";"),q=o[i];p<q;p++)n=o[p][g](c),n+1&&(f=m+unescape(o[p][h](n+c[i])));a+=l+"_t="+ +(new Date)+l+"c="+(d.characterSet||d.defaultCharset||"")+"&c8="+s(d.title)+f+"&c7="+s(d.URL)+"&c9="+s(d.referrer),a[i]>j&&a[g](m)>0&&(k=a[h](0,j-8).lastIndexOf(m),a=(a[h](0,k)+l+"cut="+s(a[h](k+1)))[h](0,j)),d.images?(n=new Image,r.ns_p||(ns_p=n),typeof b=="function"&&(n.onload=n.onerror=b),n.src=a):d.write("<","p","><",'img src="',a,'" height="1" width="1" alt="*"',"><","/p",">")}typeof _comscore=="undefined"&&(_comscore=[]),function(){var a="length",b=self,c=b.encodeURIComponent?encodeURIComponent:escape,d=".scorecardresearch.com",e="//app"+d+"/s2e/invite",f=Math,g="script",h="width",i=/c2=(\d*)&/,j,k=function(b){if(!!b){var e,f=[],g,h=0,i,j,k="";for(var l in b){g=typeof b[l];if(g=="string"||g=="number")f[f[a]]=l+"="+c(b[l]),l=="c2"?k=b[l]:l=="c1"&&(h=1)}if(f[a]<=0||k=="")return;j=b.options||{},j.d=j.d||document;if(typeof j.url_append=="string"){i=j.url_append.replace(/&amp;/,"&").split("&");for(var l=0,n=i[a],o;l<n;l++)o=i[l].split("="),o[a]==2&&(f[f[a]]=o[0]+"="+c(o[1]))}e=["http",j.d.URL.charAt(4)=="s"?"s://sb":"://b",d,"/b?",h?"":"c1=2&",f.join("&").replace(/&$/,"")],udm_(e.join(""),function(){m(this,j)})}},l=function(b){b=b||_comscore;for(var c=0,d=b[a];c<d;c++)k(b[c]);b=_comscore=[]},m=function(a,b){if(!(a.src.indexOf("c1=2")<0||!b.d.createElement))if(b.force_script_extension||a[h]==2&&a.height>f.round(f.random()*100)){var c=b.d.createElement(g),d=b.d.getElementsByTagName(g)[0],j=[b.script_extension_url||e,"?","c2=",a.src.match(i)[1]].join("");d&&(c.src=j,c.async=!0,d.parentNode.insertBefore(c,d))}};l(),(j=b.COMSCORE)?(j.purge=l,j.beacon=k):COMSCORE={purge:l,beacon:k}}()

var ns_=ns_||{};ns_.StreamSense=ns_.StreamSense||function(){function n(t){e=t}function r(e){t=e}function u(t,n){var r=t||"",i=f,u="undefined",a=s.comScore||s.sitestat||function(t){var n="comScore=",r=o.cookie,i="",a="indexOf",f="substring",l="length",c=2048,h,p="&ns_",d="&",v,m,g,y,b=s.encodeURIComponent||escape;if(r[a](n)+1)for(g=0,m=r.split(";"),y=m[l];g<y;g++)v=m[g][a](n),v+1&&(i=d+unescape(m[g][f](v+n[l])));t+=p+"_t="+ +(new Date)+p+"c="+(o.characterSet||o.defaultCharset||"")+i,t[l]>c&&t[a](d)>0&&(h=t[f](0,c-8).lastIndexOf(d),t=(t[f](0,h)+p+"cut="+b(t[f](h+1)))[f](0,c)),e(t),typeof ns_p===u&&(ns_p={src:t}),ns_p.lastMeasurement=t};if(typeof n!==u){var l=[],c=s.encodeURIComponent||escape;for(var h in n)n.hasOwnProperty(h)&&l.push(c(h)+"="+c(n[h]));/[\?\&]$/.test(r)||(r+="&"),r+=l.join("&")}return a(r)}function a(e,t){var n,r=2048,i=s.encodeURIComponent||escape,u=[],a=p.LABELS_ORDER,f=e.split("?"),l=f[0],c=f[1],h=c.split("&");for(var d=0,v=h.length;d<v;d++){var m=h[d].split("="),g=unescape(m[0]),y=unescape(m[1]);g&&(t[g]=y)}var b={};for(var d=0,v=a.length;d<v;d++){var w=a[d];t.hasOwnProperty(w)&&(b[w]=!0,u.push(i(w)+"="+i(t[w])))}for(var w in t){if(b[w])continue;t.hasOwnProperty(w)&&u.push(i(w)+"="+i(t[w]))}return n=l+"?"+u.join("&"),n=n+(n.indexOf("&c8=")<0?"&c8="+i(o.title):"")+(n.indexOf("&c7=")<0?"&c7="+i(o.URL):"")+(n.indexOf("&c9=")<0?"&c9="+i(o.referrer):""),n.length>r&&n.indexOf("&")>0&&(last=n.substr(0,r-8).lastIndexOf("&"),n=(n.substring(0,last)+"&ns_cut="+i(n.substring(last+1))).substr(0,r)),n}var e=function(e,t){},t=function(e,t,n){};n(function(e,t){var n=new Image;n.src=e,t&&setTimeout(t,0)}),r(function(e,t,n){n&&setTimeout(n,0)});var i=typeof window!="undefined"&&typeof document!="undefined",s,o;i?(s=window,o=document):(s={},o={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var f=function(){var e={uid:function(){var e=1;return function(){return+(new Date)+"_"+e++}}(),filter:function(e,t){var n={};for(var r in t)t.hasOwnProperty(r)&&e(t[r])&&(n[r]=t[r]);return n},extend:function(e){var t=arguments.length,n;e=e||{};for(var r=1;r<t;r++){n=arguments[r];if(!n)continue;for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e},getString:function(e,t){var n=String(e);return e==null?t||"na":n},getLong:function(e,t){var n=Number(e);return e==null||isNaN(n)?t||0:n},getInteger:function(e,t){var n=Number(e);return e==null||isNaN(n)?t||0:n},getBoolean:function(e,t){var n=String(e).toLowerCase()=="true";return e==null?t||!1:n},isNotEmpty:function(e){return e!=null&&e.length>0},indexOf:function(t,n){var r=-1;return e.forEach(n,function(e,n){e==t&&(r=n)}),r},forEach:function(e,t,n){try{if(typeof t=="function"){n=typeof n!="undefined"?n:null;if(typeof e["length"]!="number"||typeof e[0]=="undefined"){var r=typeof e.__proto__!="undefined";for(var i in e)(!r||r&&typeof e.__proto__[i]=="undefined")&&typeof e[i]!="function"&&t.call(n,e[i],i)}else for(var i=0,s=e.length;i<s;i++)t.call(n,e[i],i)}}catch(o){}},regionMatches:function(e,t,n,r,i){if(t<0||r<0||t+i>e.length||r+i>n.length)return!1;while(--i>=0){var s=e.charAt(t++),o=n.charAt(r++);if(s!=o)return!1}return!0},size:function(e){var t=0,n;for(var n in e)e.hasOwnProperty(n)&&t++;return t},log:function(e,t){if(typeof t!="undefined"&&t){var n=new Date,r=n.getHours()+":"+n.getMinutes()+":"+n.getSeconds();console.log(r,e)}},isTrue:function(e){return typeof e=="undefined"?!1:typeof e=="string"?(e=e.toLowerCase(),e==="true"||e==="1"||e==="on"):e?!0:!1},toString:function(t){if(typeof t=="undefined")return"undefined";if(typeof t=="string")return t;if(Object.prototype.toString.call(t)==="[object Array]")return t.join(",");if(e.size(t)>0){var n="";for(var r in t)t.hasOwnProperty(r)&&(n+=r+":"+t[r]+";");return n}return t.toString()},exists:function(e){return typeof e!="undefined"&&e!=null},firstGreaterThan0:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e];if(n>0)return n}return 0},cloneObject:function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}};return e.filterMap=function(t,n){for(var r in t)e.indexOf(r,n)==-1&&delete t[r]},e.getKeys=function(e,t){var n,r=[];for(n in e)(!t||t.test(n))&&e.hasOwnProperty(n)&&(r[r.length]=n);return r},e.getBrowserName=function(){var e=navigator.userAgent,t=navigator.appName,n,r,i;return(r=e.indexOf("Opera"))!=-1?t="Opera":(r=e.indexOf("MSIE"))!=-1?t="Microsoft Internet Explorer":(r=e.indexOf("Android"))!=-1?t="Android":(r=e.indexOf("Chrome"))!=-1?t="Chrome":(r=e.indexOf("Safari"))!=-1?t="Safari":(r=e.indexOf("Firefox"))!=-1?t="Firefox":(r=e.indexOf("Windows NT"))!=-1?t="Microsoft Internet Explorer":(n=e.lastIndexOf(" ")+1)<(r=e.lastIndexOf("/"))&&(t=e.substring(n,r),t.toLowerCase()==t.toUpperCase()&&(t=navigator.appName)),t},e.getBrowserFullVersion=function(){var e=navigator.userAgent,t=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10),r,i,s;return(i=e.indexOf("Opera"))!=-1?(t=e.substring(i+6),(i=e.indexOf("Version"))!=-1&&(t=e.substring(i+8))):(i=e.indexOf("MSIE"))!=-1?t=e.substring(i+5):(i=e.indexOf("Android"))!=-1?t=e.substring(i+8):(i=e.indexOf("Chrome"))!=-1?t=e.substring(i+7):(i=e.indexOf("Safari"))!=-1?(t=e.substring(i+7),(i=e.indexOf("Version"))!=-1&&(t=e.substring(i+8))):(i=e.indexOf("Firefox"))!=-1?t=e.substring(i+8):(i=e.indexOf("Windows NT"))!=-1?(i=e.indexOf("rv:"),t=e.substring(i+3)):(r=e.lastIndexOf(" ")+1)<(i=e.lastIndexOf("/"))&&(t=e.substring(i+1)),(s=t.indexOf(";"))!=-1&&(t=t.substring(0,s)),(s=t.indexOf(" "))!=-1&&(t=t.substring(0,s)),(s=t.indexOf(")"))!=-1&&(t=t.substring(0,s)),n=parseInt(""+t,10),isNaN(n)&&(t=""+parseFloat(navigator.appVersion)),t},e}(),l=function(){var e=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(t){return e[t]}}}(),c=function(){var e=[l.END,l.PLAY,l.PAUSE,l.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(t){return e[t]}}}(),h={ADPLAY:l.AD_PLAY,ADPAUSE:l.AD_PAUSE,ADEND:l.AD_END,ADCLICK:l.AD_CLICK},p={STREAMSENSE_VERSION:"4.1408.29",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",LABELS_ORDER:["c1","c2","ns_site","ns_vsite","ns_ap_an","ns_ap_pn","ns_ap_pv","c12","name","ns_ak","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ns_ap_sv","ns_type","ns_radio","ns_nc","ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_c12m","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ns_st_pe","ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_ct","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","c3","c4","c5","c6","c10","c11","c12","c13","c14","c15","c16","c7","c8","c9"]},d=function(){var e=function(){function h(e,t){var n=t[e];n!=null&&(a[e]=n)}var e=this,t=0,n=0,r=0,i=0,s=0,o=0,u,a;f.extend(this,{reset:function(t){t!=null&&t.length>0?f.filterMap(a,t):a={},a.hasOwnProperty("ns_st_cl")||(a.ns_st_cl="0"),a.hasOwnProperty("ns_st_pn")||(a.ns_st_pn="1"),a.hasOwnProperty("ns_st_tp")||(a.ns_st_tp="1"),e.setPauses(0),e.setStarts(0),e.setBufferingTime(0),e.setBufferingTimestamp(-1),e.setPlaybackTime(0),e.setPlaybackTimestamp(-1)},setLabels:function(t,n){t!=null&&f.extend(a,t),e.setRegisters(a,n)},getLabels:function(){return a},setLabel:function(t,n){var r={};r[t]=n,e.setLabels(r,null)},getLabel:function(e){return a[e]},getClipId:function(){return(typeof u=="undefined"||u==null)&&e.setClipId("1"),u},setClipId:function(e){u=e},setRegisters:function(i,o){var u=i.ns_st_cn;u!=null&&(e.setClipId(u),delete i.ns_st_cn),u=i.ns_st_bt,u!=null&&(r=Number(u),delete i.ns_st_bt),h("ns_st_cl",i),h("ns_st_pn",i),h("ns_st_tp",i),h("ns_st_ub",i),h("ns_st_br",i);if(o==c.PLAYING||o==null)u=i.ns_st_sq,u!=null&&(n=Number(u),delete i.ns_st_sq);o!=c.BUFFERING&&(u=i.ns_st_pt,u!=null&&(s=Number(u),delete i.ns_st_pt));if(o==c.PAUSED||o==c.IDLE||o==null)u=i.ns_st_pc,u!=null&&(t=Number(u),delete i.ns_st_pc)},createLabels:function(r,i){var s=i||{};s.ns_st_cn=e.getClipId(),s.ns_st_bt=String(e.getBufferingTime());if(r==l.PLAY||r==null)s.ns_st_sq=String(n);if(r==l.PAUSE||r==l.END||r==l.KEEP_ALIVE||r==l.HEART_BEAT||r==null)s.ns_st_pt=String(e.getPlaybackTime()),s.ns_st_pc=String(t);return f.extend(s,e.getLabels()),s},incrementPauses:function(){t++},incrementStarts:function(){n++},getBufferingTime:function(){var e=r;return i>=0&&(e+=+(new Date)-i),e},setBufferingTime:function(e){r=e},getPlaybackTime:function(){var e=s;return o>=0&&(e+=+(new Date)-o),e},setPlaybackTime:function(e){s=e},getPlaybackTimestamp:function(){return o},setPlaybackTimestamp:function(e){o=e},getBufferingTimestamp:function(){return i},setBufferingTimestamp:function(e){i=e},getPauses:function(){return t},setPauses:function(e){t=e},getStarts:function(){return n},setStarts:function(e){n=e}}),a={},e.reset()};return e}(),v=function(){var e=function(){var e=this,t=null,n,r=0,i=0,s=0,o=0,u=0,a,h=0,p=!1;f.extend(this,{reset:function(t){t!=null&&t.length>0?f.filterMap(a,t):a={},e.setPlaylistId(+(new Date)+"_"+h),e.setBufferingTime(0),e.setPlaybackTime(0),e.setPauses(0),e.setStarts(0),e.setRebufferCount(0),p=!1},setLabels:function(t,n){t!=null&&f.extend(a,t),e.setRegisters(a,n)},getLabels:function(){return a},setLabel:function(t,n){var r={};r[t]=n,e.setLabels(r,null)},getLabel:function(e){return a[e]},getClip:function(){return t},getPlaylistId:function(){return n},setPlaylistId:function(e){n=e},setRegisters:function(e,t){var a=e.ns_st_sp;a!=null&&(r=Number(a),delete e.ns_st_sp),a=e.ns_st_bc,a!=null&&(s=Number(a),delete e.ns_st_bc),a=e.ns_st_bp,a!=null&&(o=Number(a),delete e.ns_st_bp),a=e.ns_st_id,a!=null&&(n=a,delete e.ns_st_id),t!=c.BUFFERING&&(a=e.ns_st_pa,a!=null&&(u=Number(a),delete e.ns_st_pa));if(t==c.PAUSED||t==c.IDLE||t==null)a=e.ns_st_pp,a!=null&&(i=Number(a),delete e.ns_st_pp)},createLabels:function(t,o){var u=o||{};u.ns_st_bp=String(e.getBufferingTime()),u.ns_st_sp=String(r),u.ns_st_id=String(n),s>0&&(u.ns_st_bc=String(s));if(t==l.PAUSE||t==l.END||t==l.KEEP_ALIVE||t==l.HEART_BEAT||t==null)u.ns_st_pa=String(e.getPlaybackTime()),u.ns_st_pp=String(i);if(t==l.PLAY||t==null)e.didFirstPlayOccurred()||(u.ns_st_pb="1",e.setFirstPlayOccurred(!0));return f.extend(u,e.getLabels()),u},incrementStarts:function(){r++},incrementPauses:function(){i++,t.incrementPauses()},setPlaylistCounter:function(e){h=e},incrementPlaylistCounter:function(){h++},addPlaybackTime:function(n){if(t.getPlaybackTimestamp()>=0){var r=n-t.getPlaybackTimestamp();t.setPlaybackTimestamp(-1),t.setPlaybackTime(t.getPlaybackTime()+r),e.setPlaybackTime(e.getPlaybackTime()+r)}},addBufferingTime:function(n){if(t.getBufferingTimestamp()>=0){var r=n-t.getBufferingTimestamp();t.setBufferingTimestamp(-1),t.setBufferingTime(t.getBufferingTime()+r),e.setBufferingTime(e.getBufferingTime()+r)}},getBufferingTime:function(){var e=o;return t.getBufferingTimestamp()>=0&&(e+=+(new Date)-t.getBufferingTimestamp()),e},setBufferingTime:function(e){o=e},getPlaybackTime:function(){var e=u;return t.getPlaybackTimestamp()>=0&&(e+=+(new Date)-t.getPlaybackTimestamp()),e},setPlaybackTime:function(e){u=e},getStarts:function(){return r},setStarts:function(e){r=e},getPauses:function(){return i},setPauses:function(e){i=e},getRebufferCount:function(){return s},incrementRebufferCount:function(){s++},setRebufferCount:function(e){s=e},didFirstPlayOccurred:function(){return p},setFirstPlayOccurred:function(e){p=e}}),t=new d,a={},e.reset()};return e}(),m=function(){var t=function(t,i){function U(e){var t=0;if(A!=null)for(var n=0;n<A.length;n++){var r=A[n],i=r.playingtime;if(!i||e<i){t=r.interval;break}}return t}function z(){$();var e=U(S.getClip().getPlaybackTime());if(e>0){var t=_>0?_:e;L=setTimeout(V,t)}_=0}function W(){$();var e=U(S.getClip().getPlaybackTime());_=e-S.getClip().getPlaybackTime()%e,L!=null&&$()}function X(){_=0,P=0,D=0}function V(){D++;var e=yt(l.HEART_BEAT,null);st(e),_=0,z()}function $(){L!=null&&(clearTimeout(L),L=null)}function J(){Q(),k=setTimeout(K,O)}function K(){var e=yt(l.KEEP_ALIVE,null);st(e),E++,J()}function Q(){k!=null&&(clearTimeout(k),k=null)}function G(){Z(),s.isPauseOnBufferingEnabled()&&lt(c.PAUSED)&&(N=setTimeout(Y,M))}function Y(){if(B==c.PLAYING){S.incrementRebufferCount(),S.incrementPauses();var e=yt(l.PAUSE,null);st(e),E++,B=c.PAUSED}}function Z(){N!=null&&(clearTimeout(N),N=null)}function et(e){return e==c.PLAYING||e==c.PAUSED}function tt(){y&&(clearTimeout(y),y=null)}function nt(e){return e==l.PLAY?c.PLAYING:e==l.PAUSE?c.PAUSED:e==l.BUFFER?c.BUFFERING:e==l.END?c.IDLE:null}function rt(e,t,n){tt();if(n)y=setTimeout(function(e,t){return function(){rt(e,t)}}(e,t),n);else if(pt(e)){var r=vt(),i=m,s=ht(t),o=i>=0?s-i:0;at(vt(),t),ft(e,t),mt(vt()),dt(e);for(var u=0,a=q.length;u<a;u++)q[u](r,e,t,o);it(t),S.setRegisters(t,e),S.getClip().setRegisters(t,e);var l=yt(c.toEventType(e),t);f.extend(l,t),lt(w)&&(st(l),B=w,E++)}}function it(e){var t=e.ns_st_mp;t!=null&&(j=t,delete e.ns_st_mp),t=e.ns_st_mv,t!=null&&(F=t,delete e.ns_st_mv),t=e.ns_st_ec,t!=null&&(E=Number(t),delete e.ns_st_ec)}function st(t,n){n===undefined&&(n=!0),n&&ut(t);var r=s.getPixelURL();if(x){if(!ot()){var i=R.am,o=R.et,u=i.newApplicationMeasurement(x,o.HIDDEN,t,r);x.getQueue().offer(u)}}else r&&e(a(r,t))}function ot(){var e=x.getAppContext(),t=x.getSalt(),n=x.getPixelURL();return e==null||t==null||t.length==0||n==null||n.length==0}function ut(e){I=yt(null),f.extend(I,e)}function at(e,t){var n=ht(t);if(e==c.PLAYING)S.addPlaybackTime(n),W(),Q();else if(e==c.BUFFERING)S.addBufferingTime(n),Z();else if(e==c.IDLE){var r=f.getKeys(S.getClip().getLabels());S.getClip().reset(r)}}function ft(e,t){var n=ht(t),r=ct(t);g=r,e==c.PLAYING?(z(),J(),S.getClip().setPlaybackTimestamp(n),lt(e)&&(S.getClip().incrementStarts(),S.getStarts()<1&&S.setStarts(1))):e==c.PAUSED?lt(e)&&S.incrementPauses():e==c.BUFFERING?(S.getClip().setBufferingTimestamp(n),C&&G()):e==c.IDLE&&X()}function lt(e){return e!=c.PAUSED&&e!=c.IDLE||B!=c.IDLE&&B!=null?e!=c.BUFFERING&&B!=e:!1}function ct(e){var t=-1;return e.hasOwnProperty("ns_st_po")&&(t=f.getInteger(e.ns_st_po)),t}function ht(e){var t=-1;return e.hasOwnProperty("ns_ts")&&(t=Number(e.ns_ts)),t}function pt(e){return e!=null&&vt()!=e}function dt(e){w=e,m=+(new Date)}function vt(){return w}function mt(e){b=e}function gt(){return b}function yt(){var e,t;arguments.length==1?(e=c.toEventType(w),t=arguments[0]):(e=arguments[0],t=arguments[1]);var n={};if(typeof document!="undefined"){var r=document;n.c7=r.URL,n.c8=r.title,n.c9=r.referrer}return t!=null&&f.extend(n,t),n.hasOwnProperty("ns_ts")||(n.ns_ts=String(+(new Date))),e!=null&&!n.hasOwnProperty("ns_st_ev")&&(n.ns_st_ev=l.toString(e)),s.isPersistentLabelsShared()&&x&&f.extend(n,x.getLabels()),f.extend(n,s.getLabels()),bt(e,n),S.createLabels(e,n),S.getClip().createLabels(e,n),n.hasOwnProperty("ns_st_mp")||(n.ns_st_mp=j),n.hasOwnProperty("ns_st_mv")||(n.ns_st_mv=F),n.hasOwnProperty("ns_st_ub")||(n.ns_st_ub="0"),n.hasOwnProperty("ns_st_br")||(n.ns_st_br="0"),n.hasOwnProperty("ns_st_pn")||(n.ns_st_pn="1"),n.hasOwnProperty("ns_st_tp")||(n.ns_st_tp="1"),n.hasOwnProperty("ns_st_it")||(n.ns_st_it="c"),n.ns_st_sv=p.STREAMSENSE_VERSION,n.ns_type="hidden",n}function bt(e,t){var n=t||{};n.ns_st_ec=String(E);if(!n.hasOwnProperty("ns_st_po")){var r=g,i=ht(n);if(e==l.PLAY||e==l.KEEP_ALIVE||e==l.HEART_BEAT||e==null&&w==c.PLAYING)r+=i-S.getClip().getPlaybackTimestamp();n.ns_st_po=f.getInteger(r)}return e==l.HEART_BEAT&&(n.ns_st_hc=String(D)),n}function wt(e){var t=ht(e);t<0&&(e.ns_ts=String(+(new Date)))}function Et(e,t,n){t=t||{},t.ns_st_ad=1,e>=l.AD_PLAY&&e<=l.AD_CLICK&&s.notify(e,t,n)}function St(e,t){s.notify(l.CUSTOM,e,t)}var s=this,o=500,h,d=null,m=0,g=0,y,b,w,E=0,S=null,x,T=!0,N,C=!0,k,L,A=p.DEFAULT_HEARTBEAT_INTERVAL,O=p.DEFAULT_KEEP_ALIVE_INTERVAL,M=p.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,_=0,D=0,P=0,H=!1,B,j,F,I,q,R={};f.extend(this,{reset:function(e){S.reset(e),S.setPlaylistCounter(0),S.setPlaylistId(+(new Date)+"_1"),S.getClip().reset(e),e!=null&&!e.isEmpty()?f.filterMap(h,e):h={},E=1,D=0,W(),X(),Q(),Z(),tt(),w=c.IDLE,b=null,m=-1,B=null,j=p.DEFAULT_PLAYERNAME,F=p.STREAMSENSE_VERSION,I=null},setPauseOnBufferingInterval:function(e){M=e},getPauseOnBufferingInterval:function(){return M},setKeepAliveInterval:function(e){O=e},getKeepAliveInterval:function(){return O},setHeartbeatIntervals:function(e){A=e},notify:function(){var e,t,n,r;t=arguments[0],arguments.length==3?(n=arguments[1],r=arguments[2]):(n={},r=arguments[1]),e=nt(t);var i=f.extend({},n);wt(i),i.hasOwnProperty("ns_st_po")||(i.ns_st_po=f.getInteger(r).toString());if(t==l.PLAY||t==l.PAUSE||t==l.BUFFER||t==l.END)s.isPausePlaySwitchDelayEnabled()&&et(w)&&et(e)&&(w!=c.PLAYING||e!=c.PAUSED||!!y)?rt(e,i,o):rt(e,i);else{var u=yt(t,i);f.extend(u,i),st(u,!1),E++}},getLabels:function(){return h},getState:function(){return w},setLabels:function(e){e!=null&&(h==null?h=e:f.extend(h,e))},getLabel:function(e){return h[e]},setLabel:function(e,t){t==null?delete h[e]:h[e]=t},setPixelURL:function(e){if(e==null||e.length==0)return null;var t=decodeURIComponent||unescape,n=e.indexOf("?");if(n>=0){if(n<e.length-1){var r=e.substring(n+1).split("&");for(var i=0,o=r.length;i<o;i++){var u=r[i],a=u.split("=");a.length==2?s.setLabel(a[0],t(a[1])):a.length==1&&s.setLabel(p.PAGE_NAME_LABEL,t(a[0]))}e=e.substring(0,n+1)}}else e+="?";return d=e,d},getPixelURL:function(){return d?d:typeof ns_p!="undefined"&&typeof ns_p.src=="string"?d=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):typeof ns_pixelUrl=="string"?d=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null},isPersistentLabelsShared:function(){return T},setPersistentLabelsShared:function(e){T=e},isPauseOnBufferingEnabled:function(){return C},setPauseOnBufferingEnabled:function(e){C=e},isPausePlaySwitchDelayEnabled:function(){return H},setPausePlaySwitchDelayEnabled:function(e){H=e},setPausePlaySwitchDelay:function(e){e&&e>0&&(o=e)},getPausePlaySwitchDelay:function(){return o},setClip:function(e,t){var n=!1;return w==c.IDLE&&(S.getClip().reset(),S.getClip().setLabels(e,null),t&&S.incrementStarts(),n=!0),n},setPlaylist:function(e){var t=!1;return w==c.IDLE&&(S.incrementPlaylistCounter(),S.reset(),S.getClip().reset(),S.setLabels(e,null),t=!0),t},importState:function(e){reset();var t=f.extend({},e);S.setRegisters(t,null),S.getClip().setRegisters(t,null),it(t),E++},exportState:function(){return I},getVersion:function(){return p.STREAMSENSE_VERSION},addListener:function(e){q.push(e)},removeListener:function(e){q.splice(f.indexOf(e,q),1)},getClip:function(){return S.getClip()},getPlaylist:function(){return S},setHttpGet:n,setHttpPost:r}),f.extend(this,{adNotify:Et,customNotify:St,viewNotify:function(e,t){e=e||s.getPixelURL(),e&&u(e,t)}}),ns_.comScore&&(R=ns_.comScore.exports,x=R.c()),h={},E=1,w=c.IDLE,S=new v,N=null,C=!0,L=null,D=0,X(),k=null,y=null,H=!1,B=null,g=0,q=[],s.reset(),t&&s.setLabels(t),i&&s.setPixelURL(i)};return function(e){function i(e,n){return t[r]||o(e,n)}function s(){r=-1;for(var e=0;e<=n;e++)if(t.hasOwnProperty(e)){r=e;break}return ns_.StreamSense.activeIndex=r,r}function o(e,r){return e=e||null,r=r||null,e&&typeof e=="object"&&(r=e,e=null),t[++n]=new ns_.StreamSense(r,e),s(),t[n]}function u(){var e=!1,n=r;if(typeof arguments[0]=="number"&&isFinite(arguments[0]))n=arguments[0];else if(arguments[0]instanceof ns_.StreamSense)for(var i in t)if(t[i]===arguments[0]){n=i;break}return t.hasOwnProperty(n)&&(e=t[n],delete t[n],e.reset(),s()),e}function a(e){return e=e||{},i().setPlaylist(e),i().getPlaylist()}function l(e,t,n){return e=e||{},typeof t=="number"&&(e.ns_st_cn=t),i().setClip(e,n),i().getClip()}function c(e,t,n){return typeof e=="undefined"?!1:(n=n||null,t=t||{},i().notify(e,t,n))}function h(e){typeof e!="undefined"&&i().setLabels(e)}function p(){return i().getLabels()}function d(e){typeof e!="undefined"&&i().getPlaylist().setLabels(e)}function v(){return i().getPlaylist().getLabels()}function m(e){typeof e!="undefined"&&i().getClip().setLabels(e)}function g(){return i().getClip().getLabels()}function y(e){return i().reset(e||{})}function b(e){return i().getPlaylist().reset(e||{})}function w(e){return i().getClip().reset(e||{})}function E(e){return e=e||{},i().viewNotify(null,e)}function S(e,t){return arguments.length>2&&(e=arguments[1],t=arguments[2]),e=e||{},typeof t=="number"&&(e.ns_st_po=t),i().customNotify(e,t)}function x(){return i().exportState()}function T(e){i().importState(e)}var t={},n=-1,r=-1;f.extend(e,{activeIndex:r,newInstance:o,"new":o,destroyInstance:u,destroy:u,newPlaylist:a,newClip:l,notify:c,setLabels:h,getLabels:p,setPlaylistLabels:d,getPlaylistLabels:v,setClipLabels:m,getClipLabels:g,resetInstance:y,resetPlaylist:b,resetClip:w,viewEvent:E,customEvent:S,exportState:x,importState:T})}(t),t}();return m.AdEvents=h,m.PlayerEvents=l,ns_.StreamingTag=ns_.StreamingTag||function(){var e=function(){var e=function(e){function a(){if(f.exists(e)&&f.exists(e.customerC2)){var t=e.secure?"https://sb":"http"+(document.location.href.charAt(4)=="s"?"s://sb":"://b");u.setPixelURL(t+".scorecardresearch.com/p?c1=2"),u.setLabel("c2",e.customerC2),u.setLabel("ns_st_it","r")}}function h(e){return f.exists(e)||(e={}),f.exists(e.ns_st_ci)||(e.ns_st_ci="0"),f.exists(e.c3)||(e.c3="*null"),f.exists(e.c4)||(e.c4="*null"),f.exists(e.c6)||(e.c6="*null"),e}function p(e){return r>0&&e>=r?i+=e-r:i=0,i}function d(e){u.getState()!=c.IDLE&&u.getState()!=c.PAUSED?u.notify(l.END,p(e)):u.getState()==c.PAUSED&&u.notify(l.END,i)}function v(e){return g("ns_st_ci",s,e)&&g("c3",s,e)&&g("c4",s,e)&&g("c6",s,e)}function g(e,t,n){if(f.exists(e)&&f.exists(t)&&f.exists(n)){var r=t[e],i=n[e];return f.exists(r)&&f.exists(i)&&r===i}return!1}function y(e,t){d(e),n++,u.setClip({ns_st_cn:n,ns_st_pn:"1",ns_st_ct:"vc",ns_st_tp:"0"}),u.getClip().setLabels(t),s=t,r=e,i=0,u.notify(l.PLAY,i)}var t=this,n=0,r=0,i=0,s=null,o=!1,u=new m;f.extend(this,{playAdvertisement:function(){var e=+(new Date);d(e),n++;var t=h(null);t.ns_st_cn=n,t.ns_st_pn="1",t.ns_st_ct="va",t.ns_st_tp="1",t.ns_st_ad="1",u.setClip(t),i=0,u.notify(l.PLAY,i),r=e,o=!1},playContentPart:function(e){var t=+(new Date);e=h(e),o?v(e)?(u.getClip().setLabels(e),u.getState()!=c.PLAYING&&(r=t,u.notify(l.PLAY,i))):y(t,e):y(t,e),o=!0},stop:function(){var e=+(new Date);u.notify(l.PAUSE,p(e))}}),a()};return function(e){}(e),e}();return e}(),m}();


!function(){"use strict";var a="undefined"!=typeof window&&void 0!==window.document?window.document:{},b="undefined"!=typeof module&&module.exports,c="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,d=function(){for(var b,c=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],d=0,e=c.length,f={};d<e;d++)if((b=c[d])&&b[1]in a){for(d=0;d<b.length;d++)f[c[0][d]]=b[d];return f}return!1}(),e={change:d.fullscreenchange,error:d.fullscreenerror},f={request:function(b){var e=d.requestFullscreen;b=b||a.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?b[e]():b[e](c&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){a[d.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(b,c){var d=e[b];d&&a.addEventListener(d,c,!1)},off:function(b,c){var d=e[b];d&&a.removeEventListener(d,c,!1)},raw:d};if(!d)return void(b?module.exports=!1:window.screenfull=!1);Object.defineProperties(f,{isFullscreen:{get:function(){return Boolean(a[d.fullscreenElement])}},element:{enumerable:!0,get:function(){return a[d.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(a[d.fullscreenEnabled])}}}),b?module.exports=f:window.screenfull=f}();