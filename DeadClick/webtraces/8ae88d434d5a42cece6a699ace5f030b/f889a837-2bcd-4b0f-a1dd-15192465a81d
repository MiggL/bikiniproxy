/*
 * Opentag, a tag deployment platform
 * Copyright 2011-2016, Qubit Group
 * http://opentag.qubitproducts.com
 */
(function(){var u=function(){return this}();u.qubit=u.qubit||{};u.qubit.SYSTEM_DEFAULTS={pingServerUrl:"opentag-stats.qubit.com/ping",tellLoadTimesProbability:1}})();(function(){var u={"id":"35657"};try{var a=function(){return this}();if(!a.qubit)a.qubit={};var t=a.qubit;if(!t.cs)t.cs={};t.CLIENT_CONFIG=u;var J=u.id||"efault";J="d"+J;if(!t.cs[J])t.cs[J]={};t.cs[J].ClientConfig=u;if(t.SYSTEM_DEFAULTS)t.cs[J].SystemDefaults=t.SYSTEM_DEFAULTS}catch(x){}})();
(function(){(function(){function u(){return da.uv}function a(){var l=u();if(!l||!l.emit)return false;if(!X){X=true;for(var b=0;b<W.length;b++){var A=W[b];if(A.on)l.on.apply(l,A.on);else if(A.emit)l.emit.apply(l,A.emit)}l.on(/.*/,function(r){var z=r.meta.type;var g=R[z];if(!g)R[z]={current:r,history:[r]};else{g.current=r;g.history.push(r)}}).replay();Z=true}return true}(function(){if(!Function.prototype.bind)Function.prototype.bind=function(l){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying "+
"to be bound is not callable");var b=Array.prototype.slice.call(arguments,1);var A=this;var r=function(){};var z=function(){return A.apply(this instanceof r?this:l,b.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;z.prototype=new r;return z}})();var t={__anonymous__:true};var J=null;try{J=(false||eval)("this")}catch(l){}if(!J)try{var x=function(){return this};J=x()}catch(l){}t=J;var f=t.qubit||{};if(!t.qubit)t.qubit=f;var D="3.3.0";if(f.VERSION&&f.VERSION!==D)try{console.warn("There is already 'qubit.VERSION' set to: "+
f.VERSION)}catch(l){}f.VERSION=D;try{if(typeof module==="object")module.exports=t}catch(l){}var F=function(){};var O;(function(){function l(){}function b(z,g,q,d,w){var y=z.split(".");var B=l.NAMESPACE_BASE||t;var I=null;var h=null;var C;if(w)B=J;var G=B;B=q||B;for(C=0;C<y.length-1;C+=1){I=B;h=y[C];B[h]=B[h]||{};B=B[h]}I=B;h=y[y.length-1];if(J.TAGSDK_NS_OVERRIDE)d=false;if(J.TAGSDK_NS_FORCED_OVERRIDE_OPTION!==undefined)d=!J.TAGSDK_NS_FORCED_OVERRIDE_OPTION;if(g!==undefined){if(I[h]===undefined||!d)I[h]=
g}else I[h]=I[h]||{};if(g){g.CLASSPATH=y.join(".");y.splice(y.length-1,1);g.PACKAGE_NAME=y.join(".")}return{root:G,object:I,instance:I[h]}}l.global=function(){return J};l.STANDARD_CS_NS="qubit.cs";l.clientSpaceClasspath=function(){if(window.qubit.CLIENT_CONFIG)return"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id;return l.STANDARD_CS_NS};l.globalNamespace=function(z,g,q,d){return b(z,g,q,d,true)};l.namespace=function(z,g,q,d){return b(z,g,q,d,false)};l.clientNamespace=function(z,g,q,d){return l.namespace(l.clientSpaceClasspath()+
"."+z,g,q,d)};l.clazz=function(z,g,q,d,w){l.namespace(z,g,d,true);if(typeof q==="function"){g.SUPER=q;g.superclass=q;g.prototype=new q(w);g.prototype.SUPER=q;g.prototype.CLASS=g}var y=z.split(".");if(g.prototype){g.prototype.CLASSPATH=y.join(".");g.prototype.CLASS_NAME=y[y.length-1];y.splice(y.length-1,1);g.prototype.PACKAGE_NAME=y.join(".")}else{g.CLASSPATH=y.join(".");g.STATIC_NAME=y[y.length-1];y.splice(y.length-1,1);g.PACKAGE_NAME=y.join(".")}return g};l.clazz("qubit.Define",l);l.clientClazz=
function(z,g,q,d,w){return l.clazz(l.clientSpaceClasspath()+"."+z,g,q,d,w)};l.STANDARD_VS_NS="qubit.vs";l.vendorsSpaceClasspath=function(z){var g=f.VENDOR_SPACE_CP;var q=g===undefined||g===null?l.STANDARD_VS_NS:g;if(z)if(q)return q+"."+z;else return z;return q};var A=l.vendorsSpaceClasspath();var r;if(A)r=l.namespace(A,{},null,true).instance;else r=l.global();l.getVendorSpace=function(){return r};l.vendorNamespace=function(z,g,q,d){z=l.vendorsSpaceClasspath(z);return l.namespace(z,g,q,d)};l.vendorClazz=
function(z,g,q,d,w){z=l.vendorsSpaceClasspath(z);return l.clazz(z,g,q,d,w)}})();(function(){function l(z){}var b="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"*!-#$\x26+()@"+"'%./:\x3c\x3e?["+'"]^_`{|}~'+"\\"+";\x3d";var A={};for(var r=0;r<b.length;r++)A[b.charAt(r)]=r;f.Define.clazz("qubit.Cookie",l);l.cookieAlphabet=b;l.cookieAlphabetMap=A;l.decode=function(z){return unescape(z)};l.encode=function(z){return escape(z)};l.set=function(z,g,q,d,w){var y;if(q){var B=new Date;
B.setTime(B.getTime()+q*24*60*60*1E3);y="; expires\x3d"+B.toGMTString()}else y="";if(!w){z=l.encode(z);g=l.encode(g)}var I=z+"\x3d"+g+y+"; path\x3d/;";if(d)I+=" domain\x3d"+d;document.cookie=I};l.get=function(z,g){var q=z+"\x3d";var d=document.cookie.split(";");for(var w=0;w<d.length;w++){for(var y=d[w];y.charAt(0)===" ";)y=y.substring(1,y.length);if(y.indexOf(q)===0){var B=y.substring(q.length,y.length);if(!g)B=l.decode(B);return B}}return null};l.getAllForName=function(z,g){if(!z)return[];var q=
z+"\x3d";var d=document.cookie.split(";");var w=[];for(var y=0;y<d.length;y++){for(var B=d[y];B.charAt(0)===" ";)B=B.substring(1,B.length);if(B.indexOf(q)===0){var I=B.substring(q.length,B.length);if(g)I=l.decode(I);w.push(I)}}return w};l.getAll=function(z){var g=document.cookie.split(";");var q=[];for(var d=0;d<g.length;d++){for(var w=g[d];w.charAt(0)===" ";)w=w.substring(1,w.length);var y=w.substring(0,w.indexOf("\x3d"));var B=w.substring(y.length+1,w.length);if(z)B=l.decode(B);q.push([y,B])}return q};
l.rm=function(z,g){l.set(z,"",-1,g)}})();(function(){function l(h,C,G){this.collectLogs=!!l.isCollecting();this.collectLocally=G;this.collection=[];this.getPrefix=function(){var H="";if(C){if(typeof C==="function")H=C(this.ref);else if(C.CLASS_NAME)H=C.CLASS_NAME;else if(C.constructor&&C.constructor.name)H=C.constructor.name;if(H)H+=" -\x3e "}return(h||"")+H}}function b(h,C,G,H,n,m,v,e){var c;var k=z>=e;if(l.getCollectLevel()>=0||k){if(n)c=[H,v,G];else c=[C+h.getPrefix()+H,m,G];c[3]=e;h.collect(c,
e);if(k)h.printMessage.apply(h,c)}}var A=f.Define;var r=null;A.clazz("qubit.opentag.Log",l);l.LEVEL_FINEST=4;l.LEVEL_FINE=3;l.LEVEL_INFO=2;l.LEVEL_WARN=1;l.LEVEL_ERROR=0;l.LEVEL_NONE=-1;l.MAX_LOG_LEN=1E4;l.prototype.MAX_LOG_LEN=-1;var z=l.LEVEL_NONE;var g=l.LEVEL_NONE;var q=true;l.setLevelFromCookie=function(){var h=f.Cookie.get("qubit.opentag.Log.LEVEL");if(h){h=+h;if(!isNaN(h))if(h>0){var C=l.LEVEL_FINE;l.setCollectLevel(h>C?h:C);l.setLevel(+h)}}};l.setCollecting=function(h){q=!!h};l.isCollecting=
function(){return q||l.COLLECT};l.setLevel=function(h){z=+h};l.setCollectAndLevel=function(h){l.setLevel(h);l.setCollectLevel(h)};l.getLevel=function(){return z};l.setCollectLevel=function(h){g=+h};l.getCollectLevel=function(){return g};var d=[];l.logsCollection=d;l.rePrintAll=function(h,C,G,H){var n=z;if(h!==undefined)z=h;try{if(l.isCollecting()){try{if(!G)r.clear()}catch(c){}var m=H||l.logsCollection;var v=0;for(var e=0;e<m.length;e++)(function(c){var k=m[c];var p=k[3];if(p!==undefined&&z>=p){v++;
if(!C)l.print.apply(l,k);else f.opentag.Timed.setTimeout(function(){if(h!==undefined)z=h;try{l.print.apply(l,k)}finally{z=n}},v*C)}})(e)}}catch(c){}finally{z=n}};var w=A.global();var y=!!(w.webkitMediaStream||w.webkitURL||w.mozContact);l.isStyleSupported=function(){return y};var B={};l.setConsole=function(h){r=h||B;return r};l.delayPrint=-1;var I=(new Date).valueOf();l.prototype.printMessage=function(h,C,G,H){if(l.delayPrint>0){var n=l.delayPrint;var m=I-(new Date).valueOf();if(m>0)n+=m;try{f.opentag.Timed.setTimeout(function(){this.print(h,
C,G,H)}.bind(this),n)}catch(v){setTimeout(function(){this.print(h,C,G,H)}.bind(this),n)}I=(new Date).valueOf()+n}else this.print(h,C,G,H)};l.prototype.print=function(h,C,G,H){l.print(h,C,G,H)};l.print=function(h,C,G,H){if(H!==undefined&&z<H)return;try{if(r&&r.log)if(C&&l.isStyleSupported())if(G&&r[G])r[G]("%c"+h,C);else r.log("%c"+h,C);else if(G&&r[G])r[G](h);else r.log(h)}catch(n){}};l.prototype.collect=function(h,C){if(C===undefined)C=l.getCollectLevel();var G=false;var H=this.collectLogs&&l.isCollecting()&&
l.getCollectLevel()>=+C;if(H){d.push(h);G=true}if(this.collectLocally&&H){this.collection.push(h);G=true}if(l.MAX_LOG_LEN>0)if(d.length>l.MAX_LOG_LEN)d.splice(0,d.length-l.MAX_LOG_LEN);if(l.MAX_LOG_LEN>0||this.MAX_LOG_LEN>0){var n=l.MAX_LOG_LEN;if(this.MAX_LOG_LEN>0)n=this.MAX_LOG_LEN;if(this.collection.length>n)this.collection.splice(0,this.collection.length-n)}return G?h:null};l.clearAllLogs=function(){try{r.clear()}catch(h){}finally{d.splice(0,d.length)}};l.getCollectedByLevel=function(h,C){C=
C||d;var G=[];for(var H=0;H<C.length;H++){var n=C[H];var m=n[0];var v=m[4];if(v===h)G.push(n)}return G};l.prototype.rePrint=function(h,C,G){l.rePrintAll(h,C,!G,this.collection)};l.prototype.FINEST=function(h,C){b(this,"FINEST: ",false,h,C,"color:#CCCCCC;",false,l.LEVEL_FINEST)};l.prototype.FINE=function(h,C){b(this,"FINE: ",false,h,C,"color:#999999;",false,l.LEVEL_FINE)};l.prototype.INFO=function(h,C,G){b(this,"INFO: ","info",h,C,G,G,l.LEVEL_INFO)};l.prototype.WARN=function(h,C){b(this,"WARN: ","warn",
h,C,"color:#26A110;",false,l.LEVEL_WARN)};l.prototype.ERROR=function(h,C){b(this,"ERROR: ","error",h,C,"color:red;",false,l.LEVEL_ERROR)};l.setConsole(A.global().console);l.setLevelFromCookie()})();(function(){function l(c){return w.addToArrayIfNotExist(w.ANON_VARS,c)}function b(c){return c.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function A(c,k){var p=B.length;for(var E=0;E<p;E++)if(c===B[E][0])return B[E][1];B[B.length]=[c,k];return false}function r(c,k,p,E,M){var N=false;var P=false;var Q=
false;var S=false;var T=false;var ca=false;var V=false;if(k){T=!!k.all;N=T||k.nodes;S=T||k.win;P=T;V=!!k.emptyForMaxDeep;Q=k.noFunctions&&!T;if(k.noOwn!==undefined)P=!!k.noOwn;if(k.noFunctions!==undefined)Q=!!k.noFunctions;if(k.win!==undefined)S=!!k.win;if(k.nodes!==undefined)N=!!k.nodes;ca=!!k.copyReference}if(p!==undefined&&!p){if(V)return;return c}else if(p!==undefined)p--;if(!c||!(c instanceof Object))return c;if(!N){try{if(c instanceof Node)return c}catch(ia){if(c instanceof ActiveXObject&&c.nodeType!==
undefined)return c}if(c===document)return c}if(!S)if(c===y)return c;var U=c instanceof Array?[]:{};if(c instanceof Date)U=new Date(c);if(!Q&&c instanceof Function){var ea=String(c).replace(/\s+/g,"");if(ea.indexOf("{[nativecode]}")+14===ea.length)U=function(){return c.apply(M||this,arguments)};else U=function(){return c.apply(this,arguments)}}if(E===undefined){B=[];E=0}var fa=A(c,U);if(fa)return fa;var Y;if(U instanceof Array)for(Y=0;Y<c.length;Y++)if(c[Y]===c[Y])U[U.length]=r(c[Y],k,p,E+1,c);else U[U.length]=
c[Y];else{Y=0;for(var ba in c){if(P||c.hasOwnProperty(ba))if(c[ba]===c[ba])U[ba]=r(c[ba],k,p,E+1,c);else U[ba]=c[ba];Y++}}if(k.proto)U.prototype=r(c.prototype,k,p,E+1,c);if(ca)U.___copy_ref=c;return U}function z(c,k){for(var p=0;p<k&&p<I.length;p++)if(c===I[p])return true;return false}function g(c,k,p,E,M,N,P,Q){p=p||{};if(p.hasOwn===undefined)p.hasOwn=true;if(p.objectsOnly&&!(c instanceof Object))return;if(Q!==undefined&&!Q)return;else if(Q!==undefined)Q--;if(!p||!p.nodes)try{if(c instanceof Node)return}catch(ea){if(c instanceof
ActiveXObject&&c.nodeType!==undefined)return}if(c===y)return;if(E===undefined){I=[];E=0}if(z(c,E))return;I[E]=c;M=M||c;if(M&&N&&M[N]!==M[N])return;var S=k(c,M,N,P);if(S)return;var T=0;var ca="";for(var V in c){if(!p.hasOwn||c.hasOwnProperty(V))try{var U=c[V];if(p.track)ca=P?P+"."+V:V;g(U,k,p,E+1,M,V,ca,Q)}catch(ea){}T++}}var q=f.Define;var d=f.Cookie;var w=function(){};var y=q.global();q.clazz("qubit.opentag.Utils",w);w.global=q.global;w.namespace=q.namespace;w.clazz=q.clazz;w.getObjectUsingPath=
function(c,k){k=k||y;var p=c.split(".");for(var E=0;E<p.length;E++)if(k&&p[E])k=k[p[E]];return k};w.getParentObject=function(c){var k=c.lastIndexOf(".");var p=c.substring(0,k);return w.getObjectUsingPath(p)};w.variableExists=function(c){return c!==undefined&&c!==null};w.ANON_VARS=[];w.getAnonymousAcessor=function(c){var k=w.indexInArray(c,w.ANON_VARS);if(k===-1)k=l(c);return"qubit.opentag.Utils.ANON_VARS["+k+"]"};w.replaceAll=function(c,k,p){return c.replace(new RegExp(b(k),"g"),p)};w.secureText=
function(c){if(typeof c!=="string")c+="";c=c.replace(/</g,"\x26lt;");c=c.replace(/>/g,"\x26gt;");return c};w.getUrl=function(){return document.location.href};w.getQueryParam=function(c){var k;var p;var E;var M;var N;var P;var Q;M=w.getUrl();if(M.indexOf("?")>0){P=M.substring(M.indexOf("?")+1).split("\x26");for(k=0,p=P.length;k<p;k+=1){N=P[k];if(N.indexOf("\x3d")>0){Q=N.split("\x3d");if(Q.length===2&&Q[0]===c)return Q[1]}}}return null};w.getElementValue=function(c){var k=document.getElementById(c);
if(k)return k.textContent||k.innerText;return null};var B=[];w.objectCopy=function(c,k){k=k||{};var p=r(c,k,k.maxDeep);B=[];return p};var I=[];w.traverse=function(c,k,p){var E;g(c,k,p,E,E,E,E,p.maxDeep)};w.prepareQuotedString=function(c){if(typeof c==="string")return'"'+c.replace(/\"/g,'\\"')+'"';else return c};w.expressionToFunction=function(c,k){k=k||"";var p="function ("+k+") {"+c+"}";return w.gevalAndReturn(p).result};w.defineWrappedClass=function(c,k,p,E,M){var N=function(){if(M)return M.apply(this,
arguments);else return k.apply(this,arguments)};q.clazz(c,N,k,E);for(var P in p)if(p.hasOwnProperty(P)&&P!=="CONSTRUCTOR")N.prototype[P]=p[P];return N};w.copyAandAddFromB=function(c,k,p){p=p||8;var E=this.objectCopy(c,{maxDeep:p});for(var M in k)if(k.hasOwnProperty(M))E[M]=k[M];return E};w.keys=function(c){if(c instanceof Object){if(Object.keys)return Object.keys(c);var k=[];for(var p in c)if(c.hasOwnProperty(p))k[k.length]=p;return k}else throw"keys() called on non-object!";};w.getSrcElement=function(c){var k;
c=c||window.event;if(c.srcElement)k=c.srcElement;else if(c.target)k=c.target;return k};w.addToArrayIfNotExist=function(c,k,p){var E=0;for(var M=false;E<c.length;E+=1){var N=p&&p(c[E],k);if(N||c[E]===k){M=true;break}}if(!M){c[c.length]=k;E=-1}return E};w.indexInArray=function(c,k){for(var p=0;p<c.length;p++)if(c[p]===k)return p;return-1};w.existsInArray=function(c,k){for(var p=0;p<c.length;p++)if(c[p]===k)return true;return false};w.removeFromArray=function(c,k){var p=0;for(var E=0;p<c.length;)if(c[p]===
k){c.splice(p,1);E++}else p++;return E};w.addClass=function(c,k){var p;try{c.classList.add(k)}catch(E){if(c.className===null){c.className=k;return}p=c.className.split(" ");w.addToArrayIfNotExist(p,k);c.className=p.join(" ")}};w.removeClass=function(c,k){var p;try{c.classList.remove(k)}catch(E){if(c.className===null){c.className="";return}p=c.className.split(" ");w.removeFromArray(p,k);c.className=p.join(" ")}};var h="try{this.qubitopentagutilsgevalandreturn__var_test__\x3d(";var C=");}catch(ex){"+
"this.qubitopentagutilsgevalandreturn__var_test__error \x3d ex;}";w.gevalAndReturn=function(c){var k=J;k.qubitopentagutilsgevalandreturn__var_test__=undefined;k.qubitopentagutilsgevalandreturn__var_test__error=undefined;c=h+c+C;w.geval(c);var p=k.qubitopentagutilsgevalandreturn__var_test__;var E=k.qubitopentagutilsgevalandreturn__var_test__error;try{k.qubitopentagutilsgevalandreturn__var_test__=O;k.qubitopentagutilsgevalandreturn__var_test__error=O;delete k.qubitopentagutilsgevalandreturn__var_test__;
delete k.qubitopentagutilsgevalandreturn__var_test__error}catch(M){}return{result:p,error:E}};w.trim=function(c){try{return String(c).trim()}catch(k){return String(c).replace(/^\s+|\s+$/g,"")}};w.setIfUnset=function(c,k){if(c&&k)for(var p in k)if(k.hasOwnProperty(p)&&!c.hasOwnProperty(p))c[p]=k[p]};var G=Math.floor(Math.random()*1E12);w.UUID=function(){if(!y.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__)y.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__=(new Date).valueOf();return G+"."+ ++y.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__};
w.overrideFromLeftToRight=function(c,k){if(c&&k)for(var p in k)if(k.hasOwnProperty(p))c[p]=k[p];return c};w.geval=function(c){if(window&&window.execScript)return window.execScript(c===""?" ":c);else return function(){return y["eval"].call(y,c)}()};var H=[];w.bodyAvailable=function(c){var k=!!document.body;if(k){if(H){for(var p=0;p<H.length;p++)try{H[p]()}catch(E){}H=false}c()}else H.push(c)};w.rmCookiesMatching=function(c){var k=d.getAll();for(var p=0;p<k.length;p++){var E=k[p][0];if(E.match(c)===
0)d.rm(E)}};var n=[];var m=false;var v=false;w.bodyReady=function(c){if(v){if(c)c();return true}m=m||!!(document.body&&document.readyState==="complete");if(m){v=true;for(var k=0;k<n.length;k++)try{n[k]()}catch(p){}if(c)c()}else if(c)n.push(c);return m};var e=y.onload;y.onload=function(c){try{w.bodyReady()}catch(p){try{window.qubit.opentag.Utils.bodyReady()}catch(E){}}var k=false;try{k=e}catch(p){}if(k)k(c)};(function(){var c;var k=false;var p=1;var E;var M;var N;var P;M=function(S){var T;if(S===true)p-=
1;if(!p||S!==true&&!k){if(!document.body)return setTimeout(M,1);k=true;if(S!==true){p-=1;if(p>0)return}for(;E.length>0;){T=E.shift();T()}}};P=function(){if(k)return;try{document.documentElement.doScroll("left")}catch(S){setTimeout(P,1);return}M()};N=function(){if(E)return;E=[];if(document.readyState==="complete")return setTimeout(M,1);if(document.addEventListener){document.addEventListener("DOMContentLoaded",c,false);window.addEventListener("load",M,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",
c);window.attachEvent("onload",M);var S=false;try{S=window.frameElement===null||window.frameElement===undefined}catch(T){}if(document.documentElement.doScroll&&S)P()}};var Q=function(S){N();if(k)setTimeout(S,1);else E.push(S)};if(document.addEventListener)c=function(){document.removeEventListener("DOMContentLoaded",c,false);M()};else if(document.attachEvent)c=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",c);M()}};Q(function(){m=true;w.bodyReady()})})()})();
var L={};(function(){function l(B){return B<10?"0"+B:B}function b(B){g.lastIndex=0;return g.test(B)?'"'+B.replace(g,function(I){var h=w[I];return typeof h==="string"?h:"\\u"+("0000"+I.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+B+'"'}function A(B){return isFinite(B.valueOf())?B.getUTCFullYear()+"-"+l(B.getUTCMonth()+1)+"-"+l(B.getUTCDate())+"T"+l(B.getUTCHours())+":"+l(B.getUTCMinutes())+":"+l(B.getUTCSeconds())+"Z":null}function r(B,I){var h;var C;var G;var H;var n=q;var m;var v=I[B];if(v instanceof
Date)v=A(v);else if(v instanceof String||v instanceof Number||v instanceof Boolean)v=v.valueOf();if(typeof y==="function")v=y.call(I,B,v);switch(typeof v){case "string":return b(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);case "object":if(!v)return"null";q+=d;m=[];if(Object.prototype.toString.apply(v)==="[object Array]"){H=v.length;for(h=0;h<H;h+=1)try{m[h]=r(h,v)||"null"}catch(e){m[h]='{"stack_exceeded": null}'}G=m.length===0?"[]":q?"[\n"+q+m.join(",\n"+
q)+"\n"+n+"]":"["+m.join(",")+"]";q=n;return G}if(y&&typeof y==="object"){H=y.length;for(h=0;h<H;h+=1)if(typeof y[h]==="string"){C=y[h];try{G=r(C,v)}catch(e){G='{"stack_exceeded": null}'}if(G)m.push(b(C)+(q?": ":":")+G)}}else for(C in v)if(Object.prototype.hasOwnProperty.call(v,C)){try{G=r(C,v)}catch(e){G='{"stack_exceeded": null}'}if(G)m.push(b(C)+(q?": ":":")+G)}G=m.length===0?"{}":q?"{\n"+q+m.join(",\n"+q)+"\n"+n+"}":"{"+m.join(",")+"}";q=n;return G}}var z=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
var g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var q;var d;var w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var y;if(typeof L.stringify!=="function")L.stringify=function(B,I,h){var C;q="";d="";if(typeof h==="number")for(C=0;C<h;C+=1)d+=" ";else if(typeof h==="string")d=h;y=I;if(I&&typeof I!=="function"&&(typeof I!=="object"||typeof I.length!=="number"))throw new Error("JSON.stringify");
return r("",{"":B})};if(typeof L.parse!=="function")L.parse=function(B,I){function h(G,H){var n;var m;var v=G[H];if(v&&typeof v==="object")for(n in v)if(Object.prototype.hasOwnProperty.call(v,n)){m=h(v,n);if(m!==undefined)v[n]=m;else delete v[n]}return I.call(G,H,v)}var C;B=String(B);z.lastIndex=0;if(z.test(B))B=B.replace(z,function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(B.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){C=eval("("+B+")");return typeof I==="function"?h({"":C},""):C}throw new SyntaxError("JSON.parse");}})();var K={};K.html=K.html||{};(function(){function l(d){return d.replace(/^\s+/,"").replace(/\s+$/,"")}var b={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null};var A;var r="universal_variable";var z=0;var g=500;var q;b._isArray=function(d){return Object.prototype.toString.call(d)==="[object Array]"};b._targetChanged=function(d,w,y){var B;
var I;var h;if(y===null)if(w==="null")return false;else return true;else if(y===undefined)if(w===y)return false;else return true;else{B=L.parse(w);I=b._getNested(B,d);h=b._getNested(y,d);return!b._jsonIsEqual(I,h)}};b._processCallbacks=function(){var d;if(b.early_callbacks&&b.early_callbacks.length>0){for(d=0;d<b.early_callbacks.length;d+=1)b.push(b.early_callbacks[d]);b.early_callbacks=null}};b._keyStringToArr=function(d){d=l(d);if(d==="")return[];else{d=d.replace(/\[(\w+)\]/g,".$1");d=d.replace(/^\./,
"");return d.split(".")}};b._getNested=function(d,w){var y=b._keyStringToArr(w);for(var B;y.length>0;){B=y.shift();if(d.hasOwnProperty(B))d=d[B];else return}return d};b._jsonIsEqual=function(d,w){if(typeof d!=="string")d=L.stringify(d,b._stripEvents);if(typeof w!=="string")w=L.stringify(w,b._stripEvents);return d===w};b._stripEvents=function(d,w){if(d!=="events")return w;else return undefined};b._on=function(d,w){var y;var B;y=d.split(":");d=y[0];B=y[1];b.callbacks[d]=b.callbacks[d]||[];if(B)b.callbacks[d].push({keyString:B,
func:w});else b.callbacks[d].push({func:w})};b._trigger=function(d,w){var y;var B;if(b.callbacks[d])for(y=0;y<b.callbacks[d].length;y+=1)if(typeof b.callbacks[d][y].func==="function"){B=b.callbacks[d][y].keyString;if(B){if(d==="change"&&b._targetChanged(B,b.currentUV,A))b.callbacks[d][y].func(w)}else b.callbacks[d][y].func(w)}};b._eventsPush=function(d){var w;var y;A.events[A.events.length]=d;d.time=d.time||(new Date).getTime();if(b.callbacks.event){w=0;y=b.callbacks.event.length;for(w;w<y;w+=1)b.callbacks.event[w].func(d)}d.has_fired=
true};b._getUnfiredEvents=function(){var d=0;for(d=0;d<A.events.length;d+=1)if(!A.events[d].has_fired){b.unfired_events.push(A.events.splice(d,1)[0]);d-=1}};b._fireEvents=function(){for(;b.unfired_events.length>0;)A.events.push(b.unfired_events.shift())};b._resetEventsPush=function(){A.events=A.events||[];if(A.events.push.toString().indexOf("[native code]")!==-1){A.events.push=b._eventsPush;b._getUnfiredEvents();b._fireEvents()}};b._checkForChanges=function(){if(b.callbacks.change&&b.callbacks.change.length>
0)if(!b._jsonIsEqual(b.currentUV,A)){b._trigger("change",A);b.currentUV=L.stringify(A,b._stripEvents)}};b._setUVLocation=function(d){r=d;b._initUV()};b._initUV=function(){window[r]=window[r]||{events:[]};A=window[r];if(!A.events)A.events=[]};b.push=function(d){if(!b._isArray(d))return;if(d[0]==="on")b._on(d[1],d[2]);else if(d[0]==="trigger"&&d[1])b._trigger(d[1])};b.init=function(d,w){if(w)r=w;b._initUV();if(!window.uv_listener||b._isArray(window.uv_listener)){b.early_callbacks=window.uv_listener||
null;window.uv_listener=b;if(!d)b.start()}else if(w)window.uv_listener._setUVLocation(r)};b.start=function(){b.currentUV=L.stringify(A,b._stripEvents);q=setInterval(function(){b._initUV();b._resetEventsPush();b._checkForChanges()},g);b._processCallbacks()};K.html.UVListener=b})();(function(){function l(A){if(A){this._rate=A.rate||10;this._smallestRate=-1;if(A.start)this.startPooling();this.config=A}this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}f.Define.clazz("qubit.opentag.Timer",
l);l.prototype.timers=[];l.prototype.startPooling=function(A){if(A&&this.config.dynamic)if(this._smallestRate<0||this._smallestRate>A)this._smallestRate=Math.min(Math.floor(A/2),1500);if(!this.started){this.started=true;setTimeout(this._binded_pool,0)}};l.prototype._pool=function(){this.maxFrequent(function(){var r="";if(this.config&&this.config.name)r="["+this.config.name+"]"},5E3,this._lck_obj);this.callTimers();if(this.timers.length!==0){var A=this._smallestRate>this._rate?this._smallestRate:this._rate;
setTimeout(this._binded_pool,A)}else{this.started=false;this._smallestRate=-1}};l.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var A=0;A<this.timers.length;A++){var r=this.timers[A];var z=(new Date).valueOf();if(z>=r.time){try{r.execute()}catch(g){}this.timers.splice(A,1);--A}}};l.prototype.cancellAll=function(){this.timers=[]};l.prototype.setRate=function(A){this._rate=A};l.prototype.maxFrequent=function(A,r,z){if(!z){A.__maxFrequent__timer_opentag_qubit_=A.__maxFrequent__timer_opentag_qubit_||
{};z=A.__maxFrequent__timer_opentag_qubit_}var g=z.____last__timed__max__frequent____;if(!g||(new Date).valueOf()-g>r){g=(new Date).valueOf();z.____last__timed__max__frequent____=g;A()}};l.prototype.runIfNotScheduled=function(A,r,z){z=z||A;if(z.__lastRun__&&(new Date).valueOf()<r+z.__lastRun__)return this.schedule(A,r,z);else{z.__lastRun__=(new Date).valueOf();A();return true}};l.prototype.schedule=function(A,r,z){if(z.___scheduled___)return false;else{z.___scheduled___=(new Date).valueOf();this.setTimeout(function(){z.___scheduled___=
false;z.__lastRun__=(new Date).valueOf();A()},r);return true}};var b=1;l.prototype.setTimeout=function(A,r){var z={id:b++,time:(new Date).valueOf()+ +r,execute:A};this.timers.push(z);this.startPooling(r);return z};l.prototype.setInterval=function(A,r){var z=setInterval(A,r);this.inervals.push(z);return z}})();(function(){f.Define.namespace("qubit.opentag.Timed",new f.opentag.Timer({rate:37,dynamic:true}));var l=f.opentag.Timed;l.tillTrue=function(b,A,r){var z=function(){if(!b())l.setTimeout(z,r||
33);else A()};z()}})();K.html.fileLoader={};K.html.fileLoader.load=function(l,b,A,r,z,g){var q;var d;var w;var y;var B;B=false;y=function(I){return function(){if(!B){B=true;if(I&&!w)w={url:document.location.href};A(l,w,I)}}};try{if(b)d=b(l)}catch(I){d=false;A(l,"Exception loading pre",true)}finally{if(d!==false){q=K.html.fileLoader.createScriptEl(l,z,false,g);if(A){q.onload=y(false);q.onerror=y(true);q.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded")setTimeout(function(){y(false)()},
1)}}if(!r)r=window.document.getElementsByTagName("head")[0];r.appendChild(q)}}};K.html.fileLoader.createScriptEl=function(l,b,A,r){var z;var g=document.createElement("script");g.type="text/javascript";g.src=K.html.fileLoader.tidyUrl(l)+(A?"?"+(new Date).getTime():"");if(b!==false){g.async="true";g.defer="true"}else{g.async="false";if(g.async!==false)g.async=false;g.defer="false";if(g.defer!==false)g.defer=false}for(z in r)if(r.hasOwnProperty(z))g.setAttribute(z,r[z]);return g};K.html.fileLoader.tidyUrl=
function(l){if(l.substring(0,5)==="http:")return l;if(l.substring(0,6)==="https:")return l;return"//"+l};(function(){function l(r){this.calls={}}var b=f.Define;var A=f.opentag.Utils;l.prototype.on=function(r,z){if(!this.calls[r])this.calls[r]=[];return A.addToArrayIfNotExist(this.calls[r],z)};l.prototype.call=function(r,z){var g=this.calls[r];if(g)for(var q=0;q<g.length;q++)try{g[q](z)}catch(d){}};l.prototype.remove=function(r,z){if(this.calls[r])return A.removeFromArray(this.calls[r],z);return null};
l.prototype.removeAll=function(r){var z=0;for(var g in this.calls)if(this.calls.hasOwnProperty(g))z+=A.removeFromArray(this.calls[g],r);return z};l.prototype.clear=function(){this.calls={}};b.clazz("qubit.Events",l)})();(function(){function l(g){this.log=new f.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:true,name:"Filter-"+A++,script:undefined,session:undefined,restartable:true};this.runtimeId=b.UUID();this.session=
null;if(g){for(var q in g)if(g.hasOwnProperty(q))this.config[q]=g[q];if(g.session)this.setSession(g.session);this.register(this)}this.events=new f.Events({})}var b=f.opentag.Utils;var A=0;var r=[];f.Define.clazz("qubit.opentag.filter.BaseFilter",l);l.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};var z="restart";l.prototype.EVENT_TYPES={RESTART_EVENT:z};l.prototype.prepareForRestart=function(){if(this.config.restartable){this.events.call(z,this);this.reset()}};l.prototype.onRestart=function(g){this.events.on(z,
g)};l.prototype.reset=function(){this.runtimeId=b.UUID();this.enable()};l.prototype.disable=function(){this.config.disabled=true};l.prototype.enable=function(){this.config.disabled=false};l.prototype.match=function(){return true};l.prototype.setSession=function(g){this.session=g};l.prototype.getSession=function(){return this.session};l.prototype.getState=function(){var g=l.state.PASS;if(this.config.disabled)return l.state.DISABLED;if(this.config.script)g=this.config.script.call(this,g);if(isNaN(+g))g=
l.state.FAIL;this.lastState=+g;return g};l.getFilters=function(){return r};l.prototype.register=function(){l.register(this)};l.register=function(g){b.addToArrayIfNotExist(r,g)}})();(function(){var l=f.Define;var b={CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"};l.namespace("qubit.opentag.filter.pattern.PatternType",b)})();(function(){function l(g){this._lockObject={};var q={patternType:z.CONTAINS,
pattern:""};if(g)for(var d in g)if(g.hasOwnProperty(d))q[d]=g[d];l.SUPER.call(this,q)}var b=f.opentag.Utils;var A=f.opentag.filter.BaseFilter;var r=f.opentag.Timed;var z=f.opentag.filter.pattern.PatternType;f.Define.clazz("qubit.opentag.filter.URLFilter",l,A);l.prototype.PATTERNS=z;l.prototype.getURL=function(g){return g||b.getUrl()};l.prototype.match=function(g){g=this.getURL(g);var q=true;var d=this.config.pattern;switch(this.config.patternType){case z.CONTAINS:q=g.toLowerCase().indexOf(d.toLowerCase())>=
0;break;case z.MATCHES_EXACTLY:q=g.toLowerCase()===this.config.pattern.toLowerCase();break;case z.STARTS_WITH:q=g.toLowerCase().indexOf(d.toLowerCase())===0;break;case z.ENDS_WITH:q=g.lastIndexOf(d.toLowerCase())+d.length===g.length;break;case z.REGULAR_EXPRESSION:q=(new RegExp(d)).test(g);break;case z.ALL_URLS:q=true;break}return q}})();(function(){function l(g){var q={};if(g){for(var d in g)if(g.hasOwnProperty(d)){if(d==="customStarter"&&g[d])this.customStarter=g[d];else if(d==="customScript"&&
g[d])this.customScript=g[d];q[d]=g[d]}this.uid="f"+z++}this.tagsToRun=[];l.SUPER.call(this,q)}var b=f.opentag.filter.BaseFilter;var A=f.opentag.filter.URLFilter;var r=f.opentag.Utils;var z=0;f.Define.clazz("qubit.opentag.filter.Filter",l,A);l.prototype.customStarter=function(g,q,d){q(false)};l.prototype.isSession=function(){if(this.config.sessionDisabled)return false;if(this.customStarter===null&&this.customScript===null)return false;return true};l.prototype.customScript=function(g){return true};
l.prototype.match=function(g){var q=true;try{if(this.customScript){if(this._matchState===undefined)this._matchState=!!this.customScript(this.getSession());q=this._matchState}}catch(d){q=false}return q&&l.SUPER.prototype.match.call(this,g)};l.prototype.runTag=function(g){r.addToArrayIfNotExist(this.tagsToRun,g);if(!this.starterExecuted){if(!this._starterWasRun){this._starterWasRun=true;var q=this.runtimeId;var d=function(w){if(q!==this.runtimeId)return;this.reRun=w;this.starterExecuted=(new Date).valueOf();
this._processQueuedTagsToRun()}.bind(this);if(this.customStarter)this.customStarter(this.getSession(),d,g);else l.prototype.customStarter.call(this,this.getSession(),d,g)}}else this._triggerTag(g)};l.prototype._processQueuedTagsToRun=function(){for(var g=0;g<this.tagsToRun.length;g++){var q=this.tagsToRun[g];this._triggerTag(q)}};l.prototype._triggerTag=function(g){if(this.reRun===true)g.run();else g.runOnce()};l.prototype.getState=function(g){if(g)this.setSession(g);var q=l.SUPER.prototype.getState.call(this);
if(q===b.state.DISABLED)return b.state.DISABLED;if(q===b.state.PASS)if(this.isSession())q=b.state.SESSION;if(this.config.script)q=this.config.script.call(this,q,this.getSession());this.lastState=q;return q};l.prototype.reset=function(){l.SUPER.prototype.reset.call(this);this._matchState=undefined;this._starterWasRun=undefined;this.starterExecuted=undefined;this.tagsToRun=[];this.reRun=undefined}})();K.html.GlobalEval={};K.html.GlobalEval.globalEval=function(l){if(window.execScript)window.execScript(l===
""?" ":l);else{var b=function(){window["eval"].call(window,l)};b()}};K.html.HtmlInjector={};K.html.HtmlInjector.inject=function(l,b,A,r,z){var g;var q;var d;var w;var y;var B;var I;if(A.toLowerCase().indexOf("\x3cscript")>=0){d=document.createElement("div");d.innerHTML="a"+A;w=d.getElementsByTagName("script");y=[];for(g=0,q=w.length;g<q;g+=1)y.push(w[g]);I=[];for(g=0,q=y.length;g<q;g+=1){B=y[g];var h={attributes:K.html.HtmlInjector.getAttributes(B)};if(B.src)h.src=B.src;else h.script=B.innerHTML;
I.push(h);B.parentNode.removeChild(B)}if(d.innerHTML)if(d.innerHTML.length>0)d.innerHTML=d.innerHTML.substring(1);K.html.HtmlInjector.doInject(l,b,d);K.html.HtmlInjector.loadScripts(I,0,r,l)}else{d=document.createElement("div");d.innerHTML=A;K.html.HtmlInjector.doInject(l,b,d);if(r)r()}};K.html.HtmlInjector.doInject=function(l,b,A){if(A.childNodes.length>0){for(var r=document.createDocumentFragment();A.childNodes.length>0;)r.appendChild(A.removeChild(A.childNodes[0]));if(b)K.html.HtmlInjector.injectAtStart(l,
r);else K.html.HtmlInjector.injectAtEnd(l,r)}};K.html.HtmlInjector.injectAtStart=function(l,b){if(l.childNodes.length===0)l.appendChild(b);else l.insertBefore(b,l.childNodes[0])};K.html.HtmlInjector.injectAtEnd=function(l,b,A){if(!A)A=1;if(l===document.body&&document.readyState!=="complete"&&A<50)setTimeout(function(){K.html.HtmlInjector.injectAtEnd(l,b,A+1)},100);else l.appendChild(b)};K.html.HtmlInjector.loadScripts=function(l,b,A,r){var z;var g;var q=false;for(z=l.length;b<z;b+=1){g=l[b];if(g.src){q=
true;break}else K.html.GlobalEval.globalEval(g.script)}if(q)K.html.fileLoader.load(g.src,null,function(){K.html.HtmlInjector.loadScripts(l,b+1,A,r)},r,false,g.attributes);if(A&&b===z)A()};K.html.HtmlInjector.getAttributes=function(l){var b;var A;var r;var z;var g;var q={};if(l){r=l.attributes;A=r.length;for(b=0;b<A;b++){z=r[b].value;g=r[b].name.toLowerCase();if(z!==""&&(g==="id"||g==="class"||g==="charset"||g.substr(0,5)==="data-"))q[g]=z}return q}};(function(){function l(){I=I||{write:document.write,
writeln:document.writeln}}function b(){document.write=I.write;document.writeln=I.writeln;I=null}var A=f.opentag.filter.BaseFilter;var r=f.opentag.Utils;var z=K.html.HtmlInjector;var g=K.html.fileLoader;var q=f.opentag.filter.Filter;var d=function(){};f.Define.clazz("qubit.opentag.TagsUtils",d);var w=false;d.bodyLoaded=function(){if(w)return true;w=!!(document.body&&document.readyState!=="loading");return w};d.bodyAvailable=function(e){return!!document.body};var y={};var B={SUCCESS:"success",FAIL:"failure",
INIT:"not started"};d.loadScript=function(e){var c=e.url;var k=function(M,N,P){y[c].error=N;if(P){y[c].state=B.FAIL;e.onerror()}else{y[c].state=B.SUCCESS;e.onsuccess()}};if(y[c]){if(e.noMultipleLoad)return k(c,y[c].error,y[c].state===B.FAIL);y[c].count+=1}else y[c]={count:1,state:null};var p=!e.async;var E=d.bodyLoaded();if(p&&E);p=p&&!E;if(p)d.writeScriptURL(c,function(M,N){k(c,N,!M)});else g.load(c,false,k,e.node,e.async)};var I=null;d.redirectDocumentWritesToArray=function(e,c){var k=e;l();document.write=
function(p){k.push(p)};document.writeln=function(p){k.push(p)}};d.flushDocWritesArray=function(e,c,k,p,E){var M=c;if(M&&e){var N=e.splice(0,e.length);try{d.injectHTML(M,k,N.join("\n"),E||F);return true}catch(Q){}}else{var P="Flushing location not found!";return false}if(E)E();return true};d.unlockDocumentWrites=function(){if(I)b()};var h=d.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks";var C={};f.Define.namespace(h,C,J,true);var G=0;var H=(new Date).valueOf();d.writeScriptURL=function(e,
c){var k="_"+H+"_"+G++;var p=h+"."+k;var E=false;C[k]=function(T){if(E)return;E=true;if(T)c(false,"error while loading script "+e);else c(true);C[k]=undefined;delete d.writeScriptURL.callbacks[k]};var M='if(this.readyState \x3d\x3d\x3d "loaded" || '+'this.readyState \x3d\x3d\x3d "complete"){ try {'+p+"(true)"+"} catch (ex) {}}";var N="try{"+p+"(false)}catch(ex){}";var P="try{"+p+"(true)}catch(ex){}";var Q="scr";var S;e=g.tidyUrl(e);S="\x3c"+Q+"ipt onload\x3d'"+N+"'  onerror\x3d'"+P+"' onreadystatechange\x3d'"+
M+"' type\x3d'text/javascript' "+" src\x3d'"+e+"'\x3e"+"\x3c/"+Q+"ipt\x3e";if(I){b();document.write(S);l()}else document.write(S);r.bodyReady(function(){if(!E){E=true;c(true)}})};d.writeScriptURL.callbacks={};var n=A.state.SESSION;var m=A.state.PASS;var v=A.state.FAIL;d.filtersState=function(e,c,k,p){e=e.sort(function(ba,ia){try{var ga=ia.config.order;var ha=ba.config.order;if(isNaN(-ha))ha=0;if(isNaN(-ga))ga=0;return ga-ha}catch(ja){return 0}});var E=m;if(!e||e.length===0)return E;var M=null;var N=
false;var P=false;var Q=0;var S;var T;var ca=[];var V;var U;for(var ea=0;ea<e.length;ea++){V=e[ea];V.setSession(c);if(V.match()){S=V.getState();if(S>0){if(Q===0||Q>S)Q=S}else if(S===A.state.DISABLED)N=true;else if(S===n){P=true;M=V;T=V;ca.push(V)}else M=V}else U=V}var fa=false;if(M===null){fa=true;if(!N)E=v;else E=m}else if(M.config.include)E=S;else E=S===m?v:m;if(Q>0&&(E===m||fa))E=Q;if(E===n||E===m&&P){if(!T.config.include)return v;E=n;if(T instanceof q&&T.isSession())if(p)for(var Y=0;Y<ca.length;Y++)try{ca[Y].runTag(k)}catch(ba){}}if(k.config.dedupe&&
E===m)if(U&&U instanceof q&&U.isSession()){k.sendDedupePing=true;E=v}return E};d.injectHTML=function(e,c,k,p){return z.inject(e,!c?1:0,k,p||F)};d.getHTMLLocationForTag=function(e){var c;var k=e.prepareLocationObject(e.config.locationObject);switch(k){case "HEAD":c=document.getElementsByTagName("head")[0];break;case "BODY":c=document.body;break;default:if(k)c=document.getElementById(k);else c=document.body}return c}})();(function(){function l(d){this.config={};this.handlers=[];this.parameters=null;
this.callHandlersOnRead=false;if(d){this.uniqueId="BV"+z++;l.ALL_VARIABLES[this.uniqueId]=this;for(var w in d)if(d.hasOwnProperty(w)){this.config[w]=d[w];if(w==="value")this.value=d.value}var y=l.register(this);if(y&&y!==this);return y}}function b(){if(q)return false;for(var d=0;d<g.length;d++)try{var w=g[d];w.getValue()}catch(y){}r.setTimeout(b,l.CHECK_POLL_RATE);return true}var A=f.opentag.Utils;var r=f.opentag.Timed;var z=0;f.Define.clazz("qubit.opentag.pagevariable.BaseVariable",l);l.ALL_VARIABLES=
{};var g=[];l.OBSERVED_VARIABLES=g;l.pageVariables=[];l.register=function(d){if(d instanceof l){for(var w=0;w<l.pageVariables.length;w++){var y=l.pageVariables[w];if(d===y)return y}l.pageVariables.push(d);return d}return null};l.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};l.prototype._updateCurrentValue=function(d){if(!this.valuesAreEqual(d,this.currentValue)){this.oldValue=this.currentValue;this.currentValue=d;if(!q||this.callHandlersOnRead)this._handleValueChanged();
return true}return false};l.prototype.getDefaultValue=function(){return this.defaultValue};l.prototype.setDefaultValue=function(d){this.defaultValue=d};l.prototype.exists=function(d){var w=A.variableExists(this.getValue());if(d)w=w||A.variableExists(this.getDefaultValue());return w};l.prototype.getRelativeValue=function(d,w){var y=this.getValue();if(!A.variableExists(y))y=w;var B;if(d&&!A.variableExists(y)){B=this.getDefaultValue();if(A.variableExists(B))y=B}return y};l.prototype.replaceToken=function(d,
w,y,B){var I=this.exists();var h=I?this.getValue():y;d="\\$\\{"+d+"\\}";if(B||h instanceof Array){var C;if(I)C=this.getValueAccessorString();else C=A.getAnonymousAcessor(h);return w.replace(new RegExp(d,"g"),C)}else return w.replace(new RegExp(d,"g"),h)};l.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};l.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};l.prototype.onValueChanged=function(d,
w){if(A.addToArrayIfNotExist(this.handlers,d)===-1);if(w!==false)this.startObservingForChanges()};l.prototype.deatchOnValueChanged=function(d){if(A.removeFromArray(this.handlers,d)>0);};l.prototype._handleValueChanged=function(){var d={oldValue:this.oldValue,newValue:this.currentValue,variable:this};for(var w=0;w<this.handlers.length;w++)try{this.handlers[w](d)}catch(y){}};var q=true;l.CHECK_POLL_RATE=333;l.prototype.startObservingForChanges=function(){this.addToObservedVariables();if(q){q=false;
b()}};l.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();if(g.length===0)q=true};l.prototype.addToObservedVariables=function(){A.addToArrayIfNotExist(g,this)};l.prototype.removeFromObservedVariables=function(){A.removeFromArray(g,this)};l.prototype.getObservedVariables=function(){return g};l.prototype.valuesAreEqual=function(d,w){return d===w}})();(function(){function l(r){this._lockExprObject={};l.SUPER.apply(this,arguments)}var b=f.opentag.Utils;var A=f.opentag.Timed;
f.Define.clazz("qubit.opentag.pagevariable.Expression",l,f.opentag.pagevariable.BaseVariable);l.prototype.getValue=function(){var r;var z;var g=this.value;try{if(g&&g.indexOf("[#]")===-1){var q=b.gevalAndReturn(g);r=q.result;this.failMessage=null;z=q.error}else r=l.parseUVArray(g)}catch(y){z=y}if(z){var d="could not read value of expression: \n"+g+"\nexact cause: "+z;if(this.failMessage!==d)this.failMessage=d;r=null}var w=this._updateCurrentValue(r);return r};l.parseUVArray=function(r){var z=r.split("[#]");
var g=b.gevalAndReturn(z[0]).result;var q=[];var d=z[1];if(d.indexOf(".")===0)d=d.replace(".","");for(var w=0;w<g.length;w++){var y=b.getObjectUsingPath(d,g[w]);q.push(y)}return q};l.prototype.replaceToken=function(r,z,g,q){if(this.getValue()instanceof Array)q=true;return l.SUPER.prototype.replaceToken.call(this,r,z,g,q)}})();(function(){function l(A){l.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.DOMText",l,f.opentag.pagevariable.BaseVariable);l.prototype.getValue=
function(){var A=b.getElementValue(this.value);this._updateCurrentValue(A);return A}})();(function(){function l(b){l.SUPER.apply(this,arguments);this._lockObject={}}f.Define.clazz("qubit.opentag.pagevariable.Cookie",l,f.opentag.pagevariable.BaseVariable);l.prototype.getValue=function(){var b=f.Cookie.get(this.value);this._updateCurrentValue(b);return b}})();(function(){function l(A){l.SUPER.apply(this,arguments)}var b=f.opentag.Utils;f.Define.clazz("qubit.opentag.pagevariable.URLQuery",l,f.opentag.pagevariable.BaseVariable);
l.prototype.getValue=function(){var A=b.getQueryParam(this.value);this._updateCurrentValue(A);return A}})();(function(){function l(b){l.SUPER.apply(this,arguments)}f.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",l,f.opentag.pagevariable.Expression)})();(function b(){function A(){function r(m){H.level=m}function z(m,v){H.info(m,"event emitted");v=B(v||{});v.meta=v.meta||{};v.meta.type=m;C.push(v);d();n.listeners=h(n.listeners,function(e){return!e.disposed})}function g(m,v,e){function c(){H.info("Replaying events");
q(function(){y(n.events,function(M){if(p.disposed)return;if(!I(m,M.meta.type))return;v.call(e,M)})});return E}function k(){H.info("Disposing event handler");p.disposed=true;return E}H.info("Attaching event handler for",m);var p={type:m,callback:v,disposed:false,context:e||window};n.listeners.push(p);var E={replay:c,dispose:k};return E}function q(m){H.info("Calling event handlers");G++;try{m()}catch(v){H.error("UV API Error",v.stack)}G--;d()}function d(){if(C.length===0)H.info("No more events to process");
if(C.length>0&&G>0)H.info("Event will be processed later");if(C.length>0&&G===0){H.info("Processing event");var m=C.shift();n.events.push(m);q(function(){y(n.listeners,function(v){if(v.disposed)return;if(!I(v.type,m.meta.type))return;try{v.callback.call(v.context,m)}catch(e){H.error("Error emitting UV event",e.stack)}})})}}function w(m,v,e){var c=n.on(m,function(){v.apply(e||window,arguments);c.dispose()});return c}function y(m,v){var e=m.length;for(var c=0;c<e;c++)v(m[c],c)}function B(m){var v={};
for(var e in m)if(m.hasOwnProperty(e))v[e]=m[e];return v}function I(m,v){return typeof m==="string"?m===v:m.test(v)}function h(m,v){var e=m.length;var c=[];for(var k=0;k<e;k++)if(v(m[k]))c.push(m[k]);return c}var C=[];var G=0;var H={info:function v(){if(H.level>r.INFO)return;if(console&&console.info)console.info.apply(console,arguments)},error:function e(){if(H.level>r.ERROR)return;if(console&&console.error)console.error.apply(console,arguments)}};r.ALL=0;r.INFO=1;r.ERROR=2;r.OFF=3;r(r.ERROR);var n=
{on:g,emit:z,once:w,events:[],listeners:[],logLevel:r};return n}if(typeof module==="object"&&module.exports)module.exports=A;else if(window&&window.uv===undefined)window.uv=A()})();var R={};var W=[];var X=false;var Z=false;var da=f.Define.global();var aa={allEventsByType:R,subscribe:function(b,A){if(Z){var r=u();r.on(b,A)}else W.push({on:[b,A]})},getEventHistory:function(b){return this.allEventsByType[b]},publish:function(b,A){if(Z){var r=u();r.emit(b,A)}else W.push({emit:[b,A]})},connect:function(){a()}};
aa.connect();f.Define.namespace("qubit.qprotocol.PubSub",aa);(function(){function b(g){b.SUPER.apply(this,arguments)}var A=f.qprotocol.PubSub;var r=f.opentag.Utils;var z=":";f.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",b,f.opentag.pagevariable.BaseVariable);b.prototype.init=function(){if(this.initialized)return false;else this.initialized=(new Date).valueOf();this.callHandlersOnRead=true;if(!this.handlerAttached){var g=this;var q=this.getValueAndPath(this.value);this.eventName=q[0];
this.objectPath=q[1];this.updateValue();A.subscribe(this.eventName,function(d){g.updateValue(d)});this.handlerAttached=(new Date).valueOf()}};b.prototype.getValueAndPath=function(g){var q=g;var d;if(q){var w=g.indexOf(z);if(w!==-1){q=g.substring(0,w);d=g.substring(w+1)}}return[q,d]};b.prototype.getValue=function(){this.init();return this.currentValue};b.prototype.getEventsHistory=function(){return A.getEventHistory(this.eventName)};b.prototype.updateValue=function(g){if(!g){var q=this.getEventsHistory();
if(q)g=q.current}var d;var w=this.objectPath;if(g&&w)d=r.getObjectUsingPath(w,g);else d=g;this._updateCurrentValue(d);return d};b.prototype.startObservingForChanges=function(){};b.prototype.stopObservingForChanges=function(){}})();(function(){function b(){}function A(m,v){var e=[];try{var c=m.parameters;if(c)for(var k=0;k<c.length;k++)if(m.getVariableForParameter(c[k])===v)e.push(c[k])}catch(p){}return e}var r=f.opentag.Utils;var z=f.opentag.TagsUtils;var g=f.opentag.Timed;var q=f.opentag.pagevariable.BaseVariable;
var d=f.opentag.pagevariable.Expression;var w=f.opentag.pagevariable.UniversalVariable;var y=f.opentag.pagevariable.DOMText;var B=f.opentag.pagevariable.Cookie;var I=f.opentag.pagevariable.URLQuery;f.Define.clazz("qubit.opentag.TagHelper",b);b.injectHTMLForLoader=function(m,v,e,c){var k=c!==undefined?c:m.getHtml();if(k){var p=m.config.locationPlaceHolder==="END";var E=z.getHTMLLocationForTag(m);m.injectHTMLNotFinished=true;try{if(E)z.injectHTML(E,p,k,function(){m.injectHTMLNotFinished=false;if(v)try{v()}catch(M){}}.bind(m));
else if(e&&document.readyState==="loading"){document.write(k);m.injectHTMLNotFinished=false}else m.injectHTMLFailed=(new Date).valueOf()}catch(M){m.injectHTMLNotFinished=false;m.injectHTMLFailed=(new Date).valueOf()}}};b.getAllVariablesWithParameters=function(m){var v=m.getPageVariables();var e=[];for(var c=0;c<v.length;c++){var k=v[c];var p=A(m,k);for(var E=0;E<p.length;E++)e.push({parameter:p[E],variable:k})}return e};var h={};b.allParameterVariablesReadyForTag=function(m,v){var e=v;var c=true;
var k=m.getPageVariables();for(var p=0;p<k.length;p++){var E=k[p];try{var M=A(m,E);var N=E.exists();if(!N&&e){if(M.length>0)N=!!M[0].defaultValue;N=N||E.exists(true)}if(!N){c=false;break}}catch(P){c=false;break}}return c};var C="2";var G="3";var H="4";var n="5";b.validateAndGetVariableForParameter=function(m){if(m.hasOwnProperty("variable")&&m.variable)m.variable=b.initPageVariable(m.variable);return m.variable};b.initPageVariable=function(m){if(!m||m instanceof q)return m;if(typeof m==="string"){var v=
r.getObjectUsingPath(m);if(v&&v instanceof q)return v}switch(m.type){case C:return new d(m);case G:return new I(m);case H:return new B(m);case n:return new y(m);case "EPRESSION":return new d(m);case "URL_PARAMETER":return new I(m);case "COOKIE_VALUE":return new B(m);case "DOM_VALUE":return new y(m);default:return new q(m)}}})();(function(){function b(h){this.log=new w("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.urlsLoaded=0;this.urlsFailed=0;this.runCounter=
0;this.events=new f.Events({});this._depLoadedHandler=function(){if(this.dependenciesLoaded()&&this.awaitingDependencies)this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+d++,async:true,usesDocumentWrite:false,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:false,noMultipleLoad:false,loadDependenciesOnLoad:false,restartable:true};this.restartCounter=0;this.cancelled=false;this.runtimeId=
r.UUID();this.delayDocWrite=false;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(h){if(!h.name){var C="Tag-"+d++;this.config.name=C}this.addState("INITIAL");for(var G in h)this.config[G]=h[G];if(h.genericDependencies)this.genericDependencies=this.genericDependencies.concat(h.genericDependencies);if(h.dependencies)this.dependencies=h.dependencies.concat(this.dependencies);if(h.PACKAGE)this._package=h.PACKAGE;this.onInit()}}function A(){if(this.cancelled){this._handleCancel();
return}this.waitForDependenciesFinished=(new Date).valueOf();var h=this._fullBodyNeededAndUnLoaded();var C=this._bodyNeededButNotAvailable();if(h||C)this.waitForDependenciesFinished=false;else{if(!this.timeoutCountdownStart)this.timeoutCountdownStart=(new Date).valueOf();if(this.allDependenciesLoaded())this._markLoadedSuccesfuly();else if(this._loadingOutOfTimeFrames()){this.loadingTimedOut=(new Date).valueOf();if(this.allDependenciesLoaded(true))this._markLoadedSuccesfuly();else{this.addState("TIMED_OUT");
this._markLoadingDependenciesFailed();this._triggerOnLoadTimeout()}}else this.waitForDependenciesFinished=false}if(!this.waitForDependenciesFinished)this._setTimeout(A.bind(this),65);else this.addState("LOADED_DEPENDENCIES")}var r=f.opentag.Utils;var z=f.opentag.TagsUtils;var g=f.opentag.Timed;var q=f.opentag.TagHelper;var d=0;var w=f.opentag.Log;f.Define.clazz("qubit.opentag.GenericLoader",b);var y="after";var B="before";var I="restart";b.prototype.EVENT_TYPES={AFTER_EVENT:y,BEFORE_EVENT:B,RESTART_EVENT:I};
b.prototype.onInit=F;b.prototype.LOADING_TIMEOUT=5*1E3;b.prototype.getHtml=function(){if(this.config.html)return this.config.html;if(this.htmlContent)return r.trim(this.htmlContent);return null};b.prototype._executeScript=function(){var h=false;try{this.script();h=true}catch(C){this.addState("EXECUTED_WITH_ERRORS");this.executedWithErrors=(new Date).valueOf();this._onError(C)}finally{this._onExecute(h)}};b.prototype.getTimeout=function(){return this._getTimeout()};b.prototype._getTimeout=function(h){var C=
+this.config.timeout;var G=this.dependencies;if(C!==-1&&G.length>0){var H=0;h=h||[];var n=r.indexInArray(h,this)!==-1;if(!n){h[h.length]=this;for(var m=0;m<G.length;m++){var v=G[m]._getTimeout(h);if(v>H)H=v}if(H>0)C+=H}else return 0}return C};b.prototype._onExecute=function(h){this.onExecute(h)};b.prototype.onExecute=F;b.prototype._flushDocWrites=function(h){var C=true;this._docWriteNotFlushed=false;try{var G=z.getHTMLLocationForTag(this);if(G&&this._securedWrites&&this._securedWrites.length>0){var H=
this.config.locationPlaceHolder==="END";C=z.flushDocWritesArray(this._securedWrites,G,H,this.log,h);if(C)this._docWriteFlushed=(new Date).valueOf();else this._docWriteNotFlushed=(new Date).valueOf()}}catch(n){this._onError(n)}if(h)h();if(this._securedWrites&&this._securedWrites.length>0){C=false;this._docWriteNotFlushed=(new Date).valueOf()}return C};b.prototype.log=F;b.prototype.finished=function(){return!!this.runIsFinished};b.prototype.script=function(){};b.prototype.before=function(){this.beforeRun=
(new Date).valueOf();try{this.events.call(B,this)}catch(h){this._onError(h)}};b.prototype.onBefore=function(h){this.events.on(B,h)};b.prototype.after=function(h){this.afterRun=(new Date).valueOf();try{this.events.call(y,{success:h,tag:this})}catch(C){this._onError(C)}};b.prototype.onAfter=function(h){this.events.on(y,h)};b.prototype.runOnce=function(){if(!this._runOnceTriggered&&!this.scriptExecuted){this._runOnceTriggered=(new Date).valueOf();this.run()}};b.CANCEL_ALL=false;b.prototype.run=function(){if(!isNaN(this.config.runningLimit))if(this.config.runningLimit<=
this.runCounter)return false;if(this.cancelled||b.CANCEL_ALL){this._handleCancel();return false}if(this.isRunning)return false;if(this.lastRun)this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;if(!this._ignoreDeps&&!this.dependenciesLoaded()){this._attachDepsEventsToContinue();return false}return this._triggerLoadingAndExecution()};b.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();
this.load();if(this._ignoreDeps)this.execute();else this.waitForDependenciesAndExecute();return true};b.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();var h=this.dependencies;for(var C=0;C<h.length;C++)try{h[C].events.on("success",this._depLoadedHandler)}catch(G){}};b.prototype.dependenciesLoaded=function(){var h=this.dependencies;for(var C=0;C<h.length;C++)if(h[C]!==this){var G=+h[C].scriptExecuted>0;if(!G)return false}return true};b.prototype._setTimeout=
function(h,C){this._wasTimed=(new Date).valueOf();var G=this.runtimeId;var H=function(){if(this.runtimeId===G)return h()}.bind(this);return g.setTimeout(H,C)};b.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(h){this._onError(h)}};b.prototype.waitForDependenciesAndExecute=function(){if(this.loadedDependencies)this.execute();else if(this.loadingDependenciesFailed){this._markFailure();this._markFinished()}else this._setTimeout(this.waitForDependenciesAndExecute.bind(this),
30)};b.prototype.execute=function(){this._triggerExecution()};b.prototype._triggerExecution=function(){if(this.cancelled){this._handleCancel();return}if(this.scriptExecuted)return;var h=true;if(this.shouldWaitForDocWriteProtection())h=false;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();var C=false;try{C=this.before()}catch(H){this._onError(H)}if(C){this._markFailure();this._markFinished();return}}h=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(this.scriptExecuted)return;
if(this.unexpectedFail)h=true;if(!h)this._setTimeout(this._triggerExecution.bind(this),30);else{this._flushDocWrites();if(this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail)this._markFailure();else{this.scriptExecuted=(new Date).valueOf();this.addState("EXECUTED");this._executeScript()}if(this.cancelled){this._handleCancel();return false}else{var G=this.scriptExecuted>0;try{if(!this.afterRun){this.afterRun=(new Date).valueOf();this.after(G)}}catch(H){this.executedWithErrors=(new Date).valueOf()}if(!this.executedWithErrors)if(G)this.events.call("success")}this._flushDocWrites();
this._markFinished()}};b.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};b.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=false;if(b.LOCK_DOC_WRITE===this){this._flushDocWrites();z.unlockDocumentWrites();b.LOCK_DOC_WRITE=false}this.onFinished(true)};b.prototype.onFinished=F;b.prototype.onCancel=F;b.prototype.onFinished=F;b.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!b.LOCK_DOC_WRITE){b.LOCK_DOC_WRITE=
this;this._secureWriteAndCollectForExecution()}else if(b.LOCK_DOC_WRITE!==this){if(!this._lockedDocWriteInformed)this._lockedDocWriteInformed=(new Date).valueOf();return true}return false};b.prototype.runWithoutDependencies=function(){this.ignoreDependencies=true;this.run()};b.prototype.loadExecutionURLsAndHTML=function(h){if(this.cancelled){this._handleCancel();return true}if(!this._loadExecutionURLsAndHTMLInformed)this._loadExecutionURLsAndHTMLInformed=true;this._triggerURLsLoading(h);if(!this.loadURLsNotFinished){this._flushDocWrites();
this._triggerHTMLInjection();this._flushDocWrites();if(!this.injectHTMLNotFinished){this._flushDocWrites();if(!this._docWriteNotFlushed){if(this._docWriteFlushed);return true}}}return false};b.prototype._triggerURLsLoading=function(h){if(!this._urlLoadTriggered&&this.config.url){this._urlLoadTriggered=true;this.loadURLs(false,h)}};b.prototype._triggerHTMLInjection=function(){if(!this._injectHTMLTriggered&&this.getHtml()){this._injectHTMLTriggered=true;this.injectHTML()}};b.prototype.STATE={INITIAL:0,
STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:2048*2};b.prototype.addState=function(h){if(this.STATE.hasOwnProperty(h)){this.state=this.state|this.STATE[h];try{this.onStateChange(h)}catch(C){this._onError(C)}}};b.prototype.onStateChange=F;b.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};
b.prototype.unCancel=function(){this.cancelled=false};b.prototype.state=b.prototype.STATE.INITIAL;b.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};b.prototype._secureWriteAndCollectForExecution=function(){if(!this._securedWrites){this._securedWrites=[];z.redirectDocumentWritesToArray(this._securedWrites,this.log)}};b.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=
(new Date).valueOf()};b.prototype.allDependenciesLoaded=function(h,C){return this.getDependenciesToBeLoaded(h,C).length===0};b.prototype.getDependenciesToBeLoaded=function(h,C){var G=C||[];if(!this.injectionLocationReady())G.push("injection location");var H;var n=this.dependencies;for(H=0;H<n.length;H++)if(n[H]!==this){var m=+n[H].scriptExecuted>0;if(!m){var v=n[H].config?n[H].config.name:"anonymous";G.push("dependant Tag with name -\x3e "+v)}}for(H=0;H<this.genericDependencies.length;H++){var e=
this.genericDependencies[H](this);if(!e)G.push("this.genericDependencies["+H+"] (index: "+H+")")}if(G!=="");return G};b.prototype.docWriteAsksToWaitForBody=function(){return!!(this.delayDocWrite&&this.config.usesDocumentWrite)};b.prototype._bodyNeededButNotAvailable=function(){if(this._dontWaitForInjections())return false;return this._isBodyLocationNeeded()&&!z.bodyAvailable()};b.prototype._isBodyLocationNeeded=function(){if(!this.isLoadingAsynchronously())return false;if(this._isBodyLocationSet())return true;
else{var h=this.config.locationObject==="HEAD";return h&&this.config.locationPlaceHolder==="END"}};b.prototype._isBodyLocationSet=function(){var h=this.config.locationObject;return!h||h==="BODY"};b.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return false;var h=false;if(this._isBodyLocationNeeded())h=this.config.locationPlaceHolder==="END";h=h||(this.fullbodyNeeded||this.docWriteAsksToWaitForBody());return h&&!r.bodyReady()};b.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||
this.dontWaitForInjectionLocation||b.dontWaitForInjectionLocation};b.prototype.injectionLocationReady=function(){if(this._dontWaitForInjections())return true;if(this._fullBodyNeededAndUnLoaded())return false;if(!this.isLoadingAsynchronously())return true;return!!z.getHTMLLocationForTag(this)};b.prototype._loadingOutOfTimeFrames=function(){if(this.getTimeout()<0)return false;return(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};b.prototype.loadDependencies=function(){this._loadDependencies()};
b.prototype.addClientDependenciesList=function(h,C){return this.addDependenciesList(h,f.Define.clientSpaceClasspath())};b.prototype.addDependenciesList=function(h,C){if(!h||h.length===0)return;if(!this.failedDependenciesToParse)this.failedDependenciesToParse=[];var G=this.dependencies;for(var H=0;H<h.length;H++){var n=h[H];var m=false;if(n instanceof b)G.push(n);else if(typeof n==="string"){var v=n;if(C)n=C+"."+n;var e=r.getObjectUsingPath(n);if(e)if(e instanceof b)G.push(e);else m=true;else this.failedDependenciesToParse.push(v)}else m=
true;if(m){this.badDepsObjects=this.badDepsObjects||[];r.addToArrayIfNotExist(this.badDepsObjects,n)}}};b.prototype._loadDependencies=function(h){h=h||[];var C=this.dependencies;var G=r.indexInArray(h,this)!==-1;if(!G){h[h.length]=this;for(var H=0;H<C.length;H++)C[H].load(h)}};b.prototype.onError=F;b.prototype._onError=function(h){try{this.onError(h)}catch(C){}};b.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};b.prototype.onLoadTimeout=F;b.prototype.onScriptsLoadSuccess=F;b.prototype.onScriptLoadError=
F;b.prototype.onAllDependenciesLoaded=F;b.prototype.onBeforeLoad=null;b.prototype.load=function(){if(this.loadStarted)return;else{this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(h){this._onError(h)}}this.addState("LOADING_DEPENDENCIES");try{if(!this._ignoreDeps&&this.config.loadDependenciesOnLoad)this.loadDependencies()}catch(h){throw h;}A.call(this)};b.prototype._singleUrlLoadHandler=function(h,C,G){++this.urlsLoaded;if(!h)++this.urlsFailed;if(this.urlsLoaded===
C.length){this.loadURLsNotFinished=false;if(h&&this.urlsFailed===0){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{if(G)G(true)}catch(n){this._onError(n)}finally{this.onScriptsLoadSuccess()}}else{var H="error loading urls. Failed "+this.urlsFailed;this._onError(H);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=true;if(G)G(false)}catch(n){this._onError(n)}finally{this.onScriptLoadError(H)}}}};b.prototype.loadURLs=function(h,
C){var G=h||this.config.url;this.addState("LOADING_URL");try{if(G&&!(G instanceof Array))G=[G];for(var H=0;H<G.length;H++){this.loadURLsNotFinished=true;var n=G[H];n=this.prepareURL(n);this.loadURL(n,function(m){this._singleUrlLoadHandler(m,G,C)}.bind(this))}}catch(m){this.loadURLsNotFinished=false;this.addState("UNEXPECTED_FAIL");this.unexpectedFail=(new Date).valueOf();this._onError(m)}};b.prototype.prepareLocationObject=function(h){return h};b.prototype.prepareURL=function(h){return h};b.prototype.prepareHTML=
function(h){return h};b.prototype.loadURL=function(h,C,G){var H=h;this.addState("LOADING_URL");z.loadScript({onsuccess:function(){try{if(C)C(true)}catch(n){}}.bind(this),onerror:function(){try{if(C)C(false)}catch(n){}}.bind(this),url:H,node:G||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};b.prototype.onRestart=function(h){this.events.on(I,h)};b.prototype.prepareForRestart=function(){if(this.config.restartable){var h=this.restartCounter+1;
this.events.call(I,this);this.reset();this.restartCounter=h}};b.prototype.restart=function(){if(this.config.restartable){this.prepareForRestart();this.run()}};b.prototype.reset=function(){var h;this._injectHTMLTriggered=h;this._loadExecutionURLsAndHTMLInformed=h;this._lockedDocWriteInformed=h;this._runOnceTriggered=h;this._urlLoadTriggered=h;this.afterRun=h;this.beforeRun=h;this.filtersRunTriggered=h;this.injectHTMLFailed=h;this.loadStarted=h;this.loadURLsNotFinished=h;this.loadedDependencies=h;this.loadingDependenciesFailed=
h;this.loadingTimedOut=h;this.runIsFinished=h;this.scriptExecuted=h;this.scriptLoadingFailed=h;this.delayDocWrite=h;this._securedWrites=h;this.state=0;this.unexpectedFail=h;this.urlsFailed=0;this.urlsLoaded=0;this.waitForDependenciesFinished=h;this.isRunning=h;this.lastRun=h;this.cancelled=h;this._beforeEntered=h;this.awaitingDependencies=h;this.timeoutCountdownStart=h;this.restartCounter=0;this.runtimeId=r.UUID();this.addState("INITIAL")};b.prototype.isLoadingAsynchronously=function(){if(this._wasTimed)return true;
return!!(this.config.async||this.forceAsynchronous)};b.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};b.prototype.injectHTML=function(h){var C=!this.docWriteAsksToWaitForBody();var G=this.prepareHTML(this.getHtml());if(G)q.injectHTMLForLoader(this,h,C,G)};b.prototype.clone=function(){var h=new b(this.config);return h}})();(function(){function b(e){var c={filterTimeout:e&&e.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:e&&e.PACKAGE,
dedupe:false,needsConsent:false,inactive:false,variables:null,runner:null,disabled:false,locked:false,reRunOnVariableChange:false};r.setIfUnset(e,c);b.SUPER.apply(this,arguments);this.namedVariables={};this._runtimeMarkers={};this.parameters=[];this.filters=[];this.session=null;this.owningContainer=null;this.pingSent=false;this.oldPingSent=false;this.dedupePingSent=false;this.oldDedupePingSent=false;this.reRunCounter=0;if(e){this.addState("INITIAL");try{b.register(this)}catch(k){}this.setupConfig(e);
this.uniqueRefString=null;if(e.init)try{e.init.call(this,e)}catch(k){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function A(e,c){var k=e.namedVariables;var p=w.initPageVariable(k[c]);k[c]=p;return p}var r=f.opentag.Utils;var z=f.opentag.TagsUtils;var g=f.opentag.Timed;var q=f.opentag.filter.BaseFilter;var d=f.opentag.GenericLoader;var w=f.opentag.TagHelper;var y=f.opentag.pagevariable.BaseVariable;var B=f.Cookie;var I=f.Define;I.clazz("qubit.opentag.BaseTag",
b,d);b.prototype.setupConfig=function(e){if(!e)return;if(e.filters)this.addFilters(e.filters);if(e.parameters)this.addParameters(e.parameters);if(e.variables)for(var c in e.variables)if(e.variables.hasOwnProperty(c)){var k=this.getParameterByTokenName(c);if(k){var p=e.variables[c];k.variable=p;if(p.defaultValue!==undefined)k.defaultValue=p.defaultValue;if(p.uv!==undefined)k.uv=p.uv}}if(e.locked)this.lock()};b.prototype.valueForToken=function(e,c){var k=this.getParameterByTokenName(e);if(k){if(c===
undefined)if(this.loadingTimedOut)c=true;return this.getParameterValue(k,c)}var p=this.namedVariables;if(p&&p[e]){var E=A(this,e);if(E)return E.getRelativeValue(c)}return undefined};b.prototype.addParameters=function(e){this.parameters=this.parameters.concat(e)};b.prototype.LOADING_TIMEOUT=5*1E3;b.prototype.FILTER_WAIT_TIMEOUT=-1;b.prototype._isVariable=function(e){return e!==null&&e!==undefined};b.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();this.runPostInitialisationSection();
var e=this.parameters;if(e)for(var c=0;c<e.length;c++){var k=this.getVariableForParameter(e[c]);if(!this._isVariable(k)){this._markLoadingDependenciesFailed();this._markFinished();return}}if(this.config.runner){var p=false;try{this.addState("AWAITING_CALLBACK");p=this._runner=(new Date).valueOf();this.config.runner.call(this)}catch(E){}return p}else{this._runner=false;return this.start()}};b.prototype.lock=function(){this.locked=true;this._unlock=null};b.prototype.unlock=function(){this.locked=false;
if(this._unlock){this._unlock();this._unlock=false}};b.prototype.start=function(){if(!this.locked)return b.SUPER.prototype.run.call(this);else{this._unlock=function(){return b.SUPER.prototype.run.call(this)}.bind(this);return false}};b.prototype.startOnce=function(){if(!this.locked)return b.SUPER.prototype.runOnce.call(this);else{this._unlock=function(){return b.SUPER.prototype.runOnce.call(this)}.bind(this);return false}};b.prototype.getFilters=function(){return this.filters};b.prototype.runOnceIfFiltersPass=
function(){if(!this._runOnceIfFiltersPassTriggered&&!this.scriptExecuted){this._runOnceIfFiltersPassTriggered=(new Date).valueOf();this.runIfFiltersPass()}};b.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();this.runPostInitialisationSection();var e=this.filtersState(true);this.addState("FILTER_ACTIVE");if(!this.filtersRunTriggered)this.filtersRunTriggered=(new Date).valueOf();if(e===q.state.SESSION){this.addState("AWAITING_CALLBACK");this.awaitingCallback=
(new Date).valueOf()}else if(e===q.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(k){}this.run()}else if(e===q.state.FAIL){this._markFiltersFailed();this._markFinished()}else if(e>0){var c=this.config.filterTimeout;if(c<0||(new Date).valueOf()-this.filtersRunTriggered>c){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(k){}}this._setTimeout(this.runIfFiltersPass.bind(this),e)}else{this._markFiltersFailed();
this._markFinished();this.filtersRunTimedOut=(new Date).valueOf()}}try{this.onFiltersCheck(e)}catch(k){}return e};b.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};b.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,
TIMED_OUT:4096*2,UNEXPECTED_FAIL:4096*2*2,CANCELLED:4096*2*2*2};b.prototype.addState=function(e){b.SUPER.prototype.addState.call(this,e);try{b.onStateChange(this)}catch(E){}this.stateStack=[];var c=this.STATE;var k=this.state;var p=this.stateStack;if(k&c.INITIAL)p.push("Initial state.");if(k&c.FILTER_ACTIVE)p.push("Tag running with filters pass triggered.");if(k&c.FILTERS_FAILED)p.push("Filters failed to pass.");if(k&c.AWAITING_CALLBACK)p.push("Awaiting callback to run this tag. Not pooling.");if(k&
c.STARTED)p.push("Tag is initialised and loading has been started.");if(k&c.LOADING_DEPENDENCIES)p.push("Dependencies are being loaded.");if(k&c.LOADED_DEPENDENCIES)p.push("Dependencies loading process has been finished.");if(k&c.LOADING_URL)p.push("External URL is being loaded.");if(k&c.LOADED_URL)p.push("External URL has been loaded.");if(k&c.EXECUTED)p.push("Main script has been executed.");if(k&c.EXECUTED_WITH_ERRORS)p.push("Main script has been executed but errors occured.");if(k&c.FAILED_TO_LOAD_DEPENDENCIES)p.push("Dependencies has failed to load.");
if(k&c.FAILED_TO_LOAD_URL)p.push("URL location failed to load.");if(k&c.FAILED_TO_EXECUTE)p.push("Script failed to execute.");if(k&c.TIMED_OUT)p.push("Script timed out awaiting for dependencies.");if(k&c.UNEXPECTED_FAIL)p.push("Script occured UNEXPECTED exception and is failed.");if(k&c.CANCELLED)p.push("Tag has been cancelled.")};b.prototype.onTagInit=F;b.prototype.postInitialisationSection=F;b.onStateChange=F;b.prototype.onFiltersDelayed=F;b.prototype.onFiltersPassed=F;b.prototype.onFiltersCheck=
F;b.prototype.state=b.prototype.STATE.INITIAL;b.prototype.arePageVariablesLoaded=function(e){return w.allParameterVariablesReadyForTag(this,e)};b.prototype.getDependenciesToBeLoaded=function(e,c){var k=c||[];if(!this.arePageVariablesLoaded(e))k.push("page variables");return b.SUPER.prototype.getDependenciesToBeLoaded.call(this,e,k)};b.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};b.prototype.resolveDependencies=function(){var e=
this.failedDependenciesToParse;if(e){this.failedDependenciesToParse=null;this.addDependenciesList(e,I.clientSpaceClasspath())}return this.dependencies};b.prototype.addClientVariablesMap=function(e){this.unresolvedClientVariablesMap=this._addVariablesMap(e,I.clientSpaceClasspath());return this.unresolvedClientVariablesMap};b.prototype.resolvePageVariables=function(){var e=this.unresolvedClientVariablesMap;if(e){this.unresolvedClientVariablesMap=null;this.addClientVariablesMap(e)}e=this.unresolvedVariablesMap;
if(e){this.unresolvedVariablesMap=null;this.addVariablesMap(e)}return this.getPageVariables()};b.prototype.addVariablesMap=function(e){this.unresolvedVariablesMap=this._addVariablesMap(e);return this.unresolvedVariablesMap};b.prototype._addVariablesMap=function(e,c){if(!e)return;var k={};var p=this.namedVariables;for(var E in e)if(e.hasOwnProperty(E)){var M=e[E];if(M instanceof y)p[E]=M;else if(typeof M==="string"){var N=M;if(c)M=c+"."+M;var P=r.getObjectUsingPath(M);if(P)if(P instanceof y)p[E]=P;
else p[E]=M;else k[E]=N}else;}return k};b.prototype.prepareURL=function(e){return this.replaceTokensWithValues(e)};b.prototype.prepareLocationObject=function(e){return this.replaceTokensWithValues(e)};b.prototype.prepareHTML=function(e){if(e)e=this.replaceTokensWithValues(e);return e};b.prototype._executeScript=function(){if(this.config&&this.config.script)if(typeof this.config.script==="function")this.script=this.config.script;else{var e=this.replaceTokensWithValues(String(this.config.script));this.script=
r.expressionToFunction(e).bind(this)}b.SUPER.prototype._executeScript.call(this)};b.prototype.replaceTokensWithValues=function(e){if(!e||e.indexOf("${")===-1)return e;var c=this.parameters;if(c)for(var k=0;k<c.length;k++){var p=c[k];var E=this.getVariableForParameter(p);if(E){var M=c[k].token;var N=this.valueForToken(M);e=E.replaceToken(M,e,N)}}return e};b.prototype.getParameter=function(e){var c=this.parameters;var k=null;if(c)for(var p=0;p<c.length;p++)if(c[p].name===e)k=c[p];return k};b.prototype.setParameterValueByTokenName=
function(e,c){var k=this.getParameterByTokenName(e);if(k!==null){k.variable={value:c};return true}return false};b.prototype.getParameterValue=function(e,c){var k=typeof e==="string"?this.getParameter(e):e;if(k){var p=this.getVariableForParameter(k);if(p)try{var E;if(c&&k.defaultValue!=="")E=r.gevalAndReturn(k.defaultValue).result;E=p.getRelativeValue(c,E);return E}catch(M){return undefined}}return undefined};b.prototype.filtersState=function(e){var c=e;return z.filtersState(this.filters,this.session,
this,c)};b.prototype.addFilter=function(e){r.addToArrayIfNotExist(this.filters,e)};b.prototype.addFilters=function(e){for(var c=0;c<e.length;c++)this.addFilter(e[c])};b.prototype.addClientFiltersList=function(e){this.unresolvedClientFilterClasspaths=this.addFiltersList(e,I.clientSpaceClasspath());return this.unresolvedClientFilterClasspaths};b.prototype.resolveFilters=function(){var e=this.unresolvedClientFilterClasspaths;if(e){this.unresolvedClientFilterClasspaths=null;this.addClientFiltersList(e)}return this.filters};
b.prototype.addFiltersList=function(e,c){var k=[];for(var p=0;p<e.length;p++)try{var E=e[p];var M=E;var N=null;if(typeof E==="string"){N=E;if(c)E=c+"."+E;E=r.getObjectUsingPath(E)}if(typeof E==="function"){var P=E;E=new P}if(!E);if(!E instanceof q)E=null;if(E)this.addFilter(E);else if(N)r.addToArrayIfNotExist(k,N)}catch(Q){this.failedFilters=this.failedFilters||[];this.failedFilters.push(e[p])}return k};b.prototype.reset=function(){b.SUPER.prototype.reset.call(this);var e;this.filtersPassed=e;this.dedupePingSent=
false;this.oldDedupePingSent=false;this.pingSent=false;this.oldPingSent=false;this._runOnceIfFiltersPassTriggered=e;this.filtersRunTriggered=e;this._runner=e;this.reRunCounter=0;this.detachVariablesChangedListeners()};b.prototype.resetFilters=function(){for(var e=0;e<this.filters.length;e++)this.filters[e].reset()};b.prototype.getParameterByTokenName=function(e){var c=null;if(this.parameters){var k=this.parameters;for(var p=0;p<k.length;p++)if(k[p].token===e)c=k[p]}return c};b.prototype.removeFilter=
function(e){r.removeFromArray(this.filters,e)};var h=0;var C=[];var G={};var H={};b.register=function(e){var c=r.addToArrayIfNotExist(C,e);if(c===-1)e._tagIndex=C.length-1;else e._tagIndex=c;if(e.config.id){var k="Q"+e.config.id;H[k]=e;e.uniqueId=k}else H[e.CLASSPATH]=e};b.getById=function(e){return H[String(e)]};b.prototype.getById=b.getById;b.prototype.unregister=function(e){b.unregister(e||this)};b.prototype.destroy=function(){this.destroyed=true;this.cancel();b.unregister(this)};b.unregister=
function(e){var c=r.removeFromArray(C,e);e._tagIndex=-1};b.getTags=function(){return C};b.getAccessorsMap=function(){return G};b.prototype.getTags=function(){return C};b.prototype.getPageVariables=function(){var e=this.parameters;var c=[];if(e)for(var k=0;k<e.length;k++){var p=this.getVariableForParameter(e[k]);if(this._isVariable(p))r.addToArrayIfNotExist(c,p)}if(this.namedVariables)for(var E in this.namedVariables)r.addToArrayIfNotExist(c,A(this,E));return c};b.prototype.getAccessorString=function(){if(!this._accessorsMapKey){this._accessorsMapKey=
"_"+h++;G[this._accessorsMapKey]=this}return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};b.prototype.getVariableForParameter=function(e){var c;var k=this.namedVariables;if(k&&k[e.token])c=A(this,e.token);if(!c)c=w.validateAndGetVariableForParameter(e);return c};b.prototype.printVariablesState=function(){var e=[];var c=w.getAllVariablesWithParameters(this);for(var k=0;k<c.length;k++){var p=c[k].parameter;var E=c[k].variable;var M;if(p&&p.token)M=this.valueForToken(p.token);else M=
E.getRelativeValue(true);var N={name:E.config.name,exists:E.exists(),token:p?p.token:null,value:M,variable:E};e.push(N)}return e};b.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};b.prototype.getId=function(){return this._getUniqueId()};b.prototype._getUniqueId=function(){if(this.config.id)return this.config.id;if(String(this.CLASSPATH).indexOf(I.STANDARD_CS_NS)===0)return this.CLASSPATH.substring(I.STANDARD_CS_NS.length+1);else return this.CLASSPATH+"#"+this.config.name};var n="qubit.tag.forceRunning_";
var m="qubit.tag.disableRunning_";var v="qubit.tag.forceAllToRun";b.prototype.cookieSaysToRunEvenIfDisabled=function(){var e=this._getUniqueId();var c=!!B.get(v);if(!c)c=!!B.get(n+e);return c};b.prototype.setCookieForcingTagToRun=function(){var e=this._getUniqueId();B.set(n+e,"true")};b.setCookieForcingTagsToRun=function(){B.set(v,"true")};b.prototype.setCookieToDisable=function(){var e=this._getUniqueId();B.set(m+e,"true")};b.prototype.rmCookieToDisable=function(){var e=this._getUniqueId();B.rm(m+
e)};b.prototype.disabledByCookie=function(){var e=this._getUniqueId();return!!B.get(m+e)};b.rmCookieForcingTagsToRun=function(){B.rm(v)};b.prototype.rmCookieForcingTagToRun=function(){var e=this._getUniqueId();B.rm(n+e)};b.rmAllDisablingCookies=function(){r.rmCookiesMatching(m)};b.rmAllCookiesForcingTagToRun=function(){r.rmCookiesMatching(n);b.rmCookieForcingTagsToRun()};b.prototype.onVariableChanged=function(e){this.attachVariablesChangedListeners(true);this.events.on("variableChanged",e)};b.prototype._handleVariableChange=
function(e){this.events.call("variableChanged",e);if(!this.isRunning&&this.config.reRunOnVariableChange){if(!isNaN(this.config.reRunLimit))if(this.config.reRunLimit<=this.reRunCounter)return;var c=this.reRunCounter+1;this.reset();this.reRunCounter=c;this.resetFilters();this.runIfFiltersPass()}};b.prototype.attachVariablesChangedListeners=function(e){var c=this.getPageVariables();var k=!!(this.config.reRunOnVariableChange||this.config.observeVariables||e);if(k)for(var p=0;p<c.length;p++){var E=c[p];
E.onValueChanged(this.handleVariableChange,k)}};b.prototype.detachVariablesChangedListeners=function(){var e=this.getPageVariables();for(var c=0;c<e.length;c++){var k=e[c];k.deatchOnValueChanged(this.handleVariableChange)}};b.prototype._markFinished=function(){b.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()};b.prototype.prepareForRestart=function(e){if(this.config.restartable){b.SUPER.prototype.prepareForRestart.call(this,false);if(!e){var c=this.getFilters();for(var k=
0;k<c.length;k++)c[k].prepareForRestart()}}};b.prototype.restart=function(e){if(this.config.restartable){this.prepareForRestart(e);this.runIfFiltersPass()}};b.prototype.runPostInitialisationSection=function(){if(!this._postInitialisationRun){this._postInitialisationRun=true;if(this.postInitialisationSection)try{this.postInitialisationSection()}catch(e){}}}})();(function(){function b(g){r.setIfUnset(g,b.defaultConfig);if(this.singleton){var q=this.PACKAGE_NAME+"."+this.CLASS_NAME;var d=f.opentag.Utils.getObjectUsingPath(q,
t);if(d.__instance)return d.__instance;d.__instance=this}b.SUPER.call(this,g)}function A(g,q){var d=g.toString();d=d.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,"");d=d.substring(0,d.lastIndexOf("}"));d=d.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"');d=d.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2');d=d.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"');d=d.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,
'"${$1}"$2');d=d.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3");d=d.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3");d=q.replaceTokensWithValues(d);r.geval(d)}var r=f.opentag.Utils;var z=f.Define;f.Define.clazz("qubit.opentag.LibraryTag",b,f.opentag.BaseTag);b.defaultConfig={vendor:null,imageUrl:null,description:"",async:false,isPrivate:false,upgradeable:true,html:"",parameters:[],prePostWindowScope:false};b.prototype.pre=function(){};
b.prototype.post=function(){};b.prototype.before=function(){b.SUPER.prototype.before.call(this);try{var g=this.config;if(g&&g.pre)if(typeof g.pre==="function")this.pre=g.pre;else{var q=this.replaceTokensWithValues(String(g.pre));this.pre=r.expressionToFunction(q).bind(this)}if(this.config.prePostWindowScope&&this.pre!==b.prototype.pre&&this.pre.toString)A(this.pre,this);else this.pre()}catch(d){return true}return false};b.prototype.after=function(g){b.SUPER.prototype.after.call(this,g);try{var q=
this.config;if(q&&q.post)if(typeof q.post==="function")this.post=q.post;else{var d=this.replaceTokensWithValues(String(q.post));this.post=r.expressionToFunction(d).bind(this)}if(this.config.prePostWindowScope&&this.post!==b.prototype.post&&this.post.toString)A(this.post,this);else this.post(g)}catch(w){}};b.define=function(g,q){g=g.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");g=f.Define.vendorsSpaceClasspath(g);var d={};if(q.getDefaultConfig)d=q.getDefaultConfig();var w=q.CONSTRUCTOR;
var y={};for(var B in q)if(B!=="config")y[B]=q[B];var I=function(G){G=G||{};G=r.overrideFromLeftToRight(d,G);var H=f.opentag.LibraryTag.call(this,G);if(w)w.call(this,G);if(H)return H};var h=f.opentag.Utils.defineWrappedClass(g,b,y,J,I);var C=z.STANDARD_VS_NS+".";if(g.indexOf(C)!==0)r.namespace(C+g,h);return h};b.getLibraryByClasspath=function(g){return r.getObjectUsingPath(g,f.Define.getVendorSpace())}})();(function(){function b(r){var z={url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",
async:true};A.setIfUnset(r,z);b.SUPER.call(this,r)}var A=f.opentag.Utils;f.Define.clazz("qubit.opentag.CustomTag",b,f.opentag.LibraryTag)})();(function(){var b=f.opentag.Utils;var A=f.opentag.filter.BaseFilter;var r=function(){};f.Define.clazz("qubit.opentag.Tags",r);r.getById=function(g){return f.opentag.BaseTag.getById(String(g))};r.getAllTagsByState=function(){return f.opentag.Container.getAllTagsByState(r.getTags())};r.findTagByName=function(g){var q=this.getTags();var d=[];for(var w=0;w<q.length;w++)if(q[w].config.name===
g)d.push(q[w]);return d};r.findTagByMatch=function(g){var q=this.getTags();var d=[];for(var w=0;w<q.length;w++)if(q[w].config.name.match(g))d.push(q[w]);return d};r.findTagContainers=function(g){var q=r.getContainers();var d=[];for(var w=0;w<q.length;w++){var y=q[w].tags;for(var B in y)if(y[B]===g){d.push(q[w]);break}}return d};r.getTags=function(){return f.opentag.BaseTag.getTags()};r.resetAllTags=function(g){var q=r.getTags();for(var d=0;d<q.length;d++){q[d].reset();if(!g)q[d].resetFilters()}};
r.getContainersPageVariables=function(){var g=r.getContainers();var q=[];for(var d=0;d<g.length;d++)q=q.concat(g.getPageVariables());return q};r.getAllPageVariables=function(){var g=r.getTags();var q=[];for(var d=0;d<g.length;d++)q=q.concat(g[d].getPageVariables());return q};r.cancelAll=function(){var g=r.getTags();for(var q=0;q<g.length;q++)g[q].cancel()};r.resetAll=function(g){var q=r.getTags();for(var d=0;d<q.length;d++){q[d].reset();if(!g)q[d].resetFilters()}};r.getPageVariableByName=function(g){var q=
r.getAllPageVariables();var d=[];for(var w=0;w<q.length;w++)if(q[w].config.name===g)d.push(q[w]);return d};r.getLoadTime=function(g){var q=g.beforeRun;var d=g.runIsFinished;if(isNaN(d))return{tag:g,loadTime:null};else return{tag:g,loadTime:d-q}};r.getLoadTimes=function(g){var q=[];if(g instanceof f.opentag.BaseTag){q.push([r.getLoadTime(g[y])]);return q}g=g||r.getTags();var d=g instanceof Array;if(d)for(var w=0;w<g.length;w++){if(g[w]instanceof f.opentag.BaseTag)q.push(r.getLoadTime(g[w]))}else for(var y in g)if(g[y]instanceof
f.opentag.BaseTag)q.push(r.getLoadTime(g[y]));return q};r.forceAllContainersAndTagsToRunIfDisabled=function(){f.opentag.Container.setCookieForDisabledContainersToRun();f.opentag.BaseTag.setCookieForcingTagsToRun()};r.rmAllContainersAndTagsForcingFlags=function(){f.opentag.Container.rmCookieForDisabledContainersToRun();f.opentag.BaseTag.rmAllCookiesForcingTagToRun()};r.getContainers=function(){return f.opentag.Container.getContainers()};r.findAllTagsByClassPath=function(g){var q=(new Date).valueOf();
var d=[];var w=[];try{w.push(f.opentag.CustomTag);w.push(f.opentag.LibraryTag)}catch(h){}var y=r.getTags();for(var B=0;B<y.length;B++){var I=y[B];if(b.indexInArray(w,I)<0&&I.PACKAGE_NAME.indexOf(g)===0)d.push(I)}return d};r.findAllTags=function(g,q){var d=f.opentag.BaseTag;var w;var y=[];var B=(new Date).valueOf();try{y.push(f.opentag.CustomTag);y.push(f.opentag.LibraryTag)}catch(I){}w=r.findAllInstances(g,d,y,q);return w};var z=function(g,q,d,w){var y=[];if(typeof g==="string")g=b.getObjectUsingPath(g);
if(g){var B={objectsOnly:true};if(w)B.maxDeep=true;var I=function(h,C,G,H){if(q(h)){for(var n=0;n<d.length;n++)if(d[n]===h)return true;b.addToArrayIfNotExist(y,h);return true}return false}.bind(this);b.traverse(g,I,B)}return y};r.findAllInstances=function(g,q,d,w){var y=function(B){return B instanceof q};return z(g,y,d,w)};r.findAllInheriting=function(g,q,d,w){var y=function(B){return B.prototype instanceof q};return z(g,y,d,w)};r.findAllFilters=function(g,q){var d=[];try{d.push(f.opentag.filter.Filter);
d.push(f.opentag.filter.URLFilter)}catch(w){}return r.findAllInheriting(g,A,d,q)}})();K.cookie={};K.cookie.PageView={};K.cookie.PageView.update=function(){var b;var A;A=function z(){return Math.floor(1+Math.random()*65536).toString(36).substring(1)};if(!window.__pageViewId__){b=(new Date).getTime().toString(36);window.__pageViewId__=b+A()+A()+A()}return window.__pageViewId__};K.html.PostData=function(b,A,r,z){var g;var q;var d;var w;var y;var B;var I;var h;var C;var G;G=2;C=5E3;I=false;h=function(){if(G>
0)setTimeout(function(){if(!I){G-=1;g()}},C)};q=navigator.userAgent.toLowerCase();d=q.indexOf("msie")!==-1;w=q.indexOf("msie 9")!==-1;y=q.indexOf("msie 7")!==-1||q.indexOf("msie 6")!==-1;B=("https:"===document.location.protocol?"https:":"http:")+b;r=r||"POST";g=function(){var H;try{H=null;try{H=new XMLHttpRequest}catch(n){}if(H&&!d)H.open(r,B,true);else if(typeof XDomainRequest!=="undefined"){H=new XDomainRequest;H.open(r,B)}else H=null;try{H.withCredentials=false}catch(n){}if(H.setRequestHeader)if(z)H.setRequestHeader("Content-Type",
z);else H.setRequestHeader("Content-Type","text/plain;charset\x3dUTF-8");H.onload=function(){I=true};H.onreadystatechange=function(){};H.ontimeout=function(){};H.onerror=function(){};H.onprogress=function(){};H.send(A)}catch(n){try{try{K.html.fileLoader.load(B)}catch(m){if(window.console&&window.console.log)window.console.log(n)}}catch(m){}}};if(y){K.html.fileLoader.load(B);return}else g()};(function(){function b(){}function A(z,g){var q={};q.clientId=""+g.clientId;q.containerId=""+z.getContainerId();
q.classpath=""+z.PACKAGE_NAME;q.opentagStats=true;if(z.sentPing)q.containerLoad=false;else{z.sentPing=(new Date).valueOf();q.containerLoad=true}q.isS3=false;q.pageViewId=K.cookie.PageView.update();q.tags=[];return q}var r="text/plain;charset\x3dUTF-8";f.Define.clazz("qubit.opentag.Ping",b);b.prototype.sendErrors=function(z,g){};b.getPingID=function(z){if(z.config.id)return z.config.id;var g=z.PACKAGE_NAME.lastIndexOf(".");if(g!==-1)return z.PACKAGE_NAME.substring(g+1);else return z.PACKAGE_NAME};
b.prototype.send=function(z,g){var q=z.config;var d=A(z,q);var w=d.tags;var y=q.pingServerUrl;for(var B=0;B<g.length;B++){var I=g[B].tag;var h=g[B].loadTime;if(h===null||isNaN(h))continue;var C={};var G=b.getPingID(I);if(!I.pingSent&&G&&h!==null)if(G!==undefined){C.tagId=G;C.loadTime=h;C.fired=true;w.push(C);I.pingSent=true}else;else if(I.pingSent);else if(h===null);}if(y&&(w.length>0||d.containerLoad)){var H=L.stringify(d);var n="//"+y;K.html.PostData(n,H,"POST",r)}else{if(!w.length);if(!y);}};b.prototype.sendDedupe=
function(z,g){var q=z.config;var d=A(z,q);var w=q.pingServerUrl;var y=d.tags;for(var B=0;B<g.length;B++){var I=g[B];var h=b.getPingID(I);var C={};if(h===undefined);else if(!I.dedupePingSent){C.tagId=""+h;C.fired=false;C.loadTime=0;y.push(C);I.dedupePingSent=true}}if(w&&(y.length>0||d.containerLoad)){var G=L.stringify(d);var H="//"+w;K.html.PostData(H,G,"POST",r)}else{if(!y.length);if(!w);}}})();K.cookie.SimpleSessionCounter={};K.cookie.SimpleSessionCounter._cookieName="_qst_s";K.cookie.SimpleSessionCounter._sessionCookie=
"_qsst_s";K.cookie.SimpleSessionCounter.update=function(b){var A;var r;var z;var g=30;A=f.Cookie.get(K.cookie.SimpleSessionCounter._cookieName);r=f.Cookie.get(K.cookie.SimpleSessionCounter._sessionCookie);if(!A)A=1;else{A=parseInt(A,10);if(!r||parseInt(r,10)<(new Date).getTime()-g*60*1E3)A+=1}f.Cookie.set(K.cookie.SimpleSessionCounter._cookieName,A,365,b);f.Cookie.set(K.cookie.SimpleSessionCounter._sessionCookie,(new Date).getTime().toString(),null,b);return A};(function(){function b(y){if(y)if(y.alphabet){this.alphabet=
y.alphabet;this.dict={};for(var B=0;B<this.alphabet.length;B++)this.dict[this.alphabet[B]]=B}else{this.alphabet=r;this.dict=q}}function A(y,B){for(var I in B)if(y===B[I])return I;return null}var r=[];var z=Math.pow(2,8);for(var g=0;g<z;g++)r.push(String.fromCharCode(g));var q={};for(var d=0;d<r.length;d++)q[r[d]]=d;var w=f.Define;w.clazz("qubit.compression.LZW",b);b.prototype.encode=function(y){var B=this.alphabet.length;var I={};var h=[];var C=0;var G=y.charAt(C++);var H;for(var n=this.dict;!!(H=
y.charAt(C++));){var m=G+H;if(n.hasOwnProperty(m)||I.hasOwnProperty(m))G=m;else{var v=n.hasOwnProperty(G)?n[G]:I[G];if(v===undefined)throw"Dictionary base is to small for those contents: "+G;h.push(v);I[m]=B++;G=H}}if(G!=="")h.push(I.hasOwnProperty(G)?I[G]:n[G]);return h};b.prototype.decode=function(y){var B=this.dict;var I=this.alphabet.length;var h;var C={};var G=A(y[0],B);var H=G;var n=[G];for(var m=1;m<y.length;m++){var v=y[m];h=A(v,B);if(h===null){if(C.hasOwnProperty(v))h=C[v];if(h===null)h=
H+G}n.push(h);G=h.charAt(0);C[I++]=H+G;H=h}return n.join("")}})();(function(){function b(n){var m=0;var v=n<0;if(v)n=-n;var e="";var c=true;do{m=n%C;if(c){e=B[h[m]];c=false}else e=h[m]+e;n=(n-m)/C}while(n>0);if(v)return"-"+e;return e}function A(n){var m=0;var v=0;var e=true;for(var c=0;c<n.length;c++){var k=n.charAt(n.length-1-c);if(e){e=false;k=z.charAt(w[k])}m+=q[k]*Math.pow(C,v++)}return m}function r(n){}var z="abcdefghijklmnopqrstuvwxyz"+"0123456789"+"'%./:\x3c\x3e?[";var g="ABCDEFGHIJKLMNOPQRSTUVWXYZ"+
"*!-+()@{|}"+'"]^_`~$\x26#';var q={};for(var d=0;d<z.length;d++)q[z.charAt(d)]=d;var w={};for(var y=0;y<z.length;y++)w[g.charAt(y)]=y;var B={};for(var I=0;I<z.length;I++)B[z.charAt(I)]=g.charAt(I);var h=z.split("");var C=h.length;var G=new f.compression.LZW({});var H=f.Define;H.clazz("qubit.compression.Compressor",r);r.prototype.compress=function(n,m){var v=(m||G).encode(n);var e=[];for(var c=0;c<v.length;c++)e.push(String.fromCharCode(v[c]));return e.join("")};r.prototype.compressAnsi=function(n,
m){var v=(m||G).encode(n);var e=[];for(var c=0;c<v.length;c++){var k=b(v[c]);e.push(k)}return e.join("")};r.prototype.decompressAnsi=function(n,m){var v=[];var e="";for(var c=0;c<n.length;c++){var k=n.charAt(c);if(w.hasOwnProperty(k)){var p=e+k;e="";p=A(p);v.push(p)}else e+=k}return(m||G).decode(v)};r.prototype.decompress=function(n,m){var v=[];for(var e=0;e<n.length;e++)v.push(n.charCodeAt(e));return(m||G).decode(v)}})();(function(){function b(v){var e=[];for(var c=0;c<v.length;c++){var k=q(v[c][0]);
e.push([new RegExp(k,"g"),"*"+v[c][1]])}return e}function A(v,e){for(var c=0;c<e.length;c++)if(e[c][1]===v)return e[c][0];return null}function r(v){this._regexDefs=h;this._defs=I;if(v)if(v.definitions){this._regexDefs=b(v.definitions);this._defs=v.definitions}}function z(v,e){var c=[];for(var k=0;k<v.length;k++){var p=true;if(e)p=v.charCodeAt(k)<=e;var E=B.cookieAlphabetMap.hasOwnProperty(v.charAt(k));if(p&&!E)c.push("*"+v.charCodeAt(k)+".");else c.push(v.charAt(k))}return c.join("")}function g(v,
e){e=e.replace(/@/g,"@@");var c=[];var k=0;for(var p=0;k<v.length;k++){var E=v[k][0];var M=new RegExp(q(E),"g");var N=e.replace(M,"@"+p+"-");if(N!==e){c.push(v[k][0]);p++;e=N}}return[e,c]}function q(v){return v.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function d(v){var e={};var c="";for(var k=0;k<v.length;k++){var p=v.charAt(k);if(!G[p]){if(isNaN(e[c]))e[c]=v.split(c).length-1;c=""}else c+=p}var E=[];for(var M in e)if(e.hasOwnProperty(M)){var N=e[M];if(N>=m&&M.length>=n)E.push([M,N])}E=E.sort(function(P,
Q){if(P[0].length===Q[0].length)return 0;if(Q[0].length>P[0].length)return 1;else return-1});return E}function w(v,e){if(!e||e.length===0||!v)return v;var c="";var k=false;var p=false;var E="";for(var M=0;M<v.length;M++){var N=v.charAt(M);if(N==="@"||k||p)if(k||p){k=false;if(N==="@")c+="@";else if(!isNaN(+("-"+N))){p=true;E=E+N}else if(p){if(e&&N==="-"&&e[+E])c+=e[+E];else c+="@"+E+N;E="";p=false}else c+="@"+N}else k=true;else c+=N}if(E)c+="@"+E;if(k)c+="@";return c}var y=f.Define;var B=f.Cookie;
var I=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],
["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["\x3c","S"],["\x3e","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]];var h=b(I);y.clazz("qubit.opentag.compression.Encoder",r);r.prototype.encode=function e(c,k){var p=
c.replace(/\*/g,"**");var E=d(p);for(var M=0;M<this._regexDefs.length;M++){var N=this._regexDefs[M];p=p.replace(N[0],N[1])}p=p.replace(/;/g,"*-");p=p.replace(/&/g,"*.");p=p.replace(/\\/g,"*/");p=p.replace(/=/g,"*+");p=p.replace(/\n/g,"*N");p=p.replace(/ /g,"*_");p=p.replace(/\t/g,"*T");p=p.replace(/"/g,"*Q");var P=d(p);P.concat(E);var Q=g(P,p);var S=Q[1];var T=S.length>0;if(T)p=Q[0];if(!k)p=z(p);else p=z(p,k);if(T)return"Y"+S.join("*")+"@"+p;else return"N"+p};var C="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.";
var G={};for(var H=0;H<C.length;H++)G[C.charAt(H)]=true;var n=4;var m=2;r.prototype.decode=function(e){var c=null;if(e.charAt(0)==="N")e=e.substring(1);else if(e.charAt(0)==="Y"){var k=e.indexOf("@");if(k>=0){c=e.substring(1,k);c=c.split("*");e=e.substring(k+1);e=w(e,c)}}var p="";var E=false;var M=false;var N="";for(var P=0;P<e.length;P++){var Q=e.charAt(P);if(Q==="*"||E||M)if(E||M){E=false;if(!isNaN(+("-"+Q))){N=N+Q;M=true}else if(M){if(Q===".")p+=String.fromCharCode(+N);else if(Q==="-"&&A(N+"-",
this._defs))p+=A(N+"-",this._defs);else p+="*"+N+Q;N="";M=false}else if(Q==="*")p+="*";else if(Q==="-")p+=";";else if(Q==="/")p+="\\";else if(Q===".")p+="\x26";else if(Q==="+")p+="\x3d";else if(Q==="N")p+="\n";else if(Q==="_")p+=" ";else if(Q==="T")p+="\t";else if(Q==="Q")p+='"';else if(A(Q,this._defs)!==null){var S=A(Q,this._defs);p+=S}else p+="*"+Q}else E=true;else p+=Q}if(N)p+="*"+N;if(E)p+="*";return p}})();(function(){function b(g){this.testBinary=false;this.binSupported=z;if(g){this.compressor=
new f.compression.Compressor;this.encoder=new f.opentag.compression.Encoder({})}}var A=f.Define;var r=f.Cookie;var z=false;A.clazz("qubit.opentag.compression.CookieCompressor",b);b.prototype.compress=function(g,q){if(typeof g!=="string"||g==="")return g;var d=this.encoder.encode(g);var w;if(this.binSupported||this.testBinary){var y=this.compressor.compress(d);w='"B'+this.encoder.encode(y,128)+'"';r.set("__qtag_test_bin__",w,undefined,undefined,true);var B=r.get("__qtag_test_bin__",true);r.rm("__qtag_test_bin__");
if(B&&B!==w)w=null}var I;var h=this.encoder.encode(this.compressor.compressAnsi(d));if(!q&&d.length<=h.length)I="E"+d;else I="C"+h;if(w&&w.length<I.length)return w;else return I};b.prototype.decompress=function(g){if(typeof g!=="string"||g==="")return g;if(g.charAt(0)==='"')g=g.substring(1,g.length-1);var q=g.charAt(0);g=g.substring(1);switch(q){case "E":return this.encoder.decode(g);case "C":var d=this.compressor.decompressAnsi(this.encoder.decode(g));return this.encoder.decode(d);case "B":var w=
this.compressor.decompress(this.encoder.decode(g));return this.encoder.decode(w);default:throw"This code is not supported! Code: "+q;}}})();(function(){var b=f.Cookie;var A=f.opentag.Utils;var r=function(){};f.Define.clazz("qubit.opentag.Session",r);var z=new f.opentag.compression.CookieCompressor({});r.readCompressedCookie=function(g){var q=b.get(g,true);return z.decompress(q)};r.setupSession=function(g){var q=g.config;var d;var w;var y;var B;var I;var h;d={};d.sessionCount=K.cookie.SimpleSessionCounter.update(q.cookieDomain);
I="qtag_"+g.getContainerId();var C="x_qtag_"+g.getContainerId();y=b.get(I);var G=!!y;if(y===null){y=b.get(C,true);y=z.decompress(y)}if(y)try{y=L.parse(y)}catch(n){y={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else y={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};h=(new Date).getTime();if(d.sessionCount!==parseInt(y.sc,10)){y.sessionStartTime=h;y.sc=d.sessionCount;y.sessionCount+=1;y.referrer.push({url:r.getReferrer(),
landing:A.getUrl().substring(0,300),time:h});y.sessionLandingPage=A.getUrl().substring(0,300)}else if(r.isReferrerDifferent())if(!r.referrerIsSameAsPrevious(y.referrer,h,30*60*1E3)){y.referrer.push({url:r.getReferrer(),landing:A.getUrl().substring(0,300),time:h});y.sessionLandingPage=A.getUrl().substring(0,300);y.sessionStartTime=h;y.sessionCount+=1}d.sessionCount=y.sessionCount;d.sessionStartTime=y.sessionStartTime;d.pageStartTime=h;y.pageViews+=1;d.pageViews=y.pageViews;d.sessionLandingPage=y.sessionLandingPage;
d.referrer=y.referrer;if(d.referrer.length>5)d.referrer.splice(2,d.referrer.length-5);B=L.stringify(y);for(w=0;z.compress(B).length>q.maxCookieLength&&w<5;){if(y.referrer.length>=3)y.referrer.splice(2,1);else if(y.referrer.length===2)y.referrer=[y.referrer[0]];else if(y.referrer.length===1)y.referrer=[];B=L.stringify(y);w+=1}d.referrer=y.referrer;if(G)b.rm(I);var H=z.compress(B);b.rm(C);if(q.maxCookieLength>0)b.set(C,H,365,q.cookieDomain,true);d.setVariable=function(n,m,v){var e=!!v?v:0;y.__v[n]=
[m,e];var c=z.compress(L.stringify(y));if(q.maxCookieLength>0)b.set(C,c,365,q.cookieDomain,true);else b.rm(C)};d.getCookie=function(n,m){var v=b.get(n,true);if(v&&(m||n.indexOf("x_")===0))try{v=z.decompress(v)}catch(e){}else if(v!==null)v=b.decode(v);return v};d.getVariable=function(n){var m;var v;var e;m=y.__v[n];if(m){v=m[1];if(v===0||v>(new Date).getTime())return m[0]}return null};d.on=function(n,m,v){if(m.attachEvent)m.attachEvent("on"+n,v);else if(m.addEventListener)m.addEventListener(n,v,false)};
d.getTagCookie=function(){return r.readCompressedCookie(C)};r.lastSession=d;return d};r.referrerIsSameAsPrevious=function(g,q,d){var w;var y;var B;if(g.length>0){w=r.getReferrer();y=A.getUrl().substring(0,300);B=g[g.length-1];return B.url===w&&B.landing===y&&B.time+d>q}return false};r.isReferrerDifferent=function(){var g;var q;var d;d=r.getReferrer();g=d.indexOf("://");if(g===-1)return true;g+=3;try{if(d.substring(g).indexOf(r.getDomain())!==0)return true;return false}catch(w){return true}};r.getReferrer=
function(){if(document.referrer)return document.referrer.substring(0,300);return"direct"};r.getDomain=function(){return document.location.host}})();(function(){function b(){}var A=f.opentag.LibraryTag;var r=f.Define;b.library=function(){return A.define.apply(A,arguments)};b.libraryRef=function(){return A.getLibraryByClasspath.apply(A.getLibraryByClasspath,arguments)};r.namespace("qubit.Quick",b)})();(function(){function b(n){this.runQueue=[];this.tags=[];this.config={cookieDomain:"",maxCookieLength:1E3,
gzip:true,delayDocWrite:false,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:false,containerId:"",scanTags:false,noPings:false,restartable:true};this.ignoreTagsState=false;if(n){this.setConfig(n);if(!n.name)this.config.name="Cont-"+I++;b.register(this);if(b.NO_PINGS)this.config.noPings=true;this.ping=new f.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(n.init)try{n.init.call(this,n)}catch(v){}var m=this;this._tagLoadedHandler=
function(v){if(m._containerAlreadySentPings){m.sendPingsNotTooOften();if(v.success);}}}this.events=new f.Events({});return this}function A(n,m,v,e){if(n[v]){e[v]=e[v]+1||1;v+="("+e[v]+")"}n[v]=m}var r=f.opentag.Utils;var z=f.opentag.filter.BaseFilter;var g=f.opentag.filter.Filter;var q=f.opentag.BaseTag;var d=f.opentag.Timed;var w=f.opentag.Tags;var y=f.opentag.Session;var B=f.Cookie;var I=1;try{window.opentag_consentGiven=function(){b.consentIsGiven=true;var n=b.getContainers();for(var m=0;m<n.length;m++)try{n[m].run()}catch(v){}}.bind(this)}catch(n){}f.Define.clazz("qubit.opentag.Container",
b);var h=[];var C="restart";b.prototype.EVENT_TYPES={RESTART_EVENT:C};b.register=function(n){r.addToArrayIfNotExist(h,n)};b.prototype.isTellingLoadTimes=function(){var n=this.config.tellLoadTimesProbability;if(n===null)n=0;return n>Math.random()};b.prototype.destroy=function(n){this.destroyed=true;this.unregister();for(var m=0;m<this.tags.length;m++){var v=this.tags[m];if(v.owningContainer===this){v.owningContainer=null;if(n&&v instanceof q)v.destroy()}}this.tags=[]};b.destroyAll=function(n){var m=
b.getContainers();for(var v=0;v<m.length;v++)m[v].destroy(n)};b.findContainersByName=function(n){var m=b.getContainers();var v=[];for(var e=0;e<m.length;e++)if(m[e].config.name===n)v.push(m[e]);return v};b.getById=function(n){var m=b.getContainers();for(var v=0;v<m.length;v++)if(m[v].getContainerId()===n)return m[v];return null};b.prototype.unregister=function(n){b.unregister(this,n)};b.unregister=function(n,m){r.addToArrayIfNotExist(h,n);var v=r.removeFromArray(h,n);if(m){for(var e=0;e<n.tags.length;e++){var c=
n.tags[e];if(c.owningContainer===n){c.owningContainer=null;if(c instanceof q)c.unregister()}}n.tags=[]}if(!v||v.length===0);};b.prototype.hasConsent=function(){return B.get("qubitconsent")==="Accepted"};b.prototype.register=function(n){b.register(n||this)};b.getContainers=function(){return h};b.prototype.getContainers=function(){return b.getContainers()};b.prototype.onTagRegistered=function(n){};b.prototype.registerTag=function(n){if(n.owningContainer!==null)return false;else{this.tags.push(n);n.owningContainer=
this;n.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(n)}catch(m){}}return true};b.prototype.unregisterTag=function(n){if(n.owningContainer===this)n.owningContainer=null;for(var m=0;m<this.tags.length;)if(this.tags[m]===n)this.tags.splice(m,1);else m++};b.prototype.registerTags=function(n){for(var m=0;m<n.length;m++)this.registerTag(n[m])};b.prototype.setConfig=function(n){for(var m in n)this.config[m]=n[m]};b.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};b.prototype.runWithoutFilters=
function(){this.runTags({command:"run"})};b.prototype.containerScriptLoadedSynchronously=function(){var n;var m;var v;var e;var c;e=document.getElementsByTagName("script");for(n=0,m=e.length;n<m;n+=1){v=e[n];c=v.getAttribute("src");if(!!c&&c.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js")>0)return v.getAttribute("async")===null&&(v.getAttribute("defer")===false||v.getAttribute("defer")===""||v.getAttribute("defer")===null)}return true};b.prototype.prepareSessionIfNeeded=function(){var n=
this.config.trackSession;if(n!==true&&n!==false)for(var m=0;m<this.tags.length;m++){var v=this.tags[m];v.resolveAllDynamicData();var e=v.getFilters();for(var c=0;c<e.length;c++){var k=e[c];if(k instanceof g&&k.isSession()){this.trackSession=true;break}}if(this.trackSession)break}else this.trackSession=n;if(b.TRACK_SESSION)this.trackSession=true;if(this.trackSession)this.session=y.setupSession(this);if(this.session);};b.runtimeCounter=b.runtimeCounter||1;b.prototype.runTags=function(n,m){if(this.destroyed)throw"Container has been destroyed.";
if(!m)if(b.LOCKED||r.global().QUBIT_CONTAINERS_LOCKED)return;if(this.onBeforeRun)try{this.onBeforeRun()}catch(N){}var v=!this.containerScriptLoadedSynchronously();var e="runIfFiltersPass";if(n&&n.command)e=n.command;this.runningStarted=(new Date).valueOf();if(this.config.scanTags)if(!this._scanned){this.scanForTags();this._scanned=(new Date).valueOf()}this.prepareSessionIfNeeded();var c=this.getTagsInOrder();var k="___otctnmk"+b.runtimeCounter++;for(var p=0;p<c.length;p++)try{var E=c[p];if(this.includedToRun(E))this._checkAndRun(E,
e,v,k)}catch(N){}d.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),3100);this.waitForAllTagsToFinish();for(var M=0;M<c.length;M++){c[M]._runtimeMarkers[k]=undefined;delete c[M]._runtimeMarkers[k]}};b.prototype.getTagsInOrder=function(){var n=[];for(var m=0;m<this.tags.length;m++){var v=this.tags[m];var e=v.config.priority;if(+e>0){var c=0;for(var k=0;k<n.length;k++){var p=n[k];if(p){var E=+p.config.priority;if(E>0&&E>e)c++;else break}}n.splice(c,0,v)}else n.push(v)}return n};b.prototype._checkAndRun=
function(n,m,v,e){if(!n._runtimeMarkers[e])n._runtimeMarkers[e]=true;else return;var c=n.resolveDependencies();if(c.length>0)for(var k=0;k<c.length;k++)this._checkAndRun(c[k],m,v,e);this._tagRunner(n,m,v)};b.prototype._tagRunner=function(n,m,v){try{if(this.includedToRun(n)){if(v)n.forceAsynchronous=true;if(this.config.delayDocWrite)n.delayDocWrite=true;n.session=n.session||this.session;n[m]()}}catch(e){}};b.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;
else{if(this._pkgName)return this._pkgName;var n=this.PACKAGE_NAME.split(".");n=n[n.length-1];this._pkgName=n;return n}};b.prototype.includedToRun=function(n){if(!n)return false;var m=n.config;if(m.inactive)return false;if(m.disabled)if(!n.cookieSaysToRunEvenIfDisabled())return false;if(n.disabledByCookie())return false;var v=b.consentIsGiven||!m.needsConsent||this.hasConsent();var e=n.state===q.prototype.STATE.INITIAL;return this.ignoreTagsState||v&&e};b.prototype.scanForTags=function(n,m){if(n)this.tags=
[];var v;if(m&&typeof m==="object")v=this.findAllTags(m);else v=this.findAllTagsByClassPath();this.registerTags(v);return v};b.prototype.findAllTags=function(n,m){n=n||this.tagsPackageName||this.PACKAGE_NAME;return w.findAllTags(n,m)};b.prototype.findAllTagsByClassPath=function(n){n=n||this.PACKAGE_NAME;return w.findAllTagsByClassPath(n)};b.prototype.findAllFilters=function(n,m){n=n||this.tagsPackageName||this.PACKAGE_NAME;return w.findAllFilters(n,m)};b.prototype.waitForAllTagsToFinish=function(){if(this._waitForAllTagsToFinishWaiting)return;
if(!this._lastWaited)this._lastWaited=(new Date).valueOf();var n=(new Date).valueOf()-this._lastWaited>15*1E3;var m=this.allTagsFinished()||n;if(!this._showFinishedOnce&&m){this._lastWaited=null;if(n);this._showFinishedOnce=true;this.runningFinished=(new Date).valueOf();this._containerAlreadySentPings=(new Date).valueOf();this.sendPingsNotTooOften();if(this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else if(!m){this._waitForAllTagsToFinishWaiting=true;this._showFinishedOnce=false;d.setTimeout(function(){this._waitForAllTagsToFinishWaiting=
false;this.waitForAllTagsToFinish()}.bind(this),100)}else;};b.prototype.onTagsInitiallyRun=F;b.prototype.resetAllTags=function(n){for(var m=0;m<this.tags.length;m++){this.tags[m].reset();if(!n)this.tags[m].resetFilters()}};b.prototype._prepareTagsToRestart=function(n){for(var m=0;m<this.tags.length;m++)this.tags[m].prepareForRestart(n)};b.prototype.reset=function(n,m){this.runningFinished=undefined;this._waitForAllTagsToFinishWaiting=undefined;this.runningStarted=undefined;this._showFinishedOnce=
undefined;if(!n)this.resetAllTags(m)};b.prototype.onRestart=function(n){this.events.on(C,n)};b.prototype.restart=function(n,m){if(this.config.restartable){this.events.call(C,this);this.reset(true,true);if(!n)this._prepareTagsToRestart(m);this.run()}};b.restartAll=function(n,m){var v=b.getContainers();for(var e=0;e<v.length;e++)try{v[e].restart(n,m)}catch(c){log.ERROR("Restart failed for container "+v[e].config.name,c)}};b.resetAll=function(n,m){var v=b.getContainers();for(var e=0;e<v.length;e++)try{v[e].reset(n,
m)}catch(c){log.ERROR("Reset failed for container "+v[e].config.name,c)}};b.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};d.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};b.prototype.sendPings=function(){if(this.config.noPings)return;var n;if(this.isTellingLoadTimes()){var m=this.getAllTagsByState();var v=[];if(m.run)v=w.getLoadTimes(m.run);this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,v);v=w.getLoadTimes();var e=[];for(n=0;n<v.length;n++){var c=
v[n].tag;if(c.config.dedupe&&c.sendDedupePing)e.push(c)}if(e.length>0){this.lastDedupePingsSentTime=(new Date).valueOf();this.ping.sendDedupe(this,e)}if(m.other){v=w.getLoadTimes(m.other);var k=[];for(n=0;n<v.length;n++)k.push(v[n]);if(k.length>0)this.ping.send(this,k)}if(m.awaiting){v=w.getLoadTimes(m.awaiting);var p=[];for(n=0;n<v.length;n++)p.push(v[n]);if(p.length>0)this.ping.send(this,p)}}else this.ping.send(this,[])};b.prototype.getAllTagsByState=function(){return b.getAllTagsByState(this.tags)};
b.getAllTagsByState=function(n){var m=null;var v=null;var e=null;var c=null;var k=null;var p=null;var E={};var M=q.prototype.STATE.EXECUTED_WITH_ERRORS;for(var N=0;N<n.length;N++){var P=n[N];if(P instanceof q){var Q=P.config.name;if(P.scriptExecuted>0){m=m||{};A(m,P,Q,E)}else if(P.locked){p=p||{};A(p,P,Q,E)}else if(P.scriptExecuted<0||P.state>=M){c=c||{};A(c,P,Q)}else if(P.filtersState()===z.state.SESSION||P.filtersState()>0){e=e||{};A(e,P,Q,E)}else if(P.config.needsConsent){k=k||{};A(k,P,Q,E)}else{v=
v||{};A(v,P,Q,E)}}}return{run:m,failed:c,awaiting:e,consent:k,locked:p,other:v}};b.prototype.allTagsFinished=function(){for(var n=0;n<this.tags.length;n++){var m=this.tags[n];if(m instanceof f.opentag.BaseTag){var v=m.filtersState();if(!m.config.disabled){var e=m.filtersState()<0&&!m.locked;var c=!(m.finished()||m.config.runner&&!m.isRunning);if(e&&c){var k=v!==z.state.SESSION;var p=+m.awaitingDependencies>0;if(k&&!p)return false}}}}return true};b.prototype.getPageVariables=function(){var n=[];for(var m=
0;m<this.tags.length;m++){var v=this.tags[m].getPageVariables();for(var e=0;e<v.length;e++)r.addToArrayIfNotExist(n,v[e])}return n};b.getPageVariableByName=function(n){var m=this.getAllPageVariables();var v=[];for(var e=0;e<m.length;e++)if(m[e].config.name===n)v.push(m[e]);return v};var G="qubit.opentag.disableContainerRunning_";var H="qubit.opentag.forceContainerRunning";b.prototype._getCookieNameForDisabling=function(){return G+this.getContainerId()+this.config.name};b.prototype.disabledByCookie=
function(){return!!B.get(this._getCookieNameForDisabling())};b.prototype.setCookieToDisable=function(){B.set(this._getCookieNameForDisabling(),"true")};b.prototype.rmCookieToDisable=function(){B.rm(this._getCookieNameForDisabling())};b.rmAllDisablingCookies=function(){r.rmCookiesMatching(G)};b.setCookieForDisabledContainersToRun=function(){B.set(H,"true")};b.rmCookieForDisabledContainersToRun=function(){B.rm(H)}})();(function(){function b(){}function A(){var B=false;if(w.get("opentag_debug")||document.location.href.indexOf("opentag_debug")>=
0)B=true;return B}function r(){var B=false;if(w.get("opentag_debug_tool")||document.location.href.indexOf("opentag_debug_tool")>=0)B=true;return B}function z(){try{var B=J.TAGSDK_MAIN_DISABLED_FUNCTION;if(B&&B())return true}catch(I){}if(document.location.href.indexOf("opentag_disabled\x3dtrue")>=0)return true;return false}function g(B,I,h){if(h&&(B[I]===undefined||B[I]===""||B[I]===null))B[I]=h}function q(B){var I=B.PACKAGE_NAME.split(".");I=I[I.length-1];var h=y.getParentObject(B.PACKAGE_NAME);h[I]=
null;delete h[I]}function d(B){var I=y.getParentObject(B.PACKAGE_NAME);var h=I.ClientConfig;if(h&&h.clientId)return h.clientId;else{var C=B.PACKAGE_NAME.split(".");return C[C.length-2].substring(1)}}var w=f.Cookie;var y=f.opentag.Utils;f.opentag.Log.setLevelFromCookie();b.run=function(){var B=false;if(z())return;var I=false;var h=r();var C=h||A();if(!I&&C){if(!f.DEBUG_MODE)J.TAGSDK_NS_OVERRIDE=true;else J.TAGSDK_NS_OVERRIDE=false;B=true}if(f.DEBUG_MODE)J.TAGSDK_NS_OVERRIDE=false;try{K.html.UVListener.init()}catch(G){}b.runAllContainers(B)};
b.runAllContainers=function(B){try{var I=f.opentag.Container.getContainers();for(var h=0;h<I.length;h++){var C=I[h];var G=C.config;if(!C.runningStarted&&!C.configuredInMain){G.scanTags=true;var H=y.getParentObject(C.PACKAGE_NAME).ClientConfig;if(H)g(C.config,"clientId",H.id);var n=y.getParentObject(C.PACKAGE_NAME).SystemDefaults;if(n){g(G,"pingServerUrl",n.pingServerUrl);g(G,"tellLoadTimesProbability",n.tellLoadTimesProbability)}C.configuredInMain=true;if(B){C.destroy(true);q(C);b.loadDebugVersion(C)}else if(!J.QUBIT_OPENTAG_STOP_MAIN_EXECUTION)C.run();
else(function(){var m=f.opentag.RUN_STOPPED_EXECUTON;f.opentag.RUN_STOPPED_EXECUTON=function(){try{if(m)m()}finally{C.run()}}})(C)}}}catch(m){}};b.loadDebugVersion=function(B){var I=document.createElement("script");var h;var C=B.config.scriptURL;var G=d(B);var H=B.getContainerId();if(C){h=C;var n="-debug.js".length;if(h.lastIndexOf("-debug.js")!==h.length-n){h=h.substring(0,h.length-".js".length);h+="-debug.js"}}var m="//d3c3cq33003psk.cloudfront.net/opentag-"+G+"-"+H+"-debug.js";if(h&&m!==h)I.src=
h;else I.src="//s3-eu-west-1.amazonaws.com/opentag/opentag-"+G+"-"+H+"-debug.js";document.getElementsByTagName("head")[0].appendChild(I)};f.Define.namespace("qubit.opentag.Main",b)})()})()})();(function(){})();
(function(){var u=qubit.opentag.Container;var a=new u({"maxCookieLength":3E3,"cookieDomain":"","pingServerUrl":"","delayDocWrite":false,"name":"AEM: Production","gzip":true,"disabled":false,"tellLoadTimesProbability":1,"containerId":1096944});var t="aemproduction.Container";qubit.Define.clientNamespace(t,a)})();(function(){var u=qubit.opentag.pagevariable.BaseVariable;var a=new u({"name":"hotjar hjid"});var t="aemproduction.variables.HotjarHjid";qubit.Define.clientNamespace(t,a);a.value="88438"})();
(function(){var u=qubit.opentag.pagevariable.BaseVariable;var a=new u({"name":"hotjar hjsv"});var t="aemproduction.variables.HotjarHjsv";qubit.Define.clientNamespace(t,a);a.value="5"})();(function(){var u=qubit.opentag.pagevariable.BaseVariable;var a=new u({"name":"Domain Name"});var t="aemproduction.variables.DomainName";qubit.Define.clientNamespace(t,a);a.value="www.telegraph.co.uk"})();
(function(){var u=qubit.opentag.pagevariable.BaseVariable;var a=new u({"name":"Allow Linker"});var t="aemproduction.variables.AllowLinker";qubit.Define.clientNamespace(t,a);a.value="false"})();(function(){var u=qubit.opentag.pagevariable.BaseVariable;var a=new u({"name":"GA Profile ID"});var t="aemproduction.variables.GAProfileID";qubit.Define.clientNamespace(t,a);a.value="UA-7226372-1"})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all DO NOT AMEND","pattern":"","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll4";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include URL Param ?openxsync","pattern":"openxsync"});var t="aemproduction.filters.IncludeURLParamOpenxsync";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll44";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default","pattern":"*","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Default";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include /travel/tours","pattern":"/travel/tours"});var t="aemproduction.filters.IncludeTravelTours";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll42";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"HotJar Rule","patternType":"ENDS_WITH"});var t="aemproduction.filters.HotJarRule1";qubit.Define.clientNamespace(t,a);a.customStarter=function(J,x){x(false)};a.customScript=function(J){if(window.location.pathname=="/secure/registration/"||window.location.pathname=="/premium/"||window.location.pathname=="/premium/prime/"||window.location.pathname=="/premium/product/"||window.location.pathname=="/premium/digital-editions/"||window.location.pathname==
"/subscriptions/"||window.location.pathname=="/subscriptions/sub-bar/")return true;else return false};a.lexicalPattern=""})();(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/rewards","pattern":"/rewards/"});var t="aemproduction.filters.Rewards";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/secure/registration/","pattern":"/secure/registration/"});var t="aemproduction.filters.SecureRegistration";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/travel/destinations/","pattern":"telegraph.co.uk/travel/destinations/ "});var t="aemproduction.filters.TravelDestinations1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/travel/destinations","pattern":"telegraph.co.uk/travel/destinations"});var t="aemproduction.filters.TravelDestinations5";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Business Channel","pattern":"/business/"});var t="aemproduction.filters.BusinessOnly";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll5";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=function(J){return true};a.lexicalPattern='{"rows":[],"operators":[]}'})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Travel","pattern":".telegraph.co.uk/travel","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.Travel";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/travel/destinations","pattern":"telegraph.co.uk/travel/destinations"});var t="aemproduction.filters.TravelDestinations4";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll43";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Salesforce Live Agent - Chat"});var t="aemproduction.filters.SalesforceLiveAgentSales1";qubit.Define.clientNamespace(t,a);a.customStarter=function(J,x){setTimeout(x,500)};a.customScript=function(J){var x=false;var f=false;var D=location.pathname;var F=location.host;var O=D.match(/\/secure\/(personal|account|paymentdetails|newsletters)\//);window.salesforceLiveAgentChatPanel=window.salesforceLiveAgentChatPanel||{};if(F.match(/(staging|secure-staging)\.telegraph/g)){salesforceLiveAgentChatPanel.org_id=
"572m00000004Cf9";salesforceLiveAgentChatPanel.button_id="573m00000004D28";salesforceLiveAgentChatPanel.button_registration_id="573m00000004D2I";salesforceLiveAgentChatPanel.button_service_id="573m000000000j2";salesforceLiveAgentChatPanel.deployment_id="00Dm00000002iU8";salesforceLiveAgentChatPanel.chat_url="https://d.la2w1cs.salesforceliveagent.com/chat";salesforceLiveAgentChatPanel.sf_url="https://c.la2w1cs.salesforceliveagent.com/content/g/js/39.0/deployment.js"}else if(F.match(/(www|secure)\.telegraph/g)){salesforceLiveAgentChatPanel.org_id=
"57220000000PCi9";salesforceLiveAgentChatPanel.button_id="5730J000000bm0S";salesforceLiveAgentChatPanel.button_registration_id="5730J000000bm0X";salesforceLiveAgentChatPanel.button_service_id="5730J000000TPOh";salesforceLiveAgentChatPanel.deployment_id="00D2000000093Wf";salesforceLiveAgentChatPanel.chat_url="https://d.la1-c1-frf.salesforceliveagent.com/chat";salesforceLiveAgentChatPanel.sf_url="https://c.la1-c1-frf.salesforceliveagent.com/content/g/js/39.0/deployment.js"}else if(F.match(/qa5/)){salesforceLiveAgentChatPanel.org_id=
"57220000000PCi9";salesforceLiveAgentChatPanel.button_id="573260000008Oek";salesforceLiveAgentChatPanel.button_registration_id="573260000008Oel";salesforceLiveAgentChatPanel.button_service_id="573260000008OgR";salesforceLiveAgentChatPanel.deployment_id="00D26000000D9Ef";salesforceLiveAgentChatPanel.chat_url="https://d.la1-c2cs-lon.salesforceliveagent.com/chat";salesforceLiveAgentChatPanel.sf_url="https://c.la1-c2cs-lon.salesforceliveagent.com/content/g/js/39.0/deployment.js"}else if(F.match(/qa6/)&&
O){salesforceLiveAgentChatPanel.button_id="5736E0000008OmZ";salesforceLiveAgentChatPanel.button_service_id="5736E0000008PMr"}if(document.querySelector(".premium-paywall.component"))x=false;else if(D.indexOf("/subscriptions")===0)x=true;else if(D.indexOf("/premium/product")===0)x=true;else if(D.indexOf("/premium/digital-editions")===0)x=true;else if(D.indexOf("/premium/subscriptions/")===0)x=true;else if(D==="/secure/payment/"){window.salesforceLiveAgentChatPanel.dwell=-1;x=true}else if(D==="/secure/registration/"){salesforceLiveAgentChatPanel.button_id=
salesforceLiveAgentChatPanel.button_registration_id;window.salesforceLiveAgentChatPanel.dwell=-1;x=true}else if(D==="/secure/login/"){salesforceLiveAgentChatPanel.button_id=salesforceLiveAgentChatPanel.button_registration_id;window.salesforceLiveAgentChatPanel.dwell=-1;x=true}else if(O){salesforceLiveAgentChatPanel.attemptUserMapping=true;salesforceLiveAgentChatPanel.button_id=salesforceLiveAgentChatPanel.button_service_id;window.salesforceLiveAgentChatPanel.dwell=-1;x=true}if(!F.match(/(www|secure.telegraph|staging|perf|qa6|qa5)/g))f=
true;return x===true&&f===false};a.lexicalPattern=""})();(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Subscriptions","pattern":"/subscriptions"});var t="aemproduction.filters.Subscriptions";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"paywall page"});var t="aemproduction.filters.PaywallPage";qubit.Define.clientNamespace(t,a);a.customStarter=function(J,x){x(false)};a.customScript=function(J){var x=false;if(document.querySelector(".premium-paywall.component"))x=true;return x};a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/subscriptions/ppc","pattern":"telegraph.co.uk/subscriptions/ppc/","patternType":"CONTAINS"});var t="aemproduction.filters.SubscriptionsPpc";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"/secure/payment","pattern":"telegraph.co.uk/secure/payment/?","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.SecurePayment";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Match Contains: telegraph.co.uk/travel","pattern":"telegraph.co.uk/travel","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /secure/redeem","pattern":"telegraph.co.uk/secure/redeem","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.SecureActivate";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=function(J){return true};a.lexicalPattern='{"rows":[],"operators":[]}'})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/subscriptions/sub-bar","pattern":"telegraph.co.uk/subscriptions/sub-bar/","patternType":"CONTAINS"});var t="aemproduction.filters.SubscriptionsSubBar";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":'Exclude ":4502/"',"pattern":":4502/","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Exclude4502";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude telegraph.co.uk/financial-services/","pattern":"telegraph.co.uk/financial-services/","patternType":"CONTAINS"});var t="aemproduction.filters.FinancialServices";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll41";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll3";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Travel only","pattern":"telegraph.co.uk/travel"});var t="aemproduction.filters.TravelOnly";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=function(J){return true};a.lexicalPattern='{"rows":[],"operators":[]}'})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/tablet/international","pattern":"telegraph.co.uk/subscriptions/tablet/international","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSubscriptionsTabletInternational";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Money Channel","pattern":"/money/"});var t="aemproduction.filters.MoneyOnly";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include /travel/city-breaks","pattern":"/travel/city-breaks"});var t="aemproduction.filters.IncludeTravelCityBreaks";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default filter: Match all(2)","pattern":"","patternType":"ALL_URLS","priority":2});var t="aemproduction.filters.DefaultFilterMatchAll2";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Business Channel","pattern":"/business/"});var t="aemproduction.filters.BusinessChannel";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default","pattern":"*","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Default2";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /travel/hotel","pattern":"telegraph.co.uk/travel/hotel","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeTravelHotel";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Financial Services only","pattern":"telegraph.co.uk/financial-services/"});var t="aemproduction.filters.FinancialServicesOnly";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/website/international","pattern":"telegraph.co.uk/subscriptions/website/international","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSubscriptionsWebsiteInternational";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/travel/destinations","pattern":"telegraph.co.uk/travel/destinations"});var t="aemproduction.filters.TravelDestinations3";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /travel","pattern":"telegraph.co.uk/travel","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeTravel";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude /secure/","pattern":"/secure/"});var t="aemproduction.filters.ExcludeSecure1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"NOT https://secure.telegraph.co.uk/financial-services/retirement-solutions/funeral-plans/secure-page/","pattern":"https://secure.telegraph.co.uk/financial-services/retirement-solutions/funeral-plans/secure-page/","patternType":"STARTS_WITH"});var t="aemproduction.filters.NOTHttpsSecureTelegraphCoUkFinancialServicesRetirementSolutionsFuneralPlansSecurePage";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=
null;a.lexicalPattern=""})();(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/newspaper","pattern":"telegraph.co.uk/subscriptions/newspaper","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSubscriptionsNewspaper1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default","pattern":"*","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Default4";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/tablet","pattern":"telegraph.co.uk/subscriptions/tablet","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.IncludeSubscriptionsTablet";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Staging Secure Pages","pattern":"secure-staging-ams.telegraph.co.uk"});var t="aemproduction.filters.StagingSecurePages";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"/secure/payment","pattern":"telegraph.co.uk/secure/payment/","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.SecurePayment1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude /premium/","pattern":"/premium/"});var t="aemproduction.filters.ExcludeSecure2";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=function(J){return true};a.lexicalPattern='{"rows":[],"operators":["or"]}'})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default","pattern":"*","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Default3";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /secure/payment/confirmation","pattern":"telegraph.co.uk/secure/payment/confirmation","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSecurePaymentConfirmation1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Money Channel","pattern":"/money/"});var t="aemproduction.filters.MoneyChannel";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Premium","pattern":"/premium/"});var t="aemproduction.filters.Premiun";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Except homepage","pattern":"http://www.telegraph.co.uk/cars/","patternType":"MATCHES_EXACTLY","priority":1});var t="aemproduction.filters.ExceptHomepage";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude /secure/","pattern":"/secure/"});var t="aemproduction.filters.ExcludeSecure";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"HotJar Rule","patternType":"ENDS_WITH"});var t="aemproduction.filters.HotJarRule";qubit.Define.clientNamespace(t,a);a.customStarter=function(J,x){x(false)};a.customScript=function(J){if(window.location.pathname=="/secure/registration/"||window.location.pathname=="/premium/"||window.location.pathname=="/premium/prime/"||window.location.pathname=="/premium/product/"||window.location.pathname=="/premium/digital-editions/"||window.location.pathname==
"/subscriptions/"||window.location.pathname=="/subscriptions/sub-bar/")return true;else return false};a.lexicalPattern=""})();(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Confirmation","pattern":"/secure/payment/confirmation"});var t="aemproduction.filters.Confirmation";qubit.Define.clientNamespace(t,a);a.customStarter=function(J,x){x(false)};a.customScript=function(J){return true};a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/subscriptions","pattern":"telegraph.co.uk/subscriptions/","patternType":"CONTAINS"});var t="aemproduction.filters.Subscriptions1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Default","pattern":"*","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.Default1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/newspaper","pattern":"telegraph.co.uk/subscriptions/newspaper","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSubscriptionsNewspaper";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include /travel/family-holiday","pattern":"/travel/family-holiday"});var t="aemproduction.filters.IncludeTravelFamilyHoliday";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"/secure/payment/confirmation","pattern":"/secure/payment/confirmation","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.SecurePaymentConfirmation";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll46";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /travel/hotels","pattern":"telegraph.co.uk/travel/hotels","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeTravelHotel1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include Financial Services (temp)","pattern":"/financial-services/retirement-solutions/equity-release-service/interest-only-mortgages-fuel-equity-release"});var t="aemproduction.filters.IncludeFinancialServicesTemp";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include URL Param ?openxsync","pattern":"openxsync"});var t="aemproduction.filters.IncludeURLParamOpenxsync1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"Include  /registration.telegraph.co.uk/newsletters/Football/","pattern":"registration.telegraph.co.uk/newsletters/Football"});var t="aemproduction.filters.RegistrationTelegraphCoUkNewslettersFootball";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=function(J){return J.referrer[J.referrer.length-1].landing.indexOf&&J.referrer[J.referrer.length-1].landing.indexOf("registration.telegraph.co.uk/newsletters/Football")>=
0&&J.referrer[J.referrer.length-1].time>(new Date).getTime()-1*6E4};a.lexicalPattern='{"rows":[{"operators":[],"starters":[],"variables":[{"type":"lastLandingPage","comparator":[3,2],"value":["registration.telegraph.co.uk/newsletters/Football","1"]}]}],"operators":[]}'})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude /subscriptions/","pattern":"/subscriptions/"});var t="aemproduction.filters.ExcludeSubscriptions";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all(1)","pattern":"^http://www\\.telegraph\\.co\\.uk/cars/","patternType":"REGULAR_EXPRESSION","priority":2});var t="aemproduction.filters.DefaultFilterMatchAll1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /secure/payment/confirmation","pattern":"telegraph.co.uk/secure/payment/confirmation","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.IncludeSecurePaymentConfirmation";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Include /subscriptions/website","pattern":"telegraph.co.uk/subscriptions/website","patternType":"CONTAINS","priority":2});var t="aemproduction.filters.IncludeSubscriptionsWebsite";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":"Exclude /secure/","pattern":"/secure/"});var t="aemproduction.filters.ExcludeSecure11";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Cars homepage only","pattern":"http://www.telegraph.co.uk/cars/","patternType":"MATCHES_EXACTLY","priority":1});var t="aemproduction.filters.CarsHomepageOnly";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":true,"name":"Default filter: Match all","pattern":"","patternType":"ALL_URLS","priority":1});var t="aemproduction.filters.DefaultFilterMatchAll45";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"name":"/secure/registration","pattern":"telegraph.co.uk/secure/registration/","patternType":"CONTAINS"});var t="aemproduction.filters.SecureRegistration1";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.filter.Filter;var a=new u({"include":false,"name":'Exclude "chase.telegraph.co.uk"',"pattern":"chase.telegraph.co.uk","patternType":"CONTAINS","priority":1});var t="aemproduction.filters.ExcludeChaseTelegraphCoUk";qubit.Define.clientNamespace(t,a);a.customStarter=null;a.customScript=null;a.lexicalPattern=""})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Delete Ooyala Cookie:[v1.0]","description":"Delete the Ooyala cookie"});var t="aemproduction.tags.commercialdeleteooyalacookiev10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript\x3e\n(function(cookieToEmpty) {\n\tif (document.cookie.indexOf("; "+ cookieToEmpty + "\x3d")){\n\t\tdocument.cookie \x3d cookieToEmpty +"\x3d; path\x3d/;"\n\t}\n})("Ooyala");\n\x3c/script\x3e';a.addClientFiltersList([]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCIAL: Spark - Timer Functions [v1.3]","description":"SPARK team","disabled":true});var t="aemproduction.tags.commercialsparktimerfunctions.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript\x3e\nif(tmgAds.dfp.site \x3d\x3d 'sponsored'){\nvar milestones \x3d [1, 25, 50, 75, 100]; //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100];\nvar timeEvents \x3d [{t: 3000, c: '3 seconds'},{t: 10000, c: '10 seconds'},{t: 30000, c: '30 seconds'},{t: 60000, c: '60 seconds'}];\nvar articleItemprop, articleItempropchecked \x3d false, articleItempropNextElementSibling;\nvar campaignId \x3d '';\nwindow.addEventListener(\"load\", function() {\n    getCampaignId();\n    sparkTimerFunction(\"Page Load Completed\");\n    getAllElementsWithAttribute('itemprop');\n    for (var i \x3d 0; i \x3c timeEvents.length; i++) {\n        setTimeoutEvents (timeEvents[i].t, timeEvents[i].c);\n    }\n}, false);\nwindow.onscroll \x3d function(event) {\n    if (articleItemprop !\x3d\x3d undefined \x26\x26 checkVisible(articleItempropNextElementSibling) \x3d\x3d true \x26\x26 articleItempropchecked \x3d\x3d false) {\n        _satellite.setVar(\"scrollpoint\", campaignId + 'scrollpoint: articleItemprop');\n        _satellite.track(\"scrollpoint\");\n        // console.log(campaignId + 'scrollpoint: articleItemprop');\n        articleItempropchecked \x3d true;\n    }\n    for (var i \x3d 0; i \x3c milestones.length; i++) {\n        if (getScrollPercent() \x3e\x3d milestones[i]) {\n            var index \x3d milestones.indexOf(milestones[i]);\n            if (index \x3e -1) {\n                _satellite.setVar(\"scrollpoint\", campaignId + 'scrollpoint: ' + milestones[i]+'%');\n                _satellite.track(\"scrollpoint\");\n                // console.log(campaignId + 'scrollpoint: ' + milestones[i]+'%');\n                milestones.splice(index, 1);\n            }\n        }\n    }\n};\nvar sparkTimerFunction \x3d function(a) {\n    _satellite.setVar(\"timerpoint\", campaignId + a);\n    _satellite.track(\"sparkTimer\");\n    // console.log(campaignId + a);\n};\nvar getCampaignId \x3d function() {\n    campaignId \x3d (document.head.querySelector(\"[name\x3d'DCSext.campaignId']\") !\x3d null \x26\x26 document.head.querySelector(\"[name\x3d'DCSext.campaignId']\").content.length \x3e 0) ? \"Campaign id: \" + document.head.querySelector(\"[name\x3d'DCSext.campaignId']\").content + \" - \" : '';\n};\nvar setTimeoutEvents \x3d function(a,b) {\n    setTimeout(function() {\n        _satellite.setVar(\"timerpoint\", campaignId + 'timerpoint: ' + b);\n        _satellite.track(\"sparkTimer\");\n       // console.log(campaignId + 'timerpoint: ' + b);\n    }, a);\n};\nvar getScrollPercent \x3d function() {\n    var h \x3d document.documentElement,\n        b \x3d document.body,\n        st \x3d 'scrollTop',\n        sh \x3d 'scrollHeight';\n    return (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;\n};\nvar checkVisible \x3d function(elm) {\n    if(articleItempropNextElementSibling !\x3d null) {\n        var rect \x3d elm.getBoundingClientRect();\n        var viewHeight \x3d Math.max(document.documentElement.clientHeight, window.innerHeight);\n        return !(rect.bottom \x3c 0 || rect.top - viewHeight \x3e\x3d 0);\n    }    \n};\nvar getAllElementsWithAttribute \x3d function(attribute) {\n    var allElements \x3d document.getElementsByTagName('article');\n    for (var i \x3d 0, n \x3d allElements.length; i \x3c n; i++) {\n        if (allElements[i].getAttribute(attribute)) {\n            articleItemprop \x3d allElements[i];\n            articleItempropNextElementSibling \x3d articleItemprop.nextElementSibling;\n        }\n    }\n};\n};\n\x3c/script\x3e";a.addClientFiltersList([]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCIAL: WayIn Populate Adobe ID [v1.0]","description":"WayInTag","disabled":false});var t="aemproduction.tags.commercialwayinpopulateadobeidv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(){var F=document.cookie.match("(^|;)\\s*AMCV_2C7336C753C676BA0A490D4B%40AdobeOrg\\s*\x3d\\s*([^;]+)");
return F?decodeURIComponent(F.pop()).split("|")[4]:"00000000000000000000000000000000000000"}if(RUM)RUM.mark("spark_wayin_tracking_start");var x;var f;var D=window.location.href.indexOf("debug")!==-1?true:false;setTimeout(function(){var F=document.querySelectorAll('[id^\x3d"ngxFrame"]');x=F.length>0?F[0].getAttribute("id"):null;f=document.getElementById(x);var O=J();var L="";if(f){if(D)console.log("WAYIN: Frame found. Trying to send message to frame.");L=NGX.Embed.sendMessage({id:x,action:"setfieldvalues",
payload:{adobe_id:O}})}else if(D)console.log("WAYIN: Frame not found.");if(D){console.log("WayInFrame: "+f);console.log("Adobe ID: "+J());console.log("NGX response: "+L)}},7E3);if(RUM){RUM.mark("spark_wayin_tracking_end");performance.measure("spark_wayin_loadtime","spark_wayin_tracking_start","spark_wayin_tracking_end")}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"MARKETING: Branch.io [v2.0]","description":"Branch handles our Smart Banner which drives traffic from the Website to our Native Apps. This latest version handles pushing to the Editions App from Tablet devices."});var t="aemproduction.tags.marketingbranchiov20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll46","aemproduction.filters.ExcludeSecure11","aemproduction.filters.ExcludeSecure2",
"aemproduction.filters.ExcludeSubscriptions"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(L){(function(R,W,X,Z,da,aa,l,b,A,r){if(!R[Z]||!R[Z]._q){for(;b<l.length;)da(aa,l[b++]);A=W.createElement(X);A.async=1;A.src="https://cdn.branch.io/branch-latest.min.js";r=W.getElementsByTagName(X)[0];r.parentNode.insertBefore(A,r);R[Z]=aa}})(window,document,"script","branch",function(R,W){R[W]=function(){R._q.push([W,
arguments])}},{_q:[],_v:1},"addListener applyCode banner closeBanner creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode".split(" "),0);branch.init(L);var K=function(R){branch.track("Clicked Journey Close")};branch.addListener("didClickJourneyClose",K)}var x="key_live_kgFjVjI3BHbfiD2ahbAprdfjDubrjwCx";var f="key_live_kewl2z6z3givXcCT1mXWAndjAsd4yHTw";var D=navigator.userAgent.toLowerCase();
var F=/(?:iphone|ipod)|android.*mobile/i.test(D);var O=/(iphone|ipod|ipad|android)/i.test(D);if(F)J(x);else if(O)J(f)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCIAL: Custom Affiliate Link [v1.1]"});var t="aemproduction.tags.commercialcustomaffiliatelinkv11.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(){var K=document.cookie.match("(^|;)\\s*AMCV_2C7336C753C676BA0A490D4B%40AdobeOrg\\s*\x3d\\s*([^;]+)");
return K?decodeURIComponent(K.pop()).split("|")[4]:"00000000000000000000000000000000000000"}function x(){D=F!==null&&F.content.length>0?F.content:"";for(var K=0;K<O.length;K++){var R=O[K];var W=R.getAttribute("href");var X=W.replace("customid",D+"-"+J());R.href=X}}var f=window.performance?window.performance.mark("AffiliateTrack_Start"):(new Date).getTime();var D="";var F=document.head.querySelector("[name\x3d'tmgads.articleid']");var O=document.querySelectorAll(".article__body a");setTimeout(function(){x()},
5E3);var L=window.performance?window.performance.mark("AffiliateTrack_End"):(new Date).getTime();if(!window.performance&&console)console.log("Affiliate Tracking load time is:"+(L-f));else if(window.performance){window.performance.measure("js_affiliate_track","AffiliateTrack_Start","AffiliateTrack_End");window.performance.clearMarks("AffiliateTrack_End");window.performance.clearMarks("AffiliateTrack_Start")}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALYTICS: HOTJAR [v1.1]"});var t="aemproduction.tags.analyticshotjarv11.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.HotJarRule1"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J=window.performance?window.performance.mark("hotjar_start"):(new Date).getTime();(function(f,D,F,O,
L,K){f.hj=f.hj||function(){(f.hj.q=f.hj.q||[]).push(arguments)};f._hjSettings={hjid:88438,hjsv:5};L=D.getElementsByTagName("head")[0];K=D.createElement("script");K.async=1;K.src=F+f._hjSettings.hjid+O+f._hjSettings.hjsv;L.appendChild(K)})(window,document,"//static.hotjar.com/c/hotjar-",".js?sv\x3d");var x=window.performance?window.performance.mark("hotjar_end"):(new Date).getTime();if(!window.performance&&console)console.log("Affiliate Tracking load time is:"+(x-J));else if(window.performance){window.performance.measure("js_hotjar_track",
"hotjar_start","hotjar_end");window.performance.clearMarks("hotjar_end");window.performance.clearMarks("hotjar_start")}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"COMMERCIAL: Confirmation_twitter:[v1.0]","disabled":false,"id":56175094,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.commercialconfirmation_twitterv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript src\x3d"//platform.twitter.com/oct.js" type\x3d"text/javascript"\x3e\x3c/script\x3e \x3cscript type\x3d"text/javascript"\x3e twttr.conversion.trackPid(\'l5wah\', { tw_sale_amount: order.price, tw_order_quantity: 1 });\x3c/script\x3e \x3cnoscript\x3e \x3cimg height\x3d"1" width\x3d"1" style\x3d"display:none;" alt\x3d"" src\x3d"https://analytics.twitter.com/i/adsct?txn_id\x3dl5wah\x26p_id\x3dTwitter\x26tw_sale_amount\x3d0\x26tw_order_quantity\x3d0" /\x3e \x3cimg height\x3d"1" width\x3d"1" style\x3d"display:none;" alt\x3d"" src\x3d"//t.co/i/adsct?txn_id\x3dl5wah\x26p_id\x3dTwitter\x26tw_sale_amount\x3d0\x26tw_order_quantity\x3d0" /\x3e\x3c/noscript\x3ew_sale_amount\x3d0\x26tw_order_quantity\x3d0" /\x3e\x3c/noscript\x3e';
a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll2","aemproduction.filters.IncludeSecurePaymentConfirmation"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":true,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"OPERATIONS: Cookie Notification Script [v2.0]","disabled":false,"id":49047265,"locked":false,"locationObject":"BODY"});var t="aemproduction.tags.operationscookienotificationscriptv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript type\x3d"text/javascript"\x3e    \nvar cookieHolder \x3d document.createElement("div"),\n                mainBody \x3d document.getElementsByTagName("body")[0];\n\t\t\t\t\n\t\tvar mainContent \x3d mainBody.getElementsByClassName(\'main-content\');\n \n        cookieHolder.style.webkitTransition \x3d "all .3s";\n        cookieHolder.style.MozTransition \x3d "all .3s";\n        cookieHolder.style.transition \x3d "all .3s";\n        cookieHolder.style.height \x3d "0";\n        cookieHolder.style.overflow \x3d "hidden";\n \n \t    if(mainContent.length \x3d\x3d\x3d 1){\n \t    \tmainContent[0].insertBefore(cookieHolder, mainContent[0].childNodes[0]);\n \t    } else {\n \t    \tmainBody.insertBefore(cookieHolder, mainBody.childNodes[0]);\n \t    }\n \n        function cookieTop() {\n            var cookieConsent \x3d document.getElementById("qb_cookie_consent_main");\n            if (cookieConsent \x3d\x3d\x3d null) {\n                setTimeout(cookieTop, 500);\n                return;\n            }\n            cookieHolder.appendChild(cookieConsent);\n            cookieHolder.style.height \x3d "76px";\n            cookieRemove();\n           \n            setTimeout(function() {\n                cookieHolder.parentNode.removeChild(cookieHolder);\n                cookieHolder \x3d null;\n            }, 15000);\n        }\n   \n        function cookieRemove() {\n            var cookieConsent \x3d document.getElementById("qb_cookie_consent_main");\n            if (cookieConsent !\x3d null) {\n                setTimeout(cookieRemove, 250);\n                return;\n            }\n             \n            if (cookieHolder !\x3d null) {\n                cookieHolder.parentNode.removeChild(cookieHolder);\n            }\n             \n        }\n \n        cookieTop();\n\x3c/script\x3e';
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Salesforce-Active-Agent_Acquisition:[v2.0]","disabled":false});var t="aemproduction.tags.commercialsalesforceactiveagentacquisitionv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\n\x3c!--\nStart of Salesforce Active Agent (Acquisition) insert script\nThis tag must be placed as close as possible to the closing \x3c/body\x3e tag.\n0.2.1\nCreation Date: 06/01/2017\n--\x3e\n\x3cscript\x3e\n    (function(){\n        window.salesforceLiveAgentChatPanel \x3d window.salesforceLiveAgentChatPanel || {};\n        var defaults \x3d {\n            dwell: 15,\n            sf_url: \'https://c.la1-c1cs-frf.salesforceliveagent.com/content/g/js/39.0/deployment.js\',\n            chat_url: \'https://d.la1-c1cs-frf.salesforceliveagent.com/chat\',\n            org_id: \'57220000000PCi9\',\n            deployment_id: \'00D6E000000CtcP\',\n            button_id: \'5736E0000008OmZ\',\n            chat_window_height: 580,\n            user_id: null\n            /*  other available options\n             attemptUserMapping: true, (try to identify user from tmg_p13n cookie)\n             title: "Live chat",\n             text: "We\'re here to help, do you have any questions?",\n             buttonLabel: "Start live chat support now"*/\n        }, item;\n        for (item in defaults){\n            window.salesforceLiveAgentChatPanel[item] \x3d window.salesforceLiveAgentChatPanel[item] || defaults[item];\n        }\n    })();\n\x3c/script\x3e\n\x3cdiv id\x3d"liveagent_button_offline" style\x3d"display: none" title\x3d"Offline"  class\x3d"salesforce-livechat-panel inactive offline-marker"\x3ex\x3c/div\x3e\n\x3cdiv id\x3d"liveagent_button_online" style\x3d"display: none" class\x3d"salesforce-livechat-panel inactive"\x3e\n\x3cstyle\x3e\n    @media only screen and (max-width: 480px) {\n        .salesforce-livechat-panel  {\n            bottom: 18px;\n            right: 18px;\n        }\n        .ua-safari .salesforce-livechat-panel__button {\n            -webkit-transition: all 0 linear;\n            transition: all 0 linear;\n        }\n        .ua-safari .salesforce-livechat-panel  {\n            -webkit-transition: all 0ms ease-in, bottom 0ms ease-out;\n            transition: all 0ms ease-in, bottom 0ms ease-out;\n        }\n    }\n    @media only screen and (min-width: 480px) {\n        .salesforce-livechat-panel  {\n            bottom: 0;\n            max-width: 260px;\n            right: 26px;\n        }\n    }\n    @media only screen and (min-width: 730px) {\n        .salesforce-livechat-panel {\n            right: 50%;\n            transform: translateX(368px);\n        }\n        .articleRenderer2 .salesforce-livechat-panel {\n            transform: translateX(338px);\n        }\n    }\n    @media only screen and (min-width: 988px) {\n        .salesforce-livechat-panel {\n            right: 50%;\n            transform: translateX(476px);\n        }\n        .articleRenderer2 .salesforce-livechat-panel {\n            transform: translateX(456px);\n        }\n    }\n    @media only screen and (min-width: 1008px) {\n        .salesforce-livechat-panel {\n            transform: translateX(479px);\n        }\n        .articleRenderer2 .salesforce-livechat-panel {\n            transform: translateX(459px);\n        }\n    }\n    @media only screen and (min-width: 1328px) {\n        .salesforce-livechat-panel {\n            transform: translateX(626px);\n        }\n        .articleRenderer2 .salesforce-livechat-panel {\n            transform: translateX(459px);\n        }\n        .paymentRenderer .salesforce-livechat-panel {\n            transform: translateX(479px);\n        }\n    }\n    .salesforce-livechat-panel  {\n        max-height: 180px;\n        position: fixed;\n        transition: all 300ms ease-in, bottom 1500ms ease-out;\n        width: calc(100% - 36px);\n        z-index: 5000;\n    }\n    .salesforce-livechat-panel:not([data-active]) {\n        bottom: -80px;\n    }\n    .salesforce-livechat-panel.inactive.offline-marker {\n        background-color: darkred;\n        color: darkred;\n        border-radius: 50%;\n        width: 30px;\n        height: 30px;\n        overflow: hidden;\n    }\n    .salesforce-livechat-panel.inactive {\n        max-height: 40px;\n        max-width: 132px;\n        width: auto;\n    }\n    .salesforce-livechat-panel .intro {\n        margin: 0;\n    }\n    .salesforce-livechat-panel.inactive {\n        cursor: pointer;\n    }\n    .salesforce-livechat-panel.inactive .active-only {\n        display: none;\n    }\n    .salesforce-livechat-panel.inactive .header-bar__logo {\n        background-color: #c38419;\n    }\n    .salesforce-livechat-panel__content {\n        background-color: white;\n        padding: 8px;\n    }\n\n    .isalesforce-livechat-panel__intro {\n        border-bottom: 1px solid #cecece;\n        min-height: 42px;\n        position: relative;\n    }\n    .salesforce-livechat-panel__icon {\n        display: block;\n        left: 0;\n        position: absolute;\n        top: 2px;\n    }\n    .salesforce-livechat-panel__icon svg {\n        height: 26px;\n        fill: #c38419;\n        outline: 1px solid #cecece;\n        padding: 4px;\n        width: 26px;\n    }\n    .salesforce-livechat-panel__text {\n        display: inline-block;\n        font-family: "Telesans Text Regular", Arial, sans-serif;\n        font-size: 14px;\n        padding-bottom: 8px;\n    }\n    .salesforce-livechat-panel__hr {\n        border: 0;\n        background: transparent;\n        color: transparent;\n        height: 9px;\n        margin: 0;\n        padding: 0;\n    }\n    .salesforce-livechat-panel__button {\n        border: 0;\n        background-color: #c38419;\n        border-radius: 0;\n        color: #fff;\n        cursor: pointer;\n        display: block;\n        font-family: "Telesans Text Regular", Arial, sans-serif;\n        font-size: 14px;\n        font-weight: normal;\n        outline: 0;\n        padding: .9rem 1.4rem;\n        -webkit-transition: all 250ms linear;\n        transition: all 250ms linear;\n        text-align: center;\n        text-decoration: none;\n        width: 100%;\n    }\n    .salesforce-livechat-panel__button:hover,\n    .salesforce-livechat-panel__button:focus {\n        background-color: #9e6710;\n    }\n\x3c/style\x3e\n\x3cheader class\x3d"header-bar"\x3e\n    \x3cstyle\x3e\n        /*  header bar  */\n        .header-bar {\n            background-color: #353535;\n            color: white;\n            font-size: 14px;\n            line-height: 14px;\n        }\n        .header-bar__content {\n            align-items: stretch;\n            display: flex;\n        }\n        .header-bar__logo,\n        .header-bar__close {\n            font-size: 0;\n            line-height: 0;\n            padding: 8px 8px 6px 8px;\n        }\n        .header-bar__title {\n            font-size: 14px;\n            font-family: "Telesans Text Regular", Arial, sans-serif;\n            line-height: 18px;\n            padding: 8px 24px 0 12px;\n            flex-grow: 2;\n            white-space: nowrap;\n        }\n        .header-bar--graphic svg {\n            max-height: 20px;\n            max-width: 20px;\n            height: auto;\n            fill: white;\n            width: auto;\n        }\n        .header-bar__logo.header-bar--graphic svg {\n\n        }\n        .header-bar__close {\n            background: currentcolor;\n            border: 0 none;\n            color: #c38419;\n            cursor: pointer;\n            padding: 0 12px;\n        }\n        .header-bar__close:hover,\n        .header-bar__close:focus {\n            color: #9e6710;\n            outline: none;\n        }\n        .header-bar__close.header-bar--graphic svg {\n            background-color: transparent;\n            max-height: 14px;\n            max-width: 14px;\n        }\n    \x3c/style\x3e\n    \x3cdiv class\x3d"header-bar__content"\x3e\n        \x3cdiv class\x3d"header-bar__logo header-bar--graphic"\x3e\n            \x3csvg version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink" x\x3d"0px" y\x3d"0px"\n                     width\x3d"1792px" height\x3d"1792px" viewBox\x3d"0 0 1792 1792" enable-background\x3d"new 0 0 1792 1792" xml:space\x3d"preserve"\x3e\x3cg\x3e\n                    \x3cpath d\x3d"M1680.6,0H112L0,112v1121.2L112,1344h784h110.2c3.2,4.8,281.8,452.1,281.8,448c0-5.3,504-560,504-560V111.7\n                        L1680.6,0z M459.8,859.5L298.7,698.3l161.1-161.1l161.1,161.1L459.8,859.5z M895.9,859.5L734.8,698.3l161.1-161.1l161.1,161.1\n                        L895.9,859.5z M1332.2,859.5l-161.1-161.1l161.1-161.1l161.1,161.1L1332.2,859.5z"/\x3e\x3c/g\x3e\n                \x3c/svg\x3e\n        \x3c/div\x3e\n        \x3cdiv class\x3d"header-bar__title"\x3eLive chat\x3c/div\x3e\n        \x3cbutton class\x3d"header-bar__close header-bar--graphic active-only"\x3e\x3csvg version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink" x\x3d"0px" y\x3d"0px"\n                    width\x3d"1792px" height\x3d"1792px" viewBox\x3d"384 -512 1792 1792" enable-background\x3d"new 384 -512 1792 1792" xml:space\x3d"preserve"\x3e\x3cg\x3e\x3cg\x3e\x3cpolygon points\x3d"2176,1201 1359,384 2176,-433 2097,-512 1280,305 463,-512 384,-433 1201,384 384,1201 463,1280 1280,463\n                    2097,1280"/\x3e\x3c/g\x3e\x3c/g\x3e\x3c/svg\x3e\x3c/button\x3e\n    \x3c/div\x3e\n\x3c/header\x3e\n\x3cdiv class\x3d"salesforce-livechat-panel__content active-only"\x3e\n    \x3cdiv class\x3d"isalesforce-livechat-panel__intro"\x3e\n        \x3cspan class\x3d"salesforce-livechat-panel__text"\x3eWe\'re here to help, do you have any questions?\x3c/span\x3e\n    \x3c/div\x3e\n    \x3chr class\x3d"salesforce-livechat-panel__hr"/\x3e\n    \x3cbutton class\x3d"salesforce-livechat-panel__button" onclick\x3d"liveagent.startChat(salesforceLiveAgentChatPanel.button_id);"\x3e\x3cspan class\x3d"salesforce-livechat-panel__button-text"\x3eStart live chat support now\x3c/span\x3e\x3c/button\x3e\n\x3c/div\x3e\n\x3c/div\x3e\n\x3cscript\x3e\n\n(function() {\n    window.salesforceLiveAgentChatPanel \x3d window.salesforceLiveAgentChatPanel || {};\n    /*\n     * prep _laq object and load liveagent script\n     */\n    window._laq \x3d window._laq || [];\n    window._laq.push(function(){\n        var email \x3d window.tmg\x26\x26tmg.utils\x26\x26tmg.utils.store\x26\x26tmg.utils.store.get(\'tmg_user_email\');\n        liveagent.showWhenOnline(salesforceLiveAgentChatPanel.button_id, document.getElementById(\'liveagent_button_online\'), salesforceLiveAgentChatPanel.user_id);\n        if (screen.height \x3e salesforceLiveAgentChatPanel.chat_window_height+50){\n            liveagent.setChatWindowHeight(salesforceLiveAgentChatPanel.chat_window_height);\n        }\n        if (!!(salesforceLiveAgentChatPanel.attemptUserMapping)){\n            function makeUser(s){\n                var a \x3d s.replace(/{|}/g,"").split(","), i\x3d1,l \x3d a.length,obj\x3d{},t;\n                for (;i\x3cl ;i++){\n                    t \x3d a[i].split(\':\');\n                    try {\n                        obj[t[0]] \x3d t[1].replace(/(^\'|\'$)/g, "");\n                    } catch(e){}\n                }\n                return obj;\n            }\n            var user \x3d makeUser(Cookies.get("tmg_p13n")||"");\n\n            if (user.email){\n                liveagent.addCustomDetail("CaseStatus", "New");\n                liveagent.addCustomDetail("CaseOrigin", "Live Chat");\n                liveagent.addCustomDetail("CaseReason", "Live Chat - Service");\n                liveagent.findOrCreate("Case").map("Status", "CaseStatus", false, false, true);\n                liveagent.findOrCreate("Case").map("Origin", "CaseOrigin", false, false, true);\n                liveagent.findOrCreate("Case").map("Reason", "CaseReason", false, false, true);\n                liveagent.findOrCreate("Case").showOnCreate();\n                liveagent.findOrCreate("Case").saveToTranscript("CaseId");\n\n                liveagent.addCustomDetail("AccountEmail", user.email);\n                liveagent.setName(user.firstName +" "+ user.lastName);\n                liveagent.findOrCreate("Account").map("PersonEmail", "AccountEmail", true, true, false);\n                liveagent.findOrCreate("Account").saveToTranscript("AccountId");\n                liveagent.findOrCreate("Account").linkToEntity("Case", "AccountId");\n            }\n\n        }\n    });\n    var sfScript \x3d document.createElement(\'script\');\n    sfScript.type \x3d \'text/javascript\';\n    sfScript.async \x3d true;\n    sfScript.src \x3d salesforceLiveAgentChatPanel.sf_url;\n    var s \x3d document.getElementsByTagName(\'script\')[0]; s.parentNode.insertBefore(sfScript, s);\n\n    /*\n     *   Checks for the existence of window.liveagent, which is loaded async\n     *   see \'attempts\' for number of tries\n     *   see \'delay\' for wait between retries\n     */\n    var attempts \x3d 5,\n        delay \x3d 2e+3,\n        counter \x3d 0,\n        timer,\n        debug \x3d !!(location.search.match("debug")||location.hash.match("debug")),\n        prefix \x3d "Salesforce Active Agent - ",\n        getEmail \x3d function(s){\n            var a \x3d s ? s.match(/email:\\s?\'(.*?)\'/) : "";\n            return a.pop ? a.pop() : "";\n        },\n        initLiveAgent \x3d function(){\n            log("ACTIVATING");\n\n            attachObserver(\'liveagent_button_online\');\n            if (debug){\n                attachObserver(\'liveagent_button_offline\');\n            }\n            liveagent.init(salesforceLiveAgentChatPanel.chat_url, salesforceLiveAgentChatPanel.org_id, salesforceLiveAgentChatPanel.deployment_id);\n            liveagent.addCustomDetail(\'Current_Page\', location.pathname);\n        },\n        initiatePanel \x3d function(panel){\n            panel.setAttribute("data-active","true");\n            var text \x3d panel.querySelector(".salesforce-livechat-panel__text"),\n                title \x3d panel.querySelector(".header-bar__title"),\n                content \x3d panel.querySelector(".salesforce-livechat-panel__content"),\n                buttonLabel \x3d panel.querySelector(".salesforce-livechat-panel__button-text");\n\n            if (text \x26\x26 title) {\n                if (salesforceLiveAgentChatPanel.text) {\n                    text.innerText \x3d salesforceLiveAgentChatPanel.text;\n                }\n                if (salesforceLiveAgentChatPanel.title){\n                    title.innerText \x3d salesforceLiveAgentChatPanel.title;\n                }\n                if (salesforceLiveAgentChatPanel.buttonLabel){\n                    buttonLabel.innerText \x3d salesforceLiveAgentChatPanel.buttonLabel;\n                }\n                panel.addEventListener("click", function (e) {\n                    panel.classList.toggle("inactive");\n                    panel.classList.add("touched");\n                }, false);\n                content.addEventListener("click", function(e){\n                    if (e.stopPropagation){\n                        e.stopPropagation();\n                    }\n                }, false);\n                if ((salesforceLiveAgentChatPanel.dwell||salesforceLiveAgentChatPanel.dwell\x3d\x3d0)\x26\x26salesforceLiveAgentChatPanel.dwell\x3e-1){\n                    setTimeout(function () {\n                        if (panel.getAttribute("data-active") \x26\x26 panel.classList.contains("inactive") \x26\x26 !panel.classList.contains("touched")) {\n                            panel.classList.toggle("inactive");\n                        }\n                    }, +salesforceLiveAgentChatPanel.dwell * 1000);\n                }\n            }\n        },\n        attachObserver \x3d function(id){\n            var options \x3d { attributes : true, attributeFilter : [\'style\'] },\n                panel \x3d document.getElementById(id),\n                observer;\n\n            if ("MutationObserver" in window) {\n                observer \x3d new MutationObserver(function(mutations) {\n                    mutations.forEach(function(mutationRecord) {\n                        var el \x3d mutationRecord.target;\n                        setTimeout(function(){\n                            initiatePanel(el);\n                        },50);\n                    });\n                    observer.disconnect();\n                });\n                observer.observe(panel, options);\n            } else {\n                initiatePanel(panel);\n            }\n        },\n        retry \x3d function(){\n            counter++;\n            timer \x3d setTimeout(activateLiveAgent, delay);\n            log("inactive : retrying "+ counter, "darkorange");\n        },\n        log\x3dfunction(m,c){\n            if (debug){\n                c \x3d c || "green";\n                console.log("%c"+prefix + m, "color:"+c ) ;\n            }\n        },\n        activateLiveAgent \x3d function(){\n            clearTimeout(timer);\n            if (window.liveagent){\n                initLiveAgent();\n            } else if (counter \x3c attempts){\n                retry();\n            } else if (counter\x3d\x3d\x3dattempts){\n                log("ABORTING", "red");\n            }\n        };\n    activateLiveAgent();\n})();\n\x3c/script\x3e\n        \x3c!-- End of Salesforce Active Agent (Acquisition) Tag: Please do not remove --\x3e';a.addClientFiltersList(["aemproduction.filters.SalesforceLiveAgentSales1"]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Travel clicktripz [v1.5]","description":"RFC-8285"});var t="aemproduction.tags.commercialtravelclicktripzv15.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript type\x3d"text/javascript" src\x3d"https://compare-static.telegraph.co.uk/custom/telegraph/cti_telegraph.js" async\x3e\x3c/script\x3e';a.addClientFiltersList(["aemproduction.filters.Default4","aemproduction.filters.TravelDestinations5",
"aemproduction.filters.IncludeTravelCityBreaks","aemproduction.filters.IncludeTravelFamilyHoliday","aemproduction.filters.IncludeTravelTours","aemproduction.filters.IncludeTravelHotel1"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"ANALYTICS: Facebook [v2.0]","disabled":false,"id":53480643,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.marketingfacebook_periscopixv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3c!-- Facebook Pixel Code --\x3e\n\x3cscript\x3e\n!function(f,b,e,v,n,t,s){if(f.fbq)return;n\x3df.fbq\x3dfunction(){n.callMethod?\nn.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f.ac_fbq)f._fbq\x3dn;\nn.push\x3dn;n.loaded\x3d!0;n.version\x3d'2.0';n.queue\x3d[];t\x3db.createElement(e);t.async\x3d!0;\nt.src\x3dv;s\x3db.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,\ndocument,'script','//connect.facebook.net/en_US/fbevents.js');\n\nfbq('init', '678338115628438');\nfbq('track', \"PageView\");\x3c/script\x3e\n\x3cnoscript\x3e\x3cimg height\x3d\"1\" width\x3d\"1\" style\x3d\"display:none\"\nsrc\x3d\"https://www.facebook.com/tr?id\x3d678338115628438\x26ev\x3dPageView\x26noscript\x3d1\"\n/\x3e\x3c/noscript\x3e\n\x3c!-- End Facebook Pixel Code --\x3e";
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Acquisition_complete/[v1.0]"});var t="aemproduction.tags.commercialacquisitioncompletev10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3c!-- Acquisition journey complete  --\x3e\n\x3cimg src\x3d"https://traffic.outbrain.com/network/trackpxl?advid\x3d23890\x26action\x3dview" style\x3d"position: absolute" height\x3d"1" width\x3d"1" border\x3d"0" alt\x3d"" class\x3d"acquisitioncomplete" /\x3e';a.addClientFiltersList(["aemproduction.filters.IncludeSecurePaymentConfirmation1"]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"ADTECH: Polar.me [v7.0]","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var t="aemproduction.tags.adtechpolarmev70.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll45","aemproduction.filters.ExcludeSecure1"]);a.addClientVariablesMap({});
a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(){if(tmgAds.metrics.tmggptAdFirstAdQueued){tmgAdsLog("POLAR: DFP ads have already started to be called... lets do the Timewarp... I mean, call Polar ads.");window.mediaconductor=window.mediaconductor||function(){(mediaconductor.q=mediaconductor.q||[]).push(arguments)};mediaconductor("init","8147951252164934bcac37f1280cbe8a");mediaconductor("exec")}else if(x.count>=x.limit){tmgAdsLog("POLAR: DFP ads have not been called for more than "+
x.count+"s... lets call the Polar ads regardless");window.mediaconductor=window.mediaconductor||function(){(mediaconductor.q=mediaconductor.q||[]).push(arguments)};mediaconductor("init","8147951252164934bcac37f1280cbe8a");mediaconductor("exec")}else{++x.count;tmgAdsLog("POLAR: DFP ads have not started to be called yet... number of attempts left\x3d"+(x.limit-x.count));setTimeout(function(){J()},x.frequency)}}if(typeof window.tmgAdsLog!="function"){console.log("ADTECH:: Testing positive for content-blocking...");
window.tmgAdsEvent=function(f,D){var F="tmgAds:"+f;var O=new CustomEvent(F);document.dispatchEvent(O)};window.tmgAdsLog=function(f,D){if(void 0!==typeof tmgAds){var F={time:("00"+(tmgAdsTimer()/1E3).toFixed(5)).slice(-9),callee:null,extra:D,styling:"",css:{none:"background: #FFFFFF; color: #000000",alert:"background: #D4A6A6; color: #000000",success:"background: #B2D8B2; color: #000000",error:"background: #FFB2B2; color: #000000",warning:"background: #FFE4B2; color: #000000",optimizely:"background: #FFDD37: color: #000000",
event:"background: #C0CEDC; color: #000000"},msg:f};arguments.callee.caller&&(F.callee=arguments.callee.caller.name),F.msg="%c[TMG-GPT]["+F.time+"]["+(F.callee+"                         ").substr(0,25)+"]: "+F.msg,F.styling=F.css.none,"ALERT"==f.substr(0,5)&&(F.styling=F.css.alert),"OPTIMIZELY"==f.substr(0,10)&&(F.styling=F.css.optimizely),"SUCCESS"==f.substr(0,7)&&(F.styling=F.css.success),"ERROR"==f.substr(0,5)&&(F.styling=F.css.error),"WARNING"==f.substr(0,7)&&(F.styling=F.css.warning),"EVENT"==
f.substr(0,5)&&(F.styling=F.css.event),"INFO"==f.substr(0,4)&&(F.styling=F.css.info),tmgAds.log.push(F.msg)}};window.tmgAdsPerf=function(f,D){if(void 0!==window.RUM){if(tmgAdsLog("SUCCESS: RUM installed.... go go go go! - "+f+" - "+D[0]),tmgAds.log.push("Performance: RUM Installed - "+f+" - "+D[0]),"now"==f)return RUM.now();if("mark"==f)return tmgAds.metrics[D[0]]=tmgAdsTimer(),RUM.mark(D[0]);if("measure"==f)return RUM.measure(D[0],D[1],D[2])}else if(void 0!==window.performance){if(tmgAdsLog("WARNING: RUM NOT installed.... using window.performance API instead! - "+
f+" - "+D[0]),tmgAds.log.push("Performance: RUM Not installed, using performance API - "+f+" - "+D[0]),"now"==f)return window.performance.now();if("mark"==f)return tmgAds.metrics[D[0]]=tmgAdsTimer(),window.performance.mark(D[0]);if("measure"==f)return window.performance.measure(D[0],D[1],D[2])}else{if(tmgAdsLog("WARNING: RUM NOT installed AND window.performance not supported... - "+f+" - "+D[0]),tmgAds.log.push("Performance: No RUM, No perrformance API - "+f+" - "+D[0]),"now"==f)return RUM.now();
if("mark"==f)return void(tmgAds.metrics[D[0]]=tmgAdsTimer());if("measure"==f)return}};window.tmgAdsTimer=function(){var f=!1;return f=void 0!==window.RUM&&void 0!==window.RUM.now?window.RUM.now():void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),parseFloat(f.toFixed(3))};window.tmgAdsLoadJS=function(f,D,F){var O={name:f,status:"start",type:"text/javascript",url:D,performance:{loadjsStarted:tmgAdsTimer(),loadjsRequested:0,loadjsLoaded:0}};tmgAdsEvent(f+
":"+O.status);var L=document.createElement("script");L.type="text/javascript",L.async=!0,L.onload=function(){O.status="loaded",tmgAdsEvent(f+":"+O.status),O.performance.loadjsLoaded=tmgAdsTimer(),tmgAdsPerf("mark",["adverts_loaded_"+f]),tmgAds.metrics[f]||(tmgAds.metrics[f]={});for(var R in O.performance)tmgAds.metrics[f][R]=O.performance[R];tmgAds.metrics[f].loadjsLatency=parseFloat((tmgAds.metrics[f].loadjsLoaded-tmgAds.metrics[f].loadjsStarted).toFixed(3)),"function"==typeof F&&F()},O.status="requested",
O.performance.loadjsRequested=tmgAdsTimer(),tmgAdsEvent(f+":"+O.status),tmgAdsPerf("mark",["adverts_requested_"+f]),L.src=O.url;var K=document.getElementsByTagName("script")[0];K.parentNode.insertBefore(L,K)};window.tmgAdsGetMetaTag=function(f){try{var D=null;if(null!==document.getElementsByName(f)[0]&&void 0!==document.getElementsByName(f)[0]){if(tmgAdsLog("tmgAdsGetMetaTag("+f+"): document.getElementsByName('"+f+"')[0] exists"),document.getElementsByName(f)[0].content.length>0&&(D=document.getElementsByName(f)[0].content.toLowerCase(),
D="tmgads.articleid"==f?decodeURIComponent(document.getElementsByName(f)[0].content):decodeURIComponent(document.getElementsByName(f)[0].content.toLowerCase()),tmgAdsLog("tmgAdsGetMetaTag("+f+'): "'+D+'"')),"tmgads.keywords"==f)if(null!==D){D=D.split(",");for(var F=0;F<D.length;F++)String.prototype.trim?D[F]=D[F].trim():null!==typeof D[F]?D[F]=D[F].replace(/^\s\s*/,"").replace(/\s\s*$/,""):tmgAdsLog("tmgAdsGetMetaTag("+f+'): tmp[i] is null -\x3e "'+D[F]+'"'),tmgAdsLog("tmgAdsGetMetaTag("+f+'): tmgads.keywords -\x3e "'+
D[F]+'"')}else tmgAdsLog("tmgAdsGetMetaTag("+f+"): tmgads.keywords -\x3e tmgads.keywords content is not set")}else tmgAdsLog("tmgAdsGetMetaTag("+f+"): document.getElementsByName('"+f+"')[0] does not exist -\x3e "+D);return D}catch(O){tmgAdsLog("ERROR: tmgAdsGetMetTag("+f+") failed -\x3e error\x3d"+O.message)}};window.tmgAds=window.tmgAds||{};window.tmgAds.log=window.tmgAds.log||[];window.tmgAds.metrics=window.tmgAds.metrics||{ads:{}}}var x={name:"polar",ver:"7.0",date:"2017-09-07",url:"https://plugin.mediavoice.com/mediaconductor/mc.js",
callbackFn:function(){J()}};x.id=x.name;tmgAdsLoadJS(x.id,x.url,x.callbackFn)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"COMMERCIAL: Confirmation_adwords:[v1.0]","disabled":false,"id":56171982,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.commercialconfirmation_adwordsv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3c!-- Google Code for Remarketing Tag --\x3e\n\n\x3c!--------------------------------------------------\n\nRemarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup\n\n---------------------------------------------------\x3e\n\n\x3cscript type\x3d"text/javascript"\x3e\n\n/* \x3c![CDATA[ */\n\nvar google_conversion_id \x3d 971994445;\n\nvar google_custom_params \x3d window.google_tag_params;\n\nvar google_remarketing_only \x3d true;\n\n/* ]]\x3e */\n\n\x3c/script\x3e\n\n\x3cscript type\x3d"text/javascript" src\x3d"//www.googleadservices.com/pagead/conversion.js"\x3e\n\n\x3c/script\x3e\n\n\x3cnoscript\x3e\n\n\x3cdiv style\x3d"display:inline;"\x3e\n\n\x3cimg height\x3d"1" width\x3d"1" style\x3d"border-style:none;" alt\x3d"" src\x3d"//googleads.g.doubleclick.net/pagead/viewthroughconversion/971994445/?value\x3d0\x26amp;guid\x3dON\x26amp;script\x3d0"/\x3e\n\n\x3c/div\x3e\n\n\x3c/noscript\x3e';
a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll2","aemproduction.filters.IncludeSecurePaymentConfirmation"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Clear TMG Session cookie [v1.0]","disabled":false});var t="aemproduction.tags.commercialcleartmgsessioncookiev10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript\x3e\n(function() {\n\tvar cookies \x3d {},\n\t\tsplit,\n\t\tnameValue,\n\t\ti;\n\tif (document.cookie \x26\x26 document.cookie !\x3d\x3d "") {\n\t\tsplit \x3d document.cookie.split(";");\n\t\ti \x3d 0;\n\t\tfor (; i \x3c split.length; i \x3d i + 1) {\n\t\t\tnameValue \x3d split[i].split("\x3d");\n\t\t\tnameValue[0] \x3d nameValue[0].replace(/^ /, "");\n\t\t\tcookies[decodeURIComponent(nameValue[0])] \x3d decodeURIComponent(nameValue[1]);\n\t\t}\n\t}\n\tif (!cookies["tmg_pid"]\x26\x26cookies["tmg_session"]){\n\t\tdocument.cookie \x3d \'tmg_session\x3d; expires\x3d\'+ (new Date(0).toUTCString()) +\'; path\x3d/; domain\x3d.telegraph.co.uk\'\n\t};\n})();\n\x3c/script\x3e';
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALYTICS: Comscore [v5.0]","disabled":false});var t="aemproduction.tags.analyticscomscorev50.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){if(typeof window.tmgAdsLog!="function"){window.tmgAdsEvent=function(x,f){var D="tmgAds:"+x;var F=new CustomEvent(D);document.dispatchEvent(F)};
window.tmgAdsLog=function(x,f){if(void 0!==typeof tmgAds){var D={time:("00"+(tmgAdsTimer()/1E3).toFixed(5)).slice(-9),callee:null,extra:f,styling:"",css:{none:"background: #FFFFFF; color: #000000",alert:"background: #D4A6A6; color: #000000",success:"background: #B2D8B2; color: #000000",error:"background: #FFB2B2; color: #000000",warning:"background: #FFE4B2; color: #000000",optimizely:"background: #FFDD37: color: #000000",event:"background: #C0CEDC; color: #000000"},msg:x};arguments.callee.caller&&
(D.callee=arguments.callee.caller.name),D.msg="%c[TMG-GPT]["+D.time+"]["+(D.callee+"                         ").substr(0,25)+"]: "+D.msg,D.styling=D.css.none,"ALERT"==x.substr(0,5)&&(D.styling=D.css.alert),"OPTIMIZELY"==x.substr(0,10)&&(D.styling=D.css.optimizely),"SUCCESS"==x.substr(0,7)&&(D.styling=D.css.success),"ERROR"==x.substr(0,5)&&(D.styling=D.css.error),"WARNING"==x.substr(0,7)&&(D.styling=D.css.warning),"EVENT"==x.substr(0,5)&&(D.styling=D.css.event),"INFO"==x.substr(0,4)&&(D.styling=D.css.info),
tmgAds.log.push(D.msg)}};window.tmgAdsPerf=function(x,f){if(void 0!==window.RUM){if(tmgAdsLog("SUCCESS: RUM installed.... go go go go! - "+x+" - "+f[0]),tmgAds.log.push("Performance: RUM Installed - "+x+" - "+f[0]),"now"==x)return RUM.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),RUM.mark(f[0]);if("measure"==x)return RUM.measure(f[0],f[1],f[2])}else if(void 0!==window.performance){if(tmgAdsLog("WARNING: RUM NOT installed.... using window.performance API instead! - "+x+" - "+f[0]),tmgAds.log.push("Performance: RUM Not installed, using performance API - "+
x+" - "+f[0]),"now"==x)return window.performance.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),window.performance.mark(f[0]);if("measure"==x)return window.performance.measure(f[0],f[1],f[2])}else{if(tmgAdsLog("WARNING: RUM NOT installed AND window.performance not supported... - "+x+" - "+f[0]),tmgAds.log.push("Performance: No RUM, No perrformance API - "+x+" - "+f[0]),"now"==x)return RUM.now();if("mark"==x)return void(tmgAds.metrics[f[0]]=tmgAdsTimer());if("measure"==x)return}};window.tmgAdsTimer=
function(){var x=!1;return x=void 0!==window.RUM&&void 0!==window.RUM.now?window.RUM.now():void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),parseFloat(x.toFixed(3))};window.tmgAdsLoadJS=function(x,f,D){var F={name:x,status:"start",type:"text/javascript",url:f,performance:{loadjsStarted:tmgAdsTimer(),loadjsRequested:0,loadjsLoaded:0}};tmgAdsEvent(x+":"+F.status);var O=document.createElement("script");O.type="text/javascript",O.async=!0,O.onload=function(){F.status=
"loaded",tmgAdsEvent(x+":"+F.status),F.performance.loadjsLoaded=tmgAdsTimer(),tmgAdsPerf("mark",["adverts_loaded_"+x]),tmgAds.metrics[x]||(tmgAds.metrics[x]={});for(var K in F.performance)tmgAds.metrics[x][K]=F.performance[K];tmgAds.metrics[x].loadjsLatency=parseFloat((tmgAds.metrics[x].loadjsLoaded-tmgAds.metrics[x].loadjsStarted).toFixed(3)),"function"==typeof D&&D()},F.status="requested",F.performance.loadjsRequested=tmgAdsTimer(),tmgAdsEvent(x+":"+F.status),tmgAdsPerf("mark",["adverts_requested_"+
x]),O.src=F.url;var L=document.getElementsByTagName("script")[0];L.parentNode.insertBefore(O,L)};window.tmgAdsGetMetaTag=function(x){try{var f=null;if(null!==document.getElementsByName(x)[0]&&void 0!==document.getElementsByName(x)[0]){if(tmgAdsLog("tmgAdsGetMetaTag("+x+"): document.getElementsByName('"+x+"')[0] exists"),document.getElementsByName(x)[0].content.length>0&&(f=document.getElementsByName(x)[0].content.toLowerCase(),f="tmgads.articleid"==x?decodeURIComponent(document.getElementsByName(x)[0].content):
decodeURIComponent(document.getElementsByName(x)[0].content.toLowerCase()),tmgAdsLog("tmgAdsGetMetaTag("+x+'): "'+f+'"')),"tmgads.keywords"==x)if(null!==f){f=f.split(",");for(var D=0;D<f.length;D++)String.prototype.trim?f[D]=f[D].trim():null!==typeof f[D]?f[D]=f[D].replace(/^\s\s*/,"").replace(/\s\s*$/,""):tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmp[i] is null -\x3e "'+f[D]+'"'),tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmgads.keywords -\x3e "'+f[D]+'"')}else tmgAdsLog("tmgAdsGetMetaTag("+x+"): tmgads.keywords -\x3e tmgads.keywords content is not set")}else tmgAdsLog("tmgAdsGetMetaTag("+
x+"): document.getElementsByName('"+x+"')[0] does not exist -\x3e "+f);return f}catch(F){tmgAdsLog("ERROR: tmgAdsGetMetTag("+x+") failed -\x3e error\x3d"+F.message)}};window.tmgAds=window.tmgAds||{};window.tmgAds.log=window.tmgAds.log||[];window.tmgAds.metrics=window.tmgAds.metrics||{ads:{}}}var J={name:"comscore",ver:"5.0",date:"2017-08-30",site:tmgAdsGetMetaTag("tmgads.channel"),url:(document.location.protocol=="https:"?"https://sb":"http://b")+".scorecardresearch.com/beacon.js",callbackFn:function(){}};
J.id=J.name+"-"+J.ver;window._comscore=[];window._comscore.push({c1:"2",c2:"6035736",c3:"",options:{url_append:"comscorekw\x3d"+J.site}});tmgAdsLoadJS(J.id,J.url,J.callbackFn)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"COMMERCIAL: Confirmation_facebook:[v1.0]","disabled":false,"id":56171989,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.commercialconfirmation_facebookv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3c!-- Facebook Conversion Code for Subscriptions - Telegraph UK --\x3e \n\x3cscript\x3e(function() {   var _fbq \x3d window._fbq || (window._fbq \x3d []);   if (!_fbq.loaded) {     var fbds \x3d document.createElement('script');     fbds.async \x3d true;     fbds.src \x3d '//connect.facebook.net/en_US/fbds.js';     var s \x3d document.getElementsByTagName('script')[0];     s.parentNode.insertBefore(fbds, s);     _fbq.loaded \x3d true;   } })(); window._fbq \x3d window._fbq || []; window._fbq.push(['track', '6024247411211', {'value':order.price,'currency':'GBP'}]); \x3c/script\x3e \x3cnoscript\x3e\x3cimg height\x3d\"1\" width\x3d\"1\" alt\x3d\"\" style\x3d\"display:none\" src\x3d\"https://www.facebook.com/tr?ev\x3d6024247411211\x26amp;cd[value]\x3d0.00\x26amp;cd[currency]\x3dGBP\x26amp;noscript\x3d1\" /\x3e\x3c/noscript\x3e";
a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll2","aemproduction.filters.IncludeSecurePaymentConfirmation"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"ADTECH: AudienceCheck [v1.0]","description":"Pixel fire for better audience understanding"});var t="aemproduction.tags.adtechaudiencecheckv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cimg src\x3d"https://bcp.crwdcntrl.net/5/c\x3d991/b\x3d43754781" width\x3d"1" height\x3d"1"/\x3e';a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);
a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"MARKETING: Branch.io [v2.1]","description":"Branch handles our Smart Banner which drives traffic from the Website to our Native Apps. This latest version handles pushing to the Editions App from Tablet devices.","disabled":true});var t="aemproduction.tags.marketingbranchiov21.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript type\x3d"text/javascript"\x3e \n\nif(tmgAds.dfp.site !\x3d \'sponsored\'){\n\nfunction () {\n\n  var telegraphLiveAppKey \x3d \'key_live_kgFjVjI3BHbfiD2ahbAprdfjDubrjwCx\',\n      digitalEditionKey \x3d \'key_live_kewl2z6z3givXcCT1mXWAndjAsd4yHTw\',\n      userAgentLowerCase \x3d navigator.userAgent.toLowerCase(),\n      isiOSOrAndroidMobile \x3d ( /(?:iphone|ipod)|android.*mobile/i.test( userAgentLowerCase ) ),\n      isiOSOrAndroid \x3d ( /(iphone|ipod|ipad|android)/i.test( userAgentLowerCase ) );\n\n  if ( isiOSOrAndroidMobile ) {\n    startBranch(telegraphLiveAppKey)\n\n  } else {\n    //need to remove any windows / blackberries etc.\n    if (isiOSOrAndroid) {\n      startBranch(digitalEditionKey)\n    }\n  }\n\n  function startBranch(branchKey) {\n\n    (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s\x3c_.length;)c(h,_[s++]);d\x3dr.createElement(a);d.async\x3d1;d.src\x3d"https://cdn.branch.io/branch-latest.min.js";k\x3dr.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]\x3dh}})(window,document,"script","branch",function(b,r){b[r]\x3dfunction(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode banner closeBanner creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode".split(" "), 0);\n    \n    branch.init( branchKey );\n\n    var didClickJourneyCloseListener \x3d function(event) { \n      branch.track("Clicked Journey Close");\n    }\n\n    branch.addListener(\'didClickJourneyClose\', didClickJourneyCloseListener);\n  }\n}\n}\n\x3c/script\x3e';a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll46",
"aemproduction.filters.ExcludeSecure11","aemproduction.filters.ExcludeSecure2","aemproduction.filters.ExcludeSubscriptions"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"Fix: WEB-498 space-below-comments-mobile","locationObject":"HEAD"});var t="aemproduction.tags.tempfixspacebelowcommentsmobile.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cstyle\x3e\n.comments-block__main {\n\tdisplay: none;\n}\n.comments-block.is-open .comments-block__main {\n\tdisplay: block;\n}\n\x3c/style\x3e";a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll4"]);a.addClientVariablesMap({});
a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCIAL: Travel Facebook Tracking [v1.0]","description":"RFC-9682"});var t="aemproduction.tags.commercialtravelfacebooktrackingv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.TravelOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList(["aemproduction.tags.marketingfacebook_periscopixv20.Tag"]);a.pre=function(){};a.script=
function(){fbq("init","349979492031526");fbq("track","PageView")};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALYTICS: Travel Kissmetrics [v1.3]","description":"RFC-10440"});var t="aemproduction.tags.analyticstravelkissmetricsv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.TravelOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(D){setTimeout(function(){var F=document;var O=
F.getElementsByTagName("script")[0];var L=F.createElement("script");L.type="text/javascript";L.async=true;L.src=D;O.parentNode.insertBefore(L,O)},1)}var x=x||[];var f=f||"3f305d24cf322ffd19390e3929f4c407b8c7a12a";J("//i.kissmetrics.com/i.js");J("//scripts.kissmetrics.com/"+f+".2.js");document.addEventListener("DOMContentLoaded",function(){if(document.getElementsByClassName("product-listing__headline").length>0)x.push(["record","product listing present"])})};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Delete liveStreamAutoRefresh cookies [v1.0]","disabled":false});var t="aemproduction.tags.commercialdeletelivestreamautorefreshcookiesv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript\x3e\n(function(){\n\tvar keyValuePairs \x3d document.cookie.split('; '), name;\n\tfor(var i \x3d 0; i \x3c keyValuePairs.length; i++) {\n\t\tname \x3d keyValuePairs[i].substring(0, keyValuePairs[i].indexOf('\x3d'));\n\t\tif(name.indexOf('liveStreamAutoRefresh_') \x3e -1) {\n\t\t\tdocument.cookie \x3d name +\"\x3d;expires\x3dThu, 01 Jan 1970 00:00:01 GMT\";\n\t\t}\n\t}\n})();\n\x3c/script\x3e";
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"ADTECH: VisualDNA  [v1.0]","active":true,"disabled":false,"locked":false,"locationObject":"HEAD","url":"","timeout":5E3});var t="aemproduction.tags.adtechvisualdnav10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3c!-- VisualDNA Audience Analytics API Import --\x3e \n\x3cscript type\x3d"text/javascript"\x3e \n(function(){ var b, a; b\x3ddocument.createElement("script"); b.src\x3d"//a1.vdna-assets.com/analytics.js"; b.async\x3dtrue; a\x3ddocument.getElementsByTagName("head")[0]; a.insertBefore(b,a.firstChild); this.VDNA\x3dthis.VDNA||{}; this.VDNA.queue\x3dthis.VDNA.queue||[]; }()); \nVDNA.queue.push({apiKey:"telegraph.co.uk", method:"reportPageView", args:[window.location.href,document.referrer]}); \n\x3c/script\x3e \n\x3c!-- End of VisualDNA Audience Analytics API Import --\x3e';
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"TECH: Global nav HTML embed [v1.2]","disabled":false});var t="aemproduction.tags.techglobalnavhtmlembedv12.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J='\x3cstyle\x3e.header-nav-global .has-embed-visible .header-nav-global__html-embed{-webkit-animation:global-nav-html-reveal 0.3s forwards ease-out;animation:global-nav-html-reveal 0.3s forwards ease-out;display:block}.header-nav-global__html-embed{display:none;max-width:100%;opacity:0;position:absolute;right:0;top:42px;z-index:1000;overflow:hidden}.global--nav--container{font-family:"Austin News Deck Medium", Georgia, Times, serif;-webkit-font-smoothing:antialiased;width:450px;height:332px;background-image:url("/content/dam/subscriptions/premium-product/bgd.png");background-position:0 5px;background-size:100% auto;background-repeat:no-repeat;background-color:#F9F6F2;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.global--nav--container .global--nav--content{-ms-flex-item-align:start;align-self:flex-start}.global--nav--container .global--nav--title{color:#9A6710;font-size:30px;line-height:32px;width:70%;padding:25px 0 0 25px}.global--nav--container .global--nav--subtitle{color:#6B5E3F;font-size:20px;line-height:22px;padding:20px 0 0 25px}.global--nav--container a{text-decoration:none}.global--nav--container .global--nav--cta--container{width:150px;height:48px;background-color:#C38419;font-family:"Telesans Text Regular", Arial, sans-serif;font-size:14px;text-decoration:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:25px 0 0 25px}.global--nav--container .global--nav--cta{color:white}.global--nav--container .global--nav--footer{width:400px;height:40px;padding-top:10px;margin:0 25px;border-top:1px solid #DDDDDD}.global--nav--container .global--nav--footer .global--nav--footer--left{width:98px;float:left;margin-top:4px}.global--nav--container .global--nav--footer .global--nav--footer--right{width:106px;float:right}.global--nav--container img{width:100%;height:auto}\x3c/style\x3e\x3cdiv class\x3d"global--nav--container"\x3e\x3cdiv class\x3d"global--nav--content"\x3e\x3cdiv class\x3d"global--nav--title"\x3eUnlimited access to exclusive stories\x3c/div\x3e\x3cdiv class\x3d"global--nav--subtitle"\x3eFree for 30 days, then just \u00a31 per week\x3c/div\x3e\x3ca href\x3d"http://www.telegraph.co.uk/subscriptions/sub-bar/?icid\x3dgeneric_premiumsub_generic_generic_topnav-hover\x26redirectTo\x3dwww.telegraph.co.uk"\x3e\x3cdiv class\x3d"global--nav--cta--container"\x3e\x3cdiv class\x3d"global--nav--cta"\x3eStart free trial\x3c/div\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer"\x3e\x3cdiv class\x3d"global--nav--footer--line"\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer--left"\x3e\x3cimg src\x3d"/content/dam/subscriptions/premium-product/tele-micro.png" /\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer--right"\x3e\x3cimg src\x3d"/content/dam/subscriptions/premium-product/Premium-gold.png" /\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';
var x=document.querySelectorAll(".header-nav-global__html-embed");if(x)x.forEach(function(f){f.innerHTML=J})};a.post=function(){};a.postInitialisationSection=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"ANALYTICS: Bing [v2.0]","disabled":false,"id":53480642,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.marketingbingperiscopixv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript\x3e(function(w,d,t,r,u){var f,n,i;w[u]\x3dw[u]||[],f\x3dfunction(){var o\x3d{ti:"4047056"};o.q\x3dw[u],w[u]\x3dnew UET(o),w[u].push("pageLoad")},n\x3dd.createElement(t),n.src\x3dr,n.async\x3d1,n.onload\x3dn.onreadystatechange\x3dfunction(){var s\x3dthis.readyState;s\x26\x26s!\x3d\x3d"loaded"\x26\x26s!\x3d\x3d"complete"||(f(),n.onload\x3dn.onreadystatechange\x3dnull)},i\x3dd.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq");\x3c/script\x3e\x3cnoscript\x3e\x3cimg src\x3d"//bat.bing.com/action/0?ti\x3d4047056\x26Ver\x3d2" height\x3d"0" width\x3d"0" style\x3d"display:none; visibility: hidden;" /\x3e\x3c/noscript\x3e';
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ADTECH: LogEntries - AmazonA9","disabled":false});var t="aemproduction.tags.adtechlogentriesamazona9.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript\x3e\n//setTimeout(function(){\n//  ///*  Copyright 2015 Logentries - Please view license at https://raw.github.com/logentries/le_js/master/LICENSE */\n//  \'use strict\';(function(b,e){"function"\x3d\x3d\x3dtypeof define\x26\x26define.amd?define(function(){return e(b)}):"object"\x3d\x3d\x3dtypeof exports?("object"\x3d\x3d\x3dtypeof global\x26\x26(b\x3dglobal),module.exports\x3de(b)):b.LE\x3de(b)})(this,function(b){function e(a){var c\x3da.trace?(Math.random()+Math.PI).toString(36).substring(2,10):null,q\x3da.page_info,e\x3da.token,g\x3da.print,f\x3da.no_format,r;r\x3d"undefined"\x3d\x3d\x3dtypeof XDomainRequest?a.ssl:"https:"\x3d\x3d\x3db.location.protocol?!0:!1;var k;k\x3db.LEENDPOINT?b.LEENDPOINT:f?"webhook.logentries.com/noformat":"js.logentries.com/v1";k\x3d(r?"https://":"http://")+k+"/logs/"+e;var h\x3d[],l\x3d!1,s\x3d!1;if(a.catchall){var t\x3db.onerror;b.onerror\x3dfunction(a,b,d){m({error:a,line:d,location:b}).level("ERROR").send();return t?t(a,b,d):!1}}var p\x3dfunction(){var a\x3db.navigator||{doNotTrack:void 0},c\x3db.screen||{};return{url:(b.location||{}).pathname,referrer:document.referrer,screen:{width:c.width,height:c.height},window:{width:b.innerWidth,height:b.innerHeight},browser:{name:a.appName,version:a.appVersion,cookie_enabled:a.cookieEnabled,do_not_track:a.doNotTrack},platform:a.platform}},u\x3dfunction(){var a\x3dnull,a\x3dArray.prototype.slice.call(arguments);if(0\x3d\x3d\x3da.length)throw Error("No arguments!");return a\x3d1\x3d\x3d\x3da.length?a[0]:a},m\x3dfunction(a){var b\x3du.apply(this,arguments),d\x3d{event:b};"never"\x3d\x3d\x3dq||s\x26\x26"per-entry"!\x3d\x3dq||(s\x3d!0,"undefined"\x3d\x3d\x3dtypeof b.screen\x26\x26"undefined"\x3d\x3d\x3dtypeof b.browser\x26\x26m(p()).level("PAGE").send());c\x26\x26(d.trace\x3dc);return{level:function(a){if(g\x26\x26"undefined"!\x3d\x3dtypeof console\x26\x26"PAGE"!\x3d\x3da){var b\x3dnull;"undefined"!\x3d\x3dtypeof XDomainRequest\x26\x26(b\x3dd.trace+" "+d.event);try{console[a.toLowerCase()].call(console,b||d)}catch(c){console.log(b||d)}}d.level\x3da;return{send:function(){var a\x3d[],b\x3dJSON.stringify(d,function(b,d){if("undefined"\x3d\x3d\x3dtypeof d)return"undefined";if("object"\x3d\x3d\x3dtypeof d\x26\x26null!\x3d\x3dd){var c;a:{for(c\x3d0;c\x3ca.length;c++)if(d\x3d\x3d\x3da[c])break a;c\x3d-1}if(-1!\x3d\x3dc)return"\x3c?\x3e";a.push(d)}return d});l?h.push(b):n(e,b)}}}}};this.log\x3dm;var n\x3dfunction(a,b){l\x3d!0;var d;d\x3d"undefined"!\x3d\x3dtypeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;d.constructor\x3d\x3d\x3dXMLHttpRequest?d.onreadystatechange\x3dfunction(){4\x3d\x3d\x3dd.readyState\x26\x26(400\x3c\x3dd.status?(console.error("Couldn\'t submit events."),410\x3d\x3d\x3dd.status\x26\x26console.warn("This version of le_js is no longer supported!")):(301\x3d\x3d\x3dd.status\x26\x26console.warn("This version of le_js is deprecated! Consider upgrading."),0\x3ch.length?n(a,h.shift()):l\x3d!1))}:d.onload\x3dfunction(){0\x3ch.length?n(a,h.shift()):l\x3d!1};d.open("POST",k,!0);d.constructor\x3d\x3d\x3dXMLHttpRequest\x26\x26(d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.setRequestHeader("Content-type","application/json"));d.overrideMimeType\x26\x26d.overrideMimeType("text");d.send(b)}}function p(a){var b,c\x3d{ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1,endpoint:null,token:null};if("object"\x3d\x3d\x3dtypeof a)for(var f in a)c[f]\x3da[f];else throw Error("Invalid parameters for createLogStream()");if(null\x3d\x3d\x3dc.token)throw Error("Token not present.");b\x3dnew e(c);var g\x3dfunction(a){if(b)return b.log.apply(this,arguments);throw Error("You must call LE.init(...) first.");};return{log:function(){g.apply(this,arguments).level("LOG").send()},warn:function(){g.apply(this,arguments).level("WARN").send()},error:function(){g.apply(this,arguments).level("ERROR").send()},info:function(){g.apply(this,arguments).level("INFO").send()}}}var c\x3d{},f\x3dfunction(a){if("string"!\x3d\x3dtypeof a.name)throw Error("Name not present.");if(c.hasOwnProperty(a.name))throw Error("A logger with that name already exists!");c[a.name]\x3dnew p(a);return!0};return{init:function(a){var b\x3d{name:"default"};if("object"\x3d\x3d\x3dtypeof a)for(var c in a)b[c]\x3da[c];else if("string"\x3d\x3d\x3dtypeof a)b.token\x3da;else throw Error("Invalid parameters for init()");return f(b)},createLogStream:f,to:function(a){if(!c.hasOwnProperty(a))throw Error("Invalid name for logStream");return c[a]},destroy:function(a){"undefined"\x3d\x3d\x3dtypeof a\x26\x26(a\x3d"default");delete c[a]},log:function(){for(var a in c)c[a].log.apply(this,arguments)},warn:function(){for(var a in c)c[a].warn.apply(this,arguments)},error:function(){for(var a in c)c[a].error.apply(this,arguments)},info:function(){for(var a in c)c[a].info.apply(this,arguments)}}});\n//  ////////////////\n//  //// Initialise LE\n//  LE.init(\'d6e35d04-752f-46f4-b79e-e17a46619789\');\n//  ////////////////\n//  if(tmgAds){\n//    if(tmgAds.headerbidding !\x3d\x3d undefined){\n//      if(tmgAds.headerbidding.amazon){\n//        if(tmgAds.headerbidding.amazon.bids){\n//          for(var i in tmgAds.headerbidding.amazon.bids){\n//            LE.log("SUCCESS: slotID\x3d"+tmgAds.headerbidding.amazon.bids[i].slotID+" amznbid\x3d"+tmgAds.headerbidding.amazon.bids[i].amznbid+" amzniid\x3d"+tmgAds.headerbidding.amazon.bids[i].amzniid+" amznp\x3d"+tmgAds.headerbidding.amazon.bids[i].amznp);\n//          }\n//        } else {\n//          LE.log("FAIL: No tmgAds.headerbidding.amazon.bids: "+window.location.href+" -- ["+navigator.userAgent+"]");\n//        }\n//      } else {\n//        LE.log("FAIL: No tmgAds.headerbidding.amazon: "+window.location.href+" -- ["+navigator.userAgent+"]");\n//      }\n//    } else {\n//      LE.log("FAIL: No tmgAds.headerbidding: "+window.location.href+" -- ["+navigator.userAgent+"]");\n//    }\n//  } else {\n//    LE.log("FAIL: No tmgAds: "+window.location.href+" -- ["+navigator.userAgent+"]");\n//  }\n//}, 10000);\n\x3c/script\x3e';a.addClientFiltersList([]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"TECH: Global nav HTML embed [v1]","disabled":true});var t="aemproduction.tags.techglobalnavhtmlembedv1.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J='\x3cstyle\x3e.global--nav--container{font-family: "Austin News Deck Medium", Georgia, Times, serif;-webkit-font-smoothing: antialiased;width: 450px;height: 332px;background-image: url("/content/dam/subscriptions/premium-product/bgd.png");background-position: 0px 5px;background-size: 100% auto;background-repeat: no-repeat;background-color: #F9F6F2;display: flex;flex-direction: column;justify-content: space-between;}.global--nav--container .global--nav--content{align-self: flex-start;}.global--nav--container .global--nav--title{color: #9A6710;font-size: 30px;line-height: 32px;width: 70%;padding: 25px 0px 0px 25px;}.global--nav--container .global--nav--subtitle{color: #6B5E3F;font-size: 20px;line-height: 22px;padding: 20px 0px 0px 25px;}.global--nav--container a{text-decoration: none;}.global--nav--container .global--nav--cta--container{width: 150px;height: 48px;background-color: #C38419;font-family: "Telesans Text Regular", Arial, sans-serif;font-size: 14px;text-decoration: none;display: flex;align-items: center;justify-content: center;margin: 25px 0px 0px 25px;}.global--nav--container .global--nav--cta{color: white;}.global--nav--container .global--nav--footer{width: 400px;height: 40px;padding-top: 10px;margin: 0px 25px;border-top: 1px solid #DDDDDD;}.global--nav--container .global--nav--footer .global--nav--footer--left{width: 98px;float: left;margin-top: 4px;}.global--nav--container .global--nav--footer .global--nav--footer--right{width: 106px;float: right;}.global--nav--container img{width: 100%;height: auto;}\x3c/style\x3e\x3cdiv class\x3d"global--nav--container"\x3e\x3cdiv class\x3d"global--nav--content"\x3e\x3cdiv class\x3d"global--nav--title"\x3eUnlimited access to exclusive stories\x3c/div\x3e\x3cdiv class\x3d"global--nav--subtitle"\x3eFree for 30 days, then just \u00a31 per week\x3c/div\x3e\x3ca href\x3d"http://www.telegraph.co.uk/subscriptions/sub-bar/?icid\x3dgeneric_premiumsub_generic_generic_topnav-hover\x26redirectTo\x3dwww.telegraph.co.uk"\x3e\x3cdiv class\x3d"global--nav--cta--container"\x3e\x3cdiv class\x3d"global--nav--cta"\x3eStart free trial\x3c/div\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer"\x3e\x3cdiv class\x3d"global--nav--footer--line"\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer--left"\x3e\x3cimg src\x3d"/content/dam/subscriptions/premium-product/tele-micro.png" /\x3e\x3c/div\x3e\x3cdiv class\x3d"global--nav--footer--right"\x3e\x3cimg src\x3d"/content/dam/subscriptions/premium-product/Premium-gold.png" /\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';
var x=document.querySelectorAll(".header-nav-global__html-embed");if(x)x.forEach(function(f){f.innerHTML=J})};a.post=function(){};a.postInitialisationSection=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ADBLOCK: Oriel [v1.5]"});var t="aemproduction.tags.adtechorieladblocking15.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){if(typeof window.tmgAdsLog!="function"){window.tmgAdsEvent=function(x,f){var D="tmgAds:"+x;var F=new CustomEvent(D);document.dispatchEvent(F)};
window.tmgAdsLog=function(x,f){if(void 0!==typeof tmgAds){var D={time:("00"+(tmgAdsTimer()/1E3).toFixed(5)).slice(-9),callee:null,extra:f,styling:"",css:{none:"background: #FFFFFF; color: #000000",alert:"background: #D4A6A6; color: #000000",success:"background: #B2D8B2; color: #000000",error:"background: #FFB2B2; color: #000000",warning:"background: #FFE4B2; color: #000000",optimizely:"background: #FFDD37: color: #000000",event:"background: #C0CEDC; color: #000000"},msg:x};arguments.callee.caller&&
(D.callee=arguments.callee.caller.name),D.msg="%c[TMG-GPT]["+D.time+"]["+(D.callee+"                         ").substr(0,25)+"]: "+D.msg,D.styling=D.css.none,"ALERT"==x.substr(0,5)&&(D.styling=D.css.alert),"OPTIMIZELY"==x.substr(0,10)&&(D.styling=D.css.optimizely),"SUCCESS"==x.substr(0,7)&&(D.styling=D.css.success),"ERROR"==x.substr(0,5)&&(D.styling=D.css.error),"WARNING"==x.substr(0,7)&&(D.styling=D.css.warning),"EVENT"==x.substr(0,5)&&(D.styling=D.css.event),"INFO"==x.substr(0,4)&&(D.styling=D.css.info),
tmgAds.log.push(D.msg)}};window.tmgAdsPerf=function(x,f){if(void 0!==window.RUM){if(tmgAdsLog("SUCCESS: RUM installed.... go go go go! - "+x+" - "+f[0]),tmgAds.log.push("Performance: RUM Installed - "+x+" - "+f[0]),"now"==x)return RUM.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),RUM.mark(f[0]);if("measure"==x)return RUM.measure(f[0],f[1],f[2])}else if(void 0!==window.performance){if(tmgAdsLog("WARNING: RUM NOT installed.... using window.performance API instead! - "+x+" - "+f[0]),tmgAds.log.push("Performance: RUM Not installed, using performance API - "+
x+" - "+f[0]),"now"==x)return window.performance.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),window.performance.mark(f[0]);if("measure"==x)return window.performance.measure(f[0],f[1],f[2])}else{if(tmgAdsLog("WARNING: RUM NOT installed AND window.performance not supported... - "+x+" - "+f[0]),tmgAds.log.push("Performance: No RUM, No perrformance API - "+x+" - "+f[0]),"now"==x)return RUM.now();if("mark"==x)return void(tmgAds.metrics[f[0]]=tmgAdsTimer());if("measure"==x)return}};window.tmgAdsTimer=
function(){var x=!1;return x=void 0!==window.RUM&&void 0!==window.RUM.now?window.RUM.now():void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),parseFloat(x.toFixed(3))};window.tmgAdsLoadJS=function(x,f,D){var F={name:x,status:"start",type:"text/javascript",url:f,performance:{loadjsStarted:tmgAdsTimer(),loadjsRequested:0,loadjsLoaded:0}};tmgAdsEvent(x+":"+F.status);var O=document.createElement("script");O.type="text/javascript",O.async=!0,O.onload=function(){F.status=
"loaded",tmgAdsEvent(x+":"+F.status),F.performance.loadjsLoaded=tmgAdsTimer(),tmgAdsPerf("mark",["adverts_loaded_"+x]),tmgAds.metrics[x]||(tmgAds.metrics[x]={});for(var K in F.performance)tmgAds.metrics[x][K]=F.performance[K];tmgAds.metrics[x].loadjsLatency=parseFloat((tmgAds.metrics[x].loadjsLoaded-tmgAds.metrics[x].loadjsStarted).toFixed(3)),"function"==typeof D&&D()},F.status="requested",F.performance.loadjsRequested=tmgAdsTimer(),tmgAdsEvent(x+":"+F.status),tmgAdsPerf("mark",["adverts_requested_"+
x]),O.src=F.url;var L=document.getElementsByTagName("script")[0];L.parentNode.insertBefore(O,L)};window.tmgAdsGetMetaTag=function(x){try{var f=null;if(null!==document.getElementsByName(x)[0]&&void 0!==document.getElementsByName(x)[0]){if(tmgAdsLog("tmgAdsGetMetaTag("+x+"): document.getElementsByName('"+x+"')[0] exists"),document.getElementsByName(x)[0].content.length>0&&(f=document.getElementsByName(x)[0].content.toLowerCase(),f="tmgads.articleid"==x?decodeURIComponent(document.getElementsByName(x)[0].content):
decodeURIComponent(document.getElementsByName(x)[0].content.toLowerCase()),tmgAdsLog("tmgAdsGetMetaTag("+x+'): "'+f+'"')),"tmgads.keywords"==x)if(null!==f){f=f.split(",");for(var D=0;D<f.length;D++)String.prototype.trim?f[D]=f[D].trim():null!==typeof f[D]?f[D]=f[D].replace(/^\s\s*/,"").replace(/\s\s*$/,""):tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmp[i] is null -\x3e "'+f[D]+'"'),tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmgads.keywords -\x3e "'+f[D]+'"')}else tmgAdsLog("tmgAdsGetMetaTag("+x+"): tmgads.keywords -\x3e tmgads.keywords content is not set")}else tmgAdsLog("tmgAdsGetMetaTag("+
x+"): document.getElementsByName('"+x+"')[0] does not exist -\x3e "+f);return f}catch(F){tmgAdsLog("ERROR: tmgAdsGetMetTag("+x+") failed -\x3e error\x3d"+F.message)}};window.tmgAds=window.tmgAds||{};window.tmgAds.log=window.tmgAds.log||[];window.tmgAds.metrics=window.tmgAds.metrics||{ads:{}}}var J={name:"oriel",ver:"1.5",date:"2017-08-30",url:"https://zm232.com/hjuu8tk6z9pld1z8x3ucq1fk.js",callbackFn:function(){}};J.id=J.name+"-"+J.ver;tmgAdsLoadJS(J.id,J.url,J.callbackFn)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCE: DigiDip [2.2]","disabled":true});var t="aemproduction.tags.commercedigidip22.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\n/*\n1.0: Initial release.\n2.0: new version has multple version of the script for aem/aem-galleries/escenic, fixed typos, rolled out to escenic\n2.1: Emily decided to stop deliver of the Gallery tag...\n2.2: standardising how we monitor performance, goes into the tmgAds.metrics obj.\n*/\n(function(){\n  //////////////////////////////////////////////////////////////\n  var tag \x3d {\n    name        : 'digidip',\n    ver         : '2.2',\n    date        : '2017-07-25',\n    debug       : false,\n    status      : 'init',\n    type        : 'script',\n    loc         : 'script',\n    url         : false,\n    urls         : {\n      aem     : 'https://static.digidip.net/telegraph.js?loc\x3d'+window.location.href,\n      escenic : 'https://static.digidip.net/telegraph3.js?loc\x3d'+window.location.href\n    },\n    classes     : '', // blank string if no class name.       \n    count       : 0,\n    attributes  : [], // attributes to attach to the tag, each entry should be an array of two values, kay/val eg; ['data-client-id','XljfhhtlndnMVmu']\n    matched     : false,\n    delay       : 2000,\n    cms         : window.tmgAds.page.cms,\n    pagetype    : window.tmgAds.page.pagetype,\n    pagetypes   : ['article','story','gallery','video','live'], // the pagetypes this ad needs to run on\n    performance   : {\n      ts_start       : timer(),\n      ts_complete    : 0,\n      ts_requested   : 0,\n      tm_load        : 0\n    }\n  };\n  if(typeof window.tmgAds \x3d\x3d 'undefined'){\n    logit('WARNING: tmgAds is not defined');\n  }\n  //debug, make this work in debug envs.\n  if(tag.debug \x26\x26 typeof window.tmgAds \x3d\x3d 'undefined'){\n    window.tmgAds \x3d {metrics:{},dfp:{site:'test'}};\n  }\n  //\n  tag.pretag \x3d function(){\n    tag.status \x3d 'pretag';\n    logit('Pre-tag execution');\n    // ascertain which tag to use:\n    // telegraph.js  - AEM\n    // telegraph3.js - ESCENIC\n    if(window.tmgAds.page.cms \x3d\x3d 'aem'){\n      tag.url \x3d tag.urls.aem;\n    }\n    if(window.tmgAds.page.cms \x3d\x3d 'escenic'){\n      logit('Project - Escenic');\n      tag.url \x3d tag.urls.escenic;\n    }\n    // now set the site tag - we set this late due to possible race condition\n    ///////////////////\n    for(i in tag.pagetypes){\n      if(tag.pagetype \x3d\x3d tag.pagetypes[i]){\n        tag.matched \x3d true;\n        logit('Matched Site: YES - '+tag.pagetype+' - '+tag.pagetypes[i]+' - '+tag.url);\n      } else {\n        logit('Matched Site: NO  - '+tag.pagetype+' - '+tag.pagetypes[i]);\n      }\n    }\n  };\n  tag.postag \x3d function(){\n    logit('Post-tag execution');\n  };\n  //////////////////////////////////////////////////////////////\n  // functions\n  function timer(){\n    var tmp \x3d Date.now();\n    if(typeof window.performance !\x3d 'undefined'){\n      if(typeof window.performance.now !\x3d 'undefined'){\n        tmp \x3d window.performance.now(); \n      }\n     }\n     return Number(tmp.toFixed(5));\n  }\n  function logit(msg){\n    if(tag.debug){\n      console.log(tag.name+':'+tag.ver+':'+tag.status+': '+msg);\n    }\n  }\n  function actionTag(tag, action){\n    // this function records various actions being completed by the script. It's used to collect data about the script and it's performance\n    // currently only expecting 'complete' to be the only action, this provides scalability\n    tag.status \x3d action;\n    tag.performance['ts_'+action] \x3d timer();\n    logit(action+' - '+(tag.performance['ts_'+action]/1000).toFixed(5));\n    // do this if tag is loaded/complete\n    if(tag.status \x3d\x3d\x3d 'complete'){\n      tag.postag();\n      tag.performance.tm_load         \x3d Number((tag.performance.ts_complete - tag.performance.ts_start).toFixed(5));\n      window.tmgAds.metrics[tag.name] \x3d tag.performance;\n    }\n  }\n  function loadTag(tag){\n    actionTag(tag,'start');\n    tag.tag           \x3d document.createElement(tag.type);\n    tag.tag.id        \x3d tag.name;\n    tag.tag.className \x3d tag.classes;\n    // add any attributes from tag.attributes\n    for(i in tag.attributes){\n      logit('Adding attributes to tag: '+tag.attributes[i][0]+'\x3d'+tag.attributes[i][1]);\n      tag.tag.setAttribute(tag.attributes[i][0],tag.attributes[i][1]);\n    }\n    tag.tag.onload \x3d function(){\n      actionTag(tag,'complete');\n      logit('Time Start   : '+(tag.performance['ts_start']/1000).toFixed(5));\n      logit('Time Complete: '+(tag.performance['ts_complete']/1000).toFixed(5));\n      logit('Time To Load : '+(tag.performance['tm_load']/1000).toFixed(5));\n    };\n    // set tag url\n    tag.tag.src \x3d tag.url;\n    //http://stackoverflow.com/questions/12113412/dynamically-inject-javascript-file-why-do-most-examples-append-to-head/12113657#12113657\n    if(tag.type \x3d\x3d\x3d 'iframe'){\n      logit('Type \x3d IFRAME: '+tag.url);\n      tag.tag.width   \x3d '1';\n      tag.tag.height  \x3d '1';\n      tag.tag.style.display \x3d 'none';\n    } else {\n      logit('Type \x3d SCRIPT: '+tag.url);     \n    }\n    // if tag.loc is script then insert this before first script tag in page\n    if(tag.type\x3d\x3d\x3d'script' \x26\x26 tag.loc\x3d\x3d\x3d'script'){\n      logit('Inserting script tag before first script tag in page');\n      tag.performance.ts_requested \x3d timer(); \n      tag.scriptarray \x3d document.getElementsByTagName('script')[0];\n      tag.scriptarray.parentNode.insertBefore(tag.tag,tag.scriptarray);\n    } else {\n      logit('Appending tag to '+tag.loc);\n      tag.performance.ts_requested \x3d timer(); \n      document.getElementsByTagName(tag.loc)[0].appendChild(tag.tag);\n    }\n    if(tag.type\x3d\x3d\x3d'iframe'){\n      logit('Inserting iframe into '+tag.loc);\n      tag.performance.ts_requested \x3d timer(); \n      document.getElementsByTagName('body')[0].appendChild(tag.tag);\n    }\n  }\n  //////////////////////////////////////////////////////////////\n  // Now lets call this aftr a set period (tag.setTimeout)\n  if(typeof window.tmgAds !\x3d 'undefined' \x26\x26 typeof window.tmgAds.page !\x3d 'undefined' \x26\x26 typeof window.tmgAds.page.pagetype !\x3d 'undefined'){\n    if(tag.pagetypes.indexOf(window.tmgAds.page.pagetype) \x3e- 1){\n      logit('SUCCESS: Page has matched targeting criteria, loading in '+tag.delay+'ms:');\n      tag.pretag();\n      if(tag.matched){\n        loadTag(tag);\n      } else {\n        logit('WARNING: No tag called as site not matched');\n      }\n    } else {\n      logit('WARNING: Page has NOT matched targeting criteria -\x3e pagetype not matched: '+window.tmgAds.page.pagetype);\n    }\n  } else {\n    logit('WARNING: Page has NOT matched targeting criteria -\x3e tmgAds.page.pagetype not defined: ');\n  }\n})();\n\x3c/script\x3e";
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALTYICS: Content Square [v1.0]"});var t="aemproduction.tags.analtyicscontentsquarev10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){if(RUM)RUM.mark("content_square_script_start");(function(){var J=document.createElement("script");J.type="text/javascript";
J.async=true;J.src="//t.contentsquare.net/uxa/a253d20ad6622.js";document.getElementsByTagName("head")[0].appendChild(J)})();if(RUM){RUM.mark("content_square_script_end");performance.measure("content_square_script_loadtime","content_square_script_start","content_square_script_end")}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"ANALYTICS: Google Analytics [v2.0]","description":"RFC-10440"});var t="aemproduction.tags.analyticsgoogleanalyticsv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript\x3e\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']\x3dr;i[r]\x3di[r]||function(){\n(i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\nm\x3ds.getElementsByTagName(o)[0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n\nga('create', '${profile_id}', 'auto');\nga('set', 'transport', 'beacon');\nga('send', 'pageview');\n\x3c/script\x3e";
a.addClientFiltersList([]);a.addClientVariablesMap({"profile_id":"aemproduction.variables.GAProfileID"});a.addParameters([{"name":"GA Profile ID","token":"profile_id"}]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCE: DigiDip [2.3]","disabled":false});var t="aemproduction.tags.commercedigidip23.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nif(tmgAds.dfp.site !\x3d 'sponsored'){\n/*\n1.0: Initial release.\n2.0: new version has multple version of the script for aem/aem-galleries/escenic, fixed typos, rolled out to escenic\n2.1: Emily decided to stop deliver of the Gallery tag...\n2.2: standardising how we monitor performance, goes into the tmgAds.metrics obj.\n2.3: Added if statement to remove from sponsored business segments\n*/\n(function(){\n  //////////////////////////////////////////////////////////////\n  var tag \x3d {\n    name        : 'digidip',\n    ver         : '2.2',\n    date        : '2017-07-25',\n    debug       : false,\n    status      : 'init',\n    type        : 'script',\n    loc         : 'script',\n    url         : false,\n    urls         : {\n      aem     : 'https://static.digidip.net/telegraph.js?loc\x3d'+window.location.href,\n      escenic : 'https://static.digidip.net/telegraph3.js?loc\x3d'+window.location.href\n    },\n    classes     : '', // blank string if no class name.       \n    count       : 0,\n    attributes  : [], // attributes to attach to the tag, each entry should be an array of two values, kay/val eg; ['data-client-id','XljfhhtlndnMVmu']\n    matched     : false,\n    delay       : 2000,\n    cms         : window.tmgAds.page.cms,\n    pagetype    : window.tmgAds.page.pagetype,\n    pagetypes   : ['article','story','gallery','video','live'], // the pagetypes this ad needs to run on\n    performance   : {\n      ts_start       : timer(),\n      ts_complete    : 0,\n      ts_requested   : 0,\n      tm_load        : 0\n    }\n  };\n  if(typeof window.tmgAds \x3d\x3d 'undefined'){\n    logit('WARNING: tmgAds is not defined');\n  }\n  //debug, make this work in debug envs.\n  if(tag.debug \x26\x26 typeof window.tmgAds \x3d\x3d 'undefined'){\n    window.tmgAds \x3d {metrics:{},dfp:{site:'test'}};\n  }\n  //\n  tag.pretag \x3d function(){\n    tag.status \x3d 'pretag';\n    logit('Pre-tag execution');\n    // ascertain which tag to use:\n    // telegraph.js  - AEM\n    // telegraph3.js - ESCENIC\n    if(window.tmgAds.page.cms \x3d\x3d 'aem'){\n      tag.url \x3d tag.urls.aem;\n    }\n    if(window.tmgAds.page.cms \x3d\x3d 'escenic'){\n      logit('Project - Escenic');\n      tag.url \x3d tag.urls.escenic;\n    }\n    // now set the site tag - we set this late due to possible race condition\n    ///////////////////\n    for(i in tag.pagetypes){\n      if(tag.pagetype \x3d\x3d tag.pagetypes[i]){\n        tag.matched \x3d true;\n        logit('Matched Site: YES - '+tag.pagetype+' - '+tag.pagetypes[i]+' - '+tag.url);\n      } else {\n        logit('Matched Site: NO  - '+tag.pagetype+' - '+tag.pagetypes[i]);\n      }\n    }\n  };\n  tag.postag \x3d function(){\n    logit('Post-tag execution');\n  };\n  //////////////////////////////////////////////////////////////\n  // functions\n  function timer(){\n    var tmp \x3d Date.now();\n    if(typeof window.performance !\x3d 'undefined'){\n      if(typeof window.performance.now !\x3d 'undefined'){\n        tmp \x3d window.performance.now(); \n      }\n     }\n     return Number(tmp.toFixed(5));\n  }\n  function logit(msg){\n    if(tag.debug){\n      console.log(tag.name+':'+tag.ver+':'+tag.status+': '+msg);\n    }\n  }\n  function actionTag(tag, action){\n    // this function records various actions being completed by the script. It's used to collect data about the script and it's performance\n    // currently only expecting 'complete' to be the only action, this provides scalability\n    tag.status \x3d action;\n    tag.performance['ts_'+action] \x3d timer();\n    logit(action+' - '+(tag.performance['ts_'+action]/1000).toFixed(5));\n    // do this if tag is loaded/complete\n    if(tag.status \x3d\x3d\x3d 'complete'){\n      tag.postag();\n      tag.performance.tm_load         \x3d Number((tag.performance.ts_complete - tag.performance.ts_start).toFixed(5));\n      window.tmgAds.metrics[tag.name] \x3d tag.performance;\n    }\n  }\n  function loadTag(tag){\n    actionTag(tag,'start');\n    tag.tag           \x3d document.createElement(tag.type);\n    tag.tag.id        \x3d tag.name;\n    tag.tag.className \x3d tag.classes;\n    // add any attributes from tag.attributes\n    for(i in tag.attributes){\n      logit('Adding attributes to tag: '+tag.attributes[i][0]+'\x3d'+tag.attributes[i][1]);\n      tag.tag.setAttribute(tag.attributes[i][0],tag.attributes[i][1]);\n    }\n    tag.tag.onload \x3d function(){\n      actionTag(tag,'complete');\n      logit('Time Start   : '+(tag.performance['ts_start']/1000).toFixed(5));\n      logit('Time Complete: '+(tag.performance['ts_complete']/1000).toFixed(5));\n      logit('Time To Load : '+(tag.performance['tm_load']/1000).toFixed(5));\n    };\n    // set tag url\n    tag.tag.src \x3d tag.url;\n    //http://stackoverflow.com/questions/12113412/dynamically-inject-javascript-file-why-do-most-examples-append-to-head/12113657#12113657\n    if(tag.type \x3d\x3d\x3d 'iframe'){\n      logit('Type \x3d IFRAME: '+tag.url);\n      tag.tag.width   \x3d '1';\n      tag.tag.height  \x3d '1';\n      tag.tag.style.display \x3d 'none';\n    } else {\n      logit('Type \x3d SCRIPT: '+tag.url);     \n    }\n    // if tag.loc is script then insert this before first script tag in page\n    if(tag.type\x3d\x3d\x3d'script' \x26\x26 tag.loc\x3d\x3d\x3d'script'){\n      logit('Inserting script tag before first script tag in page');\n      tag.performance.ts_requested \x3d timer(); \n      tag.scriptarray \x3d document.getElementsByTagName('script')[0];\n      tag.scriptarray.parentNode.insertBefore(tag.tag,tag.scriptarray);\n    } else {\n      logit('Appending tag to '+tag.loc);\n      tag.performance.ts_requested \x3d timer(); \n      document.getElementsByTagName(tag.loc)[0].appendChild(tag.tag);\n    }\n    if(tag.type\x3d\x3d\x3d'iframe'){\n      logit('Inserting iframe into '+tag.loc);\n      tag.performance.ts_requested \x3d timer(); \n      document.getElementsByTagName('body')[0].appendChild(tag.tag);\n    }\n  }\n  //////////////////////////////////////////////////////////////\n  // Now lets call this aftr a set period (tag.setTimeout)\n  if(typeof window.tmgAds !\x3d 'undefined' \x26\x26 typeof window.tmgAds.page !\x3d 'undefined' \x26\x26 typeof window.tmgAds.page.pagetype !\x3d 'undefined'){\n    if(tag.pagetypes.indexOf(window.tmgAds.page.pagetype) \x3e- 1){\n      logit('SUCCESS: Page has matched targeting criteria, loading in '+tag.delay+'ms:');\n      tag.pretag();\n      if(tag.matched){\n        loadTag(tag);\n      } else {\n        logit('WARNING: No tag called as site not matched');\n      }\n    } else {\n      logit('WARNING: Page has NOT matched targeting criteria -\x3e pagetype not matched: '+window.tmgAds.page.pagetype);\n    }\n  } else {\n    logit('WARNING: Page has NOT matched targeting criteria -\x3e tmgAds.page.pagetype not defined: ');\n  }\n})();\n}\n\x3c/script\x3e";a.addClientFiltersList([]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"Analytics: Inhouse RUM Tag","description":"In house rum tag ","timeout":"1000"});var t="aemproduction.tags.technologyinhouserumtag.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){function J(){var L=[];var K=null;if(window.performance)if(window.performance.getEntriesByType)K=
window.performance.getEntriesByType("mark");else if(window.performance.webkitGetEntriesByType)K=window.performance.webkitGetEntriesByType("mark");K=K===null?RUM.marks:K;for(var R=0;R<K.length;R++)if(K[R].name.match("^css_")||K[R].name.match("^js_")||K[R].name.match("^adverts_")||K[R].name.match("^tmg_"))L.push(K[R]);return L}function x(){var L=document.cookie.match("(^|;)\\s*AMCV_2C7336C753C676BA0A490D4B%40AdobeOrg\\s*\x3d\\s*([^;]+)");return L?decodeURIComponent(L.pop()).split("|")[4]:""}function f(){var L=
"could_not_extract";for(var K=0;K<document.getElementsByTagName("link").length;K++){var R=document.getElementsByTagName("link")[K];if(R!==undefined&&R.href!==undefined&&R.href.indexOf("/telegraph/core/clientlibs/")!==-1&&L=="could_not_extract"){L=R.href.split(".min.").length>1?R.href.split(".min.")[1]:"could_not_extract";L=L.split(".css").length>0?L.split(".css")[0]:"could_not_extract"}}return L}function D(){var L={};try{L.timestamp=(new Date).getTime();L.domain=window.location.hostname;L.uri="/"+
window.location.pathname.substr(1)+F;L.referrer=document.referrer;L.qs=window.location.search;L.visitor_id=x();L.browser=navigator.userAgent;L.view_port_height=Math.max(document.documentElement.clientHeight,window.innerHeight||0);L.view_port_width=Math.max(document.documentElement.clientWidth,window.innerWidth||0);L.performance_timing=window.performance.timing;L.release=f();L.event=0;L.fallback=0;if(window.performance&&window.performance.getEntriesByType)L.requests=window.performance.getEntriesByType("resource").length;
L.size=0;var K=window.performance&&window.performance.getEntriesByType?window.performance.getEntriesByType("resource"):[];for(i=0;i<K.length;i++){var R=K[i];L.size+=R.transferSize!==null&&R.transferSize!==undefined?R.transferSize:0}L.marks=[];var W=J();for(i=0;i<W.length;i++){var X=W[i];var Z={"name":X.name,"start_time":X.startTime,"entry_type":X.entry_type,"duration":X.duration};L.marks.push(Z)}L.performance_timing={};var da=window.performance?window.performance.timing.navigationStart:0;var aa=window.performance?
window.performance.timing:{};for(var l in aa)L.performance_timing[l.toUnderscore()]=aa[l]-da>0?aa[l]-da:0;L.errors=O;L.country=$('meta[name\x3d"tmgads.geo"]').attr("content");L.channel=$('meta[name\x3d"tmgads.channel"]').attr("content");L.type=$('meta[name\x3d"tmgads.pagetype"]').attr("content");var b=$(document).find("title").text();if(b=="404")L.status_code="404";else if(b=="500")L.status_code="500";else L.status_code="200"}catch(z){console.log("Exception occurred collecting data for rum mark: "+
z)}var A=JSON.stringify(L);var r=false;try{r=navigator.sendBeacon("//performance-data.gcpdata.telegraph.co.uk/pageview?key\x3dAIzaSyALtnKOYjr6yaaAz2mtIZrFHo6WrpKTOCk",A)}catch(z){console.log("Error sending rum beacon");console.log(z)}if(console!==undefined&&(window.location.href.indexOf("?debug")!==-1||!r)){console.log(A);console.log(r?"rum beacon sent":"rum beacon could not be sent")}}if(navigator.sendBeacon)window.addEventListener("unload",D,false);else window.addEventListener("load",D,false);var F=
"";if(window.location.pathname=="/secure/payment/")$("button:contains('Save my details')").click(function(){RUM.mark("save_my_details_click");F="step1";D();$("button:contains('Buy your Telegraph subscription')").click(function(){RUM.mark("payment_details_click");F="step2";D()})});navigator.sendBeacon=navigator.sendBeacon||function(L,K){var R=new XMLHttpRequest;R.open("POST",L,false);R.setRequestHeader("Content-type","text/plain");R.send(K);return true};var O=[];window.onerror=function(L,K,R,W,X){try{var Z=
L.toLowerCase();var da="script error";if(Z.indexOf(da)>-1)O.push({name:"JS syntax error",line:0,file:"n/a",initiator:"n/a",type:"n/a"});else O.push({error:X,name:L,line:R,file:K,initiator:"n/a",type:"n/a"})}catch(aa){console.log("Exception occurred collecting js error data: "+aa)}return false};String.prototype.toUnderscore=function(){return this.replace(/([A-Z])/g,function(L){return"_"+L.toLowerCase()})}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: SUB-7961 [v1.0]","disabled":false});var t="aemproduction.tags.commercialsub7961v10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cscript\x3e\n(function() {\n\tObject.defineProperty(window, \'confirm\', {\n\t\tvalue: function value(string) {\n\t\t    var temp \x3d string.split(" ").pop()\n\t\t    if (temp \x26\x26 temp.match("home")){\n\t\t      location.href \x3d tmgCommerce.urls.portal;\n\t\t    } else if (temp \x26\x26 temp.match("account")){\n\t\t      location.href \x3d "/secure/account/";\n\t\t    } else if (temp) {\n\t\t      location.href \x3d decodeURIComponent( temp )\n\t\t    } else {\n\t\t\t\t  location.href \x3d tmgCommerce.urls.portal;\n\t\t    }\n\t\t},\n\t\twritable: false,\n\t\tconfigurable: false\n\t});\n})();\n\x3c/script\x3e';
a.addClientFiltersList(["aemproduction.filters.SecureActivate"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALYTICS: Liftigniter [v1.8]"});var t="aemproduction.tags.analyticsliftigniterv18.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\n    (function () {\n\n\t\tif (typeof $igniter_var \x3d\x3d\x3d \"undefined\") {\n            (function (w, d, s, p, v, e, r) {\n                w['$igniter_var'] \x3d v;\n                w[v] \x3d w[v] || function () {\n                       (w[v].q \x3d w[v].q || []).push(\n                          arguments)\n                   };\n                w[v].l \x3d 1 * new Date();\n                e \x3d d.createElement(s), r \x3d d.getElementsByTagName(s)[0];\n                e.async \x3d 1;\n                e.src \x3d p + '?ts\x3d' + (+new Date() / 3600000 | 0);\n                r.parentNode.insertBefore(e, r)\n            })(window, document, 'script', '//cdn.petametrics.com/fb6cjraf9cejut2a.js', '$p');\n\n\t\t\twindow.liftIgniterPageKeywords \x3d document.querySelector(\"meta[name\x3d'tmgads.keywords']\").content.split(',');\n\n\t\t\tvar customConfig \x3d {\n                config: {\n                    inventory: {\n                        features: [\n                            {\n                                name: \"pageType\",\n                                selector: \"meta[name\x3d'tmgads.pagetype']\",\n                                type: \"attribute\",\n                                attribute: \"content\"\n                            },\n                            {\n                                name: \"businessSegment\",\n                                selector: \"meta[name\x3d'tmgads.businessSegment']\",\n                                type: \"attribute\",\n                                attribute: \"content\"\n                            },\n                            {\n                                name: \"channel\",\n                                selector: \"meta[name\x3d'DCSext.Channel']\",\n                                type: \"attribute\",\n                                attribute: \"content\"\n                            },\n                            {\n                                name: \"keywords\",\n                                type: \"varArray\",\n                                variable: \"window.liftIgniterPageKeywords\"\n                            },\n                            {\n                                name: \"premiumState\",\n                                selector: \"meta[name\x3d'tmg.premium.state']\",\n                                type: \"attribute\",\n                                attribute: \"content\"\n                            },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"displayDate\",\n\t\t\t\t\t\t\t\tselector: \"meta[name\x3d'DCSext.articleFirstPublished']\",\n\t\t\t\t\t\t\t\ttype: \"attribute\",\n                                attribute: \"content\"\n\t\t\t\t\t\t\t}\n                        ]\n                    }\n                }\n            };\n\n           \tvar isTravelPage \x3d getTravelPage();\n\n\t\t\tif (isTravelPage) {\n\t\t\t\tvar selector \x3d isTravelPage \x3d\x3d\x3d 'travel-review' ? '.article__related .calendar-availability .travel-price__price' : '.info-bar--clone .check-availability-cta .component-content .travel-price__wrap .travel-price__price';\n                customConfig.config.inventory.features.push({\n                    name: \"price\",\n                    selector: selector,\n                    type: \"text\",\n                    transform: function (value) {\n                        return value.trim();\n                    }\n                });\n            }\n\n\t\t\t$p(\"init\", \"fb6cjraf9cejut2a\", customConfig);\n            $p(\"setRequestFields\", [\"title\", \"url\", \"image\", \"price\", \"description\", \"channel\", \"businessSegment\", \"displayDate\", \"pageType\", \"premiumState\"])\n            $p(\"send\", \"pageview\");\n        }\n        // ------------------------------------------------------------------------ //\n        // Utils\n\n        function truncate(string, maxLength) {\n            if (string.length \x3c\x3d maxLength) return string;\n            return string.slice(0, maxLength - 2).replace(/[^\\w\\s]?\\s[^\\s]*$/, '') + '...';\n        }\n\n\t\tfunction getPageMeta() {\n\t\t\tvar metaArr \x3d ['tmgads.pagetype', 'tmgads.section', 'DCSext.articleFirstPublished'];\n\t\t\tvar metaNamespace \x3d {};\n\t\t\tfor (var i \x3d metaArr.length - 1; i \x3e\x3d 0; i--) {\n\t\t\t\tvar metaTag \x3d document.querySelector('meta[name\x3d\"' + metaArr[i] + '\"]');\n\t\t\t\tif (metaTag) {\n\t\t\t\t\tmetaNamespace[metaArr[i]] \x3d metaTag.getAttribute('content');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn metaNamespace;\n\t\t}\n\n\t\tfunction getDisplayDate(date){\n\t\t\tvar parsed \x3d date.replace(/-/g, '/');\n\t\t\tvar dateDisplay \x3d new Date(parsed);\n\t\t\tvar months \x3d [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\t\t\tvar dateFormatted \x3d dateDisplay.getDate()+' '+months[dateDisplay.getMonth()]+' '+dateDisplay.getFullYear();\n\t\t\tvar hours \x3d dateDisplay.getHours() \x3e 12 ? dateDisplay.getHours() - 12 : dateDisplay.getHours();\n\t\t\tvar am_pm \x3d dateDisplay.getHours() \x3e\x3d 12 ? \"pm\" : \"am\";\n\t\t\tvar minutes \x3d dateDisplay.getMinutes() \x3c 10 ? '0' + dateDisplay.getMinutes() : dateDisplay.getMinutes();\n\n\t\t\treturn dateFormatted+', '+hours + ':' + minutes + am_pm;\n\t\t}\n\n\t\tfunction getTravelPage() {\n\n\t\t\tvar metaNamespace \x3d getPageMeta();\n\t\t\tif (metaNamespace['tmgads.pagetype'] \x3d\x3d\x3d 'travel-review') {\n\t\t\t\treturn 'travel-review';\n\t\t\t} else if (metaNamespace['tmgads.section'] \x3d\x3d\x3d 'travel-cruises' || metaNamespace['tmgads.section'] \x3d\x3d\x3d 'travel-tours') {\n\t\t\t\treturn 'travel-cruises';\n\t\t\t}\n\t\t}\n\n        // ------------------------------------------------------------------------ //\n        // RecommendedList widget\n\n        function RecommendedList(element) {\n            this.element \x3d element;\n        }\n\n        RecommendedList.selector \x3d {\n            ROOT: '#li-recommendation-widget',\n            WIDGETNAME: 'li-recommendation-widget'\n        };\n\n        RecommendedList.prototype.init \x3d function () {\n            if (this.element) {\n                $p('register', {\n                    max: 5,\n                    widget: RecommendedList.selector.WIDGETNAME,\n                    callback: this.onRequestSuccess.bind(this)\n                });\n            }\n        };\n\n        RecommendedList.prototype.onRequestSuccess \x3d function (response) {\n            var data \x3d response;\n            data.widgetTitle \x3d this.element.dataset.title || '';\n            data.items.forEach(function (item) {\n                item.truncatedTitle \x3d truncate(item.title, 100);\n            });\n            this.render(data);\n            $p('track', {\n                elements: this.element.querySelectorAll('.recommended-articles__item'),\n                name: RecommendedList.selector.WIDGETNAME,\n                source: 'LI',\n                opts: {},\n                _debug : false\n            });\n        };\n\n        RecommendedList.prototype.render \x3d function (data) {\n            var template \x3d '\x3cdiv class\x3d\"recommended-articles\"\x3e' +\n               '\x3ch3 class\x3d\"recommended-articles__title\"\x3e{{widgetTitle}}\x3c/h3\x3e' +\n               '\x3col class\x3d\"recommended-articles__items\"\x3e' +\n               '{{#items}}' +\n               '\x3cli class\x3d\"recommended-articles__item\"\x3e' +\n               '\x3ca class\x3d\"recommended-articles__item-link\" href\x3d\"{{url}}\"\x3e{{truncatedTitle}}\x3c/a\x3e' +\n               '\x3c/li\x3e' +\n               '{{/items}}' +\n               '\x3c/ol\x3e' +\n               '\x3c/div\x3e';\n            this.element.innerHTML \x3d $p('render', template, data);\n        };\n\n        // Travel Test and Target code\n        function RecommendedListTarget(element) {\n            this.element \x3d element;\n        }\n\n        RecommendedListTarget.selector \x3d {\n            ROOT: '#li-recommendation-widget-target',\n            WIDGETNAME: 'li-recommendation-widget-target'\n        };\n\n        RecommendedListTarget.prototype.init \x3d function () {\n            if (this.element) {\n                $p('register', {\n                    max: 20,\n                    widget: RecommendedListTarget.selector.WIDGETNAME,\n                    opts: {pageType:[\"travel-review\",\"travel-product\"]},\n                    callback: this.onRequestSuccess.bind(this)\n                });\n            }\n        };\n\n        RecommendedListTarget.prototype.onRequestSuccess \x3d function (response) {\n            var data \x3d response;\n            data.widgetTitle \x3d this.element.dataset.title || '';\n            data.items.forEach(function (item) {\n                item.truncatedTitle \x3d truncate(item.title, 100);\n            });\n            this.render(data);\n            $p('track', {\n                elements: this.element.querySelectorAll('.recommended-travel-item-target'),\n                name: RecommendedListTarget.selector.WIDGETNAME,\n                source: 'LI',\n                opts: {},\n                _debug : false\n            });\n\n            //tracking code\n\n        };\n\n        RecommendedListTarget.prototype.render \x3d function (data) {\n            var template \x3d '\x3cdiv class\x3d\"recommended-travel-target\"\x3e' +\n               '\x3col class\x3d\"recommended-travel-items-target\"\x3e' +\n               '{{#items}}' +\n               '\x3cli class\x3d\"recommended-travel-item-target\"\x3e' +\n               '\x3cimg class\x3d\"recommended-travel-item-image-target\" src\x3d\"{{image}}\"/\x3e' +\n               '\x3cdiv class\x3d\"recommended-travel-title-target\"\x3e{{title}}\x3c/div\x3e' +\n               '\x3cdiv  class\x3d\"recommended-travel-item-desc-target\"\x3e{{description}}\x3c/div\x3e' +\n               '\x3cdiv class\x3d\"recommended-traive-item-label-from\"\x3eFrom\x3c/div\x3e' +\n               '\x3cdiv  class\x3d\"recommended-travel-item-price-target\"\x3e\\\x26pound\\;{{price}}\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e' +\n               '\x3ca class\x3d\"recommended-travel-item-link-target\" href\x3d\"{{url}}\"\x3eFind out more\x3c/a\x3e' +\n               '\x3c/li\x3e' +\n               '{{/items}}' +\n               '\x3c/ol\x3e' +\n               '\x3c/div\x3e';\n            this.element.innerHTML \x3d $p('render', template, data);\n        };\n\n        // Initialise RecommendedList widget\n        var rlElements \x3d document.querySelectorAll(RecommendedList.selector.ROOT);\n        var rlArray \x3d Array.prototype.slice.call(rlElements);\n        rlArray.forEach(function (element) {\n            var widget \x3d new RecommendedList(element);\n            widget.init();\n        });\n\n        // Initialise Travel recommended list\n        var targetElements \x3d document.querySelectorAll(RecommendedListTarget.selector.ROOT);\n        if (targetElements) {\n            var targetArray \x3d Array.prototype.slice.call(targetElements);\n            targetArray.forEach(function (element) {\n                var widget \x3d new RecommendedListTarget(element);\n                widget.init();\n            });\n        }\n\n\t\t// ------------------------------------------------------------------------ //\n        // MidArticleUnit widget\n\n        function MidArticleUnit(element) {\n            this.element \x3d element;\n        }\n\n        MidArticleUnit.selector \x3d {\n            ROOT: '.li-mau-article',\n\t\t\tWIDGETNAME: 'li-mau-article'\n        };\n\n        MidArticleUnit.prototype.init \x3d function () {\n\t\t\tif (this.element) {\n                $p('register', {\n                    max: 1,\n                    widget: MidArticleUnit.selector.WIDGETNAME,\n\t\t\t\t\topts: {pageType: [\"story\",\"live\",\"video\"]},\n                    callback: this.onRequestSuccess.bind(this)\n                });\n            }\n        };\n\n        MidArticleUnit.prototype.onRequestSuccess \x3d function (response) {\n            var data \x3d response;\n\t\t\tdata.items.forEach(function (item) {\n                item.truncatedTitle \x3d truncate(item.title, 100);\n\t\t\t\titem.displayDate \x3d getDisplayDate(item.displayDate);\n\t\t\t\titem.premiumBool \x3d item.premiumState \x3d\x3d 'true' ? true : false;\n            });\n\t\t\tthis.render(data.items[0]);\n\t\t\t$p('track', {\n                elements: this.element,\n                name: MidArticleUnit.selector.WIDGETNAME,\n                source: 'LI',\n                opts: {},\n                _debug : false\n            });\n        };\n\n\t\tMidArticleUnit.prototype.render \x3d function (data) {\n\n\t\t\tvar template \x3d '\x3carticle class\x3d\"mau-article mau-article--{{pageType}}{{#premiumBool}}-premium{{/premiumBool}}\"\x3e' +\n\t\t\t'\x3ca class\x3d\"mau-article__link\" href\x3d\"{{url}}\"\x3e' +\n\t\t\t'\x3cdiv class\x3d\"mau-article__image-wrapper\"\x3e' +\n\t\t\t'{{#image}}\x3cimg class\x3d\"mau-article__image\" src\x3d\"{{image}}?imwidth\x3d220\" /\x3e{{/image}}' +\n\t\t\t'\x3cdiv class\x3d\"mau-article__video-icon\"\x3e\x3c/div\x3e' +\n\t\t\t'\x3c/div\x3e' +\n\t\t\t'{{#premiumBool}}\x3cspan class\x3d\"mau-article__premium-label\"\x3ePremium\x3c/span\x3e{{/premiumBool}}' +\n\t\t\t'\x3ch3 class\x3d\"mau-article__title\"\x3e\x3cdiv class\x3d\"mau-article__live-indicator\"\x3e\x3cspan class\x3d\"mau-article__live-label\"\x3eLive\x3c/span\x3e\x3c/div\x3e{{truncatedTitle}}\x3c/h3\x3e' +\n\t\t\t'{{#displayDate}}\x3ctime class\x3d\"mau-article__date\" title\x3d\"{{displayDate}}\" datetime\x3d\"{{displayDate}}\" itemprop\x3d\"datePublished\" pubdate\x3d\"\"\x3e{{displayDate}}\x3c/time\x3e{{/displayDate}}' +\n\t\t\t'\x3c/a\x3e' +\n\t\t\t'\x3c/article\x3e';\n            this.element.innerHTML \x3d $p('render', template, data);\n        };\n\n        // Initialise MidArticleUnit widget\n        var mauElements \x3d document.querySelectorAll(MidArticleUnit.selector.ROOT);\n        var mauArray \x3d Array.prototype.slice.call(mauElements);\n        mauArray.forEach(function (element) {\n            var widget \x3d new MidArticleUnit(element);\n            widget.init();\n        });\n\n\n\t\t// Fetch has been moved to the botton because it needs to be called once\n\t\t// all widget are registered (multiple widgets case) otherwise\n\t\t// only the first one will be rendered.\n\t\t$p('fetch');\n    })();\n\x3c/script\x3e";a.addClientFiltersList([]);
a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"usesDocumentWrite":false,"locationPlaceHolder":"END","name":"COMMERCIAL: Travel Infinity Tracking: [v2.1]","description":"RFC-9682","url":""});var t="aemproduction.tags.commercialtravelinfinityphonenumbertrackingv20.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nvar ictDcmIntegration \x3d function() {\n    var dcmCookie \x3d _ictt.push(['_retrieveItem', 'dcm_gid']);\n    if (dcmCookie) {\n        return dcmCookie;\n    }\n    if (!_ictt.push(['_get', 'infinityDcmScriptLoaded'])) {\n        _ictt.push(['_dropScriptTag', 'cm.g.doubleclick.net/pixel?google_nid\x3dinfinity_dmp\x26google_cm']);\n        _ictt.push(['_set', 'infinityDcmScriptLoaded', true]);\n    }\n}\n\x3c/script\x3e\n\n\x3c!-- Optimizely Integration Method --\x3e\n\x3cscript type\x3d\"text/javascript\"\x3e\nfunction setOptimizelyCustomVars(key, value) {\n    var optiCookieNames \x3d ['optimizelyBuckets', 'optimizelyEndUserId', 'optimizelySegments'];\n    var optiCookies     \x3d _ictt.push(['_getCookies', 'optimizely']);\n    if (optiCookies !\x3d\x3d false \x26\x26 optiCookies.length \x3e 0) {\n        for (var i \x3d 0; i \x3c optiCookies.length; i++) {\n            var optiCookie \x3d optiCookies[i];\n            if (optiCookie.length \x3d\x3d\x3d 2 \x26\x26 optiCookieNames.indexOf(optiCookie[0]) \x3e -1) {\n                _ictt.push(['_setCustomVar', [optiCookie[0], optiCookie[1]]]);\n            }\n        }\n    }\n    try {\n        var optiRedRef \x3d optimizely.data.state.redirectExperiment.referrer;\n        if (optiRedRef !\x3d\x3d undefined) {\n            _ictt.push(['_setReferrer', optiRedRef]);\n        }\n    } catch(e) {}\n}\n\x3c/script\x3e\n\x3c!-- End Optimizely Integration Method --\x3e\n\x3c!-- Infinity Tracking Code v2.0\n Copyright Infinity 2016\n www.infinitycloud.com --\x3e\n\x3cscript type\x3d\"text/javascript\"\x3e\n    var transactionID \x3d sessionStorage.getItem('infinityTransactionID');\n    sessionStorage.removeItem('infinityTransactionID');\n    \n    var _ictt \x3d _ictt || [];\n    _ictt.push(['_setIgrp','1003']); // Installation ID\n    _ictt.push(['_enableGAIntegration',{'gua':true,'ga':false}]);\n    _ictt.push(['_includeExternal',[{'from':'ictDcmIntegration','to':'_setCustomVar','as':'dcm_gid'}]]);\n    _ictt.push(['_includeExternal',[{'from':'document','to':'setOptimizelyCustomVars'}]]);\n    _ictt.push(['_tagExternalDestinations', ['telegraph.co.uk']]);\n    _ictt.push(['_enableAutoDiscovery']);\n    _ictt.push(['_setCustomVar', ['adobe_txid', transactionID]]);\n    _ictt.push(['_track']);\n(function() {\n    var ict \x3d document.createElement('script'); ict.type \x3d 'text/javascript'; ict.async \x3d true;\n    ict.src \x3d ('https:' \x3d\x3d document.location.protocol ? 'https://' : 'http://') + 'ict.infinity-tracking.net/js/nas.v1.min.js';\n    var scr \x3d document.getElementsByTagName('script')[0]; scr.parentNode.insertBefore(ict, scr);\n})();\n\x3c/script\x3e\n\x3c!-- Infinity Tracking Code End --\x3e";a.addClientFiltersList(["aemproduction.filters.Default1",
"aemproduction.filters.TravelOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"COMMERCIAL: Subscriptions_qubit:[v1.0]","disabled":false,"locationObject":"HEAD"});var t="aemproduction.tags.commercialsubscriptionsqubitv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3c!-- Qubit script --\x3e\n\x3cscript src\x3d'//dd6zx4ibq538k.cloudfront.net/smartserve-4833.js' async defer\x3e\x3c/script\x3e";a.addClientFiltersList(["aemproduction.filters.Subscriptions","aemproduction.filters.Confirmation",
"aemproduction.filters.Premiun","aemproduction.filters.SecurePayment","aemproduction.filters.Rewards","aemproduction.filters.SecureRegistration"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"SD-105621","disabled":true,"url":""});var t="aemproduction.tags.sd105621.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.TravelOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J="myCss";if(!document.getElementById(J)){var x=document.getElementsByTagName("head")[0];var f=document.createElement("link");
f.id=J;f.rel="stylesheet";f.type="text/css";f.href="http://www.telegraph.co.uk/etc/designs/telegraph/core/clientlibs/tmgchannels/travel.min.4-11--1.css";f.media="all";x.appendChild(f)}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"usesDocumentWrite":false,"locationPlaceHolder":"END","name":"COMMERCIAL: Financial Services Infinity Tracking","description":"RFC-9682","url":""});var t="aemproduction.tags.commercialfinancialservicesinfinitytracking.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d\"text/javascript\"\x3e\nvar ictDcmIntegration \x3d function() {\n    var dcmCookie \x3d _ictt.push(['_retrieveItem', 'dcm_gid']);\n    if (dcmCookie) {\n        return dcmCookie;\n    }\n    if (!_ictt.push(['_get', 'infinityDcmScriptLoaded'])) {\n        _ictt.push(['_dropScriptTag', 'cm.g.doubleclick.net/pixel?google_nid\x3dinfinity_dmp\x26google_cm']);\n        _ictt.push(['_set', 'infinityDcmScriptLoaded', true]);\n    }\n}\n\x3c/script\x3e\n\n\x3c!-- Optimizely Integration Method --\x3e\n\x3cscript type\x3d\"text/javascript\"\x3e\nfunction setOptimizelyCustomVars(key, value) {\n    var optiCookieNames \x3d ['optimizelyBuckets', 'optimizelyEndUserId', 'optimizelySegments'];\n    var optiCookies     \x3d _ictt.push(['_getCookies', 'optimizely']);\n    if (optiCookies !\x3d\x3d false \x26\x26 optiCookies.length \x3e 0) {\n        for (var i \x3d 0; i \x3c optiCookies.length; i++) {\n            var optiCookie \x3d optiCookies[i];\n            if (optiCookie.length \x3d\x3d\x3d 2 \x26\x26 optiCookieNames.indexOf(optiCookie[0]) \x3e -1) {\n                _ictt.push(['_setCustomVar', [optiCookie[0], optiCookie[1]]]);\n            }\n        }\n    }\n    try {\n        var optiRedRef \x3d optimizely.data.state.redirectExperiment.referrer;\n        if (optiRedRef !\x3d\x3d undefined) {\n            _ictt.push(['_setReferrer', optiRedRef]);\n        }\n    } catch(e) {}\n}\n\x3c/script\x3e\n\x3c!-- End Optimizely Integration Method --\x3e\n\n\x3c!-- Infinity Tracking Code v2.0\n Copyright Infinity 2017\n www.infinitycloud.com --\x3e\n\x3cscript type\x3d\"text/javascript\"\x3e\n    var transactionID \x3d sessionStorage.getItem('infinityTransactionID');\n    sessionStorage.removeItem('infinityTransactionID');\n    \n    var _ictt \x3d _ictt || [];\n    _ictt.push(['_setIgrp','2247']); // Installation ID\n    _ictt.push(['_enableGAIntegration',{'gua':true,'ga':false}]);\n    _ictt.push(['_enableAutoDiscovery']);\n    _ictt.push(['_setCustomVar', ['adobe_txid', transactionID]]);\n    _ictt.push(['_track']);\n(function() {\n    var ict \x3d document.createElement('script'); ict.type \x3d 'text/javascript'; ict.async \x3d true;\n    ict.src \x3d ('https:' \x3d\x3d document.location.protocol ? 'https://' : 'http://') + 'ict.infinity-tracking.net/js/nas.v1.min.js';\n    var scr \x3d document.getElementsByTagName('script')[0]; scr.parentNode.insertBefore(ict, scr);\n})();\n\x3c/script\x3e\n\x3c!-- Infinity Tracking Code End --\x3e";
a.addClientFiltersList(["aemproduction.filters.Default1","aemproduction.filters.FinancialServicesOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ANALYTICS: Chartbeat [v1.2]","description":"Code to initialise Chartbeat - analytics tool for Editorial"});var t="aemproduction.tags.analyticschartbeatv12.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="\x3cscript type\x3d'text/javascript'\x3e\n\tvar chartbeatStart \x3d window.performance ? window.performance.mark(\"chartbeat_start\") : new Date().getTime();\n\tvar _sf_async_config \x3d _sf_async_config || {};\n\n\tvar metaAuthor \x3d document.querySelector('meta[name\x3d\"DCSext.author\"]');\n\tvar metaAuthorContent \x3d metaAuthor \x26\x26 metaAuthor.getAttribute(\"content\");\n\tvar metaSegment \x3d document.querySelector('meta[name\x3d\"DCSext.Channel\"]');\n\tvar metaSegmentContent \x3d metaSegment \x26\x26 metaSegment.getAttribute(\"content\");    \n\n\t/** CONFIGURATION START **/\n\t_sf_async_config.uid \x3d 65595;\n\t_sf_async_config.domain \x3d 'telegraph.co.uk';\n\t_sf_async_config.useCanonical \x3d true;\n\t_sf_async_config.sections \x3d metaSegmentContent;\n\t_sf_async_config.authors \x3d metaAuthorContent;\n\t_sf_async_config.videoType \x3d 'ooyala';\n\t_sf_async_config.autoDetect \x3d false;    \n\t/** CONFIGURATION END **/\n\n\t/** Push appropriate ['key', 'value'] pair for given user type to _cbq array **/\n\tvar _cbq \x3d window._cbq \x3d (window._cbq || []);\n\t_cbq.push(['_acct', 'paid']);\n\n\t(function () {\n\t\t\n\t\tfunction loadChartbeat() {\n\t\t\twindow._sf_endpt \x3d (new Date()).getTime();\n\t\t\tvar e \x3d document.createElement('script');\n\t\t\te.setAttribute('language', 'javascript');\n\t\t\te.setAttribute('type', 'text/javascript');\n\t\t\te.setAttribute('src', '//static.chartbeat.com/js/chartbeat_video.js');\n\t\t\tdocument.body.appendChild(e);\n\t\t}\n\n\t\tvar oldonload \x3d window.onload;\n\t\twindow.onload \x3d (typeof window.onload !\x3d 'function') ? loadChartbeat : function() {\n\t\t\tconsole.log('window.onload -\x3e loadCharbeat');\n\t\t\toldonload();\n\t\t\tloadChartbeat();\n\t\t};\n\t})();\n\n\tvar chartbeatEnd \x3d window.performance ? window.performance.mark(\"chartbeat_end\") : new Date().getTime();\n\tif (!window.performance \x26\x26 console){\n\t\tconsole.log(\"Affiliate Tracking load time is:\"+ (chartbeatEnd - chartbeatStart))\n\t} else if (window.performance) {\n\t\twindow.performance.measure(\"js_chartbeat_track\", \"chartbeat_start\", \"chartbeat_end\" )\n\t\twindow.performance.clearMarks(\"chartbeat_start\");\n\t\twindow.performance.clearMarks(\"chartbeat_end\");\n\t}\n\x3c/script\x3e";
a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"MARKETING: EDigital Survey: Subscription Pages [v2.3]","description":"Survey for Subscription and Secure pages","disabled":true});var t="aemproduction.tags.marketingedigitalsurveysubscriptionpagesv22.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.SecurePayment1","aemproduction.filters.SecureRegistration1","aemproduction.filters.Subscriptions1"]);a.addClientVariablesMap({});a.addParameters([]);
a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J=setInterval(function(){if(0==window.location.href.startsWith(window.location.origin+"/subscriptions")&&0==window.location.href.startsWith(window.location.origin+"/secure"))return!1;if("function"==typeof jQuery&&0==document.body.classList.contains("gg-customer-testing-popup")){var x=jQuery;var f={init:function(F){x("body").addClass(F.slug).attr("test",F.version).append("\x3cstyle\x3e"+F.css+"\x3c/style\x3e")},
addPopUp:function(){if("true"==f.readCookie("gg-customer-testing-popup"))return console.log("%c Cookie found, not running.","background: #ec2a26; color: white; display: block;"),!1;x("body").append(function(){var F='\x3cdiv class\x3d"backgroundOverlay"\x3e';return F+='\x3cdiv class\x3d"popupContainer"\x3e',F+='\x3cdiv class\x3d"popup"\x3e',F+='\x3cdiv class\x3d"headerLogo"\x3e\x3cimg src\x3d"http://www.telegraph.co.uk/content/dam/best/telegraph_OUTLINE-small.png"\x3e\x3c/div\x3e',F+='\x3cdiv class\x3d"horizontalRule"\x3e\x3c/div\x3e',
F+='\x3cdiv class\x3d"headerText"\x3eYour Opinion Counts...\x3c/div\x3e',F+='\x3cdiv class\x3d"bodyText"\x3eTell us what you think of our site and receive a \x26pound;50 Amazon voucher. We want to make our website as useful as possible and would like your help. If you are interested please click continue to arrange a time to talk that suits you.\x3c/div\x3e',F+='\x3cdiv class\x3d"buttonWrapper"\x3e',F+='\x3ca class\x3d"popUpButton popUpButton--yes" href\x3d"https://edigitalsurvey.com/survey/enter/s/ESV-249923133"\x3eContinue\x3c/a\x3e',
F+='\x3ca class\x3d"popUpButton popUpButton--no" href\x3d"javascript:;"\x3eNo Thanks\x3c/a\x3e',F+="\x3c/div\x3e",F+="\x3c/div\x3e",F+="\x3c/div\x3e",F+="\x3c/div\x3e"}),f.addEvent(document,"mouseout",function(F){F=F||window.event;var O=F.relatedTarget||F.toElement;O&&"HTML"!=O.nodeName||x("body").addClass("show-popup")}),x(".popUpButton--no").click(function(F){x(".backgroundOverlay").remove(),f.createCookie("gg-customer-testing-popup",!0,365)}),x(".backgroundOverlay").click(function(F){F.target==
this&&(x(".backgroundOverlay").remove(),f.createCookie("gg-customer-testing-popup",!0,365))})},createCookie:function(F,O,L){var K="";if(L){var R=new Date;R.setTime(R.getTime()+24*L*60*60*1E3),K="; expires\x3d"+R.toUTCString()}document.cookie=F+"\x3d"+O+K+"; path\x3d/"},readCookie:function(F){var O=F+"\x3d";var L=document.cookie.split(";");for(var K=0;K<L.length;K++){for(var R=L[K];" "==R.charAt(0);)R=R.substring(1,R.length);if(0==R.indexOf(O))return R.substring(O.length,R.length)}return null},addEvent:function(F,
O,L){F.addEventListener?F.addEventListener(O,L,!1):F.attachEvent&&F.attachEvent("on"+O,L)},thatsallfolks:function(F){console.log("%c TEST RUNNING | "+F.slug.toUpperCase()+" - "+F.version+" ","background: #ec2a26; color: white; display: block;")}};x.fn.abTest=function(F){f.init(F),f.addPopUp(),f.thatsallfolks(F)};var D={css:".gg-customer-testing-popup:not(.show-popup) .backgroundOverlay{display:none !important}.gg-customer-testing-popup .backgroundOverlay{position:fixed;top:0;left:0;height:100%;width:100%;z-index:999999999;background:rgba(0,0,0,0.5)}.gg-customer-testing-popup .popupContainer{position:absolute;top:50%;left:50%;width:500px;max-width:calc(100% - 40px);-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);background-color:#efe8e8;color:#353535}.gg-customer-testing-popup .popup{padding:20px}.gg-customer-testing-popup .popup a{text-decoration:none}.gg-customer-testing-popup .buttonWrapper{text-align:center}.gg-customer-testing-popup .popUpButton{vertical-align:top;display:inline-block;border:2px solid #0b4b59;font-size:14px;font-weight:bold;padding:8px 25px;margin:10px 5px 0 5px}.gg-customer-testing-popup .popUpButton.popUpButton--yes{background-color:#0b4b59;color:#fff}.gg-customer-testing-popup .popUpButton.popUpButton--no{color:#0b4b59}.gg-customer-testing-popup .headerLogo img{height:30px;width:auto}.gg-customer-testing-popup .headerText{font-weight:bold;margin-top:20px}.gg-customer-testing-popup .bodyText{font-size:13px;margin:15px 0}.gg-customer-testing-popup .horizontalRule{min-height:1px;clear:both;width:100%;border-bottom:1px solid #000;padding-top:5px;margin:5px 0}",
slug:"gg-customer-testing-popup",version:"1.0"};x("body").abTest(D),clearInterval(J)}},100)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"COMMERCIAL: LINKEDIN PIXEL [V1.0]","description":"LinkedIn's pixel on the Business and Money sections so that we can retarget our users on LinkedIn"});var t="aemproduction.tags.commerciallinkedinpixelv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.BusinessOnly","aemproduction.filters.MoneyOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);
a.pre=function(){};a.script=function(){_linkedin_data_partner_id="104656";(function(){var J=document.getElementsByTagName("script")[0];var x=document.createElement("script");x.type="text/javascript";x.async=true;x.src="https://snap.licdn.com/li.lms-analytics/insight.min.js";J.parentNode.insertBefore(x,J)})()};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"ADTECH: Quantcast [v4.1]"});var t="aemproduction.tags.adtechquantcastv41.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){if(typeof window.tmgAdsLog!="function"){console.log("ADTECH:: Testing positive for content-blocking...");window.tmgAdsEvent=function(x,f){var D=
"tmgAds:"+x;var F=new CustomEvent(D);document.dispatchEvent(F)};window.tmgAdsLog=function(x,f){if(void 0!==typeof tmgAds){var D={time:("00"+(tmgAdsTimer()/1E3).toFixed(5)).slice(-9),callee:null,extra:f,styling:"",css:{none:"background: #FFFFFF; color: #000000",alert:"background: #D4A6A6; color: #000000",success:"background: #B2D8B2; color: #000000",error:"background: #FFB2B2; color: #000000",warning:"background: #FFE4B2; color: #000000",optimizely:"background: #FFDD37: color: #000000",event:"background: #C0CEDC; color: #000000"},
msg:x};arguments.callee.caller&&(D.callee=arguments.callee.caller.name),D.msg="%c[TMG-GPT]["+D.time+"]["+(D.callee+"                         ").substr(0,25)+"]: "+D.msg,D.styling=D.css.none,"ALERT"==x.substr(0,5)&&(D.styling=D.css.alert),"OPTIMIZELY"==x.substr(0,10)&&(D.styling=D.css.optimizely),"SUCCESS"==x.substr(0,7)&&(D.styling=D.css.success),"ERROR"==x.substr(0,5)&&(D.styling=D.css.error),"WARNING"==x.substr(0,7)&&(D.styling=D.css.warning),"EVENT"==x.substr(0,5)&&(D.styling=D.css.event),"INFO"==
x.substr(0,4)&&(D.styling=D.css.info),tmgAds.log.push(D.msg)}};window.tmgAdsPerf=function(x,f){if(void 0!==window.RUM){if(tmgAdsLog("SUCCESS: RUM installed.... go go go go! - "+x+" - "+f[0]),tmgAds.log.push("Performance: RUM Installed - "+x+" - "+f[0]),"now"==x)return RUM.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),RUM.mark(f[0]);if("measure"==x)return RUM.measure(f[0],f[1],f[2])}else if(void 0!==window.performance){if(tmgAdsLog("WARNING: RUM NOT installed.... using window.performance API instead! - "+
x+" - "+f[0]),tmgAds.log.push("Performance: RUM Not installed, using performance API - "+x+" - "+f[0]),"now"==x)return window.performance.now();if("mark"==x)return tmgAds.metrics[f[0]]=tmgAdsTimer(),window.performance.mark(f[0]);if("measure"==x)return window.performance.measure(f[0],f[1],f[2])}else{if(tmgAdsLog("WARNING: RUM NOT installed AND window.performance not supported... - "+x+" - "+f[0]),tmgAds.log.push("Performance: No RUM, No perrformance API - "+x+" - "+f[0]),"now"==x)return RUM.now();
if("mark"==x)return void(tmgAds.metrics[f[0]]=tmgAdsTimer());if("measure"==x)return}};window.tmgAdsTimer=function(){var x=!1;return x=void 0!==window.RUM&&void 0!==window.RUM.now?window.RUM.now():void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),parseFloat(x.toFixed(3))};window.tmgAdsLoadJS=function(x,f,D){var F={name:x,status:"start",type:"text/javascript",url:f,performance:{loadjsStarted:tmgAdsTimer(),loadjsRequested:0,loadjsLoaded:0}};tmgAdsEvent(x+
":"+F.status);var O=document.createElement("script");O.type="text/javascript",O.async=!0,O.onload=function(){F.status="loaded",tmgAdsEvent(x+":"+F.status),F.performance.loadjsLoaded=tmgAdsTimer(),tmgAdsPerf("mark",["adverts_loaded_"+x]),tmgAds.metrics[x]||(tmgAds.metrics[x]={});for(var K in F.performance)tmgAds.metrics[x][K]=F.performance[K];tmgAds.metrics[x].loadjsLatency=parseFloat((tmgAds.metrics[x].loadjsLoaded-tmgAds.metrics[x].loadjsStarted).toFixed(3)),"function"==typeof D&&D()},F.status="requested",
F.performance.loadjsRequested=tmgAdsTimer(),tmgAdsEvent(x+":"+F.status),tmgAdsPerf("mark",["adverts_requested_"+x]),O.src=F.url;var L=document.getElementsByTagName("script")[0];L.parentNode.insertBefore(O,L)};window.tmgAdsGetMetaTag=function(x){try{var f=null;if(null!==document.getElementsByName(x)[0]&&void 0!==document.getElementsByName(x)[0]){if(tmgAdsLog("tmgAdsGetMetaTag("+x+"): document.getElementsByName('"+x+"')[0] exists"),document.getElementsByName(x)[0].content.length>0&&(f=document.getElementsByName(x)[0].content.toLowerCase(),
f="tmgads.articleid"==x?decodeURIComponent(document.getElementsByName(x)[0].content):decodeURIComponent(document.getElementsByName(x)[0].content.toLowerCase()),tmgAdsLog("tmgAdsGetMetaTag("+x+'): "'+f+'"')),"tmgads.keywords"==x)if(null!==f){f=f.split(",");for(var D=0;D<f.length;D++)String.prototype.trim?f[D]=f[D].trim():null!==typeof f[D]?f[D]=f[D].replace(/^\s\s*/,"").replace(/\s\s*$/,""):tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmp[i] is null -\x3e "'+f[D]+'"'),tmgAdsLog("tmgAdsGetMetaTag("+x+'): tmgads.keywords -\x3e "'+
f[D]+'"')}else tmgAdsLog("tmgAdsGetMetaTag("+x+"): tmgads.keywords -\x3e tmgads.keywords content is not set")}else tmgAdsLog("tmgAdsGetMetaTag("+x+"): document.getElementsByName('"+x+"')[0] does not exist -\x3e "+f);return f}catch(F){tmgAdsLog("ERROR: tmgAdsGetMetTag("+x+") failed -\x3e error\x3d"+F.message)}};window.tmgAds=window.tmgAds||{};window.tmgAds.log=window.tmgAds.log||[];window.tmgAds.metrics=window.tmgAds.metrics||{ads:{}}}var J={name:"quantcast",ver:"4.1",date:"2017-09-27",site:window.tmgAdsGetMetaTag("tmgads.channel"),
url:(document.location.protocol=="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js",callbackFn:function(){}};J.id=J.name+"-"+J.ver;window._qevents=window._qevents||[];window._qevents.push({qacct:"p-gyXAHFFgnNQDj"});tmgAdsLoadJS(J.id,J.url,J.callbackFn)};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"ANALYTICS: Outbrain [v1.1]","description":"RFC-9682"});var t="aemproduction.tags.analyticsoutbrainv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList([]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){if(window.location.href.indexOf("telegraph.co.uk/financial-services/")===-1){var J=
document.createElement("img");J.src="https://amplifypixel.outbrain.com/pixel?mid\x3d00eaf20a66cd025f190318edba18d8089b";J.style.display="none"}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"async":true,"usesDocumentWrite":false,"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"name":"ANALYTICS: Facebook-paywall [v1.0]","active":true,"disabled":false,"locked":false,"locationObject":"BODY","url":"","timeout":5E3});var t="aemproduction.tags.analyticsfacebookpaywallv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3c!-- Facebook Pixel Code --\x3e\n\x3cscript\x3e\n(function(){\n  if (typeof fbq \x3d\x3d\x3d "function"){\n    var meter_count \x3d document.querySelector("html.logged-in--false") ? 0 : 1;\n    fbq(\'trackCustom\', "ViewPaywall", {\n  \t\tmeter_count: meter_count\n  \t}); \n  }\n})();\n\x3c/script\x3e\n\x3c!-- End Facebook Pixel Code --\x3e';
a.addClientFiltersList(["aemproduction.filters.PaywallPage"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"name":"TRAVEL: TT-1151","description":"Fix for booking com link underneath gallery to add back affiliate link"});var t="aemproduction.tags.traveltt1151.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent="";a.addClientFiltersList(["aemproduction.filters.TravelOnly"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){var J=document.querySelector('.hotelRenderer [data-js\x3d"grid-gallery"] .link');
if(J){var x=document.querySelectorAll(".hotelRenderer .product-book-now__provider .travel-cta__link")[0].getAttribute("href");J.href=x}};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"dedupe":false,"locationPlaceHolder":"END","needsConsent":false,"active":true,"url":"","timeout":5E3,"async":true,"usesDocumentWrite":false,"name":"COMMERCIAL: Confirmation_google:[v1.0]","disabled":false,"id":56175087,"locked":false,"locationObject":"HEAD"});var t="aemproduction.tags.commercialconfirmation_googlev10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3c!-- Google Code for PX - Website Conversion UK Conversion Page --\x3e \n\x3cscript type\x3d"text/javascript"\x3e /* \x3c![CDATA[ */ var google_conversion_id \x3d 971994445; var google_conversion_language \x3d "en"; var google_conversion_format \x3d "3"; var google_conversion_color \x3d "ffffff"; var google_conversion_label \x3d "pBciCOHUmFsQzeq9zwM"; var google_conversion_value \x3d order.price; var google_conversion_currency \x3d "GBP"; var google_remarketing_only \x3d false; /* ]]\x3e */ \x3c/script\x3e \x3cscript type\x3d"text/javascript" src\x3d"//www.googleadservices.com/pagead/conversion.js"\x3e \x3c/script\x3e \x3cnoscript\x3e \x3cdiv style\x3d"display:inline;"\x3e \x3cimg height\x3d"1" width\x3d"1" style\x3d"border-style:none;" alt\x3d"" src\x3d"//www.googleadservices.com/pagead/conversion/971994445/?value\x3d1.00\x26amp;currency_code\x3dGBP\x26amp;label\x3dpBciCOHUmFsQzeq9zwM\x26amp;guid\x3dON\x26amp;script\x3d0"/\x3e \x3c/div\x3e \x3c/noscript\x3e';
a.addClientFiltersList(["aemproduction.filters.DefaultFilterMatchAll2","aemproduction.filters.IncludeSecurePaymentConfirmation"]);a.addClientVariablesMap({});a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();
(function(){var u=qubit.opentag.CustomTag;var a=new u({"locationPlaceHolder":"END","name":"FINANCIAL SERVICES: CSS Fix [v1.0]","description":"Stakeholder: Tynan"});var t="aemproduction.tags.financialservicescssfixv10.Tag";qubit.Define.clientNamespace(t,a);a.htmlContent='\x3cstyle\x3eiframe[src\x3d"http://www.responsible.org.uk/strategy/calculators/telegraph/rhu2/"]{display:none;}\x3c/style\x3e';a.addClientFiltersList(["aemproduction.filters.IncludeFinancialServicesTemp"]);a.addClientVariablesMap({});
a.addParameters([]);a.genericDependencies=[];a.addClientDependenciesList([]);a.pre=function(){};a.script=function(){};a.post=function(){}})();(function(){try{qubit.opentag.Main.run()}catch(u){try{console.error("Errors during opentag main runtime.",u)}catch(a){}}})();