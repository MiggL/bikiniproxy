(function(){(function(n,m,r,g,l){n[m]=n[m]||{};for(n[m].q=n[m].q||[];l<g.length;)r(g[l++],n[m])})(window,"extole",function(n,m){m[n]=m[n]||function(){m.q.push([n,arguments])}},["createZone","log"],0);var p=[{name:"Henri Bendel Referral Program",programDomain:"refer.henribendel.com",sitePatterns:"*\\.?$ *.extole.com refer.henribendel.com *.extole.io api.extole.com *".split(" "),isSecure:!1}];extole.VERSION="5.0";extole.CORE_ROOT="https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443";
extole.CORE_CONFIG={backendTargetingEnabled:!1};extole.CLIENT_ID="1394918772";extole.CAMPAIGN_STEP_MAPPINGS={friend_landing_experience:[{zoneName:"friend_landing_experience",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6442422795513760683:version=349:coreAssetsVersion=1509024379443/render-javascript.js",campaignId:"6442422794069974042",programLabel:"6442422794069974042",apiVersion:"5"},{zoneName:"friend_landing_experience",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6463004964517692842:version=216:coreAssetsVersion=1509024379443/render-javascript.js",
campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}],share_experience:[{zoneName:"share_experience",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6487406814676792023:version=10:coreAssetsVersion=1509024379443/render-javascript.js",campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}],global_header_mobile:[{zoneName:"global_header_mobile",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6484255973011657050:version=30:coreAssetsVersion=1509024379443/render-javascript.js",
campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}],global_footer:[{zoneName:"global_footer",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6484255843964941641:version=33:coreAssetsVersion=1509024379443/render-javascript.js",campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}],confirmation:[{zoneName:"confirmation",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6487672460923324679:version=8:coreAssetsVersion=1509024379443/render-javascript.js",
campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}],global_header:[{zoneName:"global_header",creativeRenderUri:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6485633605912927056:version=12:coreAssetsVersion=1509024379443/render-javascript.js",campaignId:"6463004965218449758",programLabel:"6463004965218449758",apiVersion:"5"}]};extole.BUILD_DATE="2018213843";extole.PROGRAM=function(){var n=function(d,e){var a=Error.call(this,d);this.name="ExtoleError";
this.message=a.message;this.stack=a.stack;this.code=e};n.prototype=Error();n.prototype.constructor=n;var m=function(d,e){if(d.length)for(var a=0;a<d.length;a++)e(d[a],a);else for(a in d)d.hasOwnProperty(a)&&e(d[a],a)},r=function(d,e){var a=[];m(d,function(c){(c=e(c))&&(a[a.length]=c)});return a},g=function(d,e){e=e||[];e.push("*.extole.com");var a=!1;m(e,function(c){(new RegExp(c.replace(/\./g,"\\.").replace(/\*/g,".*"))).test(d)&&(a=!0)});return a},l=function(d){var e=window.location.hostname;return r(d,
function(a){if(g(e,a.sitePatterns))return a})}(p),h=l[0];if(!h)throw new n("No program domain is configured for hostname: "+window.location.hostname+" unable to use Extole API","site_configuration_error");1<l.length&&extole.log("warn","Multiple programs matched hostname: "+window.location.hostname+" programs: "+JSON.stringify(l));return h}();(function(n,m,r,g,l){n[m]=n[m]||{};for(n[m].q=n[m].q||[];l<g.length;)r(g[l++],n[m])})(window,"extole",function(n,m){m[n]=m[n]||function(){m.q.push([n,arguments])}},
["log"],0);extole.define||function(){function n(){}function m(){var f="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),b=document.createElement("script");this.useInteractive=b.attachEvent&&!(b.attachEvent.toString&&0>b.attachEvent.toString().indexOf("[native code"))&&!f}var r=[],g=function(f){var b;d(r,function(a){if(a.url==f)return b=a,!1});return b},l=function(f){extole.log("debug","[REQUIRE] "+f)},h=function(f){extole.log("error","[REQUIRE] "+f)},d=function(f,b){if(f.length)for(var a=
0;a<f.length;a++)b(f[a],a);else for(a in f)f.hasOwnProperty(a)&&b(f[a],a)},e=function(f,b){var a=[];d(f,function(f,c){a[c]=b(f,c)});return a},a=function(f){var b=f.split("/").slice(-1)[0],a=b.length;d(b.toLowerCase(),function(f){a+=" abcdefghijklmnopqrstuvwxyz1234567890-_.".indexOf(f)});return f.replace("origin","origin-"+a%8)},c=function(f){var b=!!f.match(/^extole-creatives:/),k=!!f.match(/^extole-media:/),q=!!f.match(/^core-root:\/\//),d=!!f.match(/^extole-assets:/),e=!!f.match(/origin\./),u=!!f.match(/^http:/),
t=!!f.match(/^https:/);return b?(f=f.slice(17),c("extole-assets:/core-modules/"+f)):d?(f=f.slice(14),f="extole-media:/assets/"+f,c(f)):k?(f=f.slice(13),f=extole.CORE_ROOT+f,c(f)):q?(f=f.slice(12),f=extole.CORE_ROOT+f,c(f)):e?(f=a(f),f+="?site="+window.location.hostname,c(f)):u?(f=f.slice(5),c(f)):t?(f=f.slice(6),c(f)):f};n.prototype={getUnresolvedDependencies:function(){var f=[];d(this.dependencies,function(b){"$config"!=b&&(b=g(b),(!b||b&&!b._defined)&&f.push(b))});return f},getDependencies:function(){var f=
this,b=[];d(f.dependencies,function(a){a="$config"==a?f.config||null:g(a).definition||null;b.push(a)});return b},define:function(){var f=this;f.defineStartTime=f.defineStartTime||(new Date).getTime();if(!f._defining&&!f._defined&&f.dependencies)if(f._defining=!0,0<f.getUnresolvedDependencies().length)f._defining=!1;else{var a=function(a){f.definedCallback=void 0;f.definition=a;f.end=(new Date).getTime();f.timeToDefine=f.end-f.start;f.timeToFetch&&l("Fetched "+f.url+" in "+f.timeToFetch+"ms");f.isAsync&&
l("Defined async "+f.url+" in "+f.timeToDefine+"ms");f._defining=!1;f._defined=!0;setTimeout(b,1)},c=f.getDependencies(),k={isAsync:!1,async:function(){k.isAsync=f.isAsync=!0;return function(f){a(f)}}};(function(){if(f.definedCallback){var b=f.definedCallback,b=b&&b.apply(k,c);k.isAsync||a(b)}else a(!0)})()}},fetch:function(){var f=this;f._fetching||f._fetched||(f.url?(f._fetching=!0,f.startFetchTime=(new Date).getTime(),k.loadModule(f.url,function(){f._fetching=!1;f.endFetchTime=(new Date).getTime();
f.timeToFetch=f.endFetchTime-f.startFetchTime;f._fetched=!0;f.define()})):h("Tried to fetch a module without a url - dependencies: "+f.dependencies+" definedCallback: "+(f.definedCallback?"exists":"null")+" config: "+f.config))}};m.prototype={defineQueue:[],interactiveScript:null,currentlyAddingScript:null,getInteractiveScript:function(){if(k.interactiveScript&&"interactive"==k.interactiveScript.readyState)return k.interactiveScript;for(var f=document.getElementsByTagName("head")[0].getElementsByTagName("script"),
b,a=f.length-1;0<=a;a--){var c=this.getScriptDataUrl(f[a]);f[a]&&"interactive"==f[a].readyState&&c&&(b=f[a],l("...interactive script "+b.src))}return b},scriptUrlAttributeName:"data-extole-require-url",getScriptDataUrl:function(f){return f.getAttribute(this.scriptUrlAttributeName)},setScriptDataUrl:function(f,b){f.setAttribute(this.scriptUrlAttributeName,b)},attachOnLoad:function(f,b){b=b||function(){};var a=this.useInteractive,c="PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,
k=function(q){var d=f.readyState;if(a&&"interactive"==d)interactiveScript=f;else if("load"===q.type||d.match(c))a?f.detachEvent("onreadystatechange",k):f.removeEventListener("load",k,!1),l(f.src+" finished loading"),b(q)};a?f.attachEvent("onreadystatechange",k):f.addEventListener("load",k,!1)},defineTimeout:null,addDefine:function(f){if(f.url)f.url=c(f.url);else{l("defining anonymous module...");var b=this.currentlyAddingScript||this.getInteractiveScript();this.useInteractive&&b?(b=this.getScriptDataUrl(b),
l("..scriptToCompare has data url "+b),f.url=b,this.interactiveScript=null):this.useInteractive&&l("..found no scriptToCompare")}f.dependencies=e(f.dependencies,c);this.useInteractive&&!f.url&&h("defines should not be missing a url in ie.");this.defineQueue.push(f);this.defineTimeout&&clearTimeout(this.defineTimeout);var a=this;this.defineTimeout=setTimeout(function(){l("intakeDefines from addDefine timeout");a.intakeDefines()},1)},intakeTimeout:null,intakeDefines:function(){for(var f={},a=function(b,
a){f[b]=f[b]?f[b]+","+a:a},c=[],k;k=this.defineQueue.shift();){var q=[];d(k.dependencies,function(b){b&&q.push(b)});var e=k.url&&g(k.url);k.url?e?a(k.url,"updated"):a(k.url,"created"):c.push("deps "+k.dependencies);d(q,function(b){a(b,"dependency");u(b)});u(k.url,q,k.definedCallback,k.config,k.isRequire)}var t="intakeDefines -- ";d(f,function(b,f){t+="\n - "+f+" "+b});t+="\n -- "+c.length+" anonymous modules created";d(c,function(b){t+="\n - "+b});l(t);this.intakeTimeout&&clearTimeout(this.intakeTimeout);
this.intakeTimeout=setTimeout(b,1)},loadModule:function(b,a){var c=document.createElement("script");c.async=!0;c.crossOrigin="anonymous";this.setScriptDataUrl(c,b);var k=this;l("loading module "+b);this.attachOnLoad(c,function(){if(!k.useInteractive){for(var c,q=k.defineQueue.length-1;0<=q;q--)k.defineQueue[q].url||(c&&h("Multiple anonymous modules loaded in one script - "+b),c=k.defineQueue[q]);c?(l("assigned "+b+" to anonymous module"),c.url=b):l("module url didn't define a module - "+b)}l("intake defines from loadModule");
k.intakeDefines();a&&a(null)});c.src=b;this.currentlyAddingScript=c;document.getElementsByTagName("head")[0].appendChild(c);this.currentlyAddingScript=void 0}};var k=new m,b=function(){d(r,function(b){b._fetched?b._defined||b.define():b.fetch()})},u=function(b,a,c,k,q){if("$config"!=b){var d=g(b),e=d||new n;d||r.push(e);b&&a&&(e._fetched=!0);e.start=e.start||(new Date).getTime();e.url=e.url||b;e.dependencies=e.dependencies||a;e.config=e.config||k;e.definedCallback=e.definedCallback||c;e.isRequire=
e.isRequire||q}},q=function(b,a,c,q){b instanceof Array&&(q=c,c=a,a=b,b=void 0);k.addDefine({url:b,dependencies:a,definedCallback:c,config:q})};q.getModule=function(b){return g(b)};var x=0,t=function(){x++;return"anonymous_"+x};extole.define=q;extole.require=function(b,a){k.addDefine({url:t(),dependencies:b,definedCallback:a,isRequire:!0})};extole.define("extole-require",[],function(){return{resolveUrl:c}});setTimeout(function(){var b=!1,a=[];d(r,function(c){c._defined||(b=!0);a.push({defineStartTime:c.defineStartTime,
dependencies:c.dependencies,end:c.end,start:c.start,isRequire:c.isRequire,timeToDefine:c.timeToDefine,url:c.url,_defined:c._defined,_defining:c._defining,_fetched:c._fetched})});b&&extole.DUMP_REQUIRE_MODULES_ON_ERROR&&extole.log("error","After 7000ms there are unresolved extole-require modules.  ###"+JSON.stringify(a)+"###")},7E3)}();extole.require(["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/uri.js",
"create-zone-implementation","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],function(n,m,r,g){var l=function(){function a(a){"function"===typeof c[a[0]]&&c[a[0]].apply(null,a[1])}for(var c={log:function(){var a=Array.prototype.slice.call(arguments),b=a[0];"function"===typeof g[b]&&g[b].apply(null,a.slice(1))},createZone:r};extole.q.length;)a(extole.q.shift());extole.q.push=a},h=function(){var a=function(b){var a={},c=/^extole_/,k=/^extole_zone_/;
n.each(b,function(b,f){f.match(k)?a[f.replace(k,"")]=b:f.match(c)&&(a[f.replace(c,"")]=b)});return a}(m.deserialize(window.location.search));if(a.name){var c=a.name,k=a.element_id;delete a.name;delete a.element_id;extole.createZone({name:c,element_id:k,data:a})}},d=function(){var a;"function"===typeof window.onerror&&(a=window.onerror);window.onerror=function(c,k,b,d,q){if(a)try{a(c,k,b,d,q)}catch(f){}k=k||window.location.href||"no_source_or_location.href";q=q&&q.stack?q.stack:"no_error.stack";var e=
[],t=JSON.stringify({MESSAGE:c,SOURCE:k,LINE_NUMBER:b,COLUMN_NUMBER:d,STACK_TRACE:q},function(b,a){if(null!==a&&"object"==typeof a){if(0<=e.indexOf(a))return;e.push(a)}return a});((q+c).match(/extole/i)||k.match(extole.PROGRAM.programDomain))&&extole.require(["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],function(b){b.error("Unhandled exception",JSON.parse(t))})}},e=function(){d();l();h();extole._bootstrapped=!0};extole.bootstrap=e;extole._bootstrapped||
e();if("undefined"!==typeof window.extoleAsyncInit)try{extoleAsyncInit()}catch(a){extole.require(["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],function(c){c.error("Error executing extended core javascript. Message : "+a.message+" Stack: "+a.stack)})}});extole.define("create-zone-implementation","zone-targeter request-zone find-element-by-id https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/Timer.js creative-javascript-api/render/CreativeContext".split(" "),
function(n,m,r,g,l,h,d){function e(a){a=g.merge({},a);delete a.campaign_id;delete a.extole_campaign_id;return a}function a(a,k){var b=[],d=0;g.each(a,function(a,c){d++;a(function(){d--;b[c]=arguments;0===d&&k(b)})})}return function(c,k){k=k||function(){};var b=c.name,u=c.parameters||c.data||{},q=c.element,g=c.element_id,t=new h;t.start();n.getCreative(b,u,function(c,h){var n=h?h.getCampaignId():null,y=h?h.getProgramLabel():null,p=e(u);a([function(){return function(a){m(b,p,n,a)}}(),function(){return function(a){(function(b){q?
b(q):g?r(g,b):b(document.body.appendChild(document.createElement("DIV")))})(function(c){var f=t.getElapsedTime();l.info("extole.createZone v5 load duration: "+f+"ms",{duration:f,zone:{name:b,parameters:u}});c=new d(b,p,c,n,y);h&&h.render(c);a(c)})}}()],function(b){var a=b[0][0];b=b[1][0];a?k(a):k(null,b.getZone())})})}});extole.define("creative-javascript-api/render/Campaign",[],function(){return function(n,m){this.getId=function(){return n};this.getProgramLabel=function(){return m}}});extole.define("creative-javascript-api/render/CoreConfig",
[],function(){return function(){this.backendTargetingEnabled=function(){return extole.CORE_CONFIG.backendTargetingEnabled}}});extole.define("creative-javascript-api/render/CreativeContext",["creative-javascript-api/render/Zone","creative-javascript-api/render/Campaign","creative-javascript-api/render/Program","creative-javascript-api/render/CoreConfig"],function(n,m,r,g){return function(l,h,d,e,a){var c=new m(e,a),k=new n(l,h,d),b=new r,u=new g;this.getCampaign=function(){return c};this.getZone=function(){return k};
this.getProgram=function(){return b};this.getCoreConfig=function(){return u}}});extole.define("creative-javascript-api/render/Program",[],function(){return function(){this.getName=function(){return extole.PROGRAM.name};this.getProgramDomain=function(){return extole.PROGRAM.programDomain};this.getSitePatterns=function(){return extole.PROGRAM.sitePatterns}}});extole.define("creative-javascript-api/render/Zone",[],function(){return function(n,m,r){this.getElement=function(){return r};this.getName=function(){return n};
this.getData=function(){return m};this.getParameters=function(){return m}}});extole.define("find-element-by-id",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],function(n){function m(m,g,l){function h(){if(g())l();else{m();var e=setTimeout,a;d||(d=10);a=500<d?500:d*=1.1;e(h,a)}}var d;h()}return function(r,g){var l=(new Date).getTime(),h=!1,d;m(function(){d=document.getElementById(r)},function(){var e=(new Date).getTime()-l;!h&&5E3<e&&(h=
!0,n.warn("Scanned for 5000 ms searching for zone element id: "+r));return Boolean(d)},function(){g(d)})}});extole.define("request-zone",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/ajax.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/type.js",
"https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/client/program.js"],function(n,m,r,g,l){function h(a,c,k){a=d(a);a.access_token=c;k&&(a.campaign_id=k);return a}function d(a){function c(b,a){if(g.isPlainObject(b))r.each(b,function(b,k){var f=a.slice();f.push(k);c(b,f)});else{var d=a.join(".");k[d]=b}}var k={};c(a,[]);return k}var e=l.getProgramDomain();return function(a,c,k,b){b=b||function(){};extole.require(["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/user-service.js"],
function(d){d.getUser(function(q,g){if(q)b(q);else{var t=l.getProtocol()+e+"/zone/"+a,f=h(c,g.getAccessToken(),k);m({type:"GET",url:t,dataType:"json",xhrFields:{withCredentials:!0},data:f,complete:function(a){var c;try{c=JSON.parse(a).access_token}catch(f){n.warn("Could not parse zone response as JSON for zone: "+t)}c||"function"!==typeof this.getResponseHeader||(c=this.getResponseHeader("X-Extole-Token"));c&&c!==g.getAccessToken()&&d.setAccessToken(c);b(null)},error:function(c,f,k){b(Error("zone request for zone: "+
a))}})}})})}});extole.define("zone-targeter",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/uri.js"],function(n){function m(h,d){for(var e=0;e<h.length;e++)if(h[e].campaignId===d)return h[e]}function r(h,d,e){this.render=h;this.getCampaignId=function(){return d};this.getProgramLabel=function(){return e}}var g=extole.CAMPAIGN_STEP_MAPPINGS,l=n.deserialize(window.location.search).extole_campaign_id;return{getCreative:function(h,d,e){var a=g[h];if(a&&
a.length){var c;d.campaign_id&&(c=m(a,d.campaign_id));!c&&d.extole_campaign_id&&(c=m(a,d.extole_campaign_id));!c&&l&&(c=m(a,l));c||(c=a[0]);extole.require([c.creativeRenderUri],function(a){e(null,new r(a,c.campaignId,c.programLabel))})}else e(Error("no creative is mapped to zone: "+h))}}})})();
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/ajax.js",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/uri.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/type.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],
function(p,n,m,r){var g=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],l=function(d){if(d=d.match(/^([a-zA-Z]*:?\/\/)?([^/]+)/))return d[2]},h=function(d,e){var a=Array.prototype.slice.call(arguments),c=e.headers||{},k=e.xhrFields||{},b=e.url||"",u=e.data||"",q=(e.type||"get").toUpperCase(),h=e.complete||function(){},t=e.error||function(){r.error("Error with url "+
b+"= "+a.join(","))},f=l(b),g=l(location.toString());(f="undefined"!=typeof XDomainRequest&&!(f&&g&&f==g))&&(d=new XDomainRequest);m.isPlainObject(u)&&("GET"==q?(b+=n.serialize(u),u=null):u=JSON.stringify(u));f?(d.open(q,b),d.onprogress=function(){},d.ontimeout=t,d.timeout=0):d.open(q,b,!0);p.merge(d,k);f||p.each(c,function(b,a){try{d.setRequestHeader(a,b)}catch(c){r.error("AJAX ERROR: Couldn't set request header "+a+" to "+b)}});var v=!1;d.onerror=function(b){v||(v=!0,t.call(d,d.statusText,d.status))};
c=function(){void 0!==d.readyState&&4!==d.readyState||v||(v=!0,String(d.status||200).match(/^[23]/)?"function"===typeof h?h.call(d,d.responseText):r.warn("`complete` callback must be a function."):t.call(d,d.statusText,d.status))};d.onload=c;d.onreadystatechange=c;d.send(u)};return function(d){d=d||{};var e;e=!1;for(var a=0;a<g.length;a++){try{e=g[a]()}catch(c){continue}break}h(e,d);return e}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/api.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/ajax.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/JSON.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/Timer.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/client/program.js".split(" "),
function(p,n,m,r,g,l){function h(){var a=this,c,k,b,d,q;this.withRequestSummary=function(b){d=b;return a};this.withResponseSummary=function(b){q=b;return a};this.withStatusCode=function(c){b=c;return a};this.withMessage=function(b){k=b;return a};this.asDebug=function(){c="debug";return a};this.asInfo=function(){c="info";return a};this.asWarn=function(){c="warn";return a};this.asError=function(){c="error";return a};this.log=function(){if(!d.url.match(n.LOGGING_ENDPOINT)){var a=[];b&&a.push("Status "+
b);k&&a.push(k);n[c](a.join(" "),{request:d,response:q})}}}var d=/^\/api\/v\d\//,e=l.getProgramDomain();return new function(){function a(b,a,c){k("get",b,null,a,c)}function c(b,a,c){k("delete",b,null,a,c)}function k(a,c,k,f,d){f=f||function(){};d=d||{};d=p.merge({"Content-Type":"application/json"},d.headers);c=l.getProtocol()+e+b(c);k=p.merge({},k);m({timeout:2E4,url:c,type:a,complete:function(b){var a=null;try{b=r.parse(b)}catch(c){a=Error("Couldn't parse as JSON response from request, response: "+
b),b=null}f&&f(a,b);b=p.merge({},b);b.timestamp=String((new Date).getTime());(new h).withRequestSummary(u).withResponseSummary(b).withMessage("Completed api request").asDebug().log()},error:function(b,a){var c;try{c=r.parse(this.response)}catch(k){c={statusText:this.statusText,status:a}}f&&f(c);var d=p.merge({},c);d.timestamp=String((new Date).getTime());d=(new h).withRequestSummary(u).withResponseSummary(d);c=String(a||c.http_status_code);"4"===c[0]?d.asInfo().withMessage("Failed api request").withStatusCode(c).log():
d.asError().withMessage("Failed api request").withStatusCode(c).log()},data:k,headers:d,xhrFields:{withCredentials:!0}});var u={url:c,type:a,data:k,timestamp:String((new Date).getTime())}}function b(b){return b.match(d)?b:"/api/v4"+b}var u=!1;this.poll=function(b,c,k){function f(){var e=d.getElapsedTime();k.headers=p.merge({"X-Extole-Polling-Time":e},k.headers);a(b,function(b,a){b||u||"FAILED"===a.status?(u&&(b=Error("poll cancelled"),b.code="cancelled"),c(b||a.error)):"SUCCEEDED"===a.status?c(null,
a):"PENDING"===a.status&&setTimeout(f,k.pollInterval||300)},k)}u=!1;c=c||function(){};k=k||{};var d=(new g).start();f()};this.cancel=function(){u=!0};this.get=a;this.post=function(b,a,c,f){k("post",b,a,c,f)};this.put=function(b,a,c,f){k("put",b,a,c,f)};this.delete=this.del=c}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/type.js"],function(p){var n=function(g,l){var h=Error.call(this,g);this.name="ExtoleError";this.message=h.message;this.stack=h.stack;this.code=l};n.prototype=Error();n.prototype.constructor=n;var m=function(g,l){var h,d;if(g.length===+g.length)for(d=0;d<g.length;d++){if(h=l(g[d],d),
!1===h)return!1}else for(d in g)if(g.hasOwnProperty(d)&&(h=l(g[d],d),!1===h))return!1};m.BREAK=!1;var r=function(g){if(!g||"object"!==typeof g&&!p.isPlainFunction(g))g={};for(var l=1;l<arguments.length;l++)if(p.isPlainObject(arguments[l]))for(var h in arguments[l]){var d=arguments[l][h];d!==g&&void 0!==d&&(p.isPlainObject(d)&&p.isPlainObject(g[h])?d=r(g[h],d):p.isArray(d)&&p.isArray(g[h])&&g[h].concat&&(d=g[h].concat(d)),g[h]=d)}return g};return{each:m,map:function(g,l){function h(a,c){e=[];m(a,function(a,
b){e.push(c(a,b))})}function d(a,c){e={};m(a,function(a,b){e[b]=c(a,b)})}var e;if(p.isArray(g))h(g,l);else if(p.isPlainObject(g))d(g,l);else throw new n(g+" argument must be type object or array","INVALID_ARGUMENT_EXCEPTION");return e},filter:function(g,l){function h(a,c){e=[];m(a,function(a,b){c(a,b)&&e.push(a)})}function d(a,c){e={};m(a,function(a,b){c(a,b)&&(e[b]=a)})}var e;if(p.isArray(g))h(g,l);else if(p.isPlainObject(g))d(g,l);else throw new n(g+" argument must be type object or array","INVALID_ARGUMENT_EXCEPTION");
return e},merge:r}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/cookie.js",["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/JSON.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js"],function(p,n,m){function r(d){return d}function g(d){try{return decodeURIComponent(d.replace(h,
" "))}catch(a){return m.error("** utils.cookie.decoded ** Cookie error for: "+d,{error:a,message:a.message,stack:a.stack,cookiePart:d}),""}}function l(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return d.json?n.parse(e):e}catch(a){}}var h=/\+/g,d=function(e,a,c){if(void 0!==a){c=p.merge({},d.defaults,c);if("number"===typeof c.expires){var k=c.expires,b=c.expires=new Date;b.setDate(b.getDate()+k)}a=d.json?n.stringify(a):String(a);return document.cookie=[d.raw?
e:encodeURIComponent(e),"=",d.raw?a:encodeURIComponent(a),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}a=d.raw?r:g;c=document.cookie.split("; ");for(var k=e?void 0:{},b=0,u=c.length;b<u;b++){var q=c[b].split("="),h=a(q[0]);if(!e)k[h]=l(a(q[1]));else if(e===h)return l(a(q[1]))}return k};d.defaults={};return d});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/dom.js",[],function(){var p={each:function(a,c){var d,b;if(a.length===+a.length)for(b=0;b<a.length;b++){if(d=c(a[b],b),!1===d)return!1}else for(b in a)if(a.hasOwnProperty(b)&&(d=c(a[b],b),!1===d))return!1},extend:function(){var a,c,d,b,e,q=arguments[0]||{},h=1,g=arguments.length,f=!1,l=this.extend;"boolean"===typeof q&&(f=q,q=arguments[1]||{},h=2);for("object"===typeof q||this.isFunction(q)||
(q={});h<g;h++)if(a=arguments[h],null!==a)for(c in a)d=q[c],b=a[c],q!==b&&(f&&b&&(this.isPlainObject(b)||(e=this.isArray(b)))?(e?(e=!1,d=d&&isArray(d)?d:[]):d=d&&isPlainObject(d)?d:{},q[c]=l(f,d,b)):void 0!==b&&(q[c]=b));return q},isFunction:function(a){return a&&"function"===typeof a&&a.call&&a.apply},isPlainObject:function(a){if("[object Object]"!==String(a)||a.nodeType||a.window&&a.window==a)return!1;try{if(a.constructor&&!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1}catch(c){return!1}return!0},
isArray:function(a){return a instanceof Array}};p.each.BREAK=!1;var n=function(){var a=[],c=function(b,c,d){for(var k=[],e=0;e<a.length;e++){var f=a[e];f.element==b&&f.eventType==c&&f.listener==d&&k.push({index:e,eventListener:f})}return k},d=function(b){this.originalEvent=b;this.type=b.type;this.keyCode=b.keyCode;this.target=b.srcElement?b.srcElement:b.target};d.prototype={preventDefault:function(){var b=this.originalEvent;b.preventDefault?b.preventDefault():b.returnValue=!1},stopPropagation:function(){var b=
this.originalEvent;b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0}};return{addListener:function(b,e,q){if(0<c(b,e,q).length)console.warn("events.add - Listener already exists for event "+e+" on element "+b);else{var h=!b.addEventListener,g=function(a){h&&(a=window.event);return q.call(b,new d(a))};a.push({element:b,eventType:e,listener:q,listenerWrapper:g});b.addEventListener?b.addEventListener(e,g,!1):b.attachEvent("on"+e,g)}},triggerEvent:function(b,a,c){var d=document.createEvent("Event");
d.initEvent(a,!0,!1);p.extend(d,c);b.dispatchEvent(d)},removeListener:function(b,d,k){k=c(b,d,k);0>=k.length?console.warn("events.remove - Couldn't find exiting event listener for type \""+d+'" listener on element '+b):p.each(k,function(c){var k=c.index;c=c.eventListener;b.removeEventListener?b.removeEventListener(d,c.listenerWrapper,!1):b.detachEvent("on"+d,c.listenerWrapper);a.splice(k,1)})}}}(),m=function(){var a=function(a){a=a.className;var b={};if(!a)return b;p.each(a.split(" "),function(a){b[a]=
1});return b},c=function(a){var b="";p.each(a,function(a,c){b+=" "+c});return b.slice(1)};return{setAttribute:function(a,b,c){a.setAttribute(b,c);a[b]=c},getAttribute:function(a,b){return a.getAttribute(b)},addClass:function(d,b){var e=a(d);e[b]||(e[b]=1,d.className=c(e))},removeClass:function(d,b){var e=a(d);delete e[b];d.className=c(e)},getClassNames:function(a){return a.className.split(" ")}}}(),r=function(){var a=function(a){var b=document.createDocumentFragment(),c=document.createElement("div");
c.innerHTML=a;p.each(c.childNodes,function(a){1==a.nodeType&&b.appendChild(a)});return b},c=function(a){var b;p.each(a.childNodes,function(a){if(!b&&1==a.nodeType)return b=a,p.each.BREAK});return b};return{prepend:function(d,b){var e=c(d),q=b;"string"==typeof b&&(q=a(b));e?d.insertBefore(q,e):d.appendChild(q)},append:function(c,b){var d=b;"string"==typeof b&&(d=a(b));c.appendChild(d)}}}(),g=function(a,c){return(c||document).querySelectorAll(a)},l={},h=function(a,c){function d(){c();e.removeEventListener(b,
"load",d)}if(l[a])return c();l[a]=!0;var b=document.createElement("link");e.setAttribute(b,"rel","stylesheet");e.setAttribute(b,"href",a);e.append(e.query("head")[0],b);e.addEventListener(b,"load",d)},d=function(a,c){0===a.length?c():h(a[0],function(){d(a.slice(1),c)})},e={addEventListener:n.addListener,removeEventListener:n.removeListener,triggerEvent:n.triggerEvent,getAttribute:m.getAttribute,setAttribute:m.setAttribute,addClass:m.addClass,removeClass:m.removeClass,getClassNames:m.getClassNames,
prepend:r.prepend,append:r.append,query:g,queryFirst:function(a,c){return g(a,c)[0]},injectStylesheet:h,injectStylesheets:d};return e});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/event-bus.js",[],function(){function p(){this._events={};var r=/\s+/,g=function(h,d,e,a){if(!e)return!0;if("object"===typeof e){for(var c in e)h[d].apply(h,[c,e[c]].concat(a));return!1}if(r.test(e)){e=e.split(r);c=0;for(var k=e.length;c<k;c++)h[d].apply(h,[e[c]].concat(a));return!1}return!0},l=function(h,d){var e,a=-1,c=h.length,k=d[0],b=d[1],g=d[2];switch(d.length){case 0:for(;++a<c;)(e=h[a]).callback.call(e.ctx);
break;case 1:for(;++a<c;)(e=h[a]).callback.call(e.ctx,k);break;case 2:for(;++a<c;)(e=h[a]).callback.call(e.ctx,k,b);break;case 3:for(;++a<c;)(e=h[a]).callback.call(e.ctx,k,b,g);break;default:for(;++a<c;)(e=h[a]).callback.apply(e.ctx,d)}};this.on=function(h,d,e){if(!g(this,"on",h,[d,e])||!d)return this;this._events||(this._events={});(this._events[h]||(this._events[h]=[])).push({callback:d,context:e,ctx:e||this});return this};this.off=function(h,d,e){var a,c,k,b,l,q,n,t;if(!this._events||!g(this,"off",
h,[d,e]))return this;if(!h&&!d&&!e)return this._events=void 0,this;b=h?[h]:m.keys(this._events);l=0;for(q=b.length;l<q;l++)if(h=b[l],k=this._events[h]){this._events[h]=a=[];if(d||e)for(n=0,t=k.length;n<t;n++)c=k[n],(d&&d!==c.callback&&d!==c.callback._callback||e&&e!==c.context)&&a.push(c);a.length||delete this._events[h]}return this};this.once=function(h,d,e){var a=this,c=function(){var k=n.call(arguments);d.apply(this,k);a.off(h,c,e)};this.on(h,c,e);return this};this.trigger=function(h){if(!this._events)return this;
var d=n.call(arguments,1);if(!g(this,"trigger",h,d))return this;var e=this._events[h],a=this._events.all;e&&l(e,d);a&&l(a,arguments);return this}}var n=Array.prototype.slice,m={isPlainObject:function(m){if("[object Object]"!==String(m)||m.nodeType||m.window&&m.window==m)return!1;try{if(m.constructor&&!m.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1}catch(g){return!1}return!0},keys:function(m){if(!this.isPlainObject(m))return[];var g=[],l;for(l in m)has(m,l)&&g.push(l);return g},_idCounter:0,
uniqueId:function(m){var g=++this._idCounter+"";return m?m+g:g}};return{create:function(){return new p}}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/JSON.js",[],function(){var p;"object"!==typeof p&&(p={});(function(){function n(a){return 10>a?"0"+a:a}function m(a){l.lastIndex=0;return l.test(a)?'"'+a.replace(l,function(a){var b=e[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function r(c,e){var b,g,q,l,t=h,f,p=e[c];p&&p instanceof Date&&(b=p,p=isFinite(b.valueOf())?b.getUTCFullYear()+
"-"+n(b.getUTCMonth()+1)+"-"+n(b.getUTCDate())+"T"+n(b.getUTCHours())+":"+n(b.getUTCMinutes())+":"+n(b.getUTCSeconds())+"Z":null);"function"===typeof a&&(p=a.call(e,c,p));switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";h+=d;f=[];if("[object Array]"===Object.prototype.toString.apply(p)){l=p.length;for(b=0;b<l;b+=1)f[b]=r(b,p)||"null";q=0===f.length?"[]":h?"[\n"+h+f.join(",\n"+h)+
"\n"+t+"]":"["+f.join(",")+"]";h=t;return q}if(a&&"object"===typeof a)for(l=a.length,b=0;b<l;b+=1)"string"===typeof a[b]&&(g=a[b],(q=r(g,p))&&f.push(m(g)+(h?": ":":")+q));else for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&(q=r(g,p))&&f.push(m(g)+(h?": ":":")+q);q=0===f.length?"{}":h?"{\n"+h+f.join(",\n"+h)+"\n"+t+"}":"{"+f.join(",")+"}";h=t;return q}}var g,l,h,d,e,a;"function"!==typeof p.stringify&&(l=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p.stringify=function(c,e,b){var g;d=h="";if("number"===typeof b)for(g=0;g<b;g+=1)d+=" ";else"string"===typeof b&&(d=b);if((a=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return r("",{"":c})});"function"!==typeof p.parse&&(g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p.parse=function(a,d){function b(a,
c){var e,f,g=a[c];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=b(g,e),void 0!==f?g[e]=f:delete g[e]);return d.call(a,c,g)}var e;a=String(a);g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+
a+")"),"function"===typeof d?b({"":e},""):e;throw new SyntaxError("JSON.parse");})})();return p});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js",[],function(){function p(e,a,c){c=c||{};c.pageId=r;c.referer=g;var k;try{k=[a||"no message","START_JSON",JSON.stringify(c),"END_JSON"].join(" ")}catch(b){m("Failed to stringify log's json data",{exception:b});return}extole.LOG_EXCLUDE_REGEX&&k.match(extole.LOG_EXCLUDE_REGEX)||(d[k]=++d[k]||1,l[e]>=l[extole.LOG_LEVEL_CONSOLE]&&window.console&&window.console.log&&window.console.log(e+
" "+k),l[e]>=l[extole.LOG_LEVEL_REMOTE]&&(a=d[k],h[a]&&n(e,k+(1<a?" log count: "+a:""))))}function n(d,a){extole.require(["https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/api.js"],function(c){var k="/api/v4/debug/logs",b;a:{b=document.cookie.split(";");for(var g=0;g<b.length;g++){var q=b[g].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");if(0===q.indexOf("extole_access_token=")){b=q.substring(20,q.length);break a}}b=null}b&&"null"!=b&&"undefined"!=b&&
(k+="?access_token="+b);c.post(k,{level:d,message:a})})}function m(d,a){p("ERROR",d,a)}var r=String((new Date).getTime()),g=window.location.href,l={DEBUG:0,INFO:1,WARN:2,ERROR:3,OFF:4},h={1:!0,3:!0,10:!0,30:!0,100:!0,250:!0,500:!0,1E3:!0};extole.LOG_EXCLUDE_REGEX=extole.LOG_EXCLUDE_REGEX||void 0;extole.LOG_LEVEL_CONSOLE=extole.LOG_LEVEL_CONSOLE||"OFF";extole.LOG_LEVEL_REMOTE=extole.LOG_LEVEL_REMOTE||"WARN";var d={};return{debug:function(d,a){p("DEBUG",d,a)},info:function(d,a){p("INFO",d,a)},warn:function(d,
a){p("WARN",d,a)},error:m,LOGGING_ENDPOINT:"/api/v4/debug/logs"}});extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/Timer.js",[],function(){return function(){var p=this,n;this.start=function(){if(n)throw Error("Timer.start has already been called");n=new Date;return p};this.getElapsedTime=function(){if(!n)throw Error("Timer has not been started");return new Date-n}}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/type.js",[],function(){return{isPlainObject:function(p){return"[object Object]"===Object.prototype.toString.call(p)&&p.constructor===Object},isPlainFunction:function(p){return"[object Function]"===Object.prototype.toString.call(p)},isArray:function(p){return"[object Array]"===Object.prototype.toString.call(p)}}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/uri.js",[],function(){function p(m){var n={};(function l(h,d){for(var e in h){var a=h[e],c=(d?d+".":"")+e;"[object Object]"===Object.prototype.toString.call(a)?l(a,c):n[c]=a}})(m);return n}function n(m){try{return decodeURIComponent(m)}catch(n){return m}}return{serialize:function(m){var n="",g;for(g in m)n+="&"+encodeURIComponent(g)+"="+encodeURIComponent(String(m[g]));return n.replace(/^\&/,
"?")},deserialize:function(m){var p={};if(!m)return p;m=(m.match(/^\?/)?m.slice(1):m).split("&");for(var g=0;g<m.length;g++){var l=m[g].split("=");p[n(l[0])]=n(l[1])}return p},objectToDotNotation:p,dotNotationToObject:function(m){var n={};m=p(m);for(var g in m){for(var l=n,h=g.split("."),d=h.pop();h.length;)var e=h.shift(),l=l[e]=l[e]||{};l[d]=m[g]}return n},decodeComponent:n,encodeComponent:function(m){return encodeURIComponent(m)}}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/client/program.js",[],function(){return{getName:function(){return extole.PROGRAM.name},getProgramDomain:function(){return extole.PROGRAM.programDomain},getSitePatterns:function(){return extole.PROGRAM.sitePatterns},isSecure:function(){return Boolean(extole.PROGRAM.isSecure)},getProtocol:function(){return this.isSecure()?"https://":window.location.protocol.match(/^https/)?"https://":"http://"}}});
extole.define("https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/user-service.js","https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/collection.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/uri.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/logger.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/event-bus.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/cookie.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/api.js https://origin.extole.io/type=core:clientId=1394918772:coreAssetsVersion=1509024379443/common/client/program.js".split(" "),
function(p,n,m,r,g,l,h){function d(){function a(){function b(a){var c=location.pathname.split("/");c.shift();c.pop();c.length&&p.each(c,function(b,d){var e="/"+c.slice(0,d+1).join("/");g(a,"",{expires:-1,path:e})})}this.get=function(a){return g(a)};this.set=function(a,c){extole.COOKIES_DISABLED||(b(a),g(a,c,{expires:365,path:"/",secure:h.isSecure()}))};this.remove=function(a){g(a,"",{expires:-1,path:"/"});b(a)}}function d(){(function(){var a="test"+(new Date).getTime();try{localStorage.setItem(a,
a),localStorage.removeItem(a)}catch(b){throw Error("Local storage not supported");}})();this.get=function(a){return window.localStorage.getItem(a)};this.set=function(a,b){window.localStorage.setItem(a,b)};this.remove=function(a){window.localStorage.removeItem(a)}}var b=[];b.push(new function(){var a={};this.get=function(b){return a[b]};this.set=function(b,c){a[b]=c};this.remove=function(b){delete a[b]}});extole.COOKIES_DISABLED||b.push(new a);if(extole.LOCAL_STORAGE_ENABLED)try{b.push(new d)}catch(e){m.info("Local Storage not supported in current browser")}this.get=
function(){for(var a,c=0;c<b.length;c++){a=b[c];var d=a.get("extole_access_token");if("string"===typeof d&&"undefined"!==d&&"null"!==d&&d.length)return a.get("extole_access_token")}};this.set=function(a){p.each(b,function(b){b.set("extole_access_token",a)})};this.remove=function(){p.each(b,function(a){a.remove("extole_access_token")})}}function e(a){function d(){return a.get()||""}function b(a){a.parameters=p.merge({},g.parameters,a.parameters);return p.merge({},g,a)}function e(){p.each(g,function(a,
b){g[b]=void 0})}var g={},h={getAccessToken:function(){return g.access_token},getId:function(){return g.id},getEmail:function(){return g.email},getFirstName:function(){return g.first_name},getLastName:function(){return g.last_name},getParameters:function(){return g.parameters},getMe:function(){return{id:g.id,email:g.email,first_name:g.first_name,last_name:g.last_name,profile_picture_url:g.profile_picture_url,partner_user_id:g.partner_user_id,parameters:g.parameters}},getCapabilities:function(){return Array.isArray(g.capabilities)?
g.capabilities.slice():[]},getScopes:function(){return Array.isArray(g.scopes)?g.scopes.slice():[]}};p.merge(this,h);(function(){var b=n.deserialize(window.location.search).extole_access_token;b&&a.set(b)})();this.asReadOnly=function(){return h};this.fetchAccessToken=function(e){var f=d(),h="/api/v4/token";f&&(h+="?access_token="+f);l.get(h,function(d,f){d?e(d):(a.set(f.access_token),g=b(f),e())})};this.upgradeAccessToken=function(a,c){var e="/api/v4/token/"+d()+"/upgrade";l.post(e,{extole_secret:a},
function(a,d){a?c(a):(g=b(d),c())})};this.deleteAccessToken=function(b){var f=d();e();a.remove();l.del("/api/v4/token?access_token="+f,function(a,c){b(a,c)})};this.fetchAttributes=function(a){var c=d();l.get("/api/v4/me?access_token="+c,function(c,d){c?a(c):(g=b(d),a(null,g))})};this.saveAttributes=function(a,c){var e=d(),h={email:a.email,first_name:a.first_name,last_name:a.last_name,profile_picture_url:a.profile_picture_url,partner_user_id:a.partner_user_id};l.post("/api/v4/me?access_token="+e,h,
function(a,d){a?c(a):(g=b(h),c(null,g))})};this.fetchParameters=function(a){var c=d();l.get("/api/v4/me/parameters?access_token="+c,function(c,d){c?a(c):(g=b({parameters:d}),a(null,g.parameters))})};this.saveParameters=function(a,c,e){c="PRIVATE"===(c||"PRIVATE").toUpperCase()?"PRIVATE":"PUBLIC";e=e||function(){};var h=d();l.post("/api/v4/me/parameters?access_token="+h,{type:c,parameters:a},function(c,d){c?e(c):(g=b({parameters:a}),e(null,g.parameters))})};this.fetchAdvocates=function(a){var b=d();
l.get("/api/v4/me/advocates?access_token="+b,function(b,c){a(b,c)})}}function a(){var a=0,d=[],b=this;this.push=function(a){d.push(a);this.next()};this.next=function(){for(;1>a&&d.length;)d.shift()(function(){a--;b.next()}),a++}}return new function(){function c(a){l.push(function(b){Boolean(t.getAccessToken())?a(null,b):g(function(c){a(c,b)})})}function g(a){function c(b){!b&&w&&(w=!1,f.events.trigger("login",t.asReadOnly()));a(b)}t.fetchAccessToken(function(d){d?"invalid_access_token"===d.code?b(c):
a(d):h(c)})}function b(a){t.deleteAccessToken(function(b){t.fetchAccessToken(a)})}function h(a){t.fetchAttributes(function(b){var c=v();b||!c?setTimeout(a,0):t.upgradeAccessToken(c,function(b){a(null)})})}var l=new a,p=new d,t=new e(p),f=this,w=!0;this.events=r.create();this.setAccessToken=function(a){p.set(a);this.flush()};this.getUser=function(a){a=a||function(){};c(function(b,c){b?a(b):a(null,t.asReadOnly());c()})};this.flush=function(a){a=a||function(){};l.push(function(b){g(function(c){c?a(c):
a(null,t.asReadOnly());b()})})};this.updateMe=function(a,b){b=b||function(){};c(function(c,d){function e(a,c){b(a,c);d()}c?e(c):a.email||a.first_name||a.last_name||a.profile_picture_url||a.partner_user_id?t.saveAttributes(a,function(a){a?e(a):e(null,t.asReadOnly())}):e(null,t.asReadOnly())})};this.updateProfile=function(a,b){m.warn("userService.updateProfile is deprecated");return this.updateMe(a,b)};this.updateParameters=function(a,b,d){"function"!==typeof b||d||(d=b,b=void 0);d=d||function(){};
c(function(c,e){c?(d(c,void 0),e()):t.saveParameters(a,b,function(a){a?d(a,void 0):(a=t.asReadOnly(),d(null,a));e()})})};this.fetchParameters=function(a){a=a||function(){};c(function(b,c){b?(a(b,void 0),c()):t.fetchParameters(function(b,d){b?a(b,void 0):a(null,d);c()})})};this.fetchAdvocates=function(a){a=a||function(){};c(function(b,c){b?(a(b,void 0),c()):t.fetchAdvocates(function(b,d){b?a(b,void 0):a(null,d);c()})})};this.logout=function(a){a=a||function(){};c(function(b,c){b?(a(b),c()):t.deleteAccessToken(function(b){w=
!0;f.events.trigger("logout",t.asReadOnly());a(null);c();f.getUser(function(){})})})};var v=function(){var a=n.deserialize(window.location.search).extole_secret;return function(){var b=a;b&&(a=null);return b}}()}});