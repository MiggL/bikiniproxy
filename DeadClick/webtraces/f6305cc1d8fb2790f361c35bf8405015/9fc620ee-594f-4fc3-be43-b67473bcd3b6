(function( blueConic, undefined ) {var p='http://plugins.blueconic.net/';var ps='https://plugins.blueconic.net/';(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.BCClass=function(){};BCClass.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.constructor=c;c.extend=arguments.callee;return c}})();var InteractionType=BCClass.extend({init:function(a){},getPreloadProperties:function(){return[]},getContent:function(){},onEvent:function(){},importLibraries:function(c){var e=[];var a=[];if(!c||c.length===0){return}for(var b=0;b<c.length;b++){var d=c[b];if(d&&d.sharing==="none"){e.push(d.url)}else{a.push(d.url)}}blueConic.fn.importLibraries.call(this,e);blueConic.fn.importAndCacheLibraries.call(this,a)}});(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.profile=this.context.getProfile();var c=this.context.getParameters();this.storeId=c.storeId&&c.storeId[0]?c.storeId[0]:null,this.metadata=c.metadata&&c.metadata[0]?c.metadata[0]:null,this.requiredOptionSet=c.requiredOptionSet&&c.requiredOptionSet[0]&&'true'===c.requiredOptionSet[0]},onLoad:function(){if(this.storeId){var a=this.metadata?this.blueConicClient.json.parse(this.metadata):null,b=new window.BlueConicMetaDataService(this.jQuery,a,'article');b.blueConicClient=this.blueConicClient;var c=b.getItemData(a),d='article'===c.pageType&&(c.publicationDate||this._getPublicationDate());if(d&&this.requiredOptionSet)for(var e=['id','url','type'],f=0;f<a.length;f++)a[f].required&&-1===e.indexOf(a[f].fieldId)&&(d=!!b.getFieldValue(a[f])&&d);if(d&&/\.(sfchronicle|houstonchronicle|expressnews)\.com/.test(document.location.href)&&(d=this._isPremium()),d&&/\.(sfgate|chron)\.com/.test(document.location.href)&&/[?&]t=/.test(document.location.search)&&(d=this._isPremium()),d){var g=this._makeMetaDataHash(b,a);this._handleView(c.itemId,c.url,g,b)}this._check404Page(c.itemId,window.location.toString())}},_makeMetaDataHash:function(a,b){var c=a.getMetaDataValues(b);return this.md5(this.blueConicClient.json.stringify(c))},_handleView:function(a,b,c,d){this.referrer=document.referrer;var e=this.referrer.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,'$1'),f=window.location.hostname,g={storeId:this.storeId,action:'view',itemId:a,url:b,profileId:this.profile.getId(),isEntrypage:e!==f,hash:c},h=d.getLastModifiedInMs();h&&(g.lastmodified=h),this.blueConicClient.recommendation.createEvent(g)},_getPublicationDate:function(){var a=this.jQuery('.article-title .timestamp,.article-share .timestamp').attr('title');if(a)return a;var b=this.jQuery('meta[name="date.release"]').attr('content'),c=this.jQuery('meta[name="time.release"]').attr('content');if(b&&c){var d=b.split('/'),e=c.split(':');return a=new Date(d[0],d[2]-1,d[1],e[0],e[1]),a.toISOString()}},_isPremium:function(){return window.HDN&&window.HDN.dataLayer&&window.HDN.dataLayer.paywall&&'isPremium'===window.HDN.dataLayer.paywall.premiumStatus},_getLastModifiedInMs:function(){var a=this.metaDataService.getLastModifiedInMs();if(a)return a;var b=this.jQuery('.article-title .timestamp').text();if(b&&-1!==b.indexOf('Update'))return isNaN(new Date(this._getPublicationDate()).getTime())?null:new Date(this._getPublicationDate()).getTime();if(b=this.jQuery('span.datestamp span.updated').text(),b&&-1!==b.indexOf('Update')){var c=b.replace('Updated: ','').replace(',','').replace(/(pm|am)/,' $1');return isNaN(new Date(c).getTime())?null:new Date(c).getTime()}},_check404Page:function(a,b){for(var c,d=[this.jQuery('title').text(),this.jQuery('meta[property="description"]').attr('content'),this.jQuery('meta[property="og:title"]').attr('content'),this.jQuery('h1').text()],e=['not found','404','niet gevonden','sorry','probleem'],f=!1,g=this.storeId,h=0;h<d.length;h++)if(c=d[h],!!c)for(var i,k=0;k<e.length;k++)if(i=e[k]||'',-1!==c.toLowerCase().indexOf(i)){f=!0;break}f&&this.jQuery.ajax({url:b,type:'HEAD',statusCode:{404:this.jQuery.proxy(function(){this.blueConicClient.recommendation.createEvent({itemId:a,url:a,storeId:g,lastmodified:new Date().getTime()})},this)}})}});var a = [];var i='connection_content_collector_hearst';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});a.push({url: '/plugins/connection_content_collector_hearst/js/metaDataService/metaDataService.js', sharing: 'local'});a.push({url: '/plugins/connection_content_collector_hearst/lib/md5.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/connection_content_collector_hearst/ts_265700549cefc17b12fef7509aedd202/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b?b:null;this.profile=a.profile.getProfile();this.element=this.context.getDOMElement();a=this.context.getParameters().content+"";this.htmlFragment=this.createElement(a)},getPreloadProperties:function(){for(var a=this.context.getParameters().content+"",b=/data-bc-preload="([^"]*)"/g,c=[],d;null!==(d=b.exec(a));){d=d[1].split(",");for(var e=0;e<d.length;e++)c.push(d[e])}return c?c:[]},getContent:function(){if(!this.htmlFragment)return null;
this.element||(this.element=this.context.getDOMElement());this.emptyElementsWithAttribute(this.htmlFragment,"div","data-bc-external");return this.htmlFragment.innerHTML},onUpdate:function(a){this.placeContent()},onLoad:function(){this.placeContent()},placeContent:function(){this.blueConicClient.isInEditMode()||this.blueConicClient.createEvent("VIEW",this.context.getInteractionId());var a=this.element||this.context.getDOMElement();if(a){var b=this.context.getParameters().content+"";this.htmlFragment=
this.createElement(b);this.assureVisibilty(a);if(b=this.getContent()){var c=a.nodeName?a.nodeName.toLowerCase():a.nodeName;if(-1===this.blueConicClient.util.array.indexOfArray("area base br col command embed hr img input keygen link meta param source track wbr".split(" "),c))a.innerHTML!==b&&(a.innerHTML=b);else if(a.parentNode){var c=a.parentNode.innerHTML,d=document.createElement("div");d.appendChild(a.cloneNode(!0));b=c.replace(d.innerHTML,b);a.parentNode.innerHTML!==b&&(a.parentNode.innerHTML=
b)}a=this.getElementsWithAttribute(a,"div","data-bc-pluginid");for(b=0;b<a.length;b++){var c=a[b],d=c.getAttribute("data-bc-pluginid"),e=c.getAttribute("data-bc-config");if(e)try{var f=e.replace(/\n/g,"\\\\n").replace(/\r/g,"\\\\r").replace(/\t/g,"\\\\t"),e=this.blueConicClient.json.parse(f)}catch(g){e=null}this.blueConicClient.event.publish("bcComplexObject",{plugin:d,config:e,node:c,interactionId:this.context.getInteractionId()});this.blueConicClient.isInEditMode()||(c.removeAttribute("data-bc-pluginid"),
c.removeAttribute("data-bc-config"))}}}},emptyElementsWithAttribute:function(a,b,c){a=this.getElementsWithAttribute(a,b,c);b=0;for(c=a.length;b<c;b++)a[b].innerHTML=""},getElementsWithAttribute:function(a,b,c){var d=[];a=a.getElementsByTagName(b);b=0;for(var e=a.length;b<e;b++){var f=a[b];f.getAttribute(c)&&d.push(f)}return d},createElement:function(a){var b;if(!a)return null;try{b=document.createElement("div"),b.innerHTML=a,this.assureVisibilty(b)}catch(c){return null}return b},assureVisibilty:function(a){this.blueConicClient.isInEditMode&&
this.blueConicClient.isInEditMode()&&(a.style.minWidth="10px",a.style.minHeight="10px")}});
var a = [];var i='contentinteractiontype';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.13/'},{ id : 'html', baseUrl : ps + 'html/1.0.10/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b?b:null,this.profile=a.profile.getProfile(),this.element=this.context.getDOMElement(),this.identifier='bc_'+this.context.getInteractionId(),this.parameters=this.context.getParameters();var c=this.parameters.content+'';this.htmlFragment=this.createElement(c),this.lastEvent=null,this.currentInsertType=this.parameters.inserttype&&this.parameters.inserttype[0]?this.parameters.inserttype[0]:'','replacecontainer'!==this.currentInsertType||document.getElementById(this.identifier)||this._hidePosition()},getPreloadProperties:function(){return this.htmlFragment?this._getPropertiesFromPlaceholders(this.htmlFragment.innerHTML):[]},getContent:function(){return this.htmlFragment?(this.element||(this.element=this.context.getDOMElement()),'replace'===this.currentInsertType)?(this.emptyElementsWithAttribute(this.htmlFragment,'div','data-bc-external'),this.htmlFragment.innerHTML):void 0:null},onUpdate:function(){this.currentInsertType!==this.context.getParameters().inserttype[0]&&document.location.reload()},onLoad:function(){this._placeContent()},_hidePosition:function(){this.styleIdentifier='bcCS'+this.context.getInteractionId();var a=this.context.getPosition()+' {opacity: 0 !important}',b=document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0],c=document.createElement('style');c.type='text/css',c.id=this.styleIdentifier,c.styleSheet?c.styleSheet.cssText=a:c.innerHTML=a,b.appendChild(c)},_showPosition:function(){this.jQuery('#'+this.styleIdentifier).remove()},_placeContent:function(){var a=this.element||this.context.getDOMElement();if(a){if(this.blueConicClient.isInEditMode()||this.handleURLs(this.htmlFragment),'replace'===this.currentInsertType){this.assureVisibilty(a);var b=this.getContent();if(!b)return;this.blueConicClient.isInEditMode()||this.blueConicClient.createEvent('VIEW',this.context.getInteractionId());var c=a.nodeName?a.nodeName.toLowerCase():a.nodeName;if(-1===this.blueConicClient.util.array.indexOfArray(['area','base','br','col','command','embed','hr','img','input','keygen','link','meta','param','source','track','wbr'],c))this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode()?a.innerHTML!==b&&(a.innerHTML=b):this.jQuery(a).html(b);else if(a.parentNode){var d=a.parentNode.innerHTML,e=document.createElement('div');e.appendChild(a.cloneNode(!0));var f=e.innerHTML,g=d.replace(f,b);a.parentNode.innerHTML!==g&&(a.parentNode.innerHTML=g)}this.handleComplexObjects(a)}else if(this.htmlFragment){this.emptyElementsWithAttribute(this.htmlFragment,'div','data-bc-external');var h=this._setContent();h&&!this.blueConicClient.isInEditMode()&&this.blueConicClient.createEvent('VIEW',this.context.getInteractionId())}if(!this.blueConicClient.isInEditMode()){var i=this.parameters.clickselector&&this.parameters.clickselector[0]?this.parameters.clickselector[0]:'';if(i){this.jQuery('body').one('click',i,this.jQuery.proxy(function(a){this.lastEvent&&this.lastEvent.originalEvent===a.originalEvent||this._logClickEvent(a)},this));try{this.jQuery(i).one('click',this.jQuery.proxy(function(a){this.lastEvent=a,this._logClickEvent(a)},this))}catch(a){}}var j=!!this.parameters.forceclick&&('true'===this.parameters.forceclick[0]||!0===this.parameters.forceclick[0]);j&&this.blueConicClient.createEvent('CLICK',this.context.getInteractionId());var k=this.parameters.javascript&&this.parameters.javascript[0]?this.parameters.javascript[0]:'';if(k)try{k=k.replace(/(^|\W)blueConicVariantId(\W|$)/,'$1"'+this.context.getInteractionId()+'"$2'),this.jQuery('<script>'+k+'</script>').appendTo(this.jQuery('body'))}catch(a){console.error(a)}}}},_logClickEvent:function(a){if(!(a&&a.originalEvent&&a.originalEvent._blueConicLoggedClickEvent===this.context.getInteractionId())){var b=a&&a.target&&a.target.pathname&&a.target.hostname&&0===a.target.pathname.indexOf('/s/')&&-1!==a.target.hostname.indexOf('blueconic');b||(a.originalEvent&&(a.originalEvent._blueConicLoggedClickEvent=this.context.getInteractionId()),this.blueConicClient.createEvent('CLICK',this.context.getInteractionId()))}},_setContent:function(){var a=this._getElementByPosition(this.context.getPosition());if(a){if(a.attr('data-bc-id')===this.identifier||0<this.jQuery('#'+this.identifier).length)return!1;var b=a.parent().get(0);if('prepend'===this.currentInsertType){var c=a.prev();if(0<c.length&&c.attr('data-bc-id')===this.identifier)return!1;if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())a.get(0).parentNode.insertBefore(this.htmlFragment,a.get(0)),this.blueConicClient.functions.setEditableNode('#bc_'+this.context.getInteractionId(),{positionName:'before',lockPosition:!0,redrawPosition:!0});else{a.before(this.htmlFragment.innerHTML);var d=a.prev();d.attr('data-bc-id',this.identifier)}}if('append'===this.currentInsertType){var e=a.next();if(0<e.length&&e.attr('data-bc-id')===this.identifier)return!1;if(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode())a.get(0).parentNode.insertBefore(this.htmlFragment,a.get(0).nextSibling),this.blueConicClient.functions.setEditableNode('#bc_'+this.context.getInteractionId(),{positionName:'after',lockPosition:!0,redrawPosition:!0});else{a.after(this.htmlFragment.innerHTML);var f=a.next();f.attr('data-bc-id',this.identifier)}}return'replacecontainer'===this.currentInsertType&&(this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode()?(a.get(0).parentNode.replaceChild(this.htmlFragment,a.get(0)),this.blueConicClient.functions.setEditableNode('#bc_'+this.context.getInteractionId(),{positionName:'after',lockPosition:!0,redrawPosition:!0})):a.replaceWith(this.htmlFragment.innerHTML),this._showPosition()),this.handleComplexObjects(b),!0}},_getElementByPosition:function(a){var b=document.getElementById(a);return b=b?this.jQuery(b):this.jQuery(a),b},createElement:function(a){var b;if(!a)return null;try{b=document.createElement('div'),b.id=this.identifier,b.innerHTML=a}catch(a){return null}return b},handleURLs:function(a){var b=this.parameters.newwindow&&this.parameters.newwindow[0]&&'true'===this.parameters.newwindow[0];if(b)for(var c=a.getElementsByTagName('a'),d=0,e=c.length;d<e;d++){var f=c[d],g=f.getAttribute('target');g||f.setAttribute('target','_blank')}this.handlePlaceholders(a)},assureVisibilty:function(a){this.blueConicClient.isInEditMode&&this.blueConicClient.isInEditMode()&&(a.style.minWidth='10px',a.style.minHeight='10px')},handlePlaceholders:function(a){for(var b=this._getPropertiesFromPlaceholders(a.innerHTML),c=0;c<b.length;c++){var d=b[c],e=this.profile.getValue(d)||'',f=new RegExp('\\$\\{'+d+'\\}','g');a.innerHTML=a.innerHTML.replace(f,encodeURI(e))}},_getPropertiesFromPlaceholders:function(a){for(var b,c=/\$\{([a-zA-Z\-_0-9]+)\}/g,d=[];null!==(b=c.exec(a));)d.push(b[1]);for(var e=/data-bc-preload="([^"]*)"/g,f=[];null!==(b=e.exec(a));)for(var g=b[1].split(','),h=0;h<g.length;h++)f.push(g[h]);return d.concat(f)},emptyElementsWithAttribute:function(a,b,c){for(var d,e=this.getElementsWithAttribute(a,b,c),f=0,g=e.length;f<g;f++)d=e[f],d.innerHTML=''},getElementsWithAttribute:function(a,b,c){for(var d,e=[],f=a.getElementsByTagName(b),g=0,h=f.length;g<h;g++)d=f[g],d.getAttribute(c)&&e.push(d);return e},handleComplexObjects:function(a){for(var b=this.getElementsWithAttribute(a,'div','data-bc-pluginid'),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute('data-bc-pluginid'),f=d.getAttribute('data-bc-config');if(f)try{var g=f.replace(/\n/g,'\\\\n').replace(/\r/g,'\\\\r').replace(/\t/g,'\\\\t');f=this.blueConicClient.json.parse(g)}catch(a){f=null}this.blueConicClient.event.publish('bcComplexObject',{plugin:e,config:f,node:d,interactionId:this.context.getInteractionId()}),this.blueConicClient.isInEditMode()||(d.removeAttribute('data-bc-pluginid'),d.removeAttribute('data-bc-config'))}}});var a = [];var i='contentinteractiontypespecial';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/contentinteractiontypespecial/ts_ede1789259725dffca993df2d910e04c/'},{ id : 'boolean', baseUrl : ps + 'boolean/1.0.1/'},{ id : 'html', baseUrl : ps + 'html/1.0.10/'},{ id : 'string', baseUrl : ps + 'string/1.0.1/'}]);})();(function(){ 'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},InteractionTypeImpl=InteractionType.extend({DEFAULT_MAX_AGE:7776000000,MAX_ITEMS:100,SKIP_LIMITED:'limited',RESET_ROLLING:'rolling',RESET_CALENDAR:'calendar',init:function init(a,b){this.blueConicClient=a,this.context=b,this.interactionId='cm'+this.context.getInteractionId(),this.historyProperty='_cm_'+this.interactionId,this.profile=this.context.getProfile(),this.parameters=this.context.getParameters(),this.preLoadProperties=[this.historyProperty],this.excludeRules=[];try{this.excludeRules=this.blueConicClient.json.parse(this.parameters.excludeRules[0])}catch(a){}this.includeRules=[];try{this.includeRules=this.blueConicClient.json.parse(this.parameters.includeRules[0])}catch(a){}this.freeRules=[];try{this.freeRules=this.blueConicClient.json.parse(this.parameters.freeRules[0])}catch(a){}0<this.freeRules.length&&(this.freeRules=this.freeRules.filter(function(a){return!!a.property}),this.preLoadProperties=this.preLoadProperties.concat(this.freeRules.map(function(a){return a.property.id}))),this.expireAt=parseInt(this.parameters.expireAt[0]),isNaN(this.expireAt)&&(this.expireAt=10),this.resetAfter=this.parameters.resetAfter[0],this.uniqueOnly='true'===this.parameters.uniqueOnly[0],this.onceOnly=!!(this.parameters.onceOnly&&'true'===this.parameters.onceOnly[0]),this.now=this.blueConicClient.getCurrentDate(),this.maxAge=this._getMaxAge()},getPreloadProperties:function getPreloadProperties(){return this.preLoadProperties},onLoad:function onLoad(){!0==!window[this.interactionId]&&(window[this.interactionId]=!0,this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){this.onLoad()}));var a=this._visitorQualifies();if(a){var b={};try{var c=this.profile.getValue(this.historyProperty);c&&(b=this.blueConicClient.json.parse(this.profile.getValue(this.historyProperty)))}catch(a){}this.history=new this.History(b,this.maxAge,this.now);var d=this._getCurrentView();if(d){var e=!d.isSkippedView||d.isSkippedView&&!!d.skippedFor;e?(this._addViewToHistory(d),!d.isSkippedView&&this._writeExtraProfileProperties(d),this.blueConicClient.profile.updateProfile(this,function(){this._throwEvents(d)})):this._throwEvents(d)}}},_throwEvents:function _throwEvents(a){var b=this._getCurrentViews(a);(a.isHistoricallyAllowedView||a.isHistoricallyAllowedFreeView)&&this.blueConicClient.createEvent('cm_already_viewed'),a.isFreeView?(this.onceOnly&&!a.isHistoricallyAllowedFreeView||!this.onceOnly)&&(this.freeViewTracker.consumedFreeCount===this.freeViewTracker.totalFree?this.blueConicClient.createEvent('cm_last_free_view'):this.blueConicClient.createEvent('cm_free_view_'+this.freeViewTracker.consumedFreeCount)):((this.onceOnly&&!a.isHistoricallyAllowedView&&!a.isSkippedView||!this.onceOnly)&&(1===b?this.blueConicClient.createEvent('cm_firstview'):b===this.expireAt-1?this.blueConicClient.createEvent('cm_lastview'):b<this.expireAt&&this.blueConicClient.createEvent('cm_view_'+b)),b>=this.expireAt&&this.blueConicClient.createEvent('cm_exceeded'),a.isSkippedView&&this.blueConicClient.createEvent('cm_excluded'));var c=this.parameters.bottomFrom&&this.parameters.bottomFrom[0]?parseInt(this.parameters.bottomFrom[0]):null,d=this.parameters.bottomTo&&this.parameters.bottomTo[0]?parseInt(this.parameters.bottomTo[0]):null,e=this.parameters.middleFrom&&this.parameters.middleFrom[0]?parseInt(this.parameters.middleFrom[0]):null,f=this.parameters.middleTo&&this.parameters.middleTo[0]?parseInt(this.parameters.middleTo[0]):null,g=this.parameters.topFrom&&this.parameters.topFrom[0]?parseInt(this.parameters.topFrom[0]):null,h=this.parameters.topTo&&this.parameters.topTo[0]?parseInt(this.parameters.topTo[0]):null;c&&d&&b>=c&&b<=d&&this.blueConicClient.createEvent('cm_bottom'),e&&f&&b>=e&&b<=f&&this.blueConicClient.createEvent('cm_middle'),g&&h&&b>=g&&b<=h&&this.blueConicClient.createEvent('cm_top')},_addViewToHistory:function _addViewToHistory(a){this._getCurrentViews(a)>=this.expireAt&&!a.isFreeView||(a.isFreeView?this.history.free.push({u:a.url,ff:a.freeFor,ts:a.timestamp}):a.isSkippedView?this.history.skipped.push({u:a.url,sf:a.skippedFor,ts:a.timestamp}):this.history.included.push({u:a.url,v:a.includeValue,ts:a.timestamp}),this.history.included.length>this.MAX_ITEMS&&(this.history.included.sort(function(c,a){var b=c.ts,d=a.ts;return b<d?-1:b>d?1:0}),this.history.included.shift()),this.profile.setValue(this.historyProperty,this.blueConicClient.json.stringify(this.history)))},_writeExtraProfileProperties:function _writeExtraProfileProperties(a){var b=this._getCurrentViews(a),c=this.parameters.expireAtProperty&&this.parameters.expireAtProperty[0]?this.parameters.expireAtProperty[0]:null,d=this.parameters.numViewsProperty&&this.parameters.numViewsProperty[0]?this.parameters.numViewsProperty[0]:null,e=this.parameters.numViewsLeftProperty&&this.parameters.numViewsLeftProperty[0]?this.parameters.numViewsLeftProperty[0]:null,f=this.parameters.numFreeViewsProperty&&this.parameters.numFreeViewsProperty[0]?this.parameters.numFreeViewsProperty[0]:null,g=this.parameters.numFreeViewsLeftProperty&&this.parameters.numFreeViewsLeftProperty[0]?this.parameters.numFreeViewsLeftProperty[0]:null;if(c&&'null'!==c&&this.profile.setValue(c,this.expireAt),d&&'null'!==d&&this.profile.setValue(d,b<=this.expireAt?b:this.expireAt),e&&'null'!==e&&this.profile.setValue(e,b<this.expireAt?this.expireAt-b:0),a.isFreeView&&(f&&'null'!==f&&this.profile.setValue(f,this.freeViewTracker.consumedFreeCount),g&&'null'!==g)){var h=this.freeViewTracker.totalFree-this.freeViewTracker.consumedFreeCount;this.profile.setValue(g,0<h?h:0)}},_getCurrentView:function _getCurrentView(){var a=(this.jQuery('meta[property="og:url"]').attr('content')||document.location.href).toLowerCase(),b=document.referrer.toLowerCase(),c=new this.PageView(a,b,this.now);return c.isHistoricallyAllowedView=this._isHistoricallyAllowed(a),c.includeValue=this._getIncludeValue(c),0<c.includeValue?(c.isSkippedView=this._isPageViewSkipped(c),this._getCurrentViews(c)>=this.expireAt&&this._setPageViewFree(c),c):null},_getIncludeValue:function _getIncludeValue(a){for(var b,c=0;c<this.includeRules.length;c++)if(b=this.includeRules[c],this._isRuleApplicable(b,a))return b.views;return 0},_isPageViewSkipped:function _isPageViewSkipped(a){var b=new this.SkippedViewTracker(this),c=this;return this.excludeRules.filter(function(b){return c._isRuleApplicable(b,a)}).some(function(d){if(d.skip.selectedoption!==c.SKIP_LIMITED)return!0;return!(b.skipped[d.id]=b.skipped[d.id]?b.skipped[d.id]+1:1,!(b.skipped[d.id]<=d.skip.views))&&(a.skippedFor=d.id,!0)})},_setPageViewFree:function _setPageViewFree(a){var b=this;this.freeViewTracker=new this.FreeViewTracker(this),a.isHistoricallyAllowedFreeView=this._isHistoricallyAllowedFree(a.url),this.freeRules.filter(function(c){return b._isRuleApplicable(c,a)}).forEach(function(c){b.freeViewTracker.totalFree+=c.views,a.isFreeView||(a.isHistoricallyAllowedFreeView?(a.freeFor=c.id,a.isFreeView=!0):(b.freeViewTracker.free[c.id]=b.freeViewTracker.free[c.id]?b.freeViewTracker.free[c.id]+1:1,b.freeViewTracker.free[c.id]<=c.views&&(a.freeFor=c.id,a.isFreeView=!0,b.freeViewTracker.consumedFreeCount++)))})},_isRuleApplicable:function _isRuleApplicable(a,b){var c=a.area.selectedoption;if('url'===c||'referrer'===c){var d='url'===c?b.url:b.referrer;if(a.anyWord||this._URLMatchesWords(d,a.containsmatches,a.words))return!0}else if('selector'===c){var e=this._getContentForSelector(a.area.selector);if(e&&a.anyWord)return!0;if(a.area.selector&&a.words&&this._contentMatchesWords(e,a.containsmatches,a.words))return!0}else if('variable'===c){var f=this._getVariableValue(a.area.variable);if(f&&a.anyWord)return!0;if(a.area.variable&&this._contentMatchesWords(f,a.containsmatches,a.words))return!0}else if('property'===c){var g=this.profile.getValues(a.property.id);if(0<g.length&&a.anyWord)return!0;var h=this;return g.some(function(b){return a.words&&h._contentMatchesWords(b,a.containsmatches,a.words)||a.dateTime&&!isNaN(parseInt(b))&&h.now.getTime()-parseInt(b)<=h.maxAge})}return!1},_isHistoricallyAllowed:function _isHistoricallyAllowed(a){if(!this.uniqueOnly)return!1;var b=this.history.included.filter(function(b){return b.u===a});return 0<b.length},_isHistoricallyAllowedFree:function _isHistoricallyAllowedFree(a){if(!this.uniqueOnly)return!1;var b=this.history.free.filter(function(b){return b.u===a});return 0<b.length},_getCurrentViews:function _getCurrentViews(a){for(var b,c=0,d=[],e=0;e<this.history.included.length;e++)(b=this.history.included[e],!(this.uniqueOnly&&-1!==this.blueConicClient.util.array.indexOfArray(d,b.u)))&&(d.push(b.u),c+=b.v);var f=this._isHistoricallyAllowed(a.url);return f||a.isSkippedView||c!==this.expireAt-1||(c+=a.includeValue),c},_visitorQualifies:function _visitorQualifies(){var a=[];try{a=this.blueConicClient.json.parse(this.parameters.segments)}catch(a){}if(0===a.length)return!0;var b=this.blueConicClient.getSegments();if(0===b.length)return!1;for(var c,d=0;d<b.length;d++){c=b[d];for(var e,f=0;f<a.length;f++)if(e=a[f],c.id===e.id)return!0}return!1},_getMaxAge:function _getMaxAge(){if(this.resetAfter===this.RESET_ROLLING){var a=this.parameters.resetRolling&&!isNaN(parseInt(this.parameters.resetRolling[0]))?parseInt(1e3*(60*(60*(24*this.parameters.resetRolling[0])))):this.DEFAULT_MAX_AGE;return a}return this.resetAfter===this.RESET_CALENDAR?this.now.getTime()-new Date(this.now.getFullYear(),this.now.getMonth(),1).getTime():this.DEFAULT_MAX_AGE},_contentMatchesWords:function _contentMatchesWords(a,b,c){if(!a||'string'!=typeof a)return!1;a=a.toLowerCase();for(var d=0;d<c.length;d++)if('contains'===b){if(-1!==a.indexOf(c[d].toLowerCase()))return!0;}else if(a===c[d].toLowerCase())return!0;return!1},_URLMatchesWords:function _URLMatchesWords(a,b,c){for(var d=0;d<c.length;d++)if('contains'===b){var e=this._escapeRegularExpressionCharacters(c[d]);try{var f=new RegExp(e,'i');if(f.test(a))return!0}catch(a){}}else if(a===c[d])return!0;return!1},_getContentForSelector:function _getContentForSelector(a){var b=null;try{b=-1===a.indexOf('jQuery(')?this.jQuery(a):function(a,b){return eval('var jQuery = arguments[1]'),eval(a)}(a,this.jQuery)}catch(a){}if(b&&b instanceof this.jQuery&&0<b.length){var c=[];return this.jQuery.each(b,this.jQuery.proxy(function(a,b){var d=this.jQuery(b);d.attr('content')?c.push(this._normalizeText(d.attr('content'))):c.push(this._normalizeText(d.text()))},this)),c.join().toLowerCase()}},_getVariableValue:function _getVariableValue(a){for(var b=a.replace('[','.').replace(']','').replace('""',''),c=b.split('.'),d=window[c.shift()];0<c.length;){if(!d)return null;d=d[c.shift()]}return d instanceof Array?d.join().toLowerCase():'object'===('undefined'==typeof d?'undefined':_typeof(d))||'function'==typeof d?null:(''+d).toLowerCase()},_escapeRegularExpressionCharacters:function _escapeRegularExpressionCharacters(a){return a=a.replace(/[\\?.{}+]/g,function addEscapeCharacter(a){return'\\'+a}),a=a.replace(/\*/g,'.*'),a},_normalizeText:function _normalizeText(a){return a?this.jQuery.trim(a).replace(/\r\n+|\r+|\n+/gi,'').replace(/\s+/gi,' '):a},PageView:function PageView(a,b,c){this.url=a,this.timestamp=c.getTime(),this.referrer=b,this.includeValue=0,this.isSkippedView=!1,this.skippedFor=null,this.isFreeView=!1,this.isHistoricallyAllowedView=!1},SkippedViewTracker:function SkippedViewTracker(a){this.skipped={};for(var b,c=[],d=0;d<a.history.skipped.length;d++)b=a.history.skipped[d],a.uniqueOnly&&-1!==a.blueConicClient.util.array.indexOfArray(c,b.u)||(this.skipped[b.sf]=this.skipped[b.sf]?this.skipped[b.sf]+1:1),c.push(b.u)},FreeViewTracker:function FreeViewTracker(a){this.free={},this.consumedFreeCount=0,this.totalFree=0;for(var b,c=[],d=0;d<a.history.free.length;d++)b=a.history.free[d],a.uniqueOnly&&-1!==a.blueConicClient.util.array.indexOfArray(c,b.u)||(this.free[b.ff]=this.free[b.ff]?this.free[b.ff]+1:1,this.consumedFreeCount++),c.push(b.u)},History:function History(a,b,c){function d(a){for(var d=a.length;d--;){var e=a[d];c.getTime()-e.ts>b&&a.splice(d,1)}return a}this.included=a.included?d(a.included):[],this.skipped=a.skipped?d(a.skipped):[],this.free=a.free?d(a.free):[]}});var a = [];var i='contentmeter';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/contentmeter/ts_0db5866c2dbc3b4dbc3e06e0e9c2ce33/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(b,a){this.blueConicClient=b;this.context=a},onLoad:function(){function b(g){if(g)for(var b=0,c=g.length;b<c;b++){var d=this.blueConicClient.json.parse(g[b]);if(d&&d.words&&d.selecterarea){var e=this._getSelector(d.selecterarea);try{0<this.jQuery(e).length?a.call(this,d):this.blueConicClient.position.subscribe(e,this,this.jQuery.proxy(a,this,d))}catch(f){}}}}function a(a){if(!f){var b=this.jQuery(this._getSelector(a.selecterarea));if(0<
b.length){var c=!1;b.text()&&(c=a.words,c=this.textContains(b.text(),c));c&&(f=a.interactionId,this.blueConicClient.createEvent("CONVERSION",a.interactionId,this,function(){this.blueConicClient.util.log("CONVERSION event registered for words in content. Interaction: ["+a.interactionId+"]")}))}}}function h(a){if(a)for(var b=0,e=a.length;b<e;b++){var d=this.blueConicClient.json.parse(a[b]);if(d&&d.selecterarea)try{0<this.jQuery(d.selecterarea).length?c.call(this,d):this.blueConicClient.position.subscribe(d.selecterarea,
this,this.jQuery.proxy(c,this,d))}catch(f){}}}function c(a){-1===k.indexOf(a.selecterarea)&&(k.push(a.selecterarea),this.jQuery(a.selecterarea).off("click.conversionlistener"),this.jQuery(a.selecterarea).one("click.conversionlistener",this.jQuery.proxy(function(){l||f===a.interactionId||(l=!0,this.blueConicClient.createEvent("CONVERSION",a.interactionId,this,function(){this.blueConicClient.util.log("CONVERSION event registered for click. Interaction: ["+a.interactionId+"]")}))},this)))}var e=this.context.getParameters();
if(e){var f=null,l=null,k=[],m=e.clickcandidates;m&&h.call(this,m);(e=e.contentcandidates)&&b.call(this,e)}},textContains:function(b,a){if(!b||!this.jQuery.isArray(a))return!1;if(0===a.length||1===a.length&&(""===a[0]||"pre_any"===a[0]))return!0;for(var h=b.toLowerCase(),c=0,e=a.length;c<e;c++)if(a[c]&&this.jQuery.trim(a[c])&&-1!==h.indexOf(a[c].toLowerCase()))return!0;return!1},_getSelector:function(b){var a=null;b&&(0===b.indexOf("pre_")?(a=b.substring(4),"any"===a?a="html":"header"===a&&(a="h1, h2, h3, h4, h5, h6")):
a=b);return a}});
var a = [];var i='conversionlistenerinteractiontype';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.1.4/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b?b:null;this.profile=this.context.getProfile();this.targetingParameters=[]},getPreloadProperties:function(){return this._getProfilePropertiesFromParameters()},onLoad:function(){if(this.targetingParameters&&0<this.targetingParameters.length){for(var a=[],b=0;b<this.targetingParameters.length;b++){var c=this.targetingParameters[b],e=c.key,c=this._getParamValue(c);e&&c&&a.push({key:e,value:c})}if("undefined"!==
typeof window.Storage)try{window.localStorage.setItem("bcDFPTargetingParams",this.blueConicClient.json.stringify(a))}catch(g){}var f=0,d=function(){window.bcDFPCallback?window.bcDFPCallback(a):40<f||(f++,window.setTimeout(d,250))};d.call(this)}},_getParamValue:function(a){if((!a.type||"text"===a.type)&&a.text)return a.text;if("property"===a.type&&a.property)return this.profile.getValues(a.property);if("segments"===a.type&&0<this.blueConicClient.getSegments().length){var b=[],c=this.blueConicClient.getSegments();
if(a.segments&&0<a.segments.length)for(var e=0;e<c.length;e++)for(var g=c[e],f=0;f<a.segments.length;f++){var d=a.segments[f];(g.id&&g.id===d.segmentId||g.name===d.segmentName)&&b.push(d.aamCode||d.dcmCode||d.smCode||g.name)}else for(a=0;a<c.length;a++)b.push(c[a].name);return b}},_getProfilePropertiesFromParameters:function(){var a=[],b=this.context.getParameters(),b=b.targeting_parameters?b.targeting_parameters[0]:b.targeting_parameters;if(!b)return a;this.targetingParameters=this.blueConicClient.json.parse(b);
for(b=0;b<this.targetingParameters.length;b++){var c=this.targetingParameters[b];"property"===c.type&&c.property&&a.push(c.property)}return a}});
var a = [];var i='dfpconnection_to';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/dfpconnection_to/ts_e19317762cea0b7a3658deb94c42c3ed/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.interaction=b,this.parameters=this.interaction.getParameters();var c=this.parameters.propertyRules&&this.parameters.propertyRules[0]?this.parameters.propertyRules[0]:null;if(c){c=a.json.parse(c),this.preLoadProperties=[];for(var d,e=0,f=0;f<c.length;f++)d=c[f],d.profileproperty&&d.decay&&d.nr&&(this.preLoadProperties.push(d.profileproperty+'_index'),d.decay>e&&(e=d.decay,this.property=d.profileproperty))}else{var g=this.parameters.property?this.parameters.property[0]:this.parameters.property;g&&(this.property=this.blueConicClient.json.parse(g)[0].profileproperty,this.preLoadProperties=[this.property+'_index'])}},getPreloadProperties:function(){return this.preLoadProperties},onLoad:function(){if(0<this.preLoadProperties.length){var a=this.interaction.getProfile(),b=this.parameters.engagement_rules?this.parameters.engagement_rules[0]:this.parameters.engagement_rules;if(!b)return;if(b=this.blueConicClient.json.parse(b),0===b.length)return;var c=this.parameters.interests?this.parameters.interests[0]:this.parameters.interests;c=c?this.blueConicClient.json.parse(c).values:[];var d=new this.BlueConicEngagement(this.blueConicClient,a,this.property,!0,c,this.jQuery);if(d.applyEngagementRules(b),d.isChanged())d.save();else{for(var e,f=!1,g=0;g<this.preLoadProperties.length;g++)e=this.preLoadProperties[g],a.getValue(e)||(a.setValue(e,'0'),f=!0);f&&this.blueConicClient.profile.updateProfile()}}}});var a = [];var i='engagement_interest_ranking';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});a.push({url: p + i + '/6.2.8/js/engagement_service/engagementService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/6.2.8/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.interaction=b,this.parameters=this.interaction.getParameters();var c=this.parameters.propertyRules&&this.parameters.propertyRules[0]?this.parameters.propertyRules[0]:null;if(c){c=a.json.parse(c),this.preLoadProperties=[];for(var d,e=0,f=0;f<c.length;f++)d=c[f],d.profileproperty&&d.decay&&(this.preLoadProperties.push(d.profileproperty),d.decay>e&&(e=d.decay,this.property=d.profileproperty))}else{var g=this.parameters.property?this.parameters.property[0]:this.parameters.property;g&&(this.property=this.blueConicClient.json.parse(g)[0].profileproperty,this.preLoadProperties=[this.property])}},getPreloadProperties:function(){return this.preLoadProperties},onLoad:function(){if(0<this.preLoadProperties.length){var a=this.interaction.getProfile(),b=this.parameters.engagement_rules?this.parameters.engagement_rules[0]:this.parameters.engagement_rules;if(!b)return;if(b=this.blueConicClient.json.parse(b),0===b.length)return;var c=new this.BlueConicEngagement(this.blueConicClient,a,this.property,!1,'',this.jQuery);if(c.applyEngagementRules(b),c.isChanged())c.save();else{for(var d,e=!1,f=0;f<this.preLoadProperties.length;f++)d=this.preLoadProperties[f],a.getValue(d)||(a.setValue(d,'0'),e=!0);e&&this.blueConicClient.profile.updateProfile()}}}});var a = [];var i='engagement_score';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});a.push({url: p + i + '/6.2.10/js/engagement_service/engagementService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/6.2.10/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b},getPreloadProperties:function(){return this.preloadProperties=[],this.context&&(this.preloadProperties=this.getProfilePropertiesFromParameters(this.context.getParameters())),this.preloadProperties},onLoad:function(){var a=this.context.getProfile(),b=this.context.getParameters(),c=b.listener_rules?b.listener_rules[0]:b.listener_rules;if(c){c=this.blueConicClient.json.parse(c);var d=new this.RuleService(this.blueConicClient,a,this.jQuery);d.applyRules(c),d.save()}},getProfilePropertiesFromParameters:function(a){var b=[],c=a.listener_rules?a.listener_rules[0]:a.listener_rules;if(!c)return b;c=this.blueConicClient.json.parse(c);for(var d,e=0;e<c.rules.length;e++)d=c.rules[e],d.profileproperty&&('set_if_empty'===d.addset||'merge'===d.addset)&&b.push(d.profileproperty[0].profileproperty);return b}});var a = [];var i='enrichprofilebyvisitorbehavior';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});a.push({url: p + 'enrichProfileByVisitorBehavior/5.1.26/js/ruleService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + 'enrichProfileByVisitorBehavior/5.1.26/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({PF_PROPERTY_PREFIX:"enpf",init:function(a,b){this.blueConicClient=a;this.context=b?b:null;this.profile=this.context.getProfile();this.parameters=this.context.getParameters();this.connectionContext={LAST_PUSH_PROPERTY:this.PF_PROPERTY_PREFIX+"lt"+this.context.getInteractionId(),VARIABLE_STATE_PUSH_PROPERTY:this.PF_PROPERTY_PREFIX+"st"+this.context.getInteractionId(),push_frequency:this.parameters.push_frequency&&this.parameters.push_frequency[0]?this.parameters.push_frequency[0]:
null,profile:this.profile,variables:[],SENT_TO_SYSTEM_PROPERTY:"sent_to_system",SENT_TO_CONNECTION_PROPERTY:"sent_to_connection"};this.preloadProperties=[this.connectionContext.LAST_PUSH_PROPERTY,this.connectionContext.VARIABLE_STATE_PUSH_PROPERTY,this.connectionContext.SENT_TO_SYSTEM_PROPERTY,this.connectionContext.SENT_TO_CONNECTION_PROPERTY];this._getVariablesFromParameters()},getPreloadProperties:function(){return this.preloadProperties},onLoad:function(){this.bcConnectionUtil.doPush(this.connectionContext)?
this._doPush():"plc"===this.connectionContext.push_frequency&&this.blueConicClient.event.subscribe(this.blueConicClient.event.onProfilePermissionChange,this,function(){this._doPush()})},_doPush:function(){var a=this.context.getParameters();if((a=a.objectname?a.objectname[0]:a.objectname)&&0<this.connectionContext.variables.length){window[a]||(window[a]={});for(var b=!1,c=0;c<this.connectionContext.variables.length;c++){var d=this.connectionContext.variables[c];if(d.key){var e=this.bcConnectionUtil.getVariableValue(d,
this.connectionContext,!0);e&&(b=!0,window[a][d.key]=e)}}b&&this.bcConnectionUtil.setSyncProperties(this.context,this.profile,[this.connectionContext.SENT_TO_SYSTEM_PROPERTY,this.connectionContext.SENT_TO_CONNECTION_PROPERTY])}},_getVariablesFromParameters:function(){var a=this.parameters.variables&&this.parameters.variables[0]?this.blueConicClient.json.parse(this.parameters.variables[0]):null;if(a&&0<a.length){this.connectionContext.variables=a;for(var b=0;b<a.length;b++){var c=a[b];c.key&&"property"===
c.type&&c.property&&this.preloadProperties.push(c.property)}}}});var a = [];var i='ensightenconnection';a.push({url: p + i + '/1.0.13/js/connection_lib/connection_lib.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.13/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.rules=[];try{this.rules=this.blueConicClient.json.parse(b.getParameters().rules[0])}catch(a){}this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){this.onLoad()})},onLoad:function(){for(var a,b=0;b<this.rules.length;b++)a=this.rules[b],'click'===a.type?this._setClickBindings(a,!0):this._createEvent(a)},_createEvent:function(a){var b=a.area.selectedoption,c=!1;if('selector'===b&&a.area.selector?a.words&&this._contentMatchesWords(this._getContentForSelector(a),a.containsmatches,a.words)?c=!0:a.anyWord&&this._getContentForSelector(a)&&(c=!0):'variable'===b&&a.area.variable?a.words&&this._contentMatchesWords(this._getVariableValue(a.area.variable),a.containsmatches,a.words)?c=!0:a.anyWord&&this._getVariableValue(a.area.variable)&&(c=!0):'customjs'===b&&a.area.customjs&&(a.words&&this._contentMatchesWords(this._getCustomJsValue(a.area.customjs),a.containsmatches,a.words)?c=!0:a.anyWord&&this._getCustomJsValue(a.area.customjs)&&(c=!0)),c){var d=0;a.delay&&!isNaN(parseInt(a.delay))&&(d=parseInt(a.delay));var e=this.jQuery;setTimeout(e.proxy(function(){this.blueConicClient.createEvent(a.event.id)},this),d)}},_setClickBindings:function(a,b){if(a.clickarea.selector){var c=this.jQuery,d=null;try{d=c(a.clickarea.selector)}catch(a){return void this.blueConicClient.util.log('Invalid click selector: '+a)}0===d.length?this.blueConicClient.position.subscribe(a.clickarea.selector,this,function(){this._setClickBindings(a,!1)}):d.off('click.'+a.id).on('click.'+a.id,{clickRule:a},this.jQuery.proxy(function(a){this.lastEvent=a;try{this._createEvent(a.data.clickRule)}catch(a){}},this)),b&&c(document).on('click',a.clickarea.selector,{clickRule:a},c.proxy(function(a){if(!this.lastEvent||this.lastEvent.originalEvent!==a.originalEvent)try{this._createEvent(a.data.clickRule)}catch(a){}},this))}},_contentMatchesWords:function(a,b,c){if(!a)return!1;for(var d=0;d<c.length;d++)if('contains'===b){if(-1!==a.indexOf(c[d].toLowerCase()))return!0;}else if(a===c[d].toLowerCase())return!0;return!1},_getContentForSelector:function(a){var b=a.area.selector,c=null;if(-1!==b.indexOf('jQuery('))c=function(a,b){return eval('var jQuery = arguments[1]'),eval(a)}(b,this.jQuery);else try{c=this.jQuery(b)}catch(a){this.blueConicClient.util.log('Invalid content selector: '+a)}if(c&&c instanceof this.jQuery&&0<c.length){var d=[];return this.jQuery.each(c,this.jQuery.proxy(function(a,b){var c=this.jQuery(b);c.attr('content')?d.push(this._normalizeText(c.attr('content'))):c.attr('src')?d.push(this._normalizeText(c.attr('src'))):d.push(this._normalizeText(c.text()))},this)),d.join().toLowerCase()}'content'===a.type&&this.blueConicClient.position.subscribe(b,this,function(){this._createEvent(a)})},_getVariableValue:function(a){try{for(var b=a.replace('[','.').replace(']','').replace('""',''),c=b.split('.'),d=window[c.shift()];0<c.length;)d=d[c.shift()];return d instanceof Array?d.join().toLowerCase():'object'==typeof d||'function'==typeof d?this.blueConicClient.json.stringify(d):d?(''+d).toLowerCase():null}catch(a){return null}},_getCustomJsValue:function(a){try{var b=function(a,b,c){return eval('var jQuery = arguments[1]'),eval('var $ = arguments[2]'),eval(a)}(a,this.jQuery,this.jQuery);return b&&b instanceof Object&&(b=this.blueConicClient.json.stringify(b)),b}catch(a){return null}},_normalizeText:function(a){return a?this.jQuery.trim(a).replace(/\r\n+|\r+|\n+/gi,'').replace(/\s+/gi,' '):a}});var a = [];var i='eventtrigger';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.1.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a},_ouibounce:function(){var a=this;this.ouibounce({aggressive:!0,timer:0,callback:function(){window.blueConicClient&&window.blueConicClient.exitIntentThrown||a.blueConicClient.createEvent("exitintent");window.blueConicClient&&(window.blueConicClient.exitIntentThrown=!0)}})},onLoad:function(){this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){window.blueConicClient&&window.blueConicClient.exitIntentThrown&&
(window.blueConicClient.exitIntentThrown=!1,this._ouibounce())});this._ouibounce()}});var a = [];var i='exitintent';a.push({url: p + i + '/2.0.3/js/ouibounce.js', sharing: 'none'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/2.0.3/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({SIMPLE_FIELDS:"email firstName lastName gender city age thumbnailURL hometown".split(" "),init:function(a,b){this.blueConicClient=a;this.context=b;this.profile=a.profile.getProfile();this.parameters=this.context.getParameters();this.connectionContext={GIGYA_LAST_TRANSFER:"gigya_lasttransfer"+this.context.getInteractionId(),GIGYA_ID:"gigya_id",SENT_TO_SYSTEM_PROPERTY:"sent_to_system",SENT_TO_CONNECTION_PROPERTY:"sent_to_connection"};this.preloadProperties=
[this.connectionContext.GIGYA_LAST_TRANSFER,this.connectionContext.GIGYA_ID,this.connectionContext.SENT_TO_SYSTEM_PROPERTY,this.connectionContext.SENT_TO_CONNECTION_PROPERTY]},getPreloadProperties:function(){var a=this.preloadProperties;a.push("fullname");a.push("avatar");return a},onLoad:function(){function a(){window.gigya?(d._addLoginListener(),d._doTransfer()):100<c||(c++,window.setTimeout(a,200))}var b=!1;if(this.profile.getValue(this.connectionContext.GIGYA_ID)){var e=this.profile.getValue(this.connectionContext.GIGYA_LAST_TRANSFER);
e||(e=0);e=new Date(parseInt(e));e.setMinutes(e.getMinutes()+30);if(new Date>e||!this.profile.getValue("avatar")||!this.profile.getValue("fullname"))b=!0}else b=!0;if(b){var d=this,c=0;a.call(this)}},_addLoginListener:function(){var a=this;window.gigya.socialize.addEventHandlers({onLogin:function(b){a._transferUser(b.user)}})},_doTransfer:function(){var a=this;window.gigya.socialize.getUserInfo({extraFields:"likes,work,education,address,hometown",callback:function(b){0===b.errorCode&&(b=b.user)&&
b.UID&&a._transferUser(b)}})},_transferUser:function(a){var b=this.parameters.mapping&&this.parameters.mapping[0]?this.parameters.mapping[0]:null;if(b&&(b=this.blueConicClient.json.parse(b))&&0<b.length){this.profile.setValue(this.connectionContext.GIGYA_ID,a.UID);this.profile.setValue(this.connectionContext.GIGYA_LAST_TRANSFER,(new Date).getTime());for(var e=!1,d=0;d<b.length;d++){var c=b[d];c.gigya_property&&c.property&&(e=!0,this._setPropertyValue(a,c.gigya_property,c.property))}this._setUserProfileProperties(a);
e&&this.bcConnectionUtil.setSyncProperties(this.context,this.profile,[this.connectionContext.SENT_TO_SYSTEM_PROPERTY,this.connectionContext.SENT_TO_CONNECTION_PROPERTY]);this.blueConicClient.profile.updateProfile()}},_setPropertyValue:function(a,b,e){var d=[];-1!==this.blueConicClient.util.array.indexOfArray(this.SIMPLE_FIELDS,b)&&a[b]&&d.push(a[b]);if("birthday"===b){var c=a.birthDay,f=a.birthMonth,g=a.birthYear;c&&f&&g&&d.push(f+"/"+c+"/"+g)}if("education"===b&&(f=a[b]))for(c=0;c<f.length;c++)g=
f[c],g.schoolType&&d.push(g.schoolType);if("work"===b&&(f=a[b]))for(c=0;c<f.length;c++)g=f[c],g.company&&d.push(g.company);if("likes"===b&&(f=a[b]))for(c=0;c<f.length;c++)g=f[c],g.name&&d.push(g.name);if("likes_categories"===b&&(a=a.likes))for(c=0;c<a.length;c++)b=a[c],b.category&&d.push(b.category);0<d.length&&this.profile.setValues(e,d)},_setUserProfileProperties:function(a){if(a.firstName&&a.lastName)var b=a.firstName+" "+a.lastName;else a.firstName&&!a.lastName?b=a.firstName:!a.firstName&&a.lastName&&
(b=a.lastName);b&&!this.profile.getValue("fullname")&&this.profile.setValue("fullname",b);a.photoURL&&!this.profile.getValue("avatar")&&this.profile.setValue("avatar",a.photoURL)}});var a = [];var i='gigyaconnection_with_custom_data';a.push({url: '/plugins/gigyaconnection_with_custom_data/js/connection_lib/connection_lib.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/gigyaconnection_with_custom_data/ts_36527059099e058610dadd824e57413b/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(b,d){this.blueConicClient=b;this.context=d?d:null;this.clickEventPublished=this.viewEventPublished=!1;var a=this.context.getParameters();if(a&&("true"===a.hasOverlay[0]&&(this.viewEventPublished=!0,this.blueConicClient.createEvent("VIEW",this.context.getInteractionId())),a=a.positions))for(var c=0;c<a.length;c++)this.blueConicClient.position.subscribe(a[c],this,this._handlePosition)},_handleClick:function(){this.clickEventPublished||(this.clickEventPublished=
!0,this.blueConicClient.createEvent("CLICK",this.context.getInteractionId()))},_handlePosition:function(b){this.viewEventPublished||this.blueConicClient.isInEditMode()||(this.viewEventPublished=!0,this.blueConicClient.createEvent("VIEW",this.context.getInteractionId()));var d=this;try{var a="bcCtrl"+this.context.getInteractionId();this.jQuery(b+" a").off("click."+a).on("click."+a,function(){d._handleClick()});this.jQuery(document).off("click."+a).on("click."+a,b+" a",function(){d._handleClick()});
this.jQuery(document).off("submit."+a).on("submit."+a,b+" form",function(){d._handleClick()});if(0<this.jQuery(b).find("iframe").length){window.focus();var c=!1,e=this.jQuery(this.jQuery(b).find("iframe"));e.off("mouseenter."+a).on("mouseenter."+a,function(){c=!0});e.off("mouseleave."+a).on("mouseleave."+a,function(){c=!1});this.jQuery(window).off("blur."+a).on("blur."+a,this.jQuery.proxy(function(){c&&this._handleClick()},this))}}catch(f){}},onLoad:function(){}});
var a = [];var i='globallistener_controlgroup';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.5/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({_timeout:null,_timeStamp:null,_interval:200,init:function(b,a){this.blueConicClient=b;this.context=a?a:null},_handleInactivity:function(){this.blueConicClient.createEvent("inactivity")},_checkTimeout:function(){var b=this;(new Date).getTime()-this._timeStamp>this._timeout?this._handleInactivity():b._timeoutID=setTimeout(function(){b._checkTimeout()},b._interval)},onLoad:function(){var b=this.jQuery,a=this;this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,
this,function(b,c){this._timeStamp=(new Date).getTime();clearTimeout(a._timeoutID);a._timeoutID=setTimeout(function(){a._checkTimeout()},a._interval)});this._timeStamp=(new Date).getTime();var c=this.context.getParameters(),d="true"===c.clicks[0],e="true"===c.inputs[0];var f=c.scrolling?"true"===c.scrolling[0]:!0;this._timeout=c.timeout[0];this._timeout?isNaN(parseInt(this._timeout))||(this._timeout=1E3*parseInt(this._timeout)):this._timeout=6E4;if(d||e||f){if(d)b(document).on("click","*",function(){a._timeStamp=
(new Date).getTime()});e&&(b("input").on("keyup",function(){a._timeStamp=(new Date).getTime()}),b("textarea").on("keyup",function(){a._timeStamp=(new Date).getTime()}),b("select").on("change",function(){a._timeStamp=(new Date).getTime()}),b("input").on("change",function(){a._timeStamp=(new Date).getTime()}));f&&(window.onscroll=function(b){a._timeStamp=(new Date).getTime()});this._timeoutID=setTimeout(function(){a._checkTimeout()},a._interval)}}});var a = [];var i='inactivitylistener';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.1.9/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=this.context.getParameters(),this.isInEditMode=this.blueConicClient.isInEditMode(),this.fancyBoxLib='lib/fancybox/jquery.fancybox.pack.js';var c=this.context.getInteractionTypeId();this.baseURL=this.blueConicClient.getBaseURL(c);var d=this.parameters.content+'';this.htmlFragment=this.createElement(d),this.profile=a.profile.getProfile(),this.inlineCss=null,this._timestamp=null,this._observer=null,this._eventListenerFunction=null,this._lightboxTriggered=!1,this.blueConicClient._renderedInteractions=this.blueConicClient._renderedInteractions||[],this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){var a=this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId());this.blueConicClient._renderedInteractions.splice(a,1)})},getPreloadProperties:function(){for(var a,b=this.context.getParameters().content+'',c=/data-bc-preload="([^"]*)"/g,d=[];null!==(a=c.exec(b));)for(var e=a[1].split(','),f=0;f<e.length;f++)d.push(e[f]);for(var g=this.htmlFragment?this._getPropertiesFromPlaceholders(this.htmlFragment.innerHTML):[],h=0;h<d.length;h++)g.push(d[h]);return g},onMessageReceived:function(a){this.blueConicClient.event.publish('lightbox.messageReceived',a)},onLoad:function(){return window.bcFancyboxLoading?void this.blueConicClient.event.subscribe('bcFancyboxLoaded',this,function(){this.onLoad()}):void(this.blueConicClient._lightboxinteractiontypeFancybox?(this.jQuery.fancybox=this.blueConicClient._lightboxinteractiontypeFancybox,this._onLoadWithLibrary()):(window.bcFancyboxLoading=!0,this.blueConicClient.util.loadScript(this.baseURL+this.fancyBoxLib,this,function(){this.blueConicClient._loadLightboxInteractionTypeFancyBox(window,document,this.jQuery),this.blueConicClient._lightboxinteractiontypeFancybox=this.jQuery.fancybox,delete this.blueConicClient._loadLightboxInteractionTypeFancyBox,this._onLoadWithLibrary(),window.bcFancyboxLoading=!1,this.blueConicClient.event.publish('bcFancyboxLoaded')})))},_onLoadWithLibrary:function(){if(this.isInEditMode)this.showLightbox();else{var a=this.parameters.selected_when||[],b=this.getParameter('click_selector');b&&-1!==this.blueConicClient.util.array.indexOfArray(a,'click_selector')&&this._addClickTriggerBindings(b);var c=this.getParameter('content_condition');c&&-1!==this.blueConicClient.util.array.indexOfArray(a,'content_condition')&&this._addContentPolling(c);var d=this.parameters.scroll_depth&&this.parameters.scroll_depth[0]&&!isNaN(this.parameters.scroll_depth[0])?parseInt(this.parameters.scroll_depth[0]):0;d&&-1!==this.blueConicClient.util.array.indexOfArray(a,'scroll_depth')&&this._addScrollBinding(d),0===a.length&&this.showLightbox(),this._addCloseEventHandler()}},_checkScrollCondition:function(a){var b=this.jQuery(window).scrollTop(),c=this.jQuery(document).height(),d=100*(b/(c-window.innerHeight));d>=a&&this.showLightbox()},_addScrollBinding:function(a){this._checkScrollCondition(a),this.jQuery(window).scroll(this.jQuery.proxy(function(){this._checkScrollCondition(a)},this))},_addClickTriggerBindings:function(a){try{var b=this.jQuery(a);0<b.length?b.off('click.lightboxinteractiontype').on('click.lightboxinteractiontype',this.jQuery.proxy(function(){this.showLightbox(!0)},this)):this.blueConicClient.position.subscribe(a,this,this.jQuery.proxy(this._addClickTriggerBindings,this,a))}catch(a){}},_addContentPolling:function(a){this._checkContentCondition(a);var b=this,c=document.getElementsByTagName('body')[0],d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(d)this._observer=new MutationObserver(function(){b._observeContentChanges(a)}),this._observer.observe(c,{childList:!0,subtree:!0});else if(window.addEventListener)this._eventListenerFunction=function(){b._observeContentChanges(a)},c.addEventListener('DOMNodeInserted',this._eventListenerFunction,!1);else var e=setInterval(function(){b._lightboxTriggered?clearInterval(e):b._checkContentCondition(a)},500)},_observeContentChanges:function(a){if(this._lightboxTriggered){if(this._observer)this._observer.disconnect();else{var b=document.getElementsByTagName('body')[0];b.removeEventListener('DOMNodeInserted',this._eventListenerFunction,!1)}return}var c=this,d=new Date().getTime();this._timestamp=d,setTimeout(function(){c._timestamp!==d||c._lightboxTriggered||c._checkContentCondition(a)},250)},_checkContentCondition:function(a){0<this.jQuery(a).length&&this.jQuery(a).html()&&0<this.jQuery(a).html().length&&this.showLightbox()},closeLightbox:function(){this.isInEditMode||this.jQuery.fancybox.close()},_addCloseEventHandler:function(){this.blueConicClient.event.subscribe('closeoverlay',this,function(a,b){b instanceof Array&&b[0]===this.context.getInteractionId()&&this.closeLightbox()})},showLightbox:function(a){if(-1===this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId())){this.blueConicClient._renderedInteractions.push(this.context.getInteractionId());this.parameters.selected_when||[];if(!this._lightboxTriggered||this.isInEditMode||a){var b=this.parameters.delay&&this.parameters.delay[0]&&!isNaN(this.parameters.delay[0])?1e3*parseInt(this.parameters.delay[0]):0;!this.isInEditMode&&0<b?window.setTimeout(this.jQuery.proxy(function(){this._showLightbox()},this),b):this._showLightbox()}}},getSettings:function(){var a=null,b=this.getParameter('width')||null,c=this.getParameter('height')||null;this.htmlFragment&&(a=this.htmlFragment.innerHTML);var d=this.getParameter('show_close'),e=this.getParameter('alternative_close'),f={parent:'body',autoSize:!(b||c),autoCenter:!1,autoWidth:!b,autoHeight:!c,closeBtn:'false'!==d,width:b||'auto',height:c||'auto',keys:{close:'false'===e||this.isInEditMode?null:[27]},helpers:{overlay:{locked:!0,closeClick:'false'!==e&&!this.isInEditMode}}},g=this.getParameter('template');g&&(f.padding=0),(a||this.isInEditMode)&&(f.content=' ',f.type='inline');var h=this,i=this.jQuery,j=this.getParameter('effect'),k=this.getParameter('effect_slide_direction')||'left';if(this.isInEditMode&&(j='noEffect'),j&&'noEffect'!==j&&('fadeIn'===j?i.fancybox.transitions.openEffect=function(){var a=i.fancybox._getPosition(!0);a.opacity=0,i.fancybox.wrap.css(a).show().animate({opacity:1},{duration:i.fancybox.current.openSpeed,complete:i.fancybox._afterZoomIn})}:'slideIn'===j&&(i.fancybox.transitions.openEffect=function(){var a,b=i.fancybox._getPosition(!0),c=i(window).height(),d=i(window).width(),e=i('.fancybox-wrap').get(0).getBoundingClientRect(),f='top'===k||'bottom'===k?'top':'left';'top'===k||'bottom'===k?a=c-(c-e.height)/2:('left'===k||'right'===k)&&(a=d-(d-e.width)/2),b[f]='top'===k||'left'===k?parseInt(b[f])-a+'px':parseInt(b[f])+a+'px';var g={},h='top'===k||'left'===k?'+':'-';g[f]=h+'='+a+'px',i.fancybox.wrap.css(b).show().animate(g,{duration:i.fancybox.current.openSpeed,complete:i.fancybox._afterZoomIn})}),i.fancybox.transitions.openEffect&&(f.openMethod='openEffect',f.openSpeed=1e3)),a)f.afterLoad=function(){h.emptyElementsWithAttribute(h.htmlFragment,'div','data-bc-external'),i('.fancybox-inner').html(h.htmlFragment.innerHTML),h.isInEditMode&&h.blueConicClient.event.publish('lightbox.interactionLoaded',{interaction:h}),h.handleComplexElements(i('.fancybox-inner').get(0));var a=h.getParameter('javascript');if(a&&!h.blueConicClient.isInEditMode()){a=a.replace(/(^|\W)blueConicVariantId(\W|$)/,'$1"'+h.context.getInteractionId()+'"$2'),h._inlineJs=h.jQuery('<script>'+a+'</script>');try{h._inlineJs.appendTo(h.jQuery('body'))}catch(a){console.error(a)}}};else if(h.isInEditMode){var l=function(){h.blueConicClient.event.publish('lightbox.interactionLoaded',{interaction:h})};f.afterLoad=l}return this.isInEditMode&&(f.afterShow=function(){i('.fancybox-close').off('click.fb')}),f.afterClose=function(){var a=h.blueConicClient.util.array.indexOfArray(h.blueConicClient._renderedInteractions,h.context.getInteractionId());h.blueConicClient._renderedInteractions.splice(a,1)},f},updateLightbox:function(){this.jQuery.fancybox.update()},getCurrentFancyBox:function(){return this.jQuery.fancybox.current},_showLightbox:function(){function a(){var d=c('<div class="fancybox-wrap jq_tmp" style="display:none"></div>');c('body').append(d);var e=d.css('top');if(d.remove(),'auto'===e){if(5<f)return;f++,window.setTimeout(c.proxy(a,this),200)}else b.call(this,c)}function b(){if(!this.isInEditMode){this.blueConicClient.createEvent('VIEW',this.context.getInteractionId());var a=!!this.parameters.forceclick&&('true'===this.parameters.forceclick[0]||!0===this.parameters.forceclick[0]);a&&this.blueConicClient.createEvent('CLICK',this.context.getInteractionId());var b=this.getParameter('click_event_selector');if(b){this.jQuery('body').one('click',b,this.jQuery.proxy(function(a){this.lastClickEvent&&this.lastClickEvent.originalEvent===a.originalEvent||this._logClickEvent(a)},this));try{this.jQuery(b).one('click',this.jQuery.proxy(function(a){this.lastClickEvent=a,this._logClickEvent(a)},this))}catch(a){}}}c('.fancybox-wrap').remove(),c('.fancybox-overlay').remove(),this.highZindex=function(a){var b,c=document.getElementsByTagName(a),d=0,e=0;for(e=0;e<c.length;e++)b=document.defaultView.getComputedStyle(c[e],null).getPropertyValue('z-index'),'auto'!==b&&parseInt(b)>d&&(d=parseInt(b));return d}('*'),this.htmlFragment&&(this.emptyElementsWithAttribute(this.htmlFragment,'div','data-bc-external'),!this.isInEditMode&&this.handlePlaceholders(this.htmlFragment)),c.fancybox(this.getSettings()),8e3<this.highZindex&&2147483647>this.highZindex+1030&&(c('.fancybox-opened').css('z-index',this.highZindex+1030),c('.fancybox-wrap').css('z-index',this.highZindex+920),c('.fancybox-overlay').css('z-index',this.highZindex+910)),2147483647<=this.highZindex+1030&&(c('.fancybox-opened').css('z-index',2147483647),c('.fancybox-wrap').css('z-index',2147483646),c('.fancybox-overlay').css('z-index',2147483645)),this.isInEditMode||this._setupFrontEndBindings()}this._lightboxTriggered=!0;var c=this.jQuery,d=this,e=this.baseURL+'lib/fancybox/jquery.fancybox.css';this.blueConicClient.util.loadCSS(e),this.handleStyling(this.getParameter('close_icon'),this.getParameter('close_icon_hover')),this.handleJavascript();var f=0;a.call(this)},_logClickEvent:function(a){if(!(a&&a.originalEvent&&a.originalEvent._blueConicLoggedClickEvent===this.context.getInteractionId())){var b=a&&a.target&&a.target.pathname&&a.target.hostname&&0===a.target.pathname.indexOf('/s/')&&-1!==a.target.hostname.indexOf('blueconic');b||(a.originalEvent&&(a.originalEvent._blueConicLoggedClickEvent=this.context.getInteractionId()),this.blueConicClient.createEvent('CLICK',this.context.getInteractionId()))}},_setupFrontEndBindings:function(){var a=this.jQuery('.bcLightboxDontShowAgainLink'),b=this.jQuery('.bcLightboxCloseButton');0<a.length&&a.off('click.dontShowAgainLinks').on('click.dontShowAgainLinks',this.jQuery.proxy(function(a){a.preventDefault(),this.blueConicClient.doNotShowAgain(this.context.getInteractionId()),this.closeLightbox()},this)),0<b.length&&b.off('click.closeButtons').on('click.closeButtons',this.jQuery.proxy(function(){this.closeLightbox()},this))},handleComplexElements:function(a){for(var b=this.getElementsWithAttribute(a,'div','data-bc-pluginid'),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute('data-bc-pluginid'),f=d.getAttribute('data-bc-config');if(f)try{var g=f.replace(/\n/g,'\\\\n').replace(/\r/g,'\\\\r').replace(/\t/g,'\\\\t');f=this.blueConicClient.json.parse(g)}catch(a){f=null}this.blueConicClient.event.publish('bcComplexObject',{plugin:e,config:f,node:d,interactionId:this.context.getInteractionId()}),this.isInEditMode||(d.removeAttribute('data-bc-pluginid'),d.removeAttribute('data-bc-config'))}},emptyElementsWithAttribute:function(a,b,c){for(var d,e=this.getElementsWithAttribute(a,b,c),f=0,g=e.length;f<g;f++)d=e[f],d.innerHTML=''},getElementsWithAttribute:function(a,b,c){for(var d,e=[],f=a.getElementsByTagName(b),g=0,h=f.length;g<h;g++)d=f[g],d.getAttribute(c)&&e.push(d);return e},createElement:function(a){var b;if(!a)return null;try{b=document.createElement('div'),b.innerHTML=a}catch(a){return null}return b},handlePlaceholders:function(a){for(var b=this._getPropertiesFromPlaceholders(a.innerHTML),c=0;c<b.length;c++){var d=b[c],e=this.profile.getValue(d)||'',f=new RegExp('\\$\\{'+d+'\\}','g');a.innerHTML=a.innerHTML.replace(f,encodeURI(e))}},_getPropertiesFromPlaceholders:function(a){for(var b,c=/\$\{([a-zA-Z\-_0-9]+)\}/g,d=[];b=c.exec(a);)d.push(b[1]);return d},getParameter:function(a){return this.parameters[a]&&this.parameters[a][0]?this.parameters[a][0]:null},getParameters:function(a){return this.parameters[a]||null},handleJavascript:function(){var a=this.jQuery,b=this.getParameters('javascript_urls'),c=[];if(b){this.javascriptUrls=b;for(var d=0;d<b.length;d++)c.push(this._getLoadScriptDeferred(b[d]))}return a.when.apply(a,c)},_getLoadScriptDeferred:function(a){var b=this.jQuery,c=b.Deferred();return this.blueConicClient.util.loadScript(a,this,function(){c.resolve()}),c},handleStyling:function(a,b){var c=this.getParameter('content');c&&-1!==c.indexOf('bcLightboxTemplate')||this.blueConicClient.util.loadCSS(this.baseURL+'css/lightbox.css');var d=this.getParameter('styling_css');d&&(this.stylingUrl=d,this.blueConicClient.util.loadCSS(d));var e='',f='true'===this.getParameter('custom_close');f&&a&&(e+='.fancybox-close {background-image: url(\''+a+'\');background-repeat: no-repeat;background-position: center center;background-size: contain;}',b&&(e+='.fancybox-close:hover {background-image: url(\''+b+'\');background-repeat: no-repeat;background-position: center center;background-size: contain;}'));var g=this.getParameter('close_position'),h=this.getParameter('close_padding');e+=this._getClosePositionStyling(g,h);var i=this.getParameter('styling_css_inline');i&&(e+=i.replace(/&#xd;/gi,'')),e&&(this.inlineCss=this.jQuery('<style>'+e+'</style>'),this.inlineCss.appendTo(this.jQuery('body')))},_getClosePositionStyling:function(a,b){if(!a)return'';(null===b||'NaN'===b)&&(b='-18');var c='.fancybox-close {';switch(a){case'TOP_LEFT':c+='top:'+b+'px; right: unset; bottom: unset; left:'+b+'px;';break;case'BOTTOM_RIGHT':c+='top: unset; right: '+b+'px; bottom: '+b+'px; left: unset;';break;default:c+='top: '+b+'px; right: '+b+'px; bottom: unset; left: unset;';}return c+='}'}});var a = [];var i='lightboxinteractiontype';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/2.1.10/'},{ id : 'html', baseUrl : ps + 'html/1.0.10/'},{ id : 'image', baseUrl : ps + 'image/1.0.2/'},{ id : 'number', baseUrl : ps + 'number/1.0.2/'},{ id : 'string', baseUrl : ps + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b},getPreloadProperties:function(){var a=this.context.getParameters();return(a=a.property?a.property[0]:a.property)?[a]:[]},onLoad:function(){var a=this,b=this.context.getProfile(),d=this.context.getParameters(),c=d.property?d.property[0]:d.property;c||(c="adblock_detected");d=function(){"no"!==b.getValue(c)&&(b.setValue(c,"no"),a.blueConicClient.profile.updateProfile())};var e=function(){"yes"!==
b.getValue(c)&&(b.setValue(c,"yes"),a.blueConicClient.profile.updateProfile())};window.blockAdBlock?(window.blockAdBlock.on(!1,d),window.blockAdBlock.on(!0,e),window.blockAdBlock.check()):e()}});var a = [];var i='listener_adblock';a.push({url: p + i + '/1.0.8/lib/blockadblock.min.js', sharing: 'none'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.8/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b},getPreloadProperties:function(){var a=this.context.getParameters(),b=a.responseProperty?a.responseProperty[0]:a.responseProperty;return b?(this.campaignIdentifierProperty=b,[b]):(this.campaignIdentifierProperty="responded_to_campaigns",["responded_to_campaigns"])},onLoad:function(){var a=this.context.getProfile(),b=this.context.getParameters(),c=this.blueConicClient,d=!1,e=!1,f=b.config?b.config[0]:b.config;if(f){for(var g=this.blueConicClient.json.parse(f),h=0;h<g.length;h++){var i=g[h],j=this.getParameterByName(i.parameter);j&&i.profileProperty&&(a.addValue(i.profileProperty,j),d=!0,i.isCampaignIdentifier&&!e&&(this._bindHandlers(j),e=!0))}d&&c.profile.updateProfile()}},_bindHandlers:function(a){var b=this,c=this.context.getProfile(),d=this.blueConicClient,e=this.jQuery;e("a").click(function(){c.addValue(b.campaignIdentifierProperty,a),d.profile.updateProfile()}),e("form").submit(function(){c.addValue(b.campaignIdentifierProperty,a),d.profile.updateProfile()})},getParameterByName:function(a){if(!a)return"";a=a.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}});var a = [];var i='listener_campaign_tracker';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.9/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){var c=Math.floor;this.blueConicClient=a,this.context=b;var d=new Date(2015,0,1,0,0,0,0),e=new Date,f=e.getTime()-d.getTime();this.days=c(f/86400000),this.weekNr=c(this.days/7)},getPreloadProperties:function(){return["_engagement","visits","clickcount"]},onLoad:function(){var a=this.context.getProfile(),b=this.context.getParameters(),c=parseInt(b.lowTreshold?b.lowTreshold[0]:b.lowTreshold),d=parseInt(b.highTreshold?b.highTreshold[0]:b.highTreshold),e=parseInt(a.getValue("clickcount")),f=parseInt(a.getValue("visits")),g="engagement",h=a.getValue("_engagement")?JSON.parse(a.getValue("_engagement")):{},j=!1;h["v"+this.weekNr]||(h["v"+this.weekNr]=f,j=!0),h["c"+this.weekNr]||(h["c"+this.weekNr]=e,j=!0);for(var k,l=this._getCalculated(h,f,e),m=0,n=0;n<l.length;n++){k=0.1,5>n?k=1:10>n?k=0.8:20>n?k=0.5:50>n&&(k=0.3);var i=l[n];m+=(i.clickCount+5*i.visits)*k}m=Math.floor(m);isNaN(m)||(a.setValue("engagement_score",m),j&&a.setValue("_engagement",JSON.stringify(h)),m<c?a.setValue(g,"low"):m>d?a.setValue(g,"high"):a.setValue(g,"medium"),this.blueConicClient.profile.updateProfile())},_getCalculated:function(a,b,c){for(var d,e=[],f=this.weekNr;0<f;f--){d=0,a["v"+f]&&(d=b-a["v"+f],b-=d);var g=0;a["c"+f]&&(g=c-a["c"+f],c-=g),e.push({week:f,visits:d,clickCount:g})}return e}});var a = [];var i='listener_engagement';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.11/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b?b:null,this.POLLING_TIMEOUT=1e3,this.parameters=b.getParameters()},getPreloadProperties:function(){return["funnel_timestamp","funnel_busy_with","funnel_steps","funnel_laststep","funnel_lastfield"]},_setLastFocus:function(a){var b=this.context.getProfile();b.setValue("funnel_lastfield",this._funnelName+" - "+this._currentStepId+": "+a),this.blueConicClient.profile.updateProfile()},_addBindings:function(){var a=this.jQuery,b=this,c=this.context.getProfile(),d=this.context.getInteractionId();a(document).off("focus."+d,"input").on("focus."+d,"input",{},function(){var c=a(this).attr("type");"text"!==c&&"radio"!==c&&"checkbox"!==c&&"number"!==c&&"email"!==c&&"tel"!==c&&"date"!==c&&a(this).attr("type")||b._setLastFocus(b._getFieldName(this))}),a(document).off("focus."+d,"select").on("focus."+d,"select",{},function(){b._setLastFocus(b._getFieldName(this))}),a(document).off("focus."+d,"textarea").on("focus."+d,"textarea",{},function(){b._setLastFocus(b._getFieldName(this))})},_getFieldName:function(a){var b=this.jQuery;return b(a).attr("name")||b(a).attr("id")},_urlsMatches:function(a,b){var c=this.jQuery,d=this;return 0<c(a.urlMatching).filter(function(a,c){return d._urlMatches(c,b)}).length},_urlMatches:function(a,b){var c=this._normalizeUrl(b),d=this._normalizeUrl(a.url),e=this._escapeRegularExpressionCharacters(d);try{var f=new RegExp(e,"i");return f.test(c)}catch(a){return!1}},_escapeRegularExpressionCharacters:function(a){return a=a.replace(/[\\?.{}+]/g,function(a){return"\\"+a}),a=a.replace(/\*/g,".*"),a},_stepIsVisible:function(a,b){var c=this,d=this.jQuery;return 0<d(a.urlMatching).filter(function(a,d){return c._urlMatches(d,b)&&(!d.word||c._wordIsVisible(d.word))}).length},_wordIsVisible:function(a){var b=this.jQuery;return a=a.toLowerCase(),0<b(":contains('"+a+"')").filter(function(){for(var b,c=0;c<this.childNodes.length;c++)if(b=this.childNodes[c],b.nodeValue&&-1!==b.nodeValue.toLowerCase().indexOf(a))return!0;return!1}).filter(":visible").length},_convertStepMapping:function(a,b){var c=this.jQuery,d=this,e=c(b).map(function(a,b){return b.name});return c(a).filter(function(a,b){return 0===b.indexOf(d._funnelName)}).map(function(a,b){var d,f=b.match(/'(.*)' to '(.*)'/);if(f&&f[1]&&f[2]&&-1!==c.inArray(f[1],e)&&-1!==c.inArray(f[2],e))d={source:f[1],target:f[2]};else{var g=b.match(/started at '(.*)'/);g&&g[1]&&-1!==c.inArray(g[1],e)&&(d={start:g[1]})}return d}).filter(function(a,b){return b})},_getFollowedStepsMapping:function(a,b){var c=this.jQuery,d=this,e=this.context.getProfile(),f=this._convertStepMapping(e.getValues("funnel_steps"),b),g=null,h=b.slice(0,b.indexOf(a)),j=!1;return c(b).each(function(b,d){var e=d.name;if(j=j||e===a,!j){var h=c(f).filter(function(a,b){return b.start===e||b.target===e});0<h.length&&(g=e)}}),g?this._funnelName+" : '"+g+"'"+" to "+"'"+a+"'":this._funnelName+" : "+"started at "+"'"+a+"'"},_checkWordMatch:function(a){var b=this.jQuery,c=this;setTimeout(function(){var d=!1;b(c._queue).each(function(b,e){c._stepIsVisible(e,a)&&(d=!0)}),d?c._onLoad():c._checkWordMatch(a)},this.POLLING_TIMEOUT)},onLoad:function(){this.jQuery.expr[":"].contains=this.jQuery.expr.createPseudo(this.jQuery.proxy(function(a){return this.jQuery.proxy(function(b){return 0<=this.jQuery(b).text().toLowerCase().indexOf(a.toLowerCase())},this)},this)),this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){this._onLoad()}),this._onLoad()},_handleEndReached:function(){var a=this.context.getProfile(),b=a.getValues("funnel_busy_with"),c=b.indexOf(this._funnelName);-1!==b.indexOf(this._funnelName)&&(b.splice(c,1),a.setValues("funnel_busy_with",b))},_removeQueryParameter:function(a,b){var c=a.split("?");if(2<=c.length){for(var d=encodeURIComponent(b)+"=",e=c[1].split(/[&;]/g),f=e.length;0<f--;)-1!==e[f].lastIndexOf(d,0)&&e.splice(f,1);return a=c[0]+(0<e.length?"?"+e.join("&"):""),a}return a},_getUrl:function(){return document.location.origin+document.location.pathname+document.location.search+document.location.hash},_getSteps:function(){var a=this.parameters.steps?this.parameters.steps[0]:this.parameters.steps;return a?this.blueConicClient.json.parse(a):[]},_normalizeUrl:function(a){return a=this._removeUrlPart(a,"http://"),a=this._removeUrlPart(a,"https://"),a=this._removeUrlPart(a,"www."),a},_removeUrlPart:function(a,b){return 0===a.indexOf(b)&&(a=a.substring(b.length)),a},_onLoad:function(a){var b=this.jQuery,c=this,d=this.context.getProfile();this._funnelName=this.parameters.funnelName?this.parameters.funnelName[0]:this.parameters.funnelName;var e=this._getSteps();if(0!==e.length){a=a||this._getUrl();var f=b(e).filter(function(b,d){return c._urlsMatches(d,a)});this._queue=[];var g=null;if(b(f).each(function(b,d){c._stepIsVisible(d,a)?g=d:c._queue.push(d)}),0<this._queue.length&&this._checkWordMatch(a),null!==g){this._currentStepId=g.name,this._addBindings(),d.setValue("funnel_laststep",this._funnelName+" - "+this._currentStepId);var h=this._getFollowedStepsMapping(this._currentStepId,e);d.addValue("funnel_steps",h);var j=!1,i=b(e).filter(function(a,b){return j=j||b.name===g.name,j&&b.name!==g.name}),k=d.getValues("funnel_steps"),l=this._funnelName;i.each(function(a,c){k=b(k).filter(function(a,b){return 0!==b.indexOf(l+" :")||-1===b.indexOf("started at '"+c.name+"'")&&-1===b.indexOf("to '"+c.name+"'")}).toArray()}),d.setValues("funnel_steps",k),d.setValue("funnel_lastfield",""),this._currentStepId===e[e.length-1].name?this._handleEndReached():d.addValue("funnel_busy_with",this._funnelName);var m=this.blueConicClient.getCurrentDate().getTime();d.setValue("funnel_timestamp",m),this.blueConicClient.profile.updateProfile()}}}});var a = [];var i='listener_funnel';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.15/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b},getPreloadProperties:function(){return[]},onLoad:function(){}});var a = [];var i='listener_geolocation';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.7/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b;a=this.context.getParameters();this.property=a.property&&a.property[0]?a.property[0]:"incognito_detected"},getPreloadProperties:function(){return[this.property]},onLoad:function(){this.checkIncognitoMode(function(a){this.blueConicClient.profile.getProfile().setValue(this.property,a?"on":"off");this.blueConicClient.profile.updateProfile();a&&this.blueConicClient.createEvent("incognito_detected")})},
checkIncognitoMode:function(a){if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(0,0,a.bind(this,!1),a.bind(this,!0));else if("MozAppearance"in document.documentElement.style){var b=window.indexedDB.open("test");b.onerror=a.bind(this,!0);b.onsuccess=a.bind(this,!1)}else return window.PointerEvent||window.MSPointerEvent?a(!window.indexedDB):"localStorage"in window?a(this._tryLocalStorage()):a(!1)},_tryLocalStorage:function(){try{return 0<window.localStorage.length||(window.localStorage.x=
1,window.localStorage.removeItem("x")),!1}catch(a){return window.navigator.cookieEnabled?!0:!1}}});
var a = [];var i='listener_incognito';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/listener_incognito/ts_ce448a810500b0dd4457ac07f3e1126f/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(c,d){this.blueConicClient=c;this.context=d;c=new Date(2017,8,1,0,0,0,0);c=this.blueConicClient.getCurrentDate().getTime()-c.getTime();this.days=Math.floor(c/864E5)},getPreloadProperties:function(){return[]},onLoad:function(){var c=this.context.getProfile(),d=this.context.getParameters(),g=d.property?d.property[0]:d.property;if(g){d=this.blueConicClient.util.array.ensureArray(d.excludedKeywords);g=this.blueConicClient.json.parse(g)[0].profileproperty;
var e=[],a=document.getElementsByTagName("meta");if(a)for(var f=!1,b=0,k=a.length;b<k;b++)if("news_keywords"===a[b].name.toLowerCase()){var h=a[b].content.split(",");0===h.length||1===h.length&&""===h[0]||(e=h,f=!0)}else f||0!==e.length||"keywords"!==a[b].name.toLowerCase()||(e=a[b].content.split(","));if(0<e.length){a={TIME:(new Date).getTime(),days:this.days,points:1,keywords:[]};for(f=0;f<e.length;f++)b=this._trim(e[f]),""!==b&&-1===this.blueConicClient.util.array.indexOfArray(d,b)&&a.keywords.push(b);
0<a.keywords.length&&(c.addValue("_hl_"+g,this.blueConicClient.json.stringify(a)),this.blueConicClient.profile.updateProfile())}}},_trim:function(c){return c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}});var a = [];var i='listener_meta_keywords_ranker';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.2.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b;a=new Date(2017,8,1,0,0,0,0);a=this.blueConicClient.getCurrentDate().getTime()-a.getTime();this.days=Math.floor(a/864E5)},getPreloadProperties:function(){return[]},onLoad:function(){var a=this.context.getProfile(),b=this.context.getParameters(),c=b.property?b.property[0]:b.property;if(c){c=this.blueConicClient.json.parse(c)[0].profileproperty;var d=this.blueConicClient.getCurrentDate();b=this._getTimeFrame(d.getHours(),
b.locale[0]);d={TIME:(new Date).getTime(),data:[]};d.data.push({n:b,p:1,d:this.days});a.addValue("_hl_"+c,this.blueConicClient.json.stringify(d));this.blueConicClient.profile.updateProfile()}},_getTimeFrame:function(a,b){return this._getHour(a,b)+" - "+this._getHour(a+1,b)},_getHour:function(a,b){return"en-us"===b?(b=12<=a?"PM":"AM",a%=12,(0===a?12:a)+" "+b):(10>a?"0"+a:a)+":00"}});var a = [];var i='listener_preferred_hour';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.2.0/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b;a=new Date(2012,0,1,0,0,0,0);a=(new Date).getTime()-a.getTime();this.days=Math.floor(a/864E5)},getPreloadProperties:function(){return[]},onLoad:function(){this.context.getProfile();var a=this.context.getParameters();if(a=a.config?a.config[0]:a.config){a=this.blueConicClient.json.parse(a);var b=document.location.href;if(0<=b.indexOf("#")||0<=b.indexOf("?"))b=b.substring(0,b.indexOf("#"))||b.substring(0,
b.indexOf("?"));b=b.split("/");var c,d=!1;for(c=0;c<a.length;c++){var e=a[c],f=b[c+3];e.checked&&e.profileProperty&&!d&&(this._storeEngagement(e.profileProperty,this._getValue(f)),f&&30<f.length&&e.checked&&(d=!0))}this.blueConicClient.profile.updateProfile()}},_getValue:function(a){if(!a||30<a.length)return null;0<=a.indexOf(".")&&(a=a.substring(0,a.indexOf(".")));return isNaN(a)&&"index"!==a&&0!==a.indexOf("index.")?a:null},_storeEngagement:function(a,b){if(b){var c=this.context.getProfile();this.context.getParameters();
var d={TIME:(new Date).getTime()};d[b]={};d[b]["p"+this.days]=1;c.addValue("_"+a,this.blueConicClient.json.stringify(d))}}});var a = [];var i='listener_url_structure';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.13/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a,this.context=b,this.profile=a.profile.getProfile(),this.referrer=document.referrer,this.currentUrl=window.location.href},onPrepare:function(){var a=this.profile,b=function(){var a=window.navigator.userLanguage||navigator.systemLanguage||window.navigator.language;if(!a)return null;var b=-1===a.indexOf('-')?a.indexOf('_'):a.indexOf('-');return-1!==b&&(a=a.substring(0,b)),a=a.toLowerCase(),a}();b&&a.setValue('language',b);var c=screen.width,d=screen.height,e=c+'x'+d;a.setValue('currentresolution',e),a.setValue('currentscreenwidth',c),a.setValue('currentscreenheight',d),a.addValue('resolution',e);var f=this.referrer,g=this.HELPER.decodeReferrer(f),h=[];if(g&&0<g.length)for(var j=0;j<g.length;j++)g[j]&&(a.addValue('keywords',g[j]),h.push(g[j]));0<h.length&&a.setValues('currentkeywords',h);var i=f.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,'$1'),k=window.location.hostname;i!==k&&''!==i&&a.setValue('referrerhost',i);var l=this.currentUrl,m=this.HELPER.substringToHash(this.HELPER.decodeReferrerQS(l,'utm_source')),n=this.HELPER.substringToHash(this.HELPER.decodeReferrerQS(l,'utm_medium')),o=this.HELPER.substringToHash(this.HELPER.decodeReferrerQS(l,'utm_term')),p=this.HELPER.substringToHash(this.HELPER.decodeReferrerQS(l,'utm_content')),q=this.HELPER.substringToHash(this.HELPER.decodeReferrerQS(l,'utm_campaign'));(m||n||o||p||q)&&(a.setValue('current_utm_source',m),a.setValue('current_utm_medium',n),a.setValue('current_utm_term',o),a.setValue('current_utm_content',p),a.setValue('current_utm_campaign',q),m&&a.addValue('utm_source',m),n&&a.addValue('utm_medium',n),o&&a.addValue('utm_term',o),p&&a.addValue('utm_content',p),q&&a.addValue('utm_campaign',q))},getPreloadProperties:function(){return['clickcount','visits','visitclicks','lastvisitdate','visitedsites','entrypage','hostentrypage','hostaveragetime','lastreferreraverage','averageTime','resolution']},onLoad:function(){var a,b,c=Math.round,d=this.profile,e=this.referrer.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,'$1'),f=window.location.hostname;if(e!==f){''!==e&&d.addValue('referrerhosts',e);var g=this.currentUrl;d.setValue('entrypage',g);var h=d.getValue('hostentrypage');if(!h)h={};else try{h=eval(h)}catch(a){h={}}h[f]={entrypage:g};var i='{';for(a in h)'}'===i.substring(i.length-1)&&(i+=','),b=''+a,i+='"'+b+'" : {',i+='"entrypage" : "'+h[a].entrypage,i+='"}';i+='}',d.setValue('hostentrypage',i)}var j=this.blueConicClient.getCurrentDate().getTime(),k=d.getValue('hostaveragetime');if(!k)k={};else try{k=k.replace(/'/g,'"'),k=this.blueConicClient.json.parse(k)}catch(a){k={}}'undefined'==typeof k[f]&&(k[f]={startdate:j,enddate:j,averageTime:0,visits:0});var l=d.getValue('lastreferreraverage'),m=0,n=0,o='{';for(a in k){b=''+a;var p=new Date;if(p.setTime(k[a].enddate),p.setMinutes(p.getMinutes()+15),j>p.getTime()){var q=k[a].enddate-k[a].startdate;if(0<q){var r=k[a].visits+1,s=c((k[a].visits*k[a].averageTime+q)/r/1e3);k[a].averageTime=s,k[a].visits=r}k[a].startdate=j,k[a].enddate=j}else b===f?k[a].enddate=j:b===e&&l!==e&&(k[a].enddate=j,d.setValue('lastreferreraverage',e));'}'===o.substring(o.length-1)&&(o+=','),o+='"'+b+'" : {',o+='"startdate" : '+k[a].startdate,o+=', "enddate" : '+k[a].enddate,o+=', "averageTime" : '+k[a].averageTime,o+=', "visits" : '+k[a].visits,o+='}',0!==k[a].averageTime&&(n+=1,m+=k[a].averageTime)}o+='}';var t=0;0<n&&(t=c(m/n)),d.setValue('hostaveragetime',o),d.setValue('averagetime',t);var u=this._getNumberProperty('clickcount'),v=d.getValues('visitedsites'),w=blueConicClient.util.array?blueConicClient.util.array.indexOfArray:indexOfArray;(null===v||0===v.length||-1===w.call(this,v,document.domain))&&d.addProperty('visitedsites',document.domain),d.setValue('clickcount',u+1);var x=d.getValue('lastvisitdate');''===x&&(x=0);var y=new Date(parseInt(x));y.setMinutes(y.getMinutes()+30);var z=this.blueConicClient.getCurrentDate(),A=this._getNumberProperty('visits');if(z>y||0===A)d.setValue('visitclicks',1),d.setValue('visits',A+1),d.addValue('resolution',screen.width+'x'+screen.height);else{var B=this._getNumberProperty('visitclicks');d.setValue('visitclicks',B+1)}d.setValue('lastvisitdate',z.getTime()),blueConicClient.profile.updateProfile()},HELPER:{search_engines:[['google\\.','q'],['bing\\.','q'],['search\\.yahoo\\.','p'],['search\\.msn\\.','q'],['search\\.live\\.','query'],['search\\.aol\\.','userQuery'],['ask\\.com','q'],['altavista\\.','q'],['feedster\\.','q'],['search\\.lycos\\.','q'],['alltheweb\\.','q'],['technorati\\.com/search/([^\\?/]+)',1],['dogpile\\.com/info\\.dogpl/search/web/([^\\?/]+)',1,!0]],substringToHash:function(a){if(a){var b=a.indexOf('#');if(-1!==b)return a.substring(0,b)}return a},decodeReferrer:function(a){for(var b,c=/(?:)/,d=0;d<this.search_engines.length;d++){b=this.search_engines[d],c.compile('^http(s?)://(www\\.)?'+b[0],'i');var e=a.match(c);if(e){var f;if(f=isNaN(b[1])?this.decodeReferrerQS(a,b[1]):e[b[1]+1],f)return f=decodeURIComponent(f),2<b.length&&b[2]&&(f=decodeURIComponent(f)),f=f.replace(/'|"/g,''),f=f.split(/[\s,+.]+/),f;break}}return null},decodeReferrerQS:function(a,b){if(null===b||'undefined'==typeof b||''===b)return null;if(null===a||'undefined'==typeof a||''===a)return null;a=decodeURIComponent(a);var c,d=a.indexOf('?');if(0<=d){var e=new String(a.substring(d+1));d=0,c=0;for(var f=0;0<=d&&0<=(c=e.indexOf('=',d));){f++;var g;if(g=e.substring(d,c),d=e.indexOf('&',c)+1,g===b)return 0>=d?e.substring(c+1):e.substring(c+1,d-1);if(0>=d)return null;if(1e3<f)return null}}return null}},_getNumberProperty:function(a){var b=this.profile.getValue(a);try{b=parseInt(b)}catch(a){b=0}return isNaN(b)&&(b=0),b}});var a = [];var i='listenerinteractiontype';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.0.26/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({open:!1,data:{},nrOfTries:0,closeButtonWidth:10,borderWidth:1,html:{nl:{content:'<p>Inhoud</p>'},"default":{content:'<p>Content</p>'}},init:function(a,b){this.blueConicClient=a,this.context=b,this.parameters=this.context.getParameters(),this._viewEventThrown=!1,this._manuallyClosed=!1,this.baseURL=this.blueConicClient.getBaseURL(this.context.getInteractionTypeId()),this._inlineCss=null,this._timestamp=null,this._observer=null,this._eventListenerFunction=null,this.isInEditMode=this.blueConicClient.isInEditMode(),this.clickTrigger=!1,this.blueConicClient._renderedInteractions=this.blueConicClient._renderedInteractions||[],this.blueConicClient.event.subscribe(this.blueConicClient.event.onUrlChange,this,function(){var a=this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId());this.blueConicClient._renderedInteractions.splice(a,1)})},getPreloadProperties:function(){for(var a,b=this.context.getParameters().content+'',c=/data-bc-preload="([^"]*)"/g,d=[];null!==(a=c.exec(b));)for(var e=a[1].split(','),f=0;f<e.length;f++)d.push(e[f]);return d},onMessageReceived:function(a){this.blueConicClient.event.publish('toaster.messageReceived',a)},onSave:function(){var a=this.jQuery;return a('.bcToasterContent').html()},onLoad:function(){var a=this,b=this.jQuery,c=this.getParameter('content'),d=c&&-1!==c.indexOf('bcToasterTemplate')?'_clean':'',e=this.getParameter('version'),f='';f=d||'3'!==e?'css/toaster':'css/toaster_v3';var g=b('<link type="text/css" href="'+this.baseURL+f+d+'.css" rel="stylesheet" />'),h=this.getParameter('template');this.template=h,g.on('load',function(){a.handleStyling(a.getParameter('close_icon'),a.getParameter('close_icon_hover')),a.handleJavascript().done(function(){a.loadToaster()})}),b('head').append(g)},loadToaster:function(){var a=this.context.getParameters(),b=this.jQuery,c=this.getParameter('close_icon');c&&(this._closeIcon=c);var d=this.getParameter('close_icon_hover');d&&(this._closeIconHover=d);var e=this;if(this._addContent(a,b),b('.bcToaster .bcClose').click(function(){e._manuallyClosed=!0,e._hideToaster()}),this.emptyElementsWithAttribute(b('.bcToaster').get(0),'div','data-bc-external'),this.handleComplexElements(b('.bcToaster').get(0)),this.positionDivs(),this.isInEditMode)e._showToaster();else{var f=[],g=0,h=this.getParameter('triggerWhen');h?(g=100,f.push(this._convertWhenSettingPreviousToasterVersion(h))):(f=a.selected_when&&0!==a.selected_when.length?a.selected_when:['onPageLoad'],g=a.scroll_depth&&a.scroll_depth[0]&&!isNaN(a.scroll_depth[0])?parseInt(a.scroll_depth[0]):0);for(var j=this.getParameter('click_selector'),k=this.getParameter('content_condition'),l=0;l<f.length;l++)switch(f[l]){case'click_selector':this._addClickTriggerBindings(j);break;case'content_condition':this._addContentPolling(k);break;case'scroll_depth':this._addScrollBinding(g);break;case'triggerOn':this._addScrollOn(e);break;default:e._checkDelayBeforeTrigger();}this._setupFrontEndBindings()}},_setupFrontEndBindings:function(){var a=this.jQuery('.bcToasterDontShowAgainLink'),b=this.jQuery('.bcToasterCloseButton');0<a.length&&a.off('click.dontShowAgainLinks').on('click.dontShowAgainLinks',this.jQuery.proxy(function(a){a.preventDefault(),this.blueConicClient.doNotShowAgain(this.context.getInteractionId()),this._hideToaster()},this)),0<b.length&&b.off('click.closeButtons').on('click.closeButtons',this.jQuery.proxy(function(){this._hideToaster()},this)),this._addCloseEventHandler()},_convertWhenSettingPreviousToasterVersion:function(a){return'scroll'===a?'triggerOn':'reachedBottom'===a?'scroll_depth':'onPageLoad'},_addCloseEventHandler:function(){this.blueConicClient.event.subscribe('closeoverlay',this,function(a,b){b instanceof Array&&b[0]===this.context.getInteractionId()&&this._hideToaster()})},_addScrollOn:function(a){var b=this.jQuery;b(window).scroll(function(){a._checkDelayBeforeTrigger()})},_checkScrollCondition:function(a){var b=this.jQuery(window).scrollTop(),c=this.jQuery(document).height(),d=100*(b/(c-window.innerHeight));d>=a&&this._checkDelayBeforeTrigger()},_addScrollBinding:function(a){this._checkScrollCondition(a),this.jQuery(window).scroll(this.jQuery.proxy(function(){this._checkScrollCondition(a)},this))},_addClickTriggerBindings:function(a){try{var b=this.jQuery(a);this.clickTrigger=!0,0<b.length?b.off('click.toaster').on('click.toaster',this.jQuery.proxy(function(){this.jQuery('.bcToaster').get(0)?this._checkDelayBeforeTrigger(!0):!this.open&&this._setupToasterBeforeToShow()},this)):this.blueConicClient.position.subscribe(a,this,this.jQuery.proxy(this._addClickTriggerBindings,this,a))}catch(a){}},_setupToasterBeforeToShow:function(){this.handleStyling(this.getParameter('close_icon'),this.getParameter('close_icon_hover')),this.handleJavascript(),this._addContent(null,this.jQuery);var a=this;this.jQuery('.bcToaster .bcClose').click(function(){a._hideToaster()}),this.clickTrigger=!0,this._checkDelayBeforeTrigger()},_addContentPolling:function(a){this._checkContentCondition(a);var b=this,c=document.getElementsByTagName('body')[0],d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(d)this._observer=new MutationObserver(function(){b._observeContentChanges(a)}),this._observer.observe(c,{childList:!0,subtree:!0});else if(window.addEventListener)this._eventListenerFunction=function(){b._observeContentChanges(a)},c.addEventListener('DOMNodeInserted',this._eventListenerFunction,!1);else var e=setInterval(function(){b.open?clearInterval(e):b._checkContentCondition(a)},500)},_observeContentChanges:function(a){if(this.open){if(this._observer)this._observer.disconnect();else{var b=document.getElementsByTagName('body')[0];b.removeEventListener('DOMNodeInserted',this._eventListenerFunction,!1)}return}var c=this,d=new Date().getTime();this._timestamp=d,setTimeout(function(){c._timestamp!==d||c.open||c._checkContentCondition(a)},250)},_checkContentCondition:function(a){0<this.jQuery(a).length&&this.jQuery(a).html()&&0<this.jQuery(a).html().length&&this._checkDelayBeforeTrigger()},_addContent:function(a,b){var c=this.getParameter('content');if(c&&-1!==c.indexOf('<body></body>')&&(c=''),!c){var d='nl'===this.context.getLocale()?'nl':'default';c=this.html[d].content}c=this.template?'<div class="bcToaster" style="visibility:hidden;"><div class="bcCloseWrapper"><div class="bcClose"><div></div></div></div><div class="bcToasterContent bcTemplateContent">'+c+'</div></div>':'<div class="bcToaster" style="visibility:hidden;"><div class="bcCloseWrapper"><div class="bcClose"><div></div></div></div><div class="bcToasterContent">'+c+'</div></div>';var e=b(c),f=this.getParameter('close_icon'),g='true'===this.getParameter('custom_close');g&&f?e.removeClass('bcDefaultClose'):e.addClass('bcDefaultClose');try{e.appendTo(b('body'))}catch(a){this.isInEditMode&&console.error('Error caught: '+a)}},handleComplexElements:function(a){for(var b=this.getElementsWithAttribute(a,'div','data-bc-pluginid'),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute('data-bc-pluginid'),f=d.getAttribute('data-bc-config');if(f)try{var g=f.replace(/\n/g,'\\\\n').replace(/\r/g,'\\\\r').replace(/\t/g,'\\\\t');f=this.blueConicClient.json.parse(g)}catch(a){f=null}this.blueConicClient.event.publish('bcComplexObject',{plugin:e,config:f,node:d,interactionId:this.context.getInteractionId()}),this.isInEditMode||(d.removeAttribute('data-bc-pluginid'),d.removeAttribute('data-bc-config'))}},emptyElementsWithAttribute:function(a,b,c){for(var d,e=this.getElementsWithAttribute(a,b,c),f=0,g=e.length;f<g;f++)d=e[f],d.innerHTML=''},getElementsWithAttribute:function(a,b,c){for(var d,e=[],f=a.getElementsByTagName(b),g=0,h=f.length;g<h;g++)d=f[g],d.getAttribute(c)&&e.push(d);return e},_positionFromPerpendicularEdge:function(){var a=Math.max,b=this.jQuery,c=this.getParameter('location')||'right',d=this.getParameter('pixelsFrom')?this.getParameter('pixelsFrom'):'',e=this.getParameter('locationFrom')?this.getParameter('locationFrom'):'left_or_top';if(this.getParameter('locationFrom')||this.getParameter('version')||(e='right_or_bottom'),d||0===d){var f='left'===c||'right'===c?'left_or_top'===e?'top':'bottom':'left_or_top'===e?'left':'right';b('.bcToaster').css(f,d+'px'),b('.bcToaster').css(c,0)}else{var g=b('.bcToasterContent').get(0).getBoundingClientRect();if('left'===c||'right'===c){var h=window.innerHeight||document.documentElement.clientHeight,i=g.height||g.bottom-g.top;b('.bcToaster').css('top',a((h-i)/2,0)+'px'),b('.bcToaster').css('left'===c?'left':'right',0)}else{var j=window.innerWidth||document.documentElement.clientWidth,k=g.width||g.right-g.left;b('.bcToaster').css('left',a((j-k)/2,0)+'px'),b('.bcToaster').css('top'===c?'top':'bottom',0)}}},positionDivs:function(){var a=this.jQuery,b=this.getParameter('location')||'right',c=this._getShowClose();this._positionFromPerpendicularEdge(),'left'===b?a('.bcToaster').removeClass('bcRight').removeClass('bcTop').removeClass('bcBottom').addClass('bcLeft'):'right'===b?a('.bcToaster').removeClass('bcLeft').removeClass('bcTop').removeClass('bcBottom').addClass('bcRight'):'top'===b?(a('.bcToaster .bcToasterContent').after(a('.bcToaster .bcCloseWrapper')),a('.bcToaster').removeClass('bcRight').removeClass('bcBottom').removeClass('bcLeft').addClass('bcTop')):a('.bcToaster').removeClass('bcRight').removeClass('bcTop').removeClass('bcLeft').addClass('bcBottom'),c?a('.bcToaster').addClass('bcShowClose'):a('.bcToaster').removeClass('bcShowClose')},handleStyling:function(a,b){var c=this.jQuery,d='',e=this._getShowClose();e?c('.bcToaster').addClass('bcShowClose'):c('.bcToaster').removeClass('bcShowClose');var f='true'===this.getParameter('custom_close');if(f&&a){c('.bcToaster').removeClass('bcDefaultClose'),d+='.bcToaster .bcClose > div { background-image: none;}';var g=this.getParameter('version'),h='.bcToaster .bcClose {background-image: url(\''+a+'\');background-repeat: no-repeat;background-color: transparent;',i='.bcToaster .bcClose:hover {background-image: url(\''+b+'\');';'3'===g?(d+=h+'background-position: center center;background-size: contain;}',b&&(d+=i+'}')):(d+=h+'}',b?d+=i+'background-position: 0px 0px;}':c('.bcToaster .bcClose:hover').css('background-position',''))}else c('.bcToaster').addClass('bcDefaultClose');var j=this.getParameter('close_position'),k=this.getParameter('close_padding');d+=this._addClosePositionStyling(j,k);var l=this.getParameter('styling_css');l&&(this.stylingUrl=l,this.blueConicClient.util.loadCSS(l));var m=this.getParameter('styling_css_inline');m&&(d+=m.replace(/&#xd;/gi,'')),d&&(this.inlineCss=c('<style>'+d+'</style>'),this.inlineCss.appendTo(c('head')))},handleJavascript:function(){var a=this.jQuery,b=this.getParameters('javascript_urls'),c=[];if(b){this.javascriptUrls=b;for(var d=0;d<b.length;d++)c.push(this._getLoadScriptDeferred(b[d]))}return a.when.apply(a,c)},_getLoadScriptDeferred:function(a){var b=this.jQuery,c=b.Deferred();return this.blueConicClient.util.loadScript(a,this,function(){c.resolve()}),c},_getShowClose:function(){var a=!1,b=this.getParameter('show_close');return'true'===b||'false'===b||!0===b||!1===b?'true'===b||!0===b:(a=!!this.getParameter('close')&&'showClose'===this.getParameter('close'),this.getParameter('showClose')&&(a=!0),a)},_hideToaster:function(){if(!this.isInEditMode){var a=this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId());this.blueConicClient._renderedInteractions.splice(a,1);var b=this.jQuery,c=b('.bcToasterContent').get(0).getBoundingClientRect(),d=this.getParameter('location')||'right',e=this._getShowClose(),f='left'===d||'right'===d?c.width:c.height;this._setToasterEffect(!0,e,f),window.setTimeout(b.proxy(function(){this.clickTrigger&&(this.open=!1)},this),501)}},_checkDelayBeforeTrigger:function(a){var b=this.context.getParameters(),c=b.delay&&b.delay[0]&&!isNaN(b.delay[0])?1e3*parseInt(b.delay[0]):0;0<c?window.setTimeout(this.jQuery.proxy(function(){this._showToaster(a)},this),c):this._showToaster(a)},_showToaster:function(a){var b=this,c=this.jQuery;if(!this._manuallyClosed||this.isInEditMode||a){if(0===c('.bcToasterContent').width()&&!a)return 10<this.nrOfTries?void 0:(this.nrOfTries++,void setTimeout(function(){b._showToaster(a)},500));if(!this.open){if(-1!==this.blueConicClient.util.array.indexOfArray(this.blueConicClient._renderedInteractions,this.context.getInteractionId()))return;this.blueConicClient._renderedInteractions.push(this.context.getInteractionId()),this.isInEditMode||this._viewEventThrown||(this._viewEventThrown=!0,this.blueConicClient.createEvent('VIEW',this.context.getInteractionId()));var d=this._getShowClose();this.positionDivs(),c('.bcToaster').css('visibility','visible'),c('.bcToaster').css('display','block'),c('.bcToaster').addClass('bcToasterOpen'),c(window).resize(c.proxy(function(){this.positionDivs()},this));var e=this.getParameter('click_event_selector');if(e){this.jQuery('body').one('click',e,this.jQuery.proxy(function(a){this.lastClickEvent&&this.lastClickEvent.originalEvent===a.originalEvent||this._logClickEvent(a)},this));try{this.jQuery(e).one('click',this.jQuery.proxy(function(a){this.lastClickEvent=a,this._logClickEvent(a)},this))}catch(a){}}this._setToasterEffect(!1,d);var f=b.getParameter('javascript');if(f&&!b.isInEditMode){f=f.replace(/(^|\W)blueConicVariantId(\W|$)/,'$1"'+b.context.getInteractionId()+'"$2');var g=b.jQuery('<script>'+f+'</script>');try{g.appendTo(b.jQuery('body'))}catch(a){console.error(a)}}this.open=!0,this.isInEditMode&&this.blueConicClient.event.publish('toaster.interactionLoaded',{interaction:this})}}},_logClickEvent:function(a){if(!(a&&a.originalEvent&&a.originalEvent._blueConicLoggedClickEvent===this.context.getInteractionId())){var b=a&&a.target&&a.target.pathname&&a.target.hostname&&0===a.target.pathname.indexOf('/s/')&&-1!==a.target.hostname.indexOf('blueconic');b||(a.originalEvent&&(a.originalEvent._blueConicLoggedClickEvent=this.context.getInteractionId()),this.blueConicClient.createEvent('CLICK',this.context.getInteractionId()))}},_setToasterEffect:function(a,b,c){var d=this.jQuery,e={},f=this.getParameter('location')||'right',g=b?this.closeButtonWidth+this.borderWidth:this.borderWidth,h=this.getParameter('effect');h||this.getParameter('version')||(h='slideIn');var i=this.getParameter('effect_slide_direction')||'left';e[f]='-'+(c+g)+'px';var j=h+'_'+i===this._effect;if(this.isInEditMode&&j&&(h='noEffect'),!(h&&'noEffect'!==h))a&&d('.bcToaster').css('display','none');else if('fadeIn'===h&&!a)d('.bcToaster').hide(),d('.bcToaster').fadeIn(500,function(){d('.bcToaster').addClass('bcToasterOpen')});else if('fadeIn'===h&&a)d('.bcToaster').fadeOut(500);else if('slideIn'===h&&!a){e[f]='0px';var k=d('.bcToasterContent').get(0).getBoundingClientRect(),l='left'===f||'right'===f?k.width:k.height;d('.bcToaster').css(f,'-'+(l+g)+'px'),d('.bcToaster').animate(e,500,function(){d('.bcToaster').addClass('bcToasterOpen')})}else'slideIn'===h&&a&&d('.bcToaster').animate(e,500,function(){d('.bcToaster').css('display','none')})},_addClosePositionStyling:function(a,b){var c='3'===this.getParameter('version');if(!a||!c)return'';(null===b||'NaN'===b)&&(b='5');var d='.bcToaster .bcClose {';switch(a){case'TOP_LEFT':d+='top:'+b+'px; right: unset; bottom: unset; left:'+b+'px;';break;case'BOTTOM_RIGHT':d+='top: unset; right: '+b+'px; bottom: '+b+'px; left: unset;';break;default:d+='top: '+b+'px; right: '+b+'px; bottom: unset; left: unset;';}return d+='}'},getParameter:function(a){return this.parameters[a]&&this.parameters[a][0]?this.parameters[a][0]:null},getParameters:function(a){return this.parameters[a]||null}});var a = [];var i='toaster';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.1.7/'},{ id : 'html', baseUrl : ps + 'html/1.0.10/'},{ id : 'image', baseUrl : ps + 'image/1.0.2/'},{ id : 'number', baseUrl : ps + 'number/1.0.2/'},{ id : 'string', baseUrl : ps + 'string/1.0.1/'}]);})();(function(){ var InteractionTypeImpl=InteractionType.extend({fallbackLabels:{content:{noStore:{nl:{name:"Titel van het artikel (Bron nog niet geselecteerd)",description:"Beschrijving van het artikel (Bron nog niet geselecteerd)"},"default":{name:"Title of the article (source not yet selected)",description:"Description of the article (source not yet selected)"}},noItems:{nl:{name:"Titel van het artikel (aanbevolen artikelen nog niet beschikbaar)",description:"Beschrijving van het artikel (aanbevolen artikelen nog niet beschikbaar)"},"default":{name:"Title of the article (recommended articles not yet available)",description:"Description of the article (recommended articles not yet available)"}}},product:{noStore:{nl:{name:"Titel van het product (Bron nog niet geselecteerd)",description:"Beschrijving van het product (Bron nog niet geselecteerd)"},"default":{name:"Title of the product (source not yet selected)",description:"Description of the product (source not yet selected)"}},noItems:{nl:{name:"Titel van het product (aanbevolen producten nog niet beschikbaar)",description:"Beschrijving van het product (aanbevolen producten nog niet beschikbaar)"},"default":{name:"Title of the product (recommended products not yet available)",description:"Description of the product (recommended products not yet available)"}}}},init:function(a,b){this.blueConicClient=a,this.profile=a.profile.getProfile(),this._templatesLoaded=[],this.baseURL=this.blueConicClient.getBaseURL(b.getInteractionTypeId()),this.context=b,this.locale=b.getLocale(),this.pluginId=b.getInteractionTypeId();var c=this;this.blueConicClient.event.subscribe("bcComplexObject",this,function(a,b){b&&b.plugin===c.pluginId&&(b.config.interactionId=b.interactionId,!this.blueConicClient.isInEditMode()&&(b.config.id=new Date().getTime()+Math.round(1e3*Math.random())),this.type="toolbar_content_recommendations"===b.plugin?"content":"product",c._setUniqueId(b.node,b.config.id),c._applyTemplate(b))}),this.blueConicClient.isInEditMode()&&this._subscribeEditModeEvents()},_subscribeEditModeEvents:function(){var a=this;this.blueConicClient.event.subscribe("recommendations.updateTemplate",this,function(b,c){var d=c.message.pluginId===a.pluginId;if(d){var e=c.message.config,f=a._createTemplateObject(c.message.template);a._addTemplateToCache(f);var g=a.jQuery(".bcComplexObject"+e.id)[0];a._applyTemplate({config:e,node:g})}}),this.blueConicClient.event.subscribe("recommendations.updateConfig",this,function(b,c){var d=c.message.pluginId===a.pluginId;if(d){var e=c.message.config,f=this._getProperties(e);e["data-bc-template-id"]=e&&e.styling&&e.styling.templateId?e.styling.templateId:"";var g="[data-bc-pluginid=\""+this.pluginId+"\"][data-bc-config*=\""+e.id+"\"]";a.jQuery(g).attr("data-bc-config",JSON.stringify(e)),0<f.length&&a.jQuery(g).attr("data-bc-preload",f.join(","));var h=a.jQuery(".bcComplexObject"+e.id)[0],i=[];if(e.exceptions&&e.exceptions.filterRules&&(i=e.exceptions.filterRules.filter(function(a){return a.property}).map(function(a){return a.property})),this.profile.loadValues(i,this,function(){a._applyTemplate({config:e,node:h})}),window.CKEDITOR&&window.CKEDITOR.instances&&0<Object.keys(window.CKEDITOR.instances).length){var j=window.CKEDITOR.instances[Object.keys(window.CKEDITOR.instances)[0]];j.fire("change")}}}),this.blueConicClient.event.subscribe("editorClosed",this,function(){a._sendMessage("recommendations.closeConfigurator")})},_getProperties:function(a){var b=a.exceptions||{},c=b&&b.filterRules?b.filterRules:[],d=[];if(c){var e=c.filter(function(a){return"property"===a.valueType});e.forEach(function(a){d.push(a.property)})}return d},_setUniqueId:function(a,b){this.jQuery(a).addClass("bcComplexObject"+b)},_applyTemplate:function(a){var b=this,c=a.config,d=c.styling.templateId;if(d){var e=".bcComplexObject"+c.id;this.jQuery(e).innerHTML="",this._loadTemplate(d,function(c){b._loadHTML(a,c)})}},_getLabelObject:function(a){return"nl"===this.locale?this.fallbackLabels[this.type][a].nl:this.fallbackLabels[this.type][a]["default"]},_getFallbackData:function(a,b){for(var c=this._getLabelObject(a),d=[],e=0;e<b;e++)d.push({name:[c.name],description:[c.description],image:[this.baseURL+"recommendations_rendering/images/fallback600x600.png?"]});return d},_initMetaDataService:function(a){var b=null;if(a["data-bc-connection-id"]){var c=this.context.getConnection(a["data-bc-connection-id"]);if(c){var d=c.getParameters().metadata;b=d?this.blueConicClient.json.parse(d):null}}this._metaDataService=new window.BlueConicMetaDataService(this.jQuery,b,this.type),this._metaDataService.blueConicClient=this.blueConicClient},_getItems:function(a){var b=this.jQuery;this._initMetaDataService(a);var c=b.Deferred(),d=a.styling.amount,e=this._getQueryStringParametersForRecommendations(a);return e.storeId?this.blueConicClient.recommendation.getRecommendations(e,b.proxy(function(a){var b=a.getItems();(!b||0===b.length)&&this.blueConicClient.isInEditMode()?c.resolve(this._getFallbackData("noItems",d)):c.resolve(b)},this)):c.resolve(this._getFallbackData("noStore",d)),c},_loadHTML:function(a,b){if(b){var c=this.jQuery,d=a.node,e=a.config;e.styling.amount||(e.styling.amount=4),this._handleStyling(e,b);var f=this._getWidthClass(d),g=c("<div class=\""+f+"\" data-bc-external=\"true\" data-bc-id=\""+e.id+"\"></div>");return this._getItems(e).then(c.proxy(function(d){if(0===d.length)return void c(".bcComplexObject"+a.config.id).empty();var f=this._getDataObject(d,e.styling.amount,e.interactionId);this._renderTemplate(f,b,g);var h=c(".bcComplexObject"+a.config.id);h.empty();for(var k=0;k<d.length;k++)if(d[k].ID&&d[k].ID[0]&&d[k].URL&&d[k].URL[0])for(var i=g.find("a[href^=\""+d[k].URL[0]+"\"]"),l=0;l<i.length;l++)i[l].setAttribute("data-bc-item-id",d[k].ID[0]);if(g.appendTo(h),!this.blueConicClient.isInEditMode()){var j=d[0].recommendationId&&d[0].recommendationId[0]?d[0].recommendationId[0]:null;this._bindClicks(g,j,e)}if(b.getJavaScript()){var m=b.getJavaScript(),n=document.createElement("script");n.type="text/javascript",n.appendChild(document.createTextNode(m));var o=document.getElementsByTagName("head")[0]||document.documentElement;try{o.insertBefore(n,o.firstChild)}catch(a){console.error(a)}}this._addOnResizeHandler(c(".bcComplexObject"+a.config.id),g)},this))}},_addOnResizeHandler:function(a,b){var c=this.jQuery;c(window).resize(c.proxy(function(){if(a&&b){for(var c=b.attr("class").split(" "),d="",e=0;e<c.length;e++)if(-1!==c[e].search("^bcp.*Width$")){d=c[e];break}var f=this._getWidthClass(a[0]);d!==f&&(b.removeClass(d),b.addClass(f))}},this))},_renderTemplate:function(a,b,c){if(a&&b&&window.Mustache){var d=b.getHtml().replace(/<img\s+src=(['"]{{image}}['"])/,"<img data-bc-src=$1"),e=window.Mustache.to_html(d,a);c.empty(),c.append(e),c.find("img[data-bc-src]").each(this.jQuery.proxy(function(a,b){var c=this.jQuery(b),d=c.attr("data-bc-src"),e=c.attr("width");isNaN(e)||(d+="&width="+e);var f=c.attr("height");isNaN(f)||(d+="&height="+f),c.attr("src",d),c.removeAttr("data-bc-src")},this))}},_getWidthClass:function(a){return 480>=a.clientWidth?"bcpSmallWidth":1024<=a.clientWidth?"bcpMaxWidth":"bcpDefaultWidth"},_getUrl:function(){var a=this.jQuery("meta[property=\"og:url\"]").attr("content")||this.jQuery("link[rel=\"canonical\"]").attr("href")||window.location.protocol+"//"+window.location.host+window.location.pathname;return a.split("?")[0]},_getQueryStringParametersForRecommendations:function(a){var b=a.styling.amount,c=a.sources,d={count:b,storeId:c,itemId:this._metaDataService.getItemId(document.location.toString())};"No profile present and will not be created."!==this.profile.getId()&&(d.profileId=this.profile.getId()),a.debug&&(d.debug=!0);var e=a.strategy||{};e&&(d=this._getStrategy(e,d));var f=a.exceptions||{};return f&&(d=this._getExceptions(f,d)),f.useFrequencyCap&&f.frequencyCap&&!isNaN(f.frequencyCap)&&!this.blueConicClient.isInEditMode()&&(d.frequencyCap=f.frequencyCap),d},_getStrategy:function(a,b){var c=[];if(a.boostLevels){a.boostLevels=this._convertToBoostLevels(a);for(var d,e=0;e<a.boostLevels.length;e++)d=a.boostLevels[e],c.push({algorithm:d.algorithm,value:+d.value.toString().replace(",","."),rampup:d.rampup})}return b.boosts=this.blueConicClient.json.stringify(c),b},_convertToBoostLevels:function(a){var b=a.boostLevels||[],c=a.rampUp||"NORMAL";if(!this.blueConicClient.util.array.isArray(b)){var d=[];for(var e in b)d.push({value:b[e],algorithm:e,rampup:c});delete a.rampUp,b=d}return b},_getExceptions:function(a,b){var c=[];for(var d in a)if("filters"==d){if(a.filters&&0<a.filters.length)for(var e=0;e<a.filters.length;e++)c.push(a.filters[e]);}else if("filterRules"==d){var f=a.filterRules;if(f&&0<f.length)for(var g,h=0;h<f.length;h++)if(g=this._handleFilterRules(f[h],this._metaDataService),g&&g.constructor===Array&&0<g.length)for(var i=0;i<g.length;i++)c.push(g[i]);else g&&c.push(g)}else"hideReadArticles"!=d||!0!==a[d]||this.blueConicClient.isInEditMode()?"frequencyCap"!=d&&(b[d]=a[d]):c.push("viewed");return b.filter=c,b},_handleFilterRules:function(a,b){if("MUSTNOTBEEMPTY"===a.operatorSetting)return"hasproperty:"+a.metaDataField;if("MUSTBEEMPTY"===a.operatorSetting)return"!hasproperty:"+a.metaDataField;var c=this._getValues(a,b,b.getMetaDataFields());if(0<c.length)switch(a.operatorSetting){case"DOESNOTCONTAIN":for(var d=[],e=0;e<c.length;e++)d.push("!"+a.metaDataField+":"+c[e]);return d;case"CONTAINSALL":for(var f=[],g=0;g<c.length;g++)f.push(a.metaDataField+":"+c[g]);return f;case"DOESNOTCONTAINALL":return"!"+a.metaDataField+":"+c.join(",");default:return a.metaDataField+":"+c.join(",");}},_getValues:function(a,b,c){if("values"===a.valueType&&0<a.values.length)return a.values;if("property"===a.valueType)return this.profile.getValues(a.property);if(c){for(var d=0;d<c.length;d++)if(c[d].fieldId===a.metaDataField)return b.getFieldValues(c[d]);}else return b.getFieldValues({fieldId:a.metaDataField,type:"default"});return[]},_handleEvent:function(a,b,c,d,e,f,g,h,i){if(d){if(!c)return void(document.location.href=b);var j={storeId:d,action:a,itemId:c,url:b};if("No profile present and will not be created."!==this.profile.getId()&&(j.profileId=this.profile.getId()),g&&f&&(j.debug=!0,j.recommendationId=f),"click"===a){if(i&&i.originalEvent&&i.originalEvent._blueConicLoggedClickEvent===e)return;i&&i.originalEvent&&(i.originalEvent._blueConicLoggedClickEvent=e),this.blueConicClient.createEvent("CLICK",e)}this.blueConicClient.recommendation.createEvent(j,function(){"click"===a&&(h?window.open(b,h):document.location.href=b)})}},_bindClicks:function(a,b,c){var d=c.sources,e=c.interactionId;this.jQuery(a).find("a[data-bc-item-id]").each(this.jQuery.proxy(function(a,f){var g=this.jQuery(f);g.one("click",this.jQuery.proxy(function(a){a.preventDefault(),this._handleEvent("click",g.attr("href"),g.data("bc-item-id"),d,e,b,c.debug,g.attr("target"),a)},this))},this))},_getDataObject:function(a,b,c){var d,e=a.length;for(d=0;d<a.length;d++)a[d].isFirstItem=0===d,a[d].isLastItem=d===e-1,a[d].index=d;b&&(a=a.slice(0,b));var f=null;return c&&(f=this.blueConicClient.getInteractionNamesById(c)||{id:c}),{interaction:f,recommendations:a}},_sendMessage:function(a,b){this.blueConicClient.fn.postMessage&&this.blueConicClient.fn.postMessage(a,b)},_handleStyling:function(a,b){var c=a.styling,d=a.id;this._appendTemplateCss(b,d),this._setCssUrl(c,d),this._appendCustomCss(c,d)},_appendTemplateCss:function(a,b){var c=this.jQuery,d="bcTemplateCss"+b;c("."+d).remove();var e="";if(a&&a.getCss()){e+=a.getCss();var f=c("<style>"+e+"</style>");f.addClass(d),f.appendTo(c("head"))}},_appendCustomCss:function(a,b){var c=this.jQuery,d="bcCustomCss"+b;if(c("."+d).remove(),a&&a.customCSS){var e=a.customCSS,f=c("<style>"+e+"</style>");f.addClass(d),f.appendTo(c("head"))}},_setCssUrl:function(a,b){var c=this.jQuery;if(!this.blueConicClient.isInEditMode&&a&&a.cssURLNode)this.blueConicClient.util.loadCSS(a.cssURLNode);else{var d="bcCssUrl"+b;if(c("#"+d).remove(),a&&a.cssURLNode){var e=c("<link>",{id:d,rel:"stylesheet",type:"text/css",href:a.cssURLNode});e.appendTo("head")}}},_loadTemplate:function(a,b){if(!this.blueConicClient.isInEditMode)return this.blueConicClient.getTemplate(a,b);var c=this._getTemplateFromCache(a);if(c)return b(c);var d=this;this.blueConicClient.getTemplate(a,function(a){return d._templatesLoaded.push(a),b(a)})},_getTemplateFromCache:function(a){for(var b=0;b<this._templatesLoaded.length;b++)if(this._templatesLoaded[b].getId()===a)return this._templatesLoaded[b];return null},_addTemplateToCache:function(a){for(var b=a.getId(),c=0;c<this._templatesLoaded.length;c++)if(this._templatesLoaded[c].getId()===b)return void(this._templatesLoaded[c]=a);this._templatesLoaded.push(a)},_createTemplateObject:function(a){var b={_css:(a.css||"").replace(/&#xd;/gi,""),_html:(a.html||"").replace(/&#xd;/gi,""),_id:a.id,_javascript:(a.javaScript||"").replace(/&#xd;/gi,""),_precompiledTemplate:a.precompiledTemplate,getHtml:function(){return this._html},getCss:function(){return this._css},getJavaScript:function(){return this._javascript},getId:function(){return this._id}};return b}});var a = [];var i='toolbar_content_recommendations';a.push({url: 'http://code.jquery.com/jquery-1.11.2.min.js', sharing: 'local'});a.push({url: p + i + '/1.3.22/recommendations_rendering/lib/mustache-2.2.1.min.js', sharing: 'local'});a.push({url: p + i + '/1.3.22/js/metaDataService/metaDataService.js', sharing: 'local'});blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : ps + i + '/1.3.22/'}]);})();(function(){ 
var InteractionTypeImpl=InteractionType.extend({init:function(a,b){this.blueConicClient=a;this.context=b},onLoad:function(){window.bcUrlListenerActive||(window.bcUrlListenerActive=!0,window.history&&window.history.pushState&&(window.history.pushState=function(a,b){return function(){b.handlePageView();a.apply(this,arguments)}}(window.history.pushState,this.blueConicClient)))}});
var a = [];var i='urllistenerinteractiontype_hearst';blueConic.fn.registerInteractionType(i, InteractionTypeImpl, a, [{ id : i, baseUrl : 'https://hearst.blueconic.net/plugins/urllistenerinteractiontype_hearst/ts_81e3a5301a9dcbbcce5b0186a790881c/'}]);})();})(blueConicClient);