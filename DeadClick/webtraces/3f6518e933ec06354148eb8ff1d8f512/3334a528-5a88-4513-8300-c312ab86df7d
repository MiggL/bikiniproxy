var AOL=AOL||{};AOL.Search=AOL.Search||{},AOL.Search.AutoComplete={inst:[],Construct:function(t,e){try{AOL.Search.AutoComplete.inst.push(this);var s=AOL.Search.AutoComplete.inst.length-1;return AOL.Search.AutoComplete.inst[s].globalId=s,this.init(t,e),AOL.Search.AutoComplete.inst[s]}catch(i){}}},AOL.Search.AutoComplete.Construct.prototype={EL:{},CONF:{},ENV:{ua:navigator.userAgent},noMatchStrLen:999,lastRequest:!1,update:function(t){t=t.replace(/^\s+(.*)$/,"$1"),t.length<this.noMatchStrLen&&t.length>=1?(t!=this.lastRequest&&AOL.Search.Helpers.Http.jsonp(this.CONF.serviceUrl+escape(t.toLowerCase())),this.lastRequest=t):this.reset()},cb:function(t){if(this.typedQuery=t[0],t[1].length>0){var e=this.EL.acList;t[0]=t[0].replace(/([\.\<\>\{\}\[\]\*\+])/g,"\\$1"),this.CONF.showAbove?(e.innerHTML=("<li style='display:none'>"+t[0]+"</li><li>"+t[1].slice(0,this.CONF.numSuggestions).reverse().join("</li><li>")).replace(new RegExp(">("+t[0]+")","gi"),"><strong>$1</strong>")+"</li>",this.realignY(!0)):e.innerHTML=("<li style='display:none'>"+t[0]+"</li><li>"+t[1].slice(0,this.CONF.numSuggestions).join("</li><li>")).replace(new RegExp(">("+t[0]+")","gi"),"><strong>$1</strong>")+"</li>",e.innerHTML=e.innerHTML.replace(this.removeCommasRegex,"</li>").replace(/,\d+<\/li>/gim,"</li>"),this.suggestions=e.getElementsByTagName("li"),e.style.visibility="visible",e.style.display="block";for(var s=this,i=0;i<this.suggestions.length;i++)this.suggestions[i].onclick=function(){try{s.CONF.invType=s.EL.form.s_it.value||s.EL.form.invocationType.value}catch(t){s.CONF.invType=this.d[s.CONF.searchType.toLowerCase()][1]||"temp_"+s.CONF.searchType}s.EL.form.s_it.value=s.CONF.invType.replace(/(\.a)+$/,"")+".a","undefined"!=typeof s.EL.form.s_qt&&(s.EL.form.s_qt.value="ac"),s.EL.inputBox.value=AOL.Search.Helpers.htmlEntityDecode(this.innerHTML.replace(/<.*?>/g,"")),s.EL.form.submit(),"undefined"!=typeof s.EL.form.s_qt&&(s.EL.form.s_qt.value="")},this.suggestions[i].onmouseover=function(){s.browse(this)};this.noMatchStrLen=999}else this.reset(t[0].length+1)},browse:function(t,e){for(var s=0;s<this.suggestions.length;s++)this.suggestions[s].className=" ";if(t){if("object"==typeof t?this.current=t:this.current="+1"==t?this.current.previousSibling||this.suggestions[this.suggestions.length-1]:this.current.nextSibling||this.suggestions[1],this.current.className="over",e){try{this.CONF.invType=this.EL.form.s_it.value||this.EL.form.invocationType.value}catch(i){this.CONF.invType=this.d[this.CONF.searchType.toLowerCase()][1]||"temp_"+this.CONF.searchType}this.EL.form.s_it.value=this.CONF.invType.toString().replace(/(\.a)+$/,"")+".a","undefined"!=typeof this.EL.form.s_qt&&(this.EL.form.s_qt.value="ac"),this.EL.inputBox.value=this.current.innerHTML.replace(/<.*?>/g,"")}this.EL.inputBox.value.match(/&/)&&(this.EL.inputBox.value=AOL.Search.Helpers.htmlEntityDecode(this.EL.inputBox.value))}},realignX:function(){this.EL.acList.style.left=("number"==typeof this.CONF.cssProps.left?this.CONF.cssProps.left:this.EL.inputBox.pos.x)+this.CONF.adjust.x+"px"},realignY:function(t){this.EL.acList.style.top=t?("number"==typeof this.CONF.cssProps.top?this.CONF.cssProps.top:this.EL.inputBox.pos.y)-this.EL.acList.offsetHeight+this.CONF.adjust.y+"px":("number"==typeof this.CONF.cssProps.top?this.CONF.cssProps.top:this.EL.inputBox.pos.y+this.EL.inputBox.offsetHeight)+this.CONF.adjust.y+"px"},setWidth:function(){this.EL.acList.style.width=(this.CONF.adjust.width||this.EL.inputBox.offsetWidth)+"px"},setCSSProps:function(){if("object"==typeof this.CONF.cssProps&&null!==this.CONF.cssProps)for(var t in this.CONF.cssProps)"top"!==t&&"left"!==t&&(this.EL.acList.style[t]=this.CONF.cssProps[t])},reset:function(t,e){this.lastRequest=!1,this.EL.inputBox.pos=AOL.Search.Helpers.getPos(this.EL.inputBox),this.EL.acList.style.visibility="hidden",this.realignX(),this.realignY(this.CONF.showAbove),this.setWidth(),this.noMatchStrLen=t||this.noMatchStrLen,this.current=!1,e&&(this.EL.inputBox.value=this.typedQuery||""),"undefined"!=typeof this.EL.form.s_qt&&(this.EL.form.s_qt.value="")},disable:function(){this.reset(),this.EL.inputBox.onkeyup=null},enable:function(){var t=this;this.EL.inputBox.onkeyup=function(e){var s="undefined"!=typeof event?window.event.keyCode:e.keyCode;switch(s){case 27:t.reset(!1,!0);break;case 40:t.browse("-1",!0);break;case 38:t.browse("+1",!0);break;case 13:t.disable();break;case 8:t.update(this.value);break;default:t.update(this.value)}},this.d=AOL.Search.AutoComplete.Config[this.CONF.locale.toLowerCase()];try{this.CONF.invType=this.EL.form.s_it.value||this.EL.form.invocationType.value}catch(e){this.CONF.invType=this.d[this.CONF.searchType.toLowerCase()][1].default_sit||"temp_"+this.CONF.searchType}this.CONF.searchType.toLowerCase().match(/^cse_/)?(AOL.Search.AutoComplete.inst["i"+this.globalId]=AOL.Search.AutoComplete.inst[this.globalId],this.CONF.serviceUrl=(this.d[this.CONF.searchType.toLowerCase()][1].serviceUrl||this.CONF.serviceUrl||this.d.SERVICE_URL)+"&callback=AOL.Search.AutoComplete.inst.i"+this.globalId+".cb&q="):this.CONF.serviceUrl=(this.d[this.CONF.searchType.toLowerCase()][1].serviceUrl||this.CONF.serviceUrl||this.d.SERVICE_URL)+"?output=json&it="+this.CONF.invType+"&count="+this.CONF.numSuggestions+"&lang="+this.CONF.locale.replace("_","-")+"&locale="+this.CONF.localeID+"&cb=AOL.Search.AutoComplete.inst["+this.globalId+"].cb&q=",AOL.Search.Helpers.addEvent(this.EL.inputBox,"blur",function(){setTimeout(function(){t.reset()},300)}),AOL.Search.Helpers.addEvent(this.EL.inputBox,"click",function(){t.reset()}),AOL.Search.Helpers.addEvent(window,"resize",function(){t.reset()})},init:function(t,e){this.CONF=e;var s=window.location.hostname.toLowerCase().replace(/^(www\.)*(.*?)\.sandbox\.eusearch.*$/g,"$2"),i="en_GB";if(this.CONF.searchType.match(/autodetect/i))for(var o in AOL.Search.AutoComplete.AutoDetectMap)window.location.hostname.match(new RegExp(o,"i"))&&(s=o,this.CONF.searchType=AOL.Search.AutoComplete.AutoDetectMap[s].dictionary,this.CONF.locale=this.CONF.locale||AOL.Search.AutoComplete.AutoDetectMap[s].locale||"en_GB");switch("autodetect"==this.CONF.searchType&&(this.CONF.searchType="web"),!0){case/aol\.de/i.test(s):i="de_DE";break;case/aol\.fr/i.test(s):i="fr_FR";break;case/aol\.co\./i.test(s):i="en_GB"}this.CONF.locale=this.CONF.locale||i,this.CONF.localeID=this.CONF.locale.substr(this.CONF.locale.search("_")+1),e.adjust=e.adjust||{},e.cssProps=e.cssProps||{},this.CONF.adjust={width:e.adjust.width||!1,x:e.adjust.x||0,y:e.adjust.y||0},this.CONF.numSuggestions=this.CONF.numSuggestions||8,this.EL={inputBox:"string"==typeof t?document.getElementById(t):t,acList:document.createElement("ul")},this.EL.acList.className="aolSearchAutoComp",this.CONF.className&&(this.EL.acList.className+=" "+this.CONF.className),this.CONF.id&&(this.EL.acList.id=this.CONF.id),this.EL.form=this.EL.inputBox;do this.EL.form=this.EL.form.parentNode;while("form"!=this.EL.form.nodeName.toLowerCase());this.setWidth(),this.setCSSProps(),this.CONF.css&&this.EL.acList.setAttribute("style",this.CONF.css),this.removeCommasRegex=new RegExp(",</li>","mig"),this.EL.acList.style.position="absolute",this.EL.acList.innerHTML="",this.EL.inputBox.setAttribute("autocomplete","off"),this.CONF.appendTo=this.CONF.appendTo||document.body,this.CONF.appendTo.appendChild(this.EL.acList),this.enable(),this.reset()}};