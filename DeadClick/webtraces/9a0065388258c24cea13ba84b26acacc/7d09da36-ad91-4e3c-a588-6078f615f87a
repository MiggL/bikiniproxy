define(["vfdp-s7-viewer.helpers","vfdp-s7-viewer.sdk"],function(a){var b=function(e,f){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.INFO){console.log("Creating a new VFDP Platform Viewer")}this.id=a.getUniqueId();this.ready=false;this.sdk_ready=false;this.stack=[];this.isActiveViewer=false;this.prototypeDependencies=["s7sdk.common.Button","s7sdk.common.ControlBar"];if(!this.init){this.init=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.error("The Viewer prototype.init method was called without being defined")}}}var c=this;a.map(this.config.getConfig(main.screen.size()).Viewer[f].modifiers,function(h,g){c.params.push(g,h)});var d=a.extend(this.prototypeDependencies,this.SDKDependencies);a.map(d,function(h,g){s7sdk.Util.lib.include(h)});this.queue=function(h,g){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer queue",h,g,this)}if(typeof h==="function"){this.stack.push({method:h,args:g});if(this.ready){this.emptyQueue()}}};this.emptyQueue=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer emptyQueue")}while(this.stack.length){var g=this.stack.shift();g.method.apply(this,g.args)}this.ready=true};if(!c.destroy){c.destroy=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer destroy")}c.ControlBar.dispose();c.Viewer.dispose()}}this._hide=this.hide||function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer hide")}this.Viewer.hide();this.ControlBar.hide()};this.hide=function(){this.queue(function(){this.isActiveViewer=false});this.queue(this._hide,arguments)};this._show=this.show||function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer show",this)}this.Viewer.show();this.ControlBar.show()};this.show=function(){this.queue(function(){this.isActiveViewer=true});this.queue(this._show,arguments)};this._resize=this.resize||function(h,g){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer _resize")}if(this.currentWidth!=h||this.currentHeight!=g){this.currentWidth=h;this.currentHeight=g;this.Viewer.resize(h,g)}};this.resize=function(){this.queue(this._resize,arguments)};this._setItem=this.setItem||function(g){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer _setItem",arguments)}this.Viewer.setItem(g)};this._validateItem=function(h){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer validateItem",h,arguments)}if(this.type.indexOf(h.type)===-1){this.hide();return}var g=this.Viewer.component.getCurrentAsset();if(g===h){this.show();return}this.setItemCache(g);this.applyItemCache(h);this._setItem(h);this.show();return};this.setItem=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer setItem")}this.queue(this._validateItem,arguments)};this._setModifier=this.setModifier||function(g){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Viewer setModifier",g)}this.Viewer.setModifier(g)};this.setModifier=function(){this.queue(this._setModifier,arguments)};if(!this.setItemCache){this.setItemCache=function(g){return}}if(!this.applyItemCache){this.applyItemCache=function(g){return}}this.params.addEventListener(s7sdk.Event.SDK_READY,function(g){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.CONFIG){console.log("viewer-prototype.SDKReady",c.sdk_ready)}if(c.sdk_ready){return}c.sdk_ready=true;var h=e.split(".");c.ViewerWrapper=new s7sdk.common.Container(c.Container.getInnerContainerId(),c.params,c.Container.getInnerContainerId()+"-"+f+"-wrapper");if(!c.Viewer){c.Viewer=new s7sdk[h[0]][h[1]](c.ViewerWrapper.getInnerContainerId(),c.params,c.ViewerWrapper.getInnerContainerId()+"-"+f)}c.ViewerWrapper.component.obj.className+=" "+f+"-ViewerWrapper";c.Viewer.hide=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Hiding the ViewerWrapper from the prototype",c,this)}c.ViewerWrapper.setCSS(f+"-ViewerWrapper","display","none")};c.Viewer.show=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Showing the ViewerWrapper from the prototype",c,this)}c.ViewerWrapper.setCSS(f+"-ViewerWrapper","display","block")};c.ControlBar=new s7sdk.common.ControlBar(c.ViewerWrapper.getInnerContainerId(),c.params,c.Viewer.getId()+"-control-bar");c.ControlBar.component.obj.className+=" "+f;c.ControlBar.attachView(c.Viewer,false);c.ControlBar.hide=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Hiding the ControlBar from the prototype")}this.setCSS(".s7controlbar","display","none")};c.ControlBar.show=function(){if(s7sdk.Logger.traceLevel>=s7sdk.Logger.FINE){console.log("Showing the ControlBar from the prototype")}this.setCSS(".s7controlbar","display","block")};c.ControlBar.FullScreenButton=new s7sdk.common.FullScreenButton(c.ControlBar.getId(),c.params,c.ControlBar.getId()+"-fullScreenBtn");c.ControlBar.setModifier(c.config.getConfig(main.screen.size()).Viewer[f].ControlBar.modifiers);c.init();c.emptyQueue()},false);this.params.init();return this};return b});