var _ain=_ain||{};_ain.track=function(){function getSocial(e,t){function n(e,t,n,i){if("undefined"!=typeof Worker){void 0===i&&(i="");var a="";for(var o in t)a+="&"+o+"="+t[o];var r=new Blob([i+"var cb = function(val) { postMessage(val) };try { importScripts('"+e+"?callback=cb"+a+"&x="+Math.random()+"'); } catch (ex) {}"],{type:"text/javascript"}),s=window.URL.createObjectURL(r),c=new Worker(s);c.onmessage=function(e){n(e),c.terminate()},c.onerror=function(){},setTimeout(function(){c.terminate()},1e4)}}for(var i=["fb_count","vk_like","vk_share","ok_count","ln_count","pn_count","gp_count"],a=[0,1,2],o=[4,2,1],r=0,s=0;s<o.length;s++)r+=o[s];for(var c=[],d=0;d<a.length;){for(s=0;s<o[d];s++)c[c.length]=a[d];d++}switch(c[Math.floor(Math.random()*r)]){case 0:isSocialCountPredefined("fb_count")||n("https://graph.facebook.com/",{format:"jsonp",id:e,fields:"og_object{engagement{count}},share"},function(e){var n="";void 0!==e.data.og_object&&(n+="&fb_count="+e.data.og_object.engagement.count),void 0!==e.data.share&&(n+="&fb_share_count="+e.data.share.share_count),t(n)}),isSocialCountPredefined("vk_share")||n("https://vk.com/share.php",{act:"count",url:e},function(e){void 0!==e.data&&t("&vk_share="+e.data)},"var VK = { Share: { count: function(a, b){ postMessage(b); } }};");break;case 1:isSocialCountPredefined("ln_count")||n("https://www.linkedin.com/countserv/count/share",{format:"jsonp",url:e},function(e){void 0!==e.data.count&&t("&ln_count="+e.data.count)}),isSocialCountPredefined("pn_count")||n("https://api.pinterest.com/v1/urls/count.json",{url:e},function(e){void 0!==e.data.count&&t("&pn_count="+e.data.count)}),isSocialCountPredefined("ok_count")||n("https://connect.ok.ru/dk",{"st.cmd":"extLike",uid:"odklcnt0",ref:e},function(e){void 0!==e.data&&t("&ok_count="+e.data)},"var ODKL = { updateCount: function(a, b) { postMessage(b) }};");break;case 2:isSocialCountPredefined("gp_count")||function(e,t){var n='[{"method":"pos.plusones.get","id":"p","params":{"nolog":true,"id":"'+decodeURIComponent(e)+'","source":"widget","userId":"@viewer","groupId":"@self"},"jsonrpc":"2.0","key":"p","apiVersion":"v1"}]';try{var i=new XMLHttpRequest;i.timeout=3e3,i.ontimeout=function(){},i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var e=JSON.parse(i.responseText);t(e[0].result.metadata.globalCounts.count)}},i.open("POST","https://clients6.google.com/rpc?key=AIzaSyCKSbrvQasunBoV16zDH9R33D88CeLr9gQ",!0),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("Content-Type","application/json"),i.send(n)}catch(e){}}(e,function(e){t("&gp_count="+e)})}for(var u in i)isSocialCountPredefined(i[u])&&t("&"+i[u]+"="+getSocialPredefinedCount(i[u]))}function isSocialCountPredefined(e){return!!(_ain.social&&e in _ain.social)}function getSocialPredefinedCount(e){return isSocialCountPredefined(e)?_ain.social[e]:0}function getFromCookie(e){var t=e+"=",n=document.cookie.split(";"),i=0;for(i;i<n.length;i+=1){for(var a=n[i];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null}function prepareParam(e){return void 0!==e?encodeURIComponent(e):""}function getValidAdditionalOption(optionId){return optionId in _ain?-1==eval(optionId.toUpperCase()+"_DEFAULTS").indexOf(_ain[optionId])?(_ain.errors.push(_ain["E_INCORRECT_OPTION_"+optionId.toUpperCase()]),""):_ain[optionId]:""}function getBaseAdditionalOption(e){return e in _ain?_ain[e]:""}function createExpirationDate(e){var t=new Date;return t.setTime(t.getTime()+e),t.toGMTString()}function generateCID(){return(new Date).getTime()+"."+1e9*Math.random()}function getLink(e,t){var n=e.querySelector("link[rel='canonical']"),i=e.querySelector("meta[property='og:url']");return null!==n?n.getAttribute("href"):null!==i?i.getAttribute("content"):t||e.URL}function getImage(e){var t=getBaseAdditionalOption(OPTION_IMAGE);if(t)return t;var n=e.querySelector("meta[property='og:image']");return null!==n?n.getAttribute("content"):""}function p(e){return-1==e.indexOf("://")&&(e=g.location.protocol+(0==e.indexOf("//")?"":"//")+e),e}function getText(e){for(var t="",n=e.childNodes.length,i=0;i<n;i++){var a=e.childNodes[i];8==a.nodeType||isElementOnBlackList(a)||(t+=1!=a.nodeType?a.nodeValue:getText(a))}return t}function getTopmostElement(e){return e.reduce(function(e,t){return e.getBoundingClientRect().top>t.getBoundingClientRect().top?t:e})}function getBottommostElement(e){return e.reduce(function(e,t){return e.getBoundingClientRect().bottom<t.getBoundingClientRect().bottom?t:e})}function getMainContentPosition(e){var t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=getTopmostElement(e),i=getBottommostElement(e),a=Math.abs(n.getBoundingClientRect().top-i.getBoundingClientRect().bottom),o=n.getBoundingClientRect().top,r=0;return r=Math.round(100*(t-o)/a),r>100?r=Math.abs(o)>=a?0:100:r<0&&(r=0),r}_ain.E_NO_EL=1,_ain.E_INV_EL=2,_ain.E_NO_SOC=3,_ain.E_LSTN=4,_ain.E_INCORRECT_OPTION_ACCESS_LEVEL=5,_ain.E_INCORRECT_OPTION_READER_TYPE=6,_ain.errors=[],_ain.selectedText="";var elementsBlackList=["SCRIPT","STYLE","CANVAS","MAP","PICTURE","IMG","VIDEO","OBJECT","SVG","IFRAME"],OPTION_ACCESS_LEVEL="access_level",OPTION_ARTICLE_TYPE="article_type",OPTION_IMAGE="image",OPTION_READER_TYPE="reader_type",ACCESS_LEVEL_DEFAULTS=["free","preview","paid"],READER_TYPE_DEFAULTS=["anonymous","registered","subscribed"];_ain.getWordCount=function(e){var t=parseInt(getBaseAdditionalOption("word_count"));return t&&t>0?t:(_ain.selectedText=e.filter(function(e){return!!e}).reduce(function(e,t){return e+=" "+getText(t)},""),_ain.selectedText.split(/\s+/).length)};var isElementOnBlackList=function(e){return-1!==elementsBlackList.indexOf(e.tagName)};_ain.getMainContentEl=function(e){var t=e,n=[];if(!t){var i={5:'[data-url="'+j.url+'"] .post',1304:"#article .info",1285:".article__content",1298:"#detail",1321:"#d_conmment_holder"};t=i[did]?i[did]:"[data-ci-maincontent]"}if("function"!=typeof document.querySelector)return null;try{n=t.split(",").map(function(e){return document.querySelector(e)}).filter(function(e){return!!e})}catch(e){_ain.errors.push(_ain.E_INV_EL)}return n.length?n:null};var g=document,j=_ain,h=getFromCookie("_ain_cid"),f=getFromCookie("_ain_uid"),d=prepareParam(p(j.url||getLink(g))),did=prepareParam(j.id),pid=j.postid?"&pid="+prepareParam(j.postid):"1208"==did?"&pid="+prepareParam(getLink(g)):"",x=Math.random(),r=prepareParam(j.referrer||g.referrer),b="?a="+prepareParam(j.authors);if(b+="&b="+r,b+="&c="+prepareParam(j.title||g.title),b+="&d="+d,b+="&e="+prepareParam(j.sections),b+="&f="+did,b+="&g="+prepareParam(j.pubdate),b+="&h="+prepareParam(j.tags),b+="&i="+prepareParam(j.comments),b+="&j="+prepareParam(getValidAdditionalOption(OPTION_ACCESS_LEVEL)),b+="&k="+prepareParam(getBaseAdditionalOption(OPTION_ARTICLE_TYPE)),b+="&l=",b+="&m="+prepareParam(getValidAdditionalOption(OPTION_READER_TYPE)),b+=pid,j._mcel=!1,j._mcelwc=null,(null!==h||(g.cookie="_ain_cid="+generateCID()+"; expires="+createExpirationDate(18e5)+"; path=/",null!==(h=getFromCookie("_ain_cid"))))&&(null===f&&(f=generateCID()),g.cookie="_ain_uid="+f+"; expires="+createExpirationDate(63072e6)+"; path=/",null!==(f=getFromCookie("_ain_uid")))){if(b+="&u="+h,b+="&ul="+f,b+="&x="+x,did){try{getSocial(prepareParam(p(j.url||g.URL)),function(e){b+=e})}catch(e){_ain.errors.push(_ain.E_NO_SOC)}var paramsPageViewEvent=b+"&t=0&err="+prepareParam(_ain.errors.join());(new Image).src=("https:"==g.location.protocol?"https":"http")+"://page-view-ingestion.appspot.com/i.gif"+paramsPageViewEvent,j._stid&&clearTimeout(j._stid),j._stid=setTimeout(function(){j._mcelwc=j._mcel?"&wc="+_ain.getWordCount(j._mcel):"";var e=b+j._mcelwc+"&t=1&err="+prepareParam(_ain.errors.join());(new Image).src=("https:"==g.location.protocol?"https":"http")+"://page-view-ingestion.appspot.com/i.gif"+e},1e4)}!function(){window.visibly={q:document,p:void 0,prefixes:["webkit","ms","o","moz","khtml"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",fn:null,onVisible:function(e){"function"==typeof e&&this.visibleCallbacks.push(e)},onHidden:function(e){"function"==typeof e&&this.hiddenCallbacks.push(e)},getPrefix:function(){if(!this.cachedPrefix)for(var e=0;bb=this.prefixes[e++];)if(bb+this.props[2]in this.q)return this.cachedPrefix=bb,this.cachedPrefix},visibilityState:function(){return this._getProp(0)},hidden:function(){return this._getProp(2)},visibilitychange:function(e){"function"==typeof e&&this.genericCallbacks.push(e);var t=this.genericCallbacks.length;if(t)if(this.cachedPrefix)for(;t--;)this.genericCallbacks[t].call(this,this.visibilityState());else for(;t--;)this.genericCallbacks[t].call(this,arguments[0])},isSupported:function(e){return this._getPropName(2)in this.q},_getPropName:function(e){return""==this.cachedPrefix?this.props[e].substring(0,1).toLowerCase()+this.props[e].substring(1):this.cachedPrefix+this.props[e]},_getProp:function(e){return this.q[this._getPropName(e)]},_execute:function(e){if(e){this._callbacks=1==e?this.visibleCallbacks:this.hiddenCallbacks;for(var t=this._callbacks.length;t--;)this._callbacks[t]()}},_visible:function(){window.visibly._execute(1),window.visibly.visibilitychange.call(window.visibly,"visible")},_hidden:function(){window.visibly._execute(2),window.visibly.visibilitychange.call(window.visibly,"hidden")},_nativeSwitch:function(){this[this._getProp(2)?"_hidden":"_visible"]()},_listen:function(){try{this.isSupported()?this.q.addEventListener(this._getPropName(1),function(){window.visibly._nativeSwitch.apply(window.visibly,arguments)},1):this.q.addEventListener?(window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):this.q.attachEvent&&(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(e){_ain.errors.push(_ain.E_LSTN)}},init:function(){this.getPrefix(),this._listen()}},this.visibly.init()}(),function(){_ain.atparams={d:d,did:did,pid:pid,h:h,f:f,x:x},_ain.atobj={secondsBetweenBeats:5.5,activeTimeout:5,sampleRateSeconds:.1,eventNames:["focus","mousedown","mouseup","mousemove","scroll","touchstart","touchenter","keyup","keydown"]};var e=(new Date).getTime();if(_ain.atobj._lastEvent=e,_ain.atobj._lastSample=e,_ain.atobj._engagedMs=0,_ain.atobj._engagedMsTotal=0,_ain.atobj.isEngaged=!0,_ain.atobj.isInteracting=!0,_ain.atobj.focused=!0,_ain.atobj.videoPlaying=!1,_ain.atobj.sequenceNum=1,window.visibly.onVisible(function(){_ain.atobj.focused=!0}),window.visibly.onHidden(function(){_ain.atobj.focused=!1}),void 0===_ain.atregisterEvent){var t=function(e,t){window.addEventListener?window.addEventListener(e,t,!1):document.attachEvent("on"+e,t)};_ain.atregisterEvent=function(){_ain.atobj._lastEvent=(new Date).getTime()};for(var n=0;n<_ain.atobj.eventNames.length;n++)t(_ain.atobj.eventNames[n],_ain.atregisterEvent);_ain.atsample=function(){var e=(new Date).getTime();_ain.atobj.isInteracting=e-_ain.atobj._lastEvent<1e3*_ain.atobj.activeTimeout,_ain.atobj.isEngaged=_ain.atobj.isInteracting&&_ain.atobj.focused||_ain.atobj.videoPlaying,_ain.atobj._engagedMs+=_ain.atobj.isEngaged?e-_ain.atobj._lastSample:0,_ain.atobj._lastSample=e},window.setInterval(_ain.atsample,1e3*_ain.atobj.sampleRateSeconds),_ain.atsendBeat=function(){!1===j._mcel&&(j._mcel=_ain.getMainContentEl(j.maincontent),j._mcel||_ain.errors.push(_ain.E_NO_EL));var e=Math.round(_ain.atobj._engagedMs/1e3);if(e>0&&e<=Math.round(_ain.atobj.secondsBetweenBeats)){_ain.atobj._engagedMsTotal+=e;var t="?d="+_ain.atparams.d+"&f="+_ain.atparams.did+_ain.atparams.pid+"&b="+r+"&u="+_ain.atparams.h+"&ul="+_ain.atparams.f+"&at="+_ain.atobj._engagedMsTotal+"&ar="+e+(j._mcel?"&sp="+getMainContentPosition(j._mcel):"")+"&ts="+Math.floor(Date.now()/1e3)+"&seq="+_ain.atobj.sequenceNum+++"&x="+_ain.atparams.x+"&err="+prepareParam(_ain.errors.join());(new Image).src=("https:"==g.location.protocol?"https":"http")+"://quick-yen-88111.appspot.com/a.gif"+t}_ain.atobj._engagedMs=0},window.setInterval(_ain.atsendBeat,1e3*_ain.atobj.secondsBetweenBeats),t("unload",_ain.atsendBeat)}}()}},"undefined"!==_ain.trackauto&&!1===_ain.trackauto||_ain.track();