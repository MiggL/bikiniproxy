var tag_mgmt=function(){return{account:"pcrg",is_touch:(('ontouchstart'in window)||(navigator.msMaxTouchPoints>0)),is_mobile:(window.location.host.search(/^m./)!=-1||window.location.host.search('.bbhosted.')!=-1||window.location.pathname.search('/mobile/')!=-1),environment:(window.location.host.search(/^(stores|www|m|prodtest-web)\./)!=-1)?'prod':'dev',initialized:false,debug_mode:false,udo_json:{},pretealium_udo_json:{},ready_udo_json:{},last_udo_json:{},toggle_basket:false,toggle_basket_to:false,trackLink:function(event,layout_section,layout_detail){var event_type=(event.type=="mouseover"||event.type=="touchstart")?"hover":"click";layout_detail=(layout_detail===false)?"":layout_detail;layout_detail+=event.currentTarget.alt;this.trackAnayticsAction(event,layout_section,layout_detail,event_type);},trackHover:function(elm,layout_section,layout_detail){if(this.is_touch){elm.ontouchstart=function(event,layout_section){tag_mgmt.trackLink(event,layout_section,layout_detail);};}else{elm.onmouseover=function(event,layout_section){tag_mgmt.trackLink(event,layout_section,layout_detail);};}},trackAnayticsAction:function(event,link_position,link_detail,event_type){if(this.initialized===true){link_position=link_position.replace(/\+/g,' ');link_detail=link_detail.replace(/\+/g,' ');if(!event_type){event_type=(event.type=="click"||event.type=="touchstart")?"click":"impression";}
utag.link({link_position:link_position.replace(/\+/g,' '),link_detail:link_detail.replace(/\+/g,' '),event_type:event_type,link_code:'version 2'});}},lazyLoadComplete:function(type){console.log("Lazy Load: "+ type);},initializeAnalytics:function(from_reinitialize){from_reinitialize=(from_reinitialize||false);console.clear();console.log(utag_data);if(utag_data['ut.account']&&utag_data['ut.account'].length!=0){this.initialized=true;this.last_udo_json=this.udo_json;this.udo_json={};this.pretealium_udo_json={};this.ready_udo_json={};from_reinitialize=true}
if(from_reinitialize===true){console.log('Tag Mgmt Reinitialization Started');}else{console.log('Tag Mgmt Initialization Started');}
for(var field in utag_data){this.udo_json[field]=utag_data[field];}
utag_data=[];if(!this.udo_json['site_name']){if(window.console){console.log('Tag Mgmt Initialization Failed: No Site Name');}
return false;}
for(var field in this.udo_json){this.pretealium_udo_json[field]=this.udo_json[field];}
this.udo_json['customer_type']=(this.udo_json['user_anonymous']===true||this.udo_json['user_anonymous']=='true')?'guest':'member';var ifrm=document.querySelector('.header-banner > iframe');if(ifrm){this.udo_json['global_offer']=ifrm.src;}
var ifrm=document.querySelector('.home-navigation-banner > iframe');if(ifrm){this.udo_json['nav_offer']=ifrm.src;}
this.getUdoCookie();this.udo_json['user_agent']=navigator.userAgent;this.setUdoFromCookie('kioskid','kiosk_id');this.setUdoFromCookie('basket','basket_id');this.setUdoFromCookie('customer','customer_id');try{this.udo_json['jvm']=this.udo_json['jsession_id'].split('.')[1];}catch(err){}
try{var ref=decodeURIComponent(tag_mgmt.getUrlParam('udo_ref'));this.udo_json['page_referrer']=(ref.length==0||ref=='false')?document.referrer:ref;}catch(err){this.udo_json['page_referrer']=document.referrer;}
if(this.udo_json['page_referrer'].search(/www\.(party|halloween)city/)!=-1){this.udo_json['page_referrer']="";}
window.utag_data=this.udo_json;for(var field in this.udo_json){this.ready_udo_json[field]=this.udo_json[field];}
try{var script_url='//tags.tiqcdn.com/utag/'+ this.account+'/'+ this.udo_json['site_name'].toLowerCase()+'/'+ this.environment+'/utag.js';if(!document.querySelector('script[src="'+ script_url+'"]')){var js=document.createElement('script');js.src=script_url;js.type='text/javascript';js.async=true;var script=document.getElementsByTagName('script')[0];script.parentNode.insertBefore(js,script);}}catch(err){console.log("UTAG Error");console.log(err.stack);}
this.initialized=true;if(from_reinitialize===true){utag.view(this.udo_json);console.log("tag_mgmt.initialized = utag.view");}
console.log("tag_mgmt.initialized = true");this.addEventTracking();},addEventTracking:function(){this.tagInHouseHtml();this.tagSeoLinks();this.tagGlobalFooter();this.tagPDP();this.tagLeftNav();if(tag_mgmt.ready_udo_json.page_type=="Family")
this.tagFamilyPage();this.tagBasket();this.tagDisplayFilters();this.tagAutoSuggest();this.tagSearchResults();this.tagGlobalHeader();this.tagBreadcrumbs();this.tagDropDowns();this.tagGlobalBasket();this.tagGlobalBanner();if(tag_mgmt.ready_udo_json.page_type=="Directory")
this.tagDirectory();if(tag_mgmt.ready_udo_json.page_type.indexOf("Vertical")>-1){var vInterval=window.setInterval(function(){var vAddToBasket=document.querySelector('.add-to-cart-cyoc');if(vAddToBasket){vAddToBasket.onclick=function(event){var name=document.querySelector('h1.heading').innerHTML.trim();tag_mgmt.trackAnayticsAction(event,name,'Add to Basket',"cart-add");}
clearInterval(vInterval);}},100);}},tagInHouseHtml:function(){var houseLayout=document.querySelectorAll('*[layout]');var ind=0;while(ind<houseLayout.length)
{houseLayout[ind].onclick=function(event){var n_tag=this.innerHTML;n_tag=n_tag.replace(/((<(\/?span)|(<!--))[^>]*>)|(\r|\n)/g," ").trim();if(n_tag.length==0||event.target.localName=="img")
{n_tag=(this.querySelector('*[alt]'))?this.querySelector('*[alt]').alt:this.alt;}
else
n_tag=event.target.innerText.replace(/((<(\/?span)|(<!--))[^>]*>)|(\r|\n)/g," ").trim();var _attr=this.getAttribute('layout');tag_mgmt.trackAnayticsAction(event,_attr,n_tag,event.type);}
ind++;}},tagSeoLinks:function(){var _seoLink=document.querySelectorAll("#seo_links a, .TabfooterLinks a");var _ind=0;while(_ind<_seoLink.length){_seoLink[_ind].onclick=function(event){var _info=tag_mgmt.readInfo(this);tag_mgmt.trackAnayticsAction(event,'SEO Link',_info,event.type);}
_ind++;}},tagGlobalFooter:function(){var footerLink=document.querySelectorAll(".section-link a,.bottom-section a, .social-holder a");var _ind=0;while(_ind<footerLink.length){footerLink[_ind].onclick=function(event){var _info=tag_mgmt.readInfo(this);tag_mgmt.trackAnayticsAction(event,'Footer',_info,event.type);}
_ind++;}
var _signUp=document.getElementById("go-btn");if(_signUp){_signUp.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Footer','Sign UP & Save','email');}}},readInfo:function(elem){var _element_data=null;n_tag=elem.innerHTML.replace(/((<(\/?span)|(<!--))[^>]*>)|(\r|\n)/g," ").trim();if(n_tag.length==0)
{n_tag=(elem.querySelector('*[alt]'))?elem.querySelector('*[alt]').alt:elem.alt;}
return n_tag;},tagPDP:function(){var _sizeChart=document.querySelector('.size-chart-link a');if(_sizeChart){_sizeChart.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Size Chart','',event.type);};}
var _size=document.querySelectorAll('.swatches li');var _ind=0;while(_ind<_size.length)
{_size[_ind].onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Info Tab: Pos '+$(this).index(),event.target.innerText,event.type);}
_ind++;}
tag_mgmt.tagAddToBasket();},tagAddToBasket:function(){var monitorInput=window.setInterval(function(){var addToBasket=document.querySelectorAll('.add-to-cart-pdp');if(addToBasket[0]){var _ind=0;while(_ind<addToBasket.length){addToBasket[_ind].onclick=function(event){var sku=document.querySelector('.sku_id').innerHTML.trim();var name=document.querySelector('h1.product-name').innerHTML.trim();tag_mgmt.trackAnayticsAction(event,sku+":"+ name,'Add to Basket',"cart-add");}
_ind++;}
clearInterval(monitorInput);}},50);},tagLeftNav:function(){var left_nav=document.querySelectorAll('.left-cat-landing li a');var _ind=0;while(_ind<left_nav.length)
{left_nav[_ind].onclick=function(event){var crumb=tag_mgmt.breadcrumb();crumb.push(this.innerText);tag_mgmt.trackAnayticsAction(event,'Left Nav',crumb.join(' > ').replace(/Home > /g,""),'Nav Click');}
_ind++;}},breadcrumb:function(){var bcrumb=document.querySelectorAll('.breadcrumb-section');var _ind=0;var _bcrumb=[];while(_ind<bcrumb.length)
{_bcrumb.push(bcrumb[_ind].innerText);_ind++;}
return _bcrumb;},tagFamilyPage:function(){var jumpLink=document.querySelectorAll('.gray-navigation-tabs h2');var product=document.querySelectorAll('.product-tile');var sku=false,name=false;var addBasket=document.querySelectorAll('.add-to-cart');var _ind=0;while(_ind<jumpLink.length)
{jumpLink[_ind].onclick=function(event){var _name=this.innerHTML.replace(/((<(\/?)|(<!--))[^>]*>)|(\r|\n)|[0-9]/g,'').trim();var _numb=this.innerHTML.replace(/((<(\/?)|(<!--))[^>]*>)|(\r|\n)/g,'').slice(0,1);tag_mgmt.trackAnayticsAction(event,'Jump Link',_numb+" > "+ _name,'Nav Click');}
_ind++;}
_ind=0;while(_ind<product.length)
{product[_ind].onmouseover=function(event){var quickView=document.querySelector('.quickview');if(quickView){quickView.onclick=function(event){tag_mgmt.tagAddToBasket();}}}
product[_ind].onclick=function(event){if(event.target.className!='quickview'&&event.target.tagName!="BUTTON"&&event.target.tagName!="INPUT"&&event.target.className!="product-name"&&event.target.className!="open-bopis-popup"){var _list=$(this.parentNode).index()+ 1;name=this.querySelector('.product-name').innerText.trim();sku=this.getAttribute("data-itemid");tag_mgmt.trackAnayticsAction(event,'Pos '+ _list+":"+ sku+":"+ name,'Price List',event.type);}}
_ind++;}
_ind=0;while(_ind<addBasket.length)
{addBasket[_ind].onclick=function(event){sku=this.parentNode.querySelector('input').value;name=document.querySelector("div[data-itemid='"+sku+"']").querySelector('.product-name').innerText.trim();var _list=$(document.querySelector("div[data-itemid='"+sku+"']").parentNode).index()+ 1;tag_mgmt.trackAnayticsAction(event,'Pos '+ _list+":"+ sku+":"+ name,'Add to Basket',"cart-add");}
_ind++;}},tagBasket:function(){var cont_shop=document.querySelector('button[value="Continue Shopping"]'),add_coupon=document.querySelector('button[id="add-coupon"]'),checkout=document.querySelector('button[value="Checkout"]'),remove_code=document.querySelector('button[value="Remove"]'),coupon_code=document.getElementById('dwfrm_cart_couponCode');if(coupon_code)
coupon_code=coupon_code.value;var print_basket=document.querySelector('.print-basket-button'),_paypal=document.querySelector('.checkout-paypal');if(cont_shop){cont_shop.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Continue Shopping','continue');}}
if(add_coupon){add_coupon.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Apply Source Code:'+ coupon_code,'apply');}}
if(checkout){checkout.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Checkout','checkout');}}
if(_paypal){_paypal.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Remove Source Code:','paypal');}}
if(remove_code){remove_code.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Remove Source Code:'+ coupon_code,'remove');}}
if(print_basket){print_basket.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Print Basket','print');}}
var estimation=document.querySelectorAll('.shipping-estimation-link');_ind=0;while(_ind<estimation.length){estimation[_ind].onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Basket','Estimate Tax and Ship',this.innerText.trim());}
_ind++;}},tagDisplayFilters:function(){var option=document.querySelectorAll('.selection-list li');var _wait=setInterval(function(){if(option.length<=0)
option=document.querySelectorAll('.selection-list li');else
{var _ind=0;while(_ind<option.length){option[_ind].onclick=function(event){console.log(this);tag_mgmt.trackAnayticsAction(event,'Filter Drop Down',"Our Picks > "+ this.innerText.trim(),'Filter');}
_ind++;}
clearInterval(_wait);}},100);},tagAutoSuggest:function(){if(this.initialized=true)
{var _quest=document.querySelector('input[name="q"]');if(_quest){_quest.onkeydown=function(){if(this.value.length>=3)
{var sugg_item=document.querySelectorAll('.phrase-suggestions');var ind=0;while(ind<sugg_item.length)
{sugg_item[ind].onclick=function(event){var search=document.querySelector('input[name="q"]').value.toLowerCase();var sugg=this.innerText.trim().toLowerCase();tag_mgmt.trackAnayticsAction(event,'AutoSuggest',search+":"+ sugg,'selected');}
ind++;}}}}}},tagSearchResults:function(){this.tagDisplayFilters();var clearContent=document.querySelectorAll('.clear-refinement');var _ind=0;while(_ind<clearContent.length)
{clearContent[_ind].onclick=function(event){var header=this.parentNode.querySelector('h3').innerText.trim();tag_mgmt.trackAnayticsAction(event,'Facet',header+":Clear",'click');}
_ind++;}},tagGlobalHeader:function(){var logo=document.querySelector('.primary-logo'),nav_link=document.querySelectorAll('.menu-utility-user li'),level_1=document.querySelectorAll('.level-1 li a'),_search=document.querySelector('form[name="simpleSearch"]'),breadCrumb=document.querySelectorAll('.breadcrumb-section a');if(breadCrumb){var _ind=0;while(_ind<breadCrumb.length)
{$(breadCrumb[_ind]).bind('click',{i:_ind},function(event){tag_mgmt.trackAnayticsAction(event,'Breadcrumb','Pos '+ event.data.i+":"+ this.innerText.trim(),event.type);});_ind++;}}
if(logo){logo.onclick=function(event){tag_mgmt.trackAnayticsAction(event,'Header','Logo',event.type);}}
if(nav_link){var _ind=0;while(_ind<nav_link.length){nav_link[_ind].onclick=function(){switch(this.className){case"country-selector-drawer":var shipto=event.target.innerText.trim();if(shipto.indexOf("Shipping")>-1)
shipto=this.querySelector('.current-country .visually-hidden').innerText.trim();tag_mgmt.trackAnayticsAction(event,'Header',"Ship To:"+ shipto,event.type)
break;default:tag_mgmt.trackAnayticsAction(event,'Header',this.innerText.trim(),event.type);break;}}
_ind++;}}
if(level_1){var _ind=0;while(_ind<level_1.length){level_1[_ind].onclick=function(event){var locClass=this.parentNode.parentNode;if(this.parentNode.className.replace(/active|\s/g,"")==="top-sub-cat")
{var parentName=this.parentNode.parentNode.parentNode.querySelector('a');tag_mgmt.trackAnayticsAction(event,'Nav L2',parentName.innerText.trim()+" > "+ this.innerText.trim(),'Nav Click');}
if(locClass.className==="level-4"){console.log(locClass.parentNode.parentNode.parentNode.parentNode.querySelector("a"));var _parent=locClass.parentNode.parentNode.parentNode.parentNode.querySelector("a").innerText.trim();var grandPa=locClass.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector("a").innerText.trim();tag_mgmt.trackAnayticsAction(event,'Nav L3',grandPa+" > "+ _parent+" > "+ this.innerText.trim(),'Nav Click');}
else if(this.parentNode.className.replace(/active|\s/g,"")==="top-cat")
tag_mgmt.trackAnayticsAction(event,'Nav L1',this.innerText.trim(),'Nav Click');}
_ind++;}}
if(_search){_search.onsubmit=function(event){tag_mgmt.trackAnayticsAction(event,'Search',this.querySelector('input[name="q"]').value,'term');}}},tagBreadcrumbs:function(){var breadC=document.querySelectorAll('.breadcrumb-section a');var bread=[];if(breadC){var _ind=0;while(_ind<breadC.length){bread.push(breadC[_ind].innerText.trim());_ind++;}
_ind=0;while(_ind<breadC.length){jQuery(breadC[_ind]).bind('click',{nav_level:bread,i:_ind},function(event){var path=new Array();for(var j=0;j<=event.data.i;j++){path.push(event.data.nav_level[j]);}
path.push(event.data.nav_level[event.data.i]);tag_mgmt.trackAnayticsAction(event,'Breadcrumb',path.join(' > '),'Nav Click');});_ind++;}}},tagDropDowns:function(){var checkboxes=document.querySelectorAll('.filter-by ul li');var _wait=setInterval(function(){if(checkboxes.length<=0)
checkboxes=document.querySelectorAll('.filter-by ul li');else{var _ind=0;while(_ind<checkboxes.length)
{checkboxes[_ind].onclick=function(event){var choice=this.innerHTML.replace(/(((<(\/?)|(<!--))[^>]*>)|(\r|\n))+/g,"");console.log(choice);tag_mgmt.trackAnayticsAction('filter_click','Filter Dropdown',choice,'Filter');}
_ind++;}
clearInterval(_wait);}},100);},tagGlobalBasket:function(new_basket_items,retry){var basket_line={};var line={};var previous_basket_line=window.top.previousBasket;var product=document.querySelectorAll('.mini-cart-product');var sold_for;var sku;var _ind=0;while(_ind<product.length){sku=product[_ind].querySelector('img').src.replace(/http(.*)\//g,"");if(!basket_line[sku]){basket_line[sku]={sku:sku,name:product[_ind].querySelector('.mini-cart-name').innerText.trim(),qty:0,price:0.00,};}
basket_line[sku].qty+=parseInt(product[_ind].querySelector('.mini-cart-qty .value').innerText);sold_for=product[_ind].querySelector('.mini-cart-price').innerText.trim().replace('$','');basket_line[sku].price=Math.max(parseFloat(basket_line[sku].price),parseFloat(sold_for));basket_line[sku].price=parseFloat(basket_line[sku].price).toFixed(2);product_units_this_add=basket_line[sku].qty;_ind++;}
var position;var a2b_call;if(this.is_mobile===false&&typeof new_basket_items=='object'){if(new_basket_items.length>1){basket_joined=new_basket_items.join(" | ");new_basket_items=new Array(basket_joined);}
for(var i=0;i<new_basket_items.length;i++){if(new_basket_items[i]=="TBD"){console.log("TBD!");var part=new Array(this.udo_json['page_type'],"TBD Product");}else{var part=new_basket_items[i].split('|');}}
if(typeof part[1]!="undefined"){var basketDelta=tag_mgmt.returnBasketDelta(basket_line,previous_basket_line);if(typeof basketDelta!="undefined"){var sizeCounter0=0;var sizeCounter=0;for(count in basketDelta){sizeCounter0++;}
for(x=0;x<sizeCounter0;x++){if(typeof basketDelta[x]=="object"){sizeCounter++;}}
var counter=0;for(y=0;y<sizeCounter;y++){var sku=basketDelta[y]["sku"];var productName=basketDelta[y]["name"];if(typeof this.udo_json['page_type']!="undefined"&&typeof this.udo_json['page_type']!=null){switch(this.udo_json['page_type'].toUpperCase()){case'PDP':if(part[0]=="TBD"||part[0]==""){position=this.udo_json['page_type'];}else if(part[0]=="Family"){position="Family PDP";}else{position=part[0];}
break;default:position=this.udo_json['page_type'];break;}}else{if(window.top.tag_mgmt.udo_json['page_type']=="Directory"){position="Directory QS";}else if(window.top.tag_mgmt.udo_json['page_type']=="Family"){position="Family QS";}else if(window.top.tag_mgmt.udo_json['page_type']=="Search Results"){position="Search Results QS";}else{position="PDP QS";}}
a2b_call={event_type:'cart-add',product_position:position,product_name:new Array(productName),product_sku:new Array(sku),product_revenue:basketDelta[y]["price"],product_units:basketDelta[y]["qty"],link_text:'cart-add'};if(window.console){}
if(self==top){utag.link(a2b_call);}else{window.parent.utag.link(a2b_call);}
counter++;}}}else{}}
if(window.console){console.log("A2B CALL END");}
this.basket_line=basket_line;this.previous_basket_line=basket_line;window.top.currentBasket=basket_line;window.top.previousBasket=basket_line;},tagGlobalBanner:function(){var global_header=document.querySelector('.header-banner');if(global_header){var area=global_header.querySelectorAll('a');for(var i=0;i<area.length;i++){area[i].onclick=function(event){var link_pos=(this.parentNode.childElementCount==1)?'Discount':'Discount '+ parseInt(i+ 1);var link_det=global_header.querySelector('img').getAttribute('alt').replace(/(\d+)%/g,"$1P");var link_det=link_det.replace(/\$(\d+)/g,"$1D");var action=(this.href.search("PC_POP")==-1)?'click':'modal';tag_mgmt.trackAnayticsAction(event,'Header','Discount|'+ link_pos+":"+ link_det,action);};if(this.is_touch){area[i].onmouseover=function(event){var link_pos=(this.parentNode.childElementCount==1)?'Discount':'Discount '+ parseInt(i+ 1);var link_det=global_header.querySelector('img').getAttribute('alt').replace(/(\d+)%/g,"$1P");var link_det=link_det.replace(/\$(\d+)/g,"$1D");var action=(this.href.search("PC_POP")==-1)?'click':'modal';tag_mgmt.trackAnayticsAction(event,'Header','Discount|'+ link_pos+":"+ link_det,action);};}}
if(this.debug_mode===true&&window.console){if(!document.all){console.timeStamp();}
console.log("tag_mgmt.tagGlobalBanner();");}}else if($('#divAdLogo iframe')[0]){window.setTimeout("tag_mgmt.tagGlobalBanner()",.5*1000);}},tagDirectory:function(){var product=document.querySelectorAll('.product-tile');var sku=false,name=false;var addBasket=document.querySelectorAll('.add-to-cart');var _ind=0;while(_ind<product.length)
{product[_ind].onclick=function(event){var method,name,sku;var _list=$(this.parentNode).index()+1;name=this.querySelector('.product-name').innerText.trim();sku=this.getAttribute("data-itemid");var _clickType=event.type;if(event.target.nodeName=="IMG"){method="Image";}
else if(event.target.className=='add-to-cart'){method="Add to Basket";_clickType="cart-add";}
else if(event.target.className=='quickView'){tag_mgmt.tagAddToBasket();}
else if(event.target.className=='quickview'&&event.target.className=='open-bopis-popup'&&event.target.className=='product-name'){method="Name";return;}
else{return;}
tag_mgmt.trackAnayticsAction(event,'Pos '+ _list+":"+ sku+":"+ name,method,_clickType);}
_ind++;}
_ind=0;},reinitializeAnalytics:function(){if(window.console){if(!document.all){console.timeStamp();}
console.log('tag_mgmt.reinitializeAnalytics');}
this.initialized=true;this.last_udo_json=this.udo_json;this.udo_json={};this.pretealium_udo_json={};this.ready_udo_json={};this.initializeAnalytics(true);},getTextContent:function(elm){if(elm.textContent){var result=elm.textContent;}else if(elm.innerText){var result=elm.innerText;}else{var result=elm.innerHTML;}
return result.trim();},readCookie:function(name){try{var name_eq=name+"=";var cookie=document.cookie.split(';');var result=false;for(var i=0;i<cookie.length&&result===false;i++){var c=cookie[i];value=c.split("=");if(value[0].trim()==name){result='';for(var j=1;j<value.length;j++){result+=(result.length==0)?"":"=";result+=value[j];}}}
if(typeof(result)=='string'){if(result.match(/^\{.*\}$/)!=null){result=JSON.parse(result);}else if(result.match(/\[.*\]/)!=null){result=JSON.parse(JSON.parse(result));}}}catch(e){}
return result;},setCookie:function(name,value,exp_days){try{switch(typeof(value)){case'object':value=JSON.stringify(value);break;default:value=escape(value);break;}
var exp_date=new Date();exp_date.setDate(exp_date.getDate()+ exp_days);document.cookie=name+"="+ value+((exp_days==null)?"":"; expires="+ exp_date.toUTCString())+"; path=/";if(this.debug_mode===true&&window.console){if(!document.all){console.timeStamp();}
console.log("'"+ name+"' Saved to Cookie");}}catch(e){}},getUrlParam:function(name){var result=false;try{name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+ name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results.length>=1){result=results[1];}}catch(err){};return result;},getUdoCookie:function(){var cookie=document.cookie.split(';');var name=false;var value=false;var result=false;for(var i=0;i<cookie.length;i++){value=cookie[i].split('=');if(value[0].match('last_page_udo__')!=-1){name=value[0].replace('last_page_udo__','').trim();this.last_udo_json[name]=this.readCookie(value[0].trim());}}},setUdoFromCookie:function(name,index){var result=this.readCookie(name);if(result!==false){this.udo_json[index]=result;}}};}();function clearDigitalBrowserCookies(){document.cookie="basket=false; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/;";document.cookie="customer=false; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/;";document.cookie="fv_mill=false; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/;";}
function bopisA2bCheck(retry){retry=(retry||0);try{console.clear();}catch(err){}
try{console.log('BOPIS Start ['+ retry+'] ...');if(tag_mgmt.readCookie('storepickup')===false){var domain=(window.location.hostname.search(/partycity.com/i)!=-1)?'stores.apps.partycity.com':'stores.dev.apps.partycity.com';jQuery.ajax({type:'post',url:'//'+ domain+'/_entry/demandware/a2b_check.php',}).done(function(response,status,obj){if(response.allow_a2b===true){console.log("BOPIS: A2B Check = YES");tag_mgmt.setCookie('storepickup',1,90);}else{console.log("BOPIS: A2B Check = NO");tag_mgmt.setCookie('storepickup',0,1);}}).fail(function(response,status,obj){console.log("BOPIS: A2B Check Failed");tag_mgmt.setCookie('storepickup',0,1);});}else{console.log("BOPIS: A2B Check Skipped");}
console.log('BOPIS End ...');}catch(err){if(retry<5){window.setTimeout(bopisA2bCheck,.25*1000,(retry+ 1));}else{console.log('BOPIS Error ...');console.log(err.stack);}}}
bopisA2bCheck();