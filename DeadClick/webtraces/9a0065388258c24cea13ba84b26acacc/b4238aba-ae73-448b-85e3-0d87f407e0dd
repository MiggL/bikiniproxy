define(["jquery","wcs.utils","wcs.context","jquery-ui"],function(e,j,m){var h=false;function c(){e(".store-results-count-js").empty();e(".found-stores-js").empty();e(".store-details-js").hide()}function l(){e(".store-results-count-js").empty();e(".found-stores-js").empty();e(".store-details-js").hide();e(".find-store-container-js").hide()}function g(){if(e(".touch").length===0){return}if(main.screen.size()==="small"){e(".retail-store-phone-js").each(function(){var n=e(this);phoneNumber=n.find("span").text();n.find("span").wrap('<a href="tel:'+phoneNumber+'"/>')})}}function i(n,p){var o=encodeURIComponent(n);switch(j.getDeviceType()){case"ios":return("http://maps.apple.com?saddr="+p+"&daddr="+o);case"android":return("geo:0,0?q="+o);case"wp7":return("maps:"+o);case"wp8":return("bingmaps:?where="+o);default:return("http://maps.google.com?saddr="+p+"&daddr="+o)}}function k(n){if(h){console.log("set USER_ENTERED_ZIP zip value",n)}m.setCookie("USER_ENTERED_ZIP",n)}function d(o){var n=m.getCookie(o);if(n!==null&&n!==undefined){return n}return undefined}function f(){var o=WCS_CONFIG.get("BOPIS::bopisFavStore")+m.getStoreId();var n=m.getCookie(o);if(n!==null&&n!==undefined){return n}return undefined}function b(){if(e("#find-in-store-modal").length){e("#find-in-store-modal").foundation("reveal","open",{error:function(){console.debug("failed to load modal:"+url)}})}e(".store-results-list").empty()}function a(o,p){var n=o;e(n).autocomplete({appendTo:".cityStateZip-search-results",minLength:3,select:function(q,r){e(this).val(r.item.label);p(q)},open:function(){e(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){e(this).removeClass("ui-corner-top").addClass("ui-corner-all")},source:function(r,q){if(e(n)[0].checkValidity()){e.ajax({url:"VFAjaxGetCityStateAPI",cache:true,dataType:"json",type:"GET",async:true,data:"searchTerm="+r.term}).done(function(s){if(s.cs){q(e.map(s.cs,function(t){return{label:t.city+", "+t.sCode,value:t.city+", "+t.sCode}}))}else{if(s.zc){e(".cityStateZip-results-text").text(s.zc.city+", "+s.zc.sCode)}else{if(!s.zc||!s.cs){e(".cityStateZip-results-text").text("")}}}}).fail(function(s){e(".cityStateZip-results-text").text("An error has occurred. Please try again.")})}}})}return{openPopup:b,setEnteredZipToCookie:k,getZipCookie:d,getFavCookie:f,clearRetailStoreForm:c,hideRetailStoreInfo:l,getGoogleMapsLink:i,cityStateZipSearch:a,convertPhoneSpanToATag:g}});