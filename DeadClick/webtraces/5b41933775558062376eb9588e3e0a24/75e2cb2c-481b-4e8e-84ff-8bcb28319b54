define(["jquery","underscore","backbone","./ticker.tmpl"],function(a,b,c,d){d=b.template(d);var e=c.View.extend({events:{mouseenter:"pause",mouseleave:"cont","click .ticker-next:not(.is-disabled)":"next","click .ticker-prev:not(.is-disabled)":"prev"},currentIndex:0,total:0,timer:null,active:!0,initialize:function(a){b.extend(this,a.options),b.bindAll(this,"cont","next"),this.$tickerItems=this.$("li"),this.total=this.$tickerItems.length;if(this.total<2)return;this.$(this.insertBefore).before(d()),this.$next=this.$(".ticker-next"),this.$prev=this.$(".ticker-prev"),this.cont(),this.render()},change:function(a){var b=this,c=this.currentIndex+a;this.atEnd()&&a===1?c=0:this.atStart()&&a===-1&&(c=this.total-1),this.hideItem(this.currentIndex),setTimeout(function(){b.showItem(c)},this.switchDelay),this.currentIndex=c,this.render()},render:function(){this.$next.toggleClass("is-disabled",this.atEnd()),this.$prev.toggleClass("is-disabled",this.atStart())},cont:function(){!this.timer&&this.active&&(this.timer=setInterval(this.next,this.delay))},showItem:function(a){this.$tickerItems.eq(a).addClass("current")},hideItem:function(a){this.$tickerItems.eq(a).removeClass("current")},wait:function(){var a=this;this.pause(),this.active=!1,setTimeout(function(){a.active=!0,a.cont()},this.resetDelay)},pause:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},next:function(a){a&&this.wait(),this.change(1)},prev:function(a){a&&this.wait(),this.change(-1)},atStart:function(){return this.currentIndex===0},atEnd:function(){return this.currentIndex===this.total-1}},{defaults:{selector:".ticker",insertBefore:"ul:first",switchDelay:100,delay:5e3,resetDelay:5e3}});if(window.Modernizr&&!Modernizr.csstransitions){var f=e.prototype.initialize;e.prototype.initialize=function(){f.apply(this,arguments),this.$tickerItems.eq(this.currentIndex).css("opacity",1)},e.prototype.showItem=function(b){this.$tickerItems.eq(b).css("opacity",0).animate({opacity:1},200,function(){a(this).addClass("current")})},e.prototype.hideItem=function(b){this.$tickerItems.eq(b).css("opacity",1).animate({opacity:0},200,function(){a(this).removeClass("current")})}}var g={Ticker:e,init:function(c){return c=b.extend({},e.defaults,c),a(c.selector).each(function(){var b=a(this).find("li").length;b>1&&a.data(this,"ticker",new e({el:this,options:c}))})}};return g})